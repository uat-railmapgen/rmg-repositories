"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[9586],{4074:function(t,n,e){e.r(n);var r=e(9439),a=e(3433),i=e(2791),c=e(6169),o=e(8306),s=e(184);n.default=(0,i.memo)((function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l,{}),(0,s.jsx)(f,{})]})}));var l=(0,i.memo)((function(){return(0,s.jsx)("defs",{children:(0,s.jsx)("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:(0,s.jsx)("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})})),f=function(){var t=(0,c.CG)((function(t){return t.helper})),n=t.routes,e=t.branches,l=(0,c.CG)((function(t){return t.param})),f=l.line_name,x=l.current_stn_idx,g=l.direction,j=l.stn_list,p=l.platform_num,_=l.info_panel_type,v=l.svgWidth,w=l.svg_height,z=l.loop,S=z?(0,o.f2)(e,g,j,x):function(t,n,e){return(0,a.Z)(new Set(t.filter((function(t){return t.includes(e)})).map((function(t){var e=t.filter((function(t){return!["linestart","lineend"].includes(t)}));return"l"===n?e[0]:e.reverse()[0]}))))}(n,g,x),N=z||"sh2020"===_?S.map((function(t){return j[t].name.map((function(t){return t.replace("\\"," ")}))})):[[S.map((function(t){return j[t].name[0]})).join("\uff0c"),S.map((function(t){return j[t].name[1]})).join(", ").replace("\\"," ")]],k=(0,i.useRef)(null),Z=(0,i.useState)({width:0}),b=(0,r.Z)(Z,2),E=b[0],M=b[1];(0,i.useEffect)((function(){return M(k.current.getBBox())}),[JSON.stringify(N),JSON.stringify(x)]);var y=v.destination/2,B=y-10-36-E.width>=162.5&&y-10-36-264>=162.5?y:"l"===g?(v.destination+E.width-264)/2:(v.destination-E.width+264)/2;return(0,s.jsxs)("g",{transform:"translate(0,".concat(w-300,")"),children:[(0,s.jsx)("path",{stroke:"var(--rmg-theme-colour)",strokeWidth:12,d:"l"===g?"M".concat(v.destination-24,",16 H 36"):"M24,16 H ".concat(v.destination-36),transform:"translate(0,220)",markerEnd:"url(#slope)"}),(0,s.jsx)(u,{ref:k,destNames:N}),""!==p&&(0,s.jsx)("g",{transform:"translate(".concat(B,",0)"),children:(0,s.jsx)(m,{})}),f[0].match(/^[\w\d]+/)?(0,s.jsx)(d,{}):(0,s.jsx)(h,{})]})},u=(0,i.forwardRef)((function(t,n){var e=t.destNames,r=(0,c.CG)((function(t){return t.param})),a=r.direction,o=r.svgWidth;return(0,s.jsxs)("g",{ref:n,transform:"translate(".concat("l"===a?36:o.destination-36,",145)"),children:[(0,s.jsx)("g",{transform:"translate(0,".concat(2===e.length?-20:20,")"),children:(0,s.jsx)("path",{d:"M60,60L0,0L60-60H100L55-15H160V15H55L100,60z",fill:"black",transform:"rotate(".concat("l"===a?0:180,")scale(0.8)")})}),(0,s.jsx)("g",{textAnchor:"l"===a?"start":"end",transform:"translate(".concat("l"===a?148:-148,",25)"),children:e.map((function(t,n){return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:70,dy:-100*n+7,children:"\u5f80"+t[0]},"zh".concat(n)),(0,s.jsx)("text",{className:"rmg-name__en",fontSize:25,dy:-100*n+40,children:"To "+t[1]},"en".concat(n))]},n)}))})]})})),m=function(){var t=(0,c.CG)((function(t){return t.param})).platform_num;return(0,i.useMemo)((function(){return(0,s.jsxs)("g",{transform:"translate(".concat(-102.5,",150)"),children:[(0,s.jsx)("circle",{r:60,fill:"none",stroke:"black",strokeWidth:2}),(0,s.jsx)("text",{className:"rmg-name__en",dominantBaseline:"central",fontSize:120,textAnchor:"middle",children:t}),(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:100,dominantBaseline:"central",x:65,children:"\u7ad9\u53f0"})]})}),[t])},h=function(){var t=(0,c.CG)((function(t){return t.param})),n=t.line_name,e=t.direction,o=t.svgWidth,l="l"===e?o.destination-42:42,f=(0,i.useRef)(null),u=i.useState({width:0}),m=(0,r.Z)(u,2),h=m[0],d=m[1];i.useEffect((function(){return d(f.current.getBBox())}),(0,a.Z)(n));var x=("l"===e?-h.width:0)-6,g=("l"===e?-1:1)*h.width/2;return(0,i.useMemo)((function(){return(0,s.jsxs)("g",{transform:"translate(".concat(l,",92)"),children:[(0,s.jsx)("rect",{fill:"var(--rmg-theme-colour)",x:x,width:h.width+10,height:120}),(0,s.jsxs)("g",{textAnchor:"r"===e?"start":"end",transform:"translate(0,68)",fill:"var(--rmg-theme-fg)",children:[(0,s.jsx)("g",{ref:f,children:(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:68,children:n[0]})}),(0,s.jsx)("text",{className:"rmg-name__en",fontSize:30,textAnchor:"middle",x:g,dy:42,children:n[1]})]})]})}),[h,l,e,n])},d=function(){var t=(0,c.CG)((function(t){return t.param})),n=t.line_name,e=t.direction,o=t.svgWidth,l=n[0].match(/^[\w\d]+|.+/g),f=(0,r.Z)(l,2),u=f[0],m=f[1],h="l"===e?o.destination-36-210:90;return(0,i.useMemo)((function(){return(0,s.jsxs)("g",{transform:"translate(".concat(h,",92)"),children:[(0,s.jsx)("rect",{fill:"var(--rmg-theme-colour)",x:-54,width:108,height:120}),(0,s.jsx)("text",{className:"rmg-name__zh",fill:"var(--rmg-theme-fg)",fontSize:96,textAnchor:"middle",dominantBaseline:"central",transform:"translate(0,60)",letterSpacing:-5,children:u}),(0,s.jsxs)("g",{textAnchor:"start",transform:"translate(74,68)",children:[(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:68,children:m}),(0,s.jsx)("text",{className:"rmg-name__en",fontSize:30,dy:42,children:n[1]})]})]})}),[h].concat((0,a.Z)(n),[e,o.destination]))}},8306:function(t,n,e){e.d(n,{cX:function(){return a},Ft:function(){return i},f2:function(){return c}});var r=e(3433),a=function(t,n,e,a){var i=t.length-2*a-e,c=t.findIndex((function(t){return t===n})),o=[].concat((0,r.Z)(t),(0,r.Z)(t),(0,r.Z)(t)),s=t.length+c-Math.floor(i/2)+(i%2===0?1:0),l=t.length+c+Math.floor(i/2);return{top:o.slice(s,l+1),left:o.slice(s-a,s),right:o.slice(l+1,l+1+a),bottom:o.slice(l+1+a,l+1+a+e)}},i=function(t,n){var e=Object.fromEntries(t.map((function(t){return[t,-1]}))),r=Object.fromEntries(t.map((function(t){return[t,-1]}))),a=.1;return n.top.forEach((function(t,i){e[t]=a/2+.9/(n.top.length+1)*(i+1),r[t]=0})),n.right.forEach((function(t,i){e[t]=1,r[t]=a/2+.9/(n.right.length+1)*(i+1)})),n.bottom.forEach((function(t,a){e[t]=.95-.9/(n.bottom.length+1)*(a+1),r[t]=1})),n.left.forEach((function(t,a){e[t]=0,r[t]=.95-.9/(n.left.length+1)*(a+1)})),{x_shares:e,y_shares:r}},c=function(t,n,e,a){var i=t[0].filter((function(t){return!["linestart","lineend"].includes(t)})),c=[].concat((0,r.Z)(i),(0,r.Z)(i),(0,r.Z)(i)),o="r"===n?c:c.reverse(),s=o.findIndex((function(t){return a===t}))+i.length;return o.slice(s+1).filter((function(t){return e[t].loop_pivot})).slice(void 0,2)}}}]);
//# sourceMappingURL=destinationSHMetro.e88f24b0.chunk.js.map