"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[4880],{41552:function(n,t,e){e.r(t),e.d(t,{default:function(){return m},DefsSHMetro:function(){return p}});var r=e(4942),i=e(1413),s=e(72791),a=e(23824),c=e(25481),l=e(78359),o=e(20713),u=e(37732),h=e(54940),d=e(62554),f=e(80184),g=o.Ht.Indoor;function m(){var n=(0,u.Qy)((function(n){return n.app})).canvasScale,t=(0,u.Qy)((function(n){return n.param})),e=t.svgWidth,r=t.svg_height,i=t.theme,s=t.loop,a=e[g];return(0,f.jsxs)(d.Z,{type:g,svgWidth:a,svgHeight:r,canvasScale:n,theme:i,children:[(0,f.jsx)(p,{}),s?(0,f.jsx)(h.Z,{bank_angle:!1,canvas:o.Ht.Indoor}):(0,f.jsx)(_,{}),(0,f.jsx)(k,{})]})}var p=s.memo((function(){return(0,f.jsxs)("defs",{children:[(0,f.jsx)("circle",{id:"stn_indoor_sh",fill:"var(--rmg-white)",strokeWidth:5,r:8,transform:"scale(1.5)"}),(0,f.jsx)("path",{id:"int2_indoor_sh",fill:"var(--rmg-white)",transform:"translate(0, -10)scale(2)",strokeWidth:4,d:"M -5,0 a 5,5 0 1 1 10,0 V10 a 5,5 0 1 1 -10,0Z"}),(0,f.jsx)("path",{id:"express_indoor_sh",fill:"var(--rmg-white)",transform:"translate(0, -10)scale(2)",strokeWidth:4,d:"M -5,0 a 5,5 0 1 1 10,0 V25 a 5,5 0 1 1 -10,0Z"}),(0,f.jsx)("path",{id:"direct_indoor_sh",fill:"var(--rmg-white)",transform:"translate(0, -10)scale(2)",strokeWidth:4,d:"M -5,0 a 5,5 0 1 1 10,0 V40 a 5,5 0 1 1 -10,0Z"})]})})),x=function(n,t){var e=0;return 2===n[t].parents.length&&(e+=1),2===n[n[t].parents[0]].children.length&&(e+=1),e},v=function(n,t){var e=0;return 2===n[t].children.length&&(e+=1),2===n[n[t].children[0]].parents.length&&(e+=1),e},_=function(){var n=(0,u.Qy)((function(n){return n.helper})),t=n.routes,e=n.branches,c=n.depsStr,h=(0,u.Qy)((function(n){return n.param})),d=(0,a.Az)(h.stn_list,x,v),g=(0,a.QE)("linestart","lineend",d),m=(0,a.QE)(g.nodes[1],g.nodes.slice(-2)[0],d),p=s.useMemo((function(){return console.log("computing x shares"),Object.keys(h.stn_list).reduce((function(n,t){return(0,i.Z)((0,i.Z)({},n),{},(0,r.Z)({},t,(0,a.ML)(t,d,e)))}),{})}),[e.toString(),JSON.stringify(d)]),_=[h.svgWidth.indoor*h.padding/100,h.svgWidth.indoor*(1-h.padding/100)],k=Object.keys(p).reduce((function(n,t){return(0,i.Z)((0,i.Z)({},n),{},(0,r.Z)({},t,_[0]+p[t]/m.len*(_[1]-_[0])))}),{}),Z=(0,s.useMemo)((function(){return l.A_.getYShares(h.stn_list,e)}),[c]),S=Object.keys(Z).reduce((function(n,t){return(0,i.Z)((0,i.Z)({},n),{},(0,r.Z)({},t,Z[t]*h.branchSpacingPct*h.svg_height/200))}),{}),w=s.useMemo((function(){return(0,a.h6)(h.current_stn_idx,t,h.direction)}),[h.current_stn_idx,h.direction,t.toString()]),O=Object.values(o.K9),b=Object.values(h.stn_list).map((function(n){return n.services})).flat().reduce((function(n,t){return n[O.indexOf(t)]=!0,n}),[!1,!1,!1]).map((function(n,t){return[O[t],n]})).filter((function(n){return n[1]})).map((function(n){return n[0]})),z=l.A_.drawLine(e,w,h.stn_list,_,k,S,h.branchSpacingPct*h.svg_height/200,g,0);return(0,f.jsxs)("g",{id:"main",transform:"translate(0,".concat(h.svg_height/2,")"),children:[(0,f.jsx)(j,{paths:z,services:b}),(0,f.jsx)(y,{xs:k,ys:S,services:b})]})},j=function(n){return(0,f.jsx)("g",{fill:"none",strokeWidth:12,stroke:"var(--rmg-theme-colour)",children:n.services.map((function(t,e){return(0,f.jsxs)("g",{transform:"translate(0, ".concat(30*e,")"),children:[n.paths.main.map((function(n,t){return(0,f.jsx)("path",{d:n},t)})),n.paths.pass.map((function(n,t){return(0,f.jsx)("path",{d:n},t)}))]},"indoor_line_".concat(e))}))})},y=function(n){var t=(0,u.Qy)((function(n){return n.helper})).branches,e=(0,u.Qy)((function(n){return n.param})),r=n.xs,i=n.ys,s=n.services;return(0,f.jsx)("g",{children:Object.keys(e.stn_list).filter((function(n){return!["linestart","lineend"].includes(n)})).filter((function(n){return 0!==e.stn_list[n].services.length})).map((function(n){return(0,f.jsx)("g",{transform:"translate(".concat(r[n],",").concat(i[n],")"),children:(0,f.jsx)(c.Z,{stnId:n,nameDirection:t.filter((function(t){return t.includes(n)})).map((function(t){return t.indexOf(n)%2===0||s.length>1?"downward":"upward"}))[0],services:s})},n)}))})},k=function(){var n=(0,u.Qy)((function(n){return n.param}));return s.useMemo((function(){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("g",{transform:"translate(".concat(n.svgWidth.indoor/2,",50)"),children:(0,f.jsxs)("text",{textAnchor:"middle",fontSize:"30",className:"rmg-name__zh",children:["\u8f68\u9053\u4ea4\u901a",n.line_name[0],"\u8fd0\u8425\u7ebf\u8def\u793a\u610f\u56fe"]})}),(0,f.jsxs)("g",{transform:"translate(".concat(n.svgWidth.indoor/2,",").concat(n.svg_height-270,")"),children:[(0,f.jsx)("text",{textAnchor:"middle",fontSize:"18",className:"rmg-name__zh",dx:"-30",dy:"230",children:"\u53cb\u60c5\u63d0\u793a\uff1a\u8bf7\u7559\u610f\u60a8\u9700\u8981\u6362\u4e58\u7ebf\u8def\u7684\u9996\u672b\u73ed\u65f6\u95f4\uff0c\u4ee5\u514d\u803d\u8bef\u60a8\u7684\u51fa\u884c\uff0c\u672b\u73ed\u8f66\u8fdb\u7ad9\u524d\u4e09\u5206\u949f\u505c\u552e\u8be5\u672b\u73ed\u8f66\u8f66\u7968\u3002"}),(0,f.jsx)("text",{textAnchor:"middle",fontSize:"12",className:"rmg-name__en",dx:"10",dy:"250",children:"Please pay attention to the interchange schedule if you want to transfer to other lines. Stop selling tickets 3 minutes before the last train services."}),(0,f.jsxs)("g",{transform:"translate(-600,215)",children:[(0,f.jsx)("rect",{x:"-5",y:"-25",width:"100",height:"70",fill:"none",stroke:"black",rx:"5"}),(0,f.jsx)("line",{x1:"28",x2:"28",y1:"-20",y2:"40",stroke:"black"}),(0,f.jsx)("text",{className:"rmg-name__zh",dx:"3",fontSize:"18",children:"\u56fe"}),(0,f.jsx)("text",{className:"rmg-name__zh",dx:"3",dy:"18",fontSize:"18",children:"\u4f8b"}),(0,f.jsx)("text",{className:"rmg-name__en",dy:"35",fontSize:"8",children:"legend"}),(0,f.jsx)("use",{transform:"translate(45,10)",xlinkHref:"#int2_indoor_sh",stroke:"var(--rmg-theme-colour)"}),(0,f.jsx)("text",{className:"rmg-name__zh",dx:"60",dy:"10",fontSize:"10",children:"\u6362\u4e58\u7ad9"}),(0,f.jsx)("text",{className:"rmg-name__en",dx:"60",dy:"20",fontSize:"6",children:"Interchange"}),(0,f.jsx)("text",{className:"rmg-name__en",dx:"60",dy:"30",fontSize:"6",children:"Station"})]})]})]})}),[n.svgWidth.indoor,n.svg_height,n.line_name])}},86584:function(n,t,e){e.d(t,{C:function(){return i},T:function(){return s}});var r=e(37762),i=function(n,t,e){var r=t[0];if(r.includes(n)){if(t.slice(1).find((function(t){return t.includes(n)})))return 0;var i=t.slice(1).find((function(t){var e="linestart"===t[0],i=r.indexOf(n)<r.indexOf(t.slice(-1)[0]),s="lineend"===t.slice(-1)[0],a=r.indexOf(n)>r.indexOf(t[0]);return e&&i||s&&a}));return i?1===e[i[0]].children.indexOf(i[1])?-1:1:0}var s=t.slice(1).find((function(t){return t.includes(n)}));return s?"linestart"!==s[0]&&"lineend"!==s.slice(-1)[0]?1===e[s[0]].children.indexOf(s[1])?1.2:-1.2:1===e[s[0]].children.indexOf(s[1])?1:-1:0},s=function(n){var t,e,i="a".concat(6,",").concat(6,",0,0,1,").concat(6,",").concat(6),s="a".concat(6,",").concat(6,",0,0,0,").concat(6,",").concat(6),a="a".concat(6,",").concat(6,",0,0,0,").concat(6,",-").concat(6),c="a".concat(6,",").concat(6,",0,0,1,").concat(6,",-").concat(6),l=[],o=(0,r.Z)(n);try{for(o.s();!(e=o.n()).done;){var u=e.value;if(t)if(u[1]===t[1])l.push("H"+u[0]);else{var h=(u[0]+t[0])/2-(0===t[1]?0:12);l.push("H"+h),u[1]>t[1]?(l.push(i),l.push("V"+(u[1]-6)),l.push(s)):(l.push(a),l.push("V"+(u[1]+6)),l.push(c)),l.push("H"+u[0])}else l.push("M"+u.join(","));t=u}}catch(d){o.e(d)}finally{o.f()}return l.join(" ").replace(/( H([\d.]+))+/g," H$2")}},78359:function(n,t,e){e.d(t,{kL:function(){return o},AQ:function(){return u},ZM:function(){return h},A_:function(){return d}});var r=e(15671),i=e(43144),s=e(60136),a=e(54062),c=e(23824),l=e(86584),o=function(n,t){var e=0,r=n[t].transfer,i=r.info.map((function(n){return n.length}));return"l"===r.tick_direc&&(!i[1]&&i[0]>1&&(e+=.8),!i[1]||1===i[0]&&2===i[1]||(e+=.8)),1===i[0]&&2===i[1]&&"linestart"!==n[t].parents[0]&&"lineend"!==n[t].children[0]&&(e+=.8),2===n[t].parents.length&&(e+=.2),2===n[n[t].parents[0]].children.length&&(e+=.4),e},u=function(n,t){var e=0,r=n[t].transfer,i=r.info.map((function(n){return n.length}));return"r"===r.tick_direc&&(!i[1]&&i[0]>1&&(e+=.8),!i[1]||1===i[0]&&2===i[1]||(e+=.8)),1===i[0]&&2===i[1]&&"linestart"!==n[t].parents[0]&&"lineend"!==n[t].children[0]&&(e+=.8),2===n[t].children.length&&(e+=.2),2===n[n[t].children[0]].parents.length&&(e+=.4),e},h=function(n){(0,s.Z)(e,n);var t=(0,a.Z)(e);function e(){var n;(0,r.Z)(this,e);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(n=t.call.apply(t,[this].concat(s))).leftWideFactor=function(t){return o(n.stnList,t)},n.rightWideFactor=function(t){return u(n.stnList,t)},n}return(0,i.Z)(e,null,[{key:"drawLine",value:function(n,t,e,r,i,s,a,c){var o=this,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h={main:[],pass:[],sidingMain:[],sidingPass:[]};return n.forEach((function(d,f){var g="linestart"!==d[0]&&"lineend"!==d.slice(-1)[0],m=(d=d.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),p=d.filter((function(n){return t[n]<=0}));1===m.length&&(p=d),0===m.filter((function(n){return-1!==p.indexOf(n)})).length&&m.length&&(p[0]===d[0]?p.push(m[0]):m[0]===d[0]&&m[m.length-1]===d[d.length-1]&&p.length?(p=d,m=[]):p.unshift(m[m.length-1])),g?(h.sidingMain.push((0,l.T)(m.map((function(n){return[i[n],s[n]]})))),h.sidingPass.push((0,l.T)(p.map((function(n){return[i[n],s[n]]}))))):(h.main.push(new o({stnList:e,criticalPath:c})._linePath(m,r,n,i,s,a,c,u)),h.pass.push(new o({stnList:e,criticalPath:c})._linePath(p,r,n,i,s,a,c,u)))})),h}}]),e}(c.LD),d=function(n){(0,s.Z)(e,n);var t=(0,a.Z)(e);function e(){return(0,r.Z)(this,e),t.apply(this,arguments)}return(0,i.Z)(e,null,[{key:"drawLine",value:function(n,t,e,r,i,s,a,c){var l=this,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u={main:[],pass:[],sidingMain:[],sidingPass:[]};return n.forEach((function(h,d){var f=(h=h.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),g=h.filter((function(n){return t[n]<=0}));1===f.length&&(g=h),0===f.filter((function(n){return-1!==g.indexOf(n)})).length&&f.length&&(g[0]===h[0]?g.push(f[0]):f[0]===h[0]&&f[f.length-1]===h[h.length-1]&&g.length?(g=h,f=[]):g.unshift(f[f.length-1])),u.main.push(new l({stnList:e,criticalPath:c})._linePath(f,r,n,i,s,a,c,o)),u.pass.push(new l({stnList:e,criticalPath:c})._linePath(g,r,n,i,s,a,c,o))})),u}}]),e}(h)}}]);
//# sourceMappingURL=indoorSHMetro.92452daf.chunk.js.map