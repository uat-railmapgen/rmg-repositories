"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[773,3078,2756,9145,8045,9945,3222,5704,484],{43078:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});n(72791);var r=n(20713),a=n(52756),i=n(89945),s=n(80184);function o(t){var e=t.interchangeInfoList,n=t.direction,o=t.isPassed,c=t.isReversed,l=t.repel,u=e.length<=1?0:18*e.length;return(0,s.jsxs)("g",{children:[1===e.length&&(0,s.jsx)(a.default,{interchangeInfo:e[0],isPassed:o,position:c?r.Ly.UP:r.Ly.DOWN,repel:l}),e.length>1&&e.map((function(t,e){return(0,s.jsx)("g",{transform:"translate(0,".concat(c?-18*(e+1):18*(e+1),")"),children:(0,s.jsx)(a.default,{interchangeInfo:t,isPassed:o,position:n===r.Nm.right?r.Ly.RIGHT:r.Ly.LEFT})},e)})),(0,s.jsx)(i.default,{length:u,isPassed:o,isReversed:c})]})}},52756:function(t,e,n){n.r(e);var r=n(72791),a=n(20713),i=n(80184),s=function(t){switch(t){case a.Ly.UP:return 180;case a.Ly.DOWN:return 0;case a.Ly.LEFT:return 90;case a.Ly.RIGHT:return-90}};function o(t){var e=t.interchangeInfo,n=t.isPassed,r=t.position,o=t.repel,c=e[4].split("\\").length,l=e[5].split("\\").length,u=r===a.Ly.LEFT||o===a.Nm.left?"end":r===a.Ly.RIGHT||o===a.Nm.right?"start":"middle",d={path:{rotate:s(r)},g:{x:(r===a.Ly.LEFT?-24:r===a.Ly.RIGHT?24:0)+(o===a.Nm.left?-3:o===a.Nm.right?3:0),y:r===a.Ly.UP?-37-10*(c-1)-7*(l-1):r===a.Ly.DOWN?31:6-(20+10*(c-1)+7*(l-1)-1)/2}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0,0v17",strokeLinecap:"round",stroke:n?"var(--rmg-grey)":e[2],strokeWidth:8,transform:"rotate(".concat(d.path.rotate,")")}),(0,i.jsxs)("g",{textAnchor:u,transform:"translate(".concat(d.g.x,",").concat(d.g.y,")"),fill:n?"var(--rmg-grey)":"var(--rmg-black)",children:[e[4].split("\\").map((function(t,e){return(0,i.jsx)("text",{dy:10*e,className:"rmg-name__zh",fontSize:10,children:t},e)})),e[5].split("\\").map((function(t,e){return(0,i.jsx)("text",{dy:10*c-1+7*e,className:"rmg-name__en",fontSize:7,children:t},c+e)}))]})]})}e.default=(0,r.memo)(o,(function(t,e){return t.interchangeInfo.toString()===e.interchangeInfo.toString()&&t.isPassed===e.isPassed&&t.position===e.position&&t.repel===e.repel}))},89145:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});n(72791);var r=n(20713),a=n(52756),i=n(89945),s=n(80184);function o(t){var e,n,o,c,l,u=t.interchangeInfoList,d=t.direction,f=t.isPassed,g=t.isReversed,m=t.isTerminal,h=t.stationName,x=null!==(e=null===h||void 0===h||null===(n=h[1])||void 0===n||null===(o=n.split("\\"))||void 0===o?void 0:o.length)&&void 0!==e?e:1,v=18*(u.length-1),p={name:{x:m?0:1===u.length?d===r.Nm.left?-13:13:d===r.Nm.left?13:-13,y:m?g?19:-28:(g?-9:9)*(u.length-1)-4-5*(x-1)}};return(0,s.jsxs)("g",{children:[u.map((function(t,e,n){return(0,s.jsx)("g",{transform:"translate(0,".concat(g?-18*e:18*e,")"),children:(0,s.jsx)(a.default,{interchangeInfo:t,isPassed:f,position:1===n.length?g?r.Ly.UP:r.Ly.DOWN:d===r.Nm.right?r.Ly.RIGHT:r.Ly.LEFT})},e)})),(0,s.jsx)(i.default,{length:v,isPassed:f,isReversed:g}),(0,s.jsxs)("g",{textAnchor:0===p.name.x?"middle":p.name.x>0?"start":"end",fill:f?"var(--rmg-grey)":"var(--rmg-black)",transform:"translate(".concat(p.name.x,",").concat(p.name.y,")"),children:[(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:14,children:null===h||void 0===h?void 0:h[0]}),null===h||void 0===h||null===(c=h[1])||void 0===c||null===(l=c.split("\\"))||void 0===l?void 0:l.map((function(t,e){return(0,s.jsx)("text",{className:"rmg-name__en",fontSize:9,dy:12+10*e,children:t},e)}))]})]})}},89945:function(t,e,n){n.r(e),n.d(e,{default:function(){return a}});n(72791);var r=n(80184);function a(t){var e=t.length,n=t.isPassed,a=t.isReversed;return(0,r.jsx)("path",{d:"M-8,0 v".concat(e," a8,8 0 0,0 16,0 v-").concat(e," a8,8 0 0,0 -16,0Z"),className:"rmg-stn__mtr",stroke:n?"var(--rmg-grey)":"var(--rmg-black)",transform:"scale(1,".concat(a?-1:1,")")})}},85704:function(t,e,n){n.r(e),n.d(e,{NAME_FULL_HEIGHT:function(){return d},default:function(){return f}});var r=n(1413),a=n(29439),i=n(45987),s=n(72791),o=n(20713),c=n(73222),l=n(80184),u=["stationName","stationState","lower","align","facility"],d=33.03125;function f(t){var e=t.stationName,n=t.stationState,f=t.lower,g=t.align,m=t.facility,h=(0,i.Z)(t,u),x=(0,s.useState)({x:0,width:0}),v=(0,a.Z)(x,2),p=v[0],y=v[1],N=e[1].split("\\").length,j={g:{x:g?g===o.Nm.right?-3:3:0,y:(f?24.8125:-3.1875-d-11*(N-1))+(g?f?10:-10:0)},rect:{x:p.x-3+(m===o.mV.none?0:g?g===o.Nm.right?-3-d:0:(d+5)/2-3-d),y:-11.8125,width:p.width+6+(m===o.mV.none?0:d+3),height:d+2+11*(N-1)},use:{x:g?g===o.Nm.right?-(d+2)/2-p.width-3:(d+2)/2-2:-(p.width+3)/2,y:5.5*(N-1)-11.8125},StationName:{x:m===o.mV.none?0:g?g===o.Nm.right?0:d+3:(d+5)/2,y:0}};return(0,l.jsx)("g",(0,r.Z)((0,r.Z)({},h),{},{children:(0,l.jsxs)("g",{fill:function(t){switch(t){case o.KR.PASSED:return"var(--rmg-grey)";case o.KR.CURRENT:return"#fff";case o.KR.FUTURE:return"var(--rmg-black)"}}(n),transform:"translate(".concat(j.g.x,",").concat(j.g.y,")"),children:[n===o.KR.CURRENT&&(0,l.jsx)("rect",{x:j.rect.x,y:j.rect.y,width:j.rect.width,height:j.rect.height,fill:"var(--rmg-black)"}),m!==o.mV.none&&(0,l.jsx)("use",{xlinkHref:"#".concat(m),fill:n===o.KR.PASSED?"var(--rmg-grey)":"var(--rmg-black)",x:j.use.x,y:j.use.y}),(0,l.jsx)("g",{transform:"translate(".concat(j.StationName.x,",").concat(j.StationName.y,")"),children:(0,l.jsx)(c.default,{stnName:e,onUpdate:y,align:g})})]})}))}},73222:function(t,e,n){n.r(e);var r=n(72791),a=n(20713),i=n(40484),s=n(80184);e.default=(0,r.memo)((function(t){var e=t.stnName,n=t.onUpdate,o=t.align,c=(0,r.useRef)(null),l=function(){null===n||void 0===n||n(c.current.getBBox())};(0,r.useEffect)((function(){l(),(0,i.waitForFontReady)().then().catch(console.log).finally(l)}),[e.toString(),o]);return(0,s.jsxs)("g",{ref:c,textAnchor:function(t){switch(t){case a.Nm.left:return"start";case a.Nm.right:return"end";default:return"middle"}}(o),children:[(0,s.jsx)("text",{className:"rmg-name__zh rmg-name__mtr--station",children:e[0]}),e[1].split("\\").map((function(t,e){return(0,s.jsx)("text",{className:"rmg-name__en rmg-name__mtr--station",dy:(n=e,17+11*n),children:t},e);var n}))]})}),(function(t,e){return t.stnName.toString()===e.stnName.toString()&&t.align===e.align}))},98045:function(t,e,n){n.r(e),n.d(e,{default:function(){return l}});n(72791);var r=n(20713),a=n(43078),i=n(37732),s=n(89145),o=n(85704),c=n(80184);function l(t){var e,n,l,u,d,f,g,m=t.stationId,h=t.stationState,x=t.isReversed,v=(0,i.Qy)((function(t){return t.param.stn_list[m]})),p=v.name,y=v.parents,N=v.children,j=v.transfer,S=j.info,k=j.tick_direc,R=j.osi_names,L=j.paid_area,_=v.facility,P=null!==(e=S[0])&&void 0!==e&&e.length?y.includes("linestart")?r.Nm.left:N.includes("lineend")?r.Nm.right:void 0:void 0,w=Boolean((null===(n=S[1])||void 0===n?void 0:n.length)&&!P),b={link:{scaleX:P===r.Nm.left?-1:1,scaleY:x?-1:1},osi:{x:P?P===r.Nm.left?-41:41:0,y:P?0:x?-26:26}};return(0,c.jsxs)("g",{"data-testid":"station-icon-wrapper",children:[(null===(l=S[1])||void 0===l?void 0:l.length)&&(0,c.jsx)("path",{d:P&&null!==(u=S[0])&&void 0!==u&&u.length?"M0,0H41":"M0,0V26",strokeWidth:2.69,strokeDasharray:L?0:2.5,stroke:h===r.KR.PASSED?"var(--rmg-grey)":"var(--rmg-black)",transform:"scale(".concat(b.link.scaleX,",").concat(b.link.scaleY,")")}),(0,c.jsx)(a.default,{interchangeInfoList:S[0],direction:k===r.wA.right?r.Nm.right:r.Nm.left,isPassed:h===r.KR.PASSED,isReversed:!P&&null!==(d=S[1])&&void 0!==d&&d.length?!x:x,repel:w?k===r.wA.right?r.Nm.right:r.Nm.left:void 0}),(null===(f=S[1])||void 0===f?void 0:f.length)&&(0,c.jsx)("g",{transform:"translate(".concat(b.osi.x,",").concat(b.osi.y,")"),children:(0,c.jsx)(s.default,{interchangeInfoList:S[1],direction:P||(k===r.wA.right?r.Nm.right:r.Nm.left),stationName:R[0],isPassed:h===r.KR.PASSED,isReversed:P?!x:x,isTerminal:Boolean(P)})}),(0,c.jsx)(o.default,{stationName:p,stationState:h,facility:_,lower:x,align:null!==(g=S[0])&&void 0!==g&&g.length&&w?k===r.wA.left?r.Nm.left:r.Nm.right:void 0})]})}},40484:function(t,e,n){n.r(e),n.d(e,{waitForFontReady:function(){return o}});var r=n(15861),a=n(87757),i=n.n(a),s=n(17253),o=function(){var t=(0,r.Z)(i().mark((function t(){var e,n,r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=3;case 1:if(!e--){t.next=19;break}return t.next=4,document.fonts.ready;case 4:n=t.sent,r=n.values();case 6:if(!(a=r.next()).done){t.next=10;break}return t.abrupt("break",14);case 10:if("GenYoMin TW"!==a.value.family){t.next=12;break}return t.abrupt("return");case 12:t.next=6;break;case 14:return console.log("GenYoMin is NOT ready. Retry attempts remaining: "+e+" ..."),t.next=17,(0,s.aA)(500);case 17:t.next=1;break;case 19:throw new Error("Failed to load GenYoMin after 3 attempts");case 20:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},40773:function(t,e,n){n.r(e);var r=n(4942),a=n(1413),i=n(72791),s=n(23824),o=n(78359),c=n(20713),l=n(37732),u=n(98045),d=n(86584),f=n(80184);e.default=function(){var t,e=(0,l.Qy)((function(t){return t.helper})),n=e.branches,u=e.routes,h=e.depsStr,x=(0,l.Qy)((function(t){return t.param})),v=x.svgWidth,p=x.svg_height,y=x.y_pc,N=x.padding,j=x.branchSpacingPct,S=x.direction,k=x.namePosMTR,R=x.current_stn_idx,L=x.stn_list,_=(0,s.adjacencyList)(L,o.leftWideFactor,o.rightWideFactor),P=(0,i.useMemo)((function(){return(0,s.criticalPathMethod)("linestart","lineend",_)}),[JSON.stringify(_)]),w=(0,i.useMemo)((function(){return(0,s.criticalPathMethod)(P.nodes[1],P.nodes.slice(-2)[0],_)}),[JSON.stringify(_)]),b=(0,i.useMemo)((function(){return console.log("computing x shares"),Object.keys(L).reduce((function(t,e){return(0,a.Z)((0,a.Z)({},t),{},(0,r.Z)({},e,(0,s.getXShareMTR)(e,_,n)))}),{})}),[n.toString(),JSON.stringify(_)]),M=[v[c.Ht.RailMap]*N/100,v[c.Ht.RailMap]*(1-N/100)],T=Object.keys(b).reduce((function(t,e){return(0,a.Z)((0,a.Z)({},t),{},(0,r.Z)({},e,M[0]+b[e]/w.len*(M[1]-M[0])))}),{}),Z=(0,i.useMemo)((function(){return Object.keys(L).reduce((function(t,e){return(0,a.Z)((0,a.Z)({},t),{},(0,r.Z)({},e,(0,d.getStationYShare)(e,n,L)*j*p/200))}),{})}),[h,j,p]),I=(0,i.useMemo)((function(){return(0,s.getStnState)(R,u,S)}),[R,S,u.toString()]),O=Object.keys(L).reduce((function(t,e){return(0,a.Z)((0,a.Z)({},t),{},(0,r.Z)({},e,function(t,e,n){var r,a=n.isStagger,i=n.isFlip;if(!a)return i;if(e[0].includes(t))r=e[0].indexOf(t)%2;else{var s=e.filter((function(e){return e.includes(t)}))[0];r=(e[0].indexOf(s[0])+s.indexOf(t)+1)%2}return 0===r?i:!i}(e,n,k)))}),{}),E=o.StationsMTR.drawLine(n,I,L,M,T,Z,j*p/200,P);return(0,f.jsxs)("g",{id:"main",style:(t={},(0,r.Z)(t,"--y-percentage",y),(0,r.Z)(t,"transform","translateY(calc(var(--y-percentage) * var(--rmg-svg-height) / 100))"),t),children:[(0,f.jsx)(g,{paths:E}),(0,f.jsx)(m,{xs:T,ys:Z,stnStates:I,namePoss:O})]})};var g=i.memo((function(t){return(0,f.jsxs)("g",{fill:"none",strokeWidth:9.68,children:[(0,f.jsxs)("g",{stroke:"var(--rmg-grey)",children:[t.paths.pass.map((function(t,e){return(0,f.jsx)("path",{d:t},e)})),t.paths.sidingPass.map((function(t,e){var n;return(0,f.jsx)("path",{d:t,strokeDasharray:4===(null===(n=t.match(/a/g))||void 0===n?void 0:n.length)?"10 4":void 0},e)}))]}),(0,f.jsxs)("g",{stroke:"var(--rmg-theme-colour)",children:[t.paths.main.map((function(t,e){return(0,f.jsx)("path",{d:t},e)})),t.paths.sidingMain.map((function(t,e){var n;return(0,f.jsx)("path",{d:t,strokeDasharray:4===(null===(n=t.match(/a/g))||void 0===n?void 0:n.length)?"10 4":void 0},e)}))]})]})}),(function(t,e){return JSON.stringify(t.paths)===JSON.stringify(e.paths)})),m=function(t){var e=t.xs,n=t.ys,r=t.stnStates,a=t.namePoss,i=(0,l.Qy)((function(t){return t.param.stn_list}));return(0,f.jsx)("g",{id:"stn_icons",children:Object.keys(i).filter((function(t){return!["linestart","lineend"].includes(t)})).map((function(t){return(0,f.jsx)("g",{style:{transform:"translate(".concat(e[t],"px,").concat(n[t],"px)")},children:(0,f.jsx)(u.default,{stationId:t,stationState:r[t],isReversed:a[t]})},t)}))})}}}]);
//# sourceMappingURL=773.c79fde4f.chunk.js.map