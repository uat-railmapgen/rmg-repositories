"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[9350,3078,2756,9145,8045,9945,3222,5704,484],{13203:function(t,e,n){n.d(e,{MM:function(){return c},Yg:function(){return u}});var r=n(1413),a=n(85884),i=n(20713),s=n(37732),o=n(8785),c=(0,a.Z)((0,o.Bx)()),l=s.ZP.getState(),u=function(t){return c((0,r.Z)((0,r.Z)({},l),{},{param:(0,r.Z)((0,r.Z)({},l.param),{},{stn_list:t})}))};i.H_.through,i.H_.through},43078:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});n(72791);var r=n(20713),a=n(52756),i=n(89945),s=n(80184);function o(t){var e=t.interchangeInfoList,n=t.direction,o=t.isPassed,c=t.isReversed,l=t.repel,u=e.length<=1?0:18*e.length;return(0,s.jsxs)("g",{children:[1===e.length&&(0,s.jsx)(a.default,{interchangeInfo:e[0],isPassed:o,position:c?r.Ly.UP:r.Ly.DOWN,repel:l}),e.length>1&&e.map((function(t,e){return(0,s.jsx)("g",{transform:"translate(0,".concat(c?-18*(e+1):18*(e+1),")"),children:(0,s.jsx)(a.default,{interchangeInfo:t,isPassed:o,position:n===r.Nm.right?r.Ly.RIGHT:r.Ly.LEFT})},e)})),(0,s.jsx)(i.default,{length:u,isPassed:o,isReversed:c})]})}},52756:function(t,e,n){n.r(e);var r=n(72791),a=n(20713),i=n(80184),s=function(t){switch(t){case a.Ly.UP:return 180;case a.Ly.DOWN:return 0;case a.Ly.LEFT:return 90;case a.Ly.RIGHT:return-90}};function o(t){var e=t.interchangeInfo,n=t.isPassed,r=t.position,o=t.repel,c=e[4].split("\\").length,l=e[5].split("\\").length,u=r===a.Ly.LEFT||o===a.Nm.left?"end":r===a.Ly.RIGHT||o===a.Nm.right?"start":"middle",d={path:{rotate:s(r)},g:{x:(r===a.Ly.LEFT?-24:r===a.Ly.RIGHT?24:0)+(o===a.Nm.left?-3:o===a.Nm.right?3:0),y:r===a.Ly.UP?-37-10*(c-1)-7*(l-1):r===a.Ly.DOWN?31:6-(20+10*(c-1)+7*(l-1)-1)/2}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M0,0v17",strokeLinecap:"round",stroke:n?"var(--rmg-grey)":e[2],strokeWidth:8,transform:"rotate(".concat(d.path.rotate,")")}),(0,i.jsxs)("g",{textAnchor:u,transform:"translate(".concat(d.g.x,",").concat(d.g.y,")"),fill:n?"var(--rmg-grey)":"var(--rmg-black)",children:[e[4].split("\\").map((function(t,e){return(0,i.jsx)("text",{dy:10*e,className:"rmg-name__zh",fontSize:10,children:t},e)})),e[5].split("\\").map((function(t,e){return(0,i.jsx)("text",{dy:10*c-1+7*e,className:"rmg-name__en",fontSize:7,children:t},c+e)}))]})]})}e.default=(0,r.memo)(o,(function(t,e){return t.interchangeInfo.toString()===e.interchangeInfo.toString()&&t.isPassed===e.isPassed&&t.position===e.position&&t.repel===e.repel}))},89145:function(t,e,n){n.r(e),n.d(e,{default:function(){return o}});n(72791);var r=n(20713),a=n(52756),i=n(89945),s=n(80184);function o(t){var e,n,o,c,l,u=t.interchangeInfoList,d=t.direction,f=t.isPassed,m=t.isReversed,g=t.isTerminal,h=t.stationName,p=null!==(e=null===h||void 0===h||null===(n=h[1])||void 0===n||null===(o=n.split("\\"))||void 0===o?void 0:o.length)&&void 0!==e?e:1,v=18*(u.length-1),x={name:{x:g?0:1===u.length?d===r.Nm.left?-13:13:d===r.Nm.left?13:-13,y:g?m?19:-28:(m?-9:9)*(u.length-1)-4-5*(p-1)}};return(0,s.jsxs)("g",{children:[u.map((function(t,e,n){return(0,s.jsx)("g",{transform:"translate(0,".concat(m?-18*e:18*e,")"),children:(0,s.jsx)(a.default,{interchangeInfo:t,isPassed:f,position:1===n.length?m?r.Ly.UP:r.Ly.DOWN:d===r.Nm.right?r.Ly.RIGHT:r.Ly.LEFT})},e)})),(0,s.jsx)(i.default,{length:v,isPassed:f,isReversed:m}),(0,s.jsxs)("g",{textAnchor:0===x.name.x?"middle":x.name.x>0?"start":"end",fill:f?"var(--rmg-grey)":"var(--rmg-black)",transform:"translate(".concat(x.name.x,",").concat(x.name.y,")"),children:[(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:14,children:null===h||void 0===h?void 0:h[0]}),null===h||void 0===h||null===(c=h[1])||void 0===c||null===(l=c.split("\\"))||void 0===l?void 0:l.map((function(t,e){return(0,s.jsx)("text",{className:"rmg-name__en",fontSize:9,dy:12+10*e,children:t},e)}))]})]})}},89945:function(t,e,n){n.r(e),n.d(e,{default:function(){return a}});n(72791);var r=n(80184);function a(t){var e=t.length,n=t.isPassed,a=t.isReversed;return(0,r.jsx)("path",{d:"M-8,0 v".concat(e," a8,8 0 0,0 16,0 v-").concat(e," a8,8 0 0,0 -16,0Z"),className:"rmg-stn__mtr",stroke:n?"var(--rmg-grey)":"var(--rmg-black)",transform:"scale(1,".concat(a?-1:1,")")})}},85704:function(t,e,n){n.r(e),n.d(e,{NAME_FULL_HEIGHT:function(){return d},default:function(){return f}});var r=n(1413),a=n(29439),i=n(45987),s=n(72791),o=n(20713),c=n(73222),l=n(80184),u=["stationName","stationState","lower","align","facility"],d=33.03125;function f(t){var e=t.stationName,n=t.stationState,f=t.lower,m=t.align,g=t.facility,h=(0,i.Z)(t,u),p=(0,s.useState)({x:0,width:0}),v=(0,a.Z)(p,2),x=v[0],y=v[1],N=e[1].split("\\").length,w={g:{x:m?m===o.Nm.right?-3:3:0,y:(f?24.8125:-3.1875-d-11*(N-1))+(m?f?10:-10:0)},rect:{x:x.x-3+(g===o.mV.none?0:m?m===o.Nm.right?-3-d:0:(d+5)/2-3-d),y:-11.8125,width:x.width+6+(g===o.mV.none?0:d+3),height:d+2+11*(N-1)},use:{x:m?m===o.Nm.right?-(d+2)/2-x.width-3:(d+2)/2-2:-(x.width+3)/2,y:5.5*(N-1)-11.8125},StationName:{x:g===o.mV.none?0:m?m===o.Nm.right?0:d+3:(d+5)/2,y:0}};return(0,l.jsx)("g",(0,r.Z)((0,r.Z)({},h),{},{children:(0,l.jsxs)("g",{fill:function(t){switch(t){case o.KR.PASSED:return"var(--rmg-grey)";case o.KR.CURRENT:return"#fff";case o.KR.FUTURE:return"var(--rmg-black)"}}(n),transform:"translate(".concat(w.g.x,",").concat(w.g.y,")"),children:[n===o.KR.CURRENT&&(0,l.jsx)("rect",{x:w.rect.x,y:w.rect.y,width:w.rect.width,height:w.rect.height,fill:"var(--rmg-black)"}),g!==o.mV.none&&(0,l.jsx)("use",{xlinkHref:"#".concat(g),fill:n===o.KR.PASSED?"var(--rmg-grey)":"var(--rmg-black)",x:w.use.x,y:w.use.y}),(0,l.jsx)("g",{transform:"translate(".concat(w.StationName.x,",").concat(w.StationName.y,")"),children:(0,l.jsx)(c.default,{stnName:e,onUpdate:y,align:m})})]})}))}},73222:function(t,e,n){n.r(e);var r=n(72791),a=n(20713),i=n(40484),s=n(80184);e.default=(0,r.memo)((function(t){var e=t.stnName,n=t.onUpdate,o=t.align,c=(0,r.useRef)(null),l=function(){null===n||void 0===n||n(c.current.getBBox())};(0,r.useEffect)((function(){l(),(0,i.waitForFontReady)().then().catch(console.log).finally(l)}),[e.toString(),o]);return(0,s.jsxs)("g",{ref:c,textAnchor:function(t){switch(t){case a.Nm.left:return"start";case a.Nm.right:return"end";default:return"middle"}}(o),children:[(0,s.jsx)("text",{className:"rmg-name__zh rmg-name__mtr--station",children:e[0]}),e[1].split("\\").map((function(t,e){return(0,s.jsx)("text",{className:"rmg-name__en rmg-name__mtr--station",dy:(n=e,17+11*n),children:t},e);var n}))]})}),(function(t,e){return t.stnName.toString()===e.stnName.toString()&&t.align===e.align}))},69350:function(t,e,n){n.r(e);var r=n(29439),a=n(15861),i=n(87757),s=n.n(i),o=(n(72791),n(99607)),c=n(98045),l=n(37722),u=n(20713),d=n(41125),f=n(13203),m=n(80184);Document.prototype.fonts={ready:Promise.resolve([])},SVGElement.prototype.getBBox=function(){return{x:-40,width:80}};var g=[d.jk.Hongkong,"twl","#E2231A",u.AJ.white,"",""],h=function(t,e,n){return{name:["ZH name","EN name"],parents:n===u.Nm.left?["linestart"]:["stn-par"],children:n===u.Nm.right?["lineend"]:["stn-child"],transfer:{info:[Array(t).fill(g),Array(e).fill(g)],osi_names:[["ZH OSI","EN OSI"]]}}},p=function(t,e,n){(0,l.s)((0,m.jsx)("svg",{children:(0,m.jsx)(c.default,{stationId:"test-id",stationState:u.KR.CURRENT,isReversed:!1})}),{store:(0,f.Yg)({"test-id":h(t,e,n)})})};describe("MTR Station",(function(){describe("MTR Station - OSI link",(function(){var t='path[stroke-width="2.69"]';it("Can render OSI link for 0-1 station as expected",(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.TK)((0,a.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(0,1);case 1:case"end":return t.stop()}}),t)}))));case 2:n=o.sp.getByTestId("station-icon-wrapper").querySelector(t),expect(null===n||void 0===n?void 0:n.getAttribute("d")).toContain("V26");case 4:case"end":return e.stop()}}),e)})))),it("Can render OSI link for 0-2 station as expected",(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.TK)((0,a.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(0,2);case 1:case"end":return t.stop()}}),t)}))));case 2:n=o.sp.getByTestId("station-icon-wrapper").querySelector(t),expect(null===n||void 0===n?void 0:n.getAttribute("d")).toContain("V26");case 4:case"end":return e.stop()}}),e)})))),it("Can render OSI link for 0-1 terminal station as expected",(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.TK)((0,a.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(0,1,u.Nm.left);case 1:case"end":return t.stop()}}),t)}))));case 2:n=o.sp.getByTestId("station-icon-wrapper").querySelector(t),expect(null===n||void 0===n?void 0:n.getAttribute("d")).toContain("V26");case 4:case"end":return e.stop()}}),e)})))),it("Can render OSI link for 0-2 terminal station as expected",(0,a.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.TK)((0,a.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(0,2,u.Nm.right);case 1:case"end":return t.stop()}}),t)}))));case 2:n=o.sp.getByTestId("station-icon-wrapper").querySelector(t),expect(null===n||void 0===n?void 0:n.getAttribute("d")).toContain("V26");case 4:case"end":return e.stop()}}),e)})))),it("Can render OSI link for 1-1 terminal station as expected",(0,a.Z)(s().mark((function e(){var n,i,c,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.TK)((0,a.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(1,1,u.Nm.left);case 1:case"end":return t.stop()}}),t)}))));case 2:i=o.sp.getByTestId("station-icon-wrapper").querySelector(t),expect(null===i||void 0===i?void 0:i.getAttribute("d")).toContain("H41"),c=null===i||void 0===i||null===(n=i.getAttribute("transform"))||void 0===n?void 0:n.match(/-?\d+/g),l=(0,r.Z)(c,1),d=l[0],expect(d).toBe("-1");case 6:case"end":return e.stop()}}),e)})))),it("Can render OSI link for 1-2 terminal station as expected",(0,a.Z)(s().mark((function e(){var n,i,c,l,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.TK)((0,a.Z)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:p(1,2,u.Nm.right);case 1:case"end":return t.stop()}}),t)}))));case 2:i=o.sp.getByTestId("station-icon-wrapper").querySelector(t),expect(null===i||void 0===i?void 0:i.getAttribute("d")).toContain("H41"),c=null===i||void 0===i||null===(n=i.getAttribute("transform"))||void 0===n?void 0:n.match(/-?\d+/g),l=(0,r.Z)(c,1),d=l[0],expect(d).toBe("1");case 6:case"end":return e.stop()}}),e)}))))}))}))},98045:function(t,e,n){n.r(e),n.d(e,{default:function(){return l}});n(72791);var r=n(20713),a=n(43078),i=n(37732),s=n(89145),o=n(85704),c=n(80184);function l(t){var e,n,l,u,d,f,m,g=t.stationId,h=t.stationState,p=t.isReversed,v=(0,i.Qy)((function(t){return t.param.stn_list[g]})),x=v.name,y=v.parents,N=v.children,w=v.transfer,k=w.info,S=w.tick_direc,j=w.osi_names,R=w.paid_area,Z=v.facility,I=null!==(e=k[0])&&void 0!==e&&e.length?y.includes("linestart")?r.Nm.left:N.includes("lineend")?r.Nm.right:void 0:void 0,T=Boolean((null===(n=k[1])||void 0===n?void 0:n.length)&&!I),L={link:{scaleX:I===r.Nm.left?-1:1,scaleY:p?-1:1},osi:{x:I?I===r.Nm.left?-41:41:0,y:I?0:p?-26:26}};return(0,c.jsxs)("g",{"data-testid":"station-icon-wrapper",children:[(null===(l=k[1])||void 0===l?void 0:l.length)&&(0,c.jsx)("path",{d:I&&null!==(u=k[0])&&void 0!==u&&u.length?"M0,0H41":"M0,0V26",strokeWidth:2.69,strokeDasharray:R?0:2.5,stroke:h===r.KR.PASSED?"var(--rmg-grey)":"var(--rmg-black)",transform:"scale(".concat(L.link.scaleX,",").concat(L.link.scaleY,")")}),(0,c.jsx)(a.default,{interchangeInfoList:k[0],direction:S===r.wA.right?r.Nm.right:r.Nm.left,isPassed:h===r.KR.PASSED,isReversed:!I&&null!==(d=k[1])&&void 0!==d&&d.length?!p:p,repel:T?S===r.wA.right?r.Nm.right:r.Nm.left:void 0}),(null===(f=k[1])||void 0===f?void 0:f.length)&&(0,c.jsx)("g",{transform:"translate(".concat(L.osi.x,",").concat(L.osi.y,")"),children:(0,c.jsx)(s.default,{interchangeInfoList:k[1],direction:I||(S===r.wA.right?r.Nm.right:r.Nm.left),stationName:j[0],isPassed:h===r.KR.PASSED,isReversed:I?!p:p,isTerminal:Boolean(I)})}),(0,c.jsx)(o.default,{stationName:x,stationState:h,facility:Z,lower:p,align:null!==(m=k[0])&&void 0!==m&&m.length&&T?S===r.wA.left?r.Nm.left:r.Nm.right:void 0})]})}},40484:function(t,e,n){n.r(e),n.d(e,{waitForFontReady:function(){return o}});var r=n(15861),a=n(87757),i=n.n(a),s=n(17253),o=function(){var t=(0,r.Z)(i().mark((function t(){var e,n,r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=3;case 1:if(!e--){t.next=19;break}return t.next=4,document.fonts.ready;case 4:n=t.sent,r=n.values();case 6:if(!(a=r.next()).done){t.next=10;break}return t.abrupt("break",14);case 10:if("GenYoMin TW"!==a.value.family){t.next=12;break}return t.abrupt("return");case 12:t.next=6;break;case 14:return console.log("GenYoMin is NOT ready. Retry attempts remaining: "+e+" ..."),t.next=17,(0,s.aA)(500);case 17:t.next=1;break;case 19:throw new Error("Failed to load GenYoMin after 3 attempts");case 20:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},37722:function(t,e,n){n.d(e,{s:function(){return p}});var r=n(45987),a=n(1413),i=(n(24089),n(72791),n(99607)),s=n(83533),o=n(46726),c=n(59434),l=n(37732),u=n(13203),d=n(16871),f=n(80184),m=["store"],g={store:(0,u.MM)((0,a.Z)({},l.ZP.getState()))},h=function(t){var e=t.children,n=t.store;return(0,f.jsx)(s.a,{i18n:o.Z,children:(0,f.jsx)(c.zt,{store:n,children:(0,f.jsx)(d.VA,{children:e})})})},p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,n=e.store,s=(0,r.Z)(e,m);return(0,i.sY)(t,(0,a.Z)({wrapper:function(t){return(0,f.jsx)(h,(0,a.Z)({store:n},t))}},s))}}}]);
//# sourceMappingURL=9350.f2dafb86.chunk.js.map