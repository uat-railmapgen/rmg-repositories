"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[6667,3824,1401],{23824:function(n,t,e){e.r(t),e.d(t,{adjacencyList:function(){return h},criticalPathMethod:function(){return f},getXShareMTR:function(){return d},getStnState:function(){return p},Stations:function(){return v},drawLine:function(){return y}});var r=e(29439),i=e(15671),a=e(43144),c=e(93433),o=e(37762),u=e(4942),s=e(1413),l=e(20713),h=function(n,t,e){return Object.keys(n).reduce((function(r,i){return(0,s.Z)((0,s.Z)({},r),{},(0,u.Z)({},i,n[i].children.reduce((function(r,a){return(0,s.Z)((0,s.Z)({},r),{},(0,u.Z)({},a,1+t(n,a)+e(n,i)))}),{})))}),{})},f=function n(t,e,r){if(t===e)return{len:0,nodes:[t]};var i=[],a=[];Object.keys(r[t]).forEach((function(c){var o=n(c,e,r);o.len<0||(i.push(r[t][c]+o.len),o.nodes.unshift(t),a.push(o.nodes))}));var c=Math.max.apply(Math,i);return{len:c,nodes:a[i.indexOf(c)]}},d=function(n,t,e){var r=f("linestart","lineend",t);if(r.nodes.includes(n))return f(r.nodes[1],n,t).len;for(var i=e.filter((function(t){return t.includes(n)}))[0],a=n;!r.nodes.includes(a);)a=i[i.indexOf(a)-1];for(var c=n;!r.nodes.includes(c);)c=i[i.indexOf(c)+1];var o="linestart"===a,u=[];return o||"lineend"===c?o?(u[0]=0,u[1]=f(r.nodes[1],c,t).len,u[2]=f(i[1],n,t).len,u[3]=f(n,c,t).len):(u[0]=f(r.nodes[1],a,t).len,u[1]=f(a,r.nodes.slice(-2)[0],t).len,u[2]=f(a,n,t).len,u[3]=f(n,i.slice(-2)[0],t).len):(u[0]=f(r.nodes[1],a,t).len,u[1]=f(a,c,t).len,u[2]=f(a,n,t).len,u[3]=f(n,c,t).len),u[0]+u[2]*u[1]/(u[2]+u[3])},p=function(n,t,e){var r;return console.log("computing stations' states"),(0,c.Z)(new Set((r=[]).concat.apply(r,(0,c.Z)(t)))).reduce((function(r,i){return(0,s.Z)((0,s.Z)({},r),{},(0,u.Z)({},i,i===n?0:(e===l.wA.right?function(n,t,e){var r,i=(0,o.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,c=a.indexOf(n),u=a.indexOf(t);if(-1!==c&&c<u)return!0}}catch(s){i.e(s)}finally{i.f()}return!1}(n,i,t):function(n,t,e){var r,i=(0,o.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,c=a.indexOf(n),u=a.indexOf(t);if(-1!==u&&u<c)return!0}}catch(s){i.e(s)}finally{i.f()}return!1}(n,i,t))?1:-1))}),{})},v=function(){function n(t){var e=this;(0,i.Z)(this,n),this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=function(n){return 0},this.rightWideFactor=function(n){return 0},this.pathTurnParams=function(n){var t=35-17.5*Math.sqrt(3),e=n-2*t;return{tr:35,dx_a:17.5,dy_a:t,dx_l:e*Math.sqrt(3),dy_l:e}},this.pathTurnSE=function(n){var t=e.pathTurnParams(n),r=t.tr,i=t.dx_a,a=t.dy_a,c=t.dx_l,o=t.dy_l;return"a ".concat(r,",").concat(r," 0 0,1 ").concat(i,",").concat(a," l ").concat(c,",").concat(o," a ").concat(r,",").concat(r," 0 0,0 ").concat(i,",").concat(a)},this.pathTurnNE=function(n){var t=e.pathTurnParams(n),r=t.tr,i=t.dx_a,a=t.dy_a,c=t.dx_l,o=t.dy_l;return"a ".concat(r,",").concat(r," 0 0,0 ").concat(i,",").concat(-a," l ").concat(c,",").concat(-o," a ").concat(r,",").concat(r," 0 0,1 ").concat(i,",").concat(-a)},this.stnList=t.stnList,this.criticalPath=t.criticalPath}return(0,a.Z)(n,[{key:"getYShare",value:function(n,t){if(n in this.yShares)return this.yShares[n];if(["linestart","lineend"].includes(n)||this.stnList[n].parents.length>1||this.stnList[n].children.length>1)return this.yShares[n]=0,0;var e=this.stnList[n].parents[0];if(e){if(1===this.stnList[e].children.length){var r=this.getYShare(e);return this.yShares[n]=r,r}var i=0===this.stnList[e].children.indexOf(n)?1:-1;return this.yShares[n]=i,i}return this.yShares[n]=0,0}},{key:"_linePath",value:function(n,t,e,i,a,c,o,u){var s=this,l=(0,r.Z)([],3),h=l[0],f=l[1],d=l[2],p=[],v=this.pathTurnParams(c),y=v.dx_a+v.dx_l/2,g=(t[1]-t[0])/o.len*2,m=((t[1]-t[0])/o.len-2*y)/2;return m+g<0&&console.warn("SVG width too small! ".concat(m+g)),n.forEach((function(t){var r=i[t],o=a[t];if(!f&&0!==f)return h=t,d=r,f=o,void(1===n.length?p.push("M ".concat(r,",").concat(o)):e[0].includes(t)?e[0].includes(n[1])?p.push("M ".concat(r,",").concat(o)):(i[n[1]]>0&&p.push("M ".concat(r,",").concat(o+u)),a[n[1]]<0&&p.push("M ".concat(r,",").concat(o-u))):p.push("M ".concat(r,",").concat(o)));o>f?(p.push("h ".concat(0===o?r-d-g*s.leftWideFactor(t)-m-2*y:g*s.rightWideFactor(h)+m)),p.push(s.pathTurnSE(c))):o<f&&(p.push("h ".concat(0===o?r-d-g*s.leftWideFactor(t)-m-2*y:g*s.rightWideFactor(h)+m)),p.push(s.pathTurnNE(c))),p.push("H ".concat(r)),h=t,d=r,f=o})),p.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}],[{key:"getYShares",value:function(n,t){console.log("computing y shares");var e=new this({stnList:n});return Object.keys(n).forEach((function(n){["linestart","lineend"].includes(n)||n in e.yShares||e.getYShare(n,t)})),e.yShares}}]),n}(),y=function(n,t){var e=(n=n.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),r=n.filter((function(n){return t[n]<=0}));return 1===e.length&&(r=n),0===e.filter((function(n){return-1!==r.indexOf(n)})).length&&e.length&&(r[0]===n[0]?r.push(e[0]):e[0]===n[0]&&e[e.length-1]===n[n.length-1]&&r.length?(r=n,e=[]):r.unshift(e[e.length-1])),{main:e,pass:r}}},51401:function(n,t,e){e.r(t),e.d(t,{calculateColineStations:function(){return a},calculateColine:function(){return c}});var r=e(93433),i=e(23824),a=function(n,t){return n.map((function(n){var e=t.filter((function(t){return t.includes(n.from)&&t.includes(n.to)}));if(1!==e.length)return{linePath:[],colors:n.colors};var r=e.flat(),i=r.indexOf(n.from),a=r.indexOf(n.to);return{linePath:i<a?r.slice(i,a+1):r.slice(a,i+1),colors:n.colors}})).filter((function(n){return 0!==n.linePath.length}))},c=function(n,t){return n.map((function(n){var e=(0,i.drawLine)(n.linePath,t);return{main:[{linePath:e.main,colors:n.colors}],pass:[{linePath:e.pass,colors:n.colors}]}})).reduce((function(n,t){return n.main=[].concat((0,r.Z)(n.main),(0,r.Z)(t.main)),n.pass=[].concat((0,r.Z)(n.pass),(0,r.Z)(t.pass)),n}),{main:[],pass:[]})}},37762:function(n,t,e){e.d(t,{Z:function(){return i}});var r=e(40181);function i(n,t){var e="undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=(0,r.Z)(n))||t&&n&&"number"===typeof n.length){e&&(n=e);var i=0,a=function(){};return{s:a,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,u=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return o=n.done,n},e:function(n){u=!0,c=n},f:function(){try{o||null==e.return||e.return()}finally{if(u)throw c}}}}}}]);
//# sourceMappingURL=6667.e621b329.chunk.js.map