"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[7250],{17250:function(n,t,e){e.r(t);var r=e(45987),i=e(29439),s=e(1413),o=e(93433),a=e(72791),c=e(20713),l=e(37732),f=e(80184),d=["stnName","oneLine","directionPolarity"],m=["intInfos","direction"];t.default=function(n){var t=n.stnId,e=n.stnState,r=n.color,i=n.bank,a=n.direction,c=(0,l.Qy)((function(n){return n.param})),d=c.direction,m=c.info_panel_type,h=c.stn_list,g=c.loop,j=h[t],_=null!==a&&void 0!==a?a:d,v=g?0:([].concat((0,o.Z)(j.branch.left),(0,o.Z)(j.branch.right)).length?8+12*j.name[1].split("\\").length:0)*("r"===_?-1:1),y="",p={};"sh2020"===m?(y=3===j.services.length?"stn_sh_2020_direct":2===j.services.length?"stn_sh_2020_express":"stn_sh_2020",p.fill=-1===e?"gray":r||"var(--rmg-theme-colour)"):(y=3===j.services.length?"direct_sh":2===j.services.length?"express_sh":[].concat((0,o.Z)(j.transfer.info[0]),(0,o.Z)(j.transfer.info[1]||[])).length>0?"int2_sh":"stn_sh",p.stroke=-1===e?"gray":r||"var(--rmg-theme-colour)");var S=null!==i&&void 0!==i?i:0,Z=("l"===_?6:-6)+v+30*S,k=("sh2020"===m?-20:-6)+Math.abs(S)*("sh2020"===m?25:11),b=S?0:"l"===_?-45:45;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("use",(0,s.Z)((0,s.Z)({xlinkHref:"#".concat(y)},p),{},{transform:"translate(".concat(S*("sh2020"===m?5:0),",0)")+"rotate(".concat(90*S*("sh2020"===m?1:-1),")")})),(0,f.jsx)("g",{transform:"translate(".concat(Z,",").concat(k,")rotate(").concat(b,")"),children:(0,f.jsx)(u,{name:j.name,infos:j.transfer.info,stnState:e,direction:_,facility:j.facility,bank:S,oneLine:j.one_line,intPadding:j.int_padding})}),0===e?(0,f.jsx)(x,{}):void 0]})};var u=function(n){var t,e=n.name,r=n.infos,s=n.stnState,l=n.direction,d=n.facility,m=n.bank,u=n.oneLine,x=n.intPadding,j=a.useRef(null),_="l"===l?1:-1,v=d!==c.mV.none?30:0,S=m?-12:0,Z=a.useRef(null),k=a.useState(0),b=(0,i.Z)(k,2),z=b[0],N=b[1];a.useEffect((function(){var n,t;return N(null!==(n=null===(t=Z.current)||void 0===t?void 0:t.getBBox().width)&&void 0!==n?n:0)}),(0,o.Z)(JSON.stringify(r)));var I=x-z;return(0,f.jsxs)(f.Fragment,{children:[r.flat().length>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("line",{x1:(S+v)*_,x2:I*_,stroke:-1===s?"gray":"black",strokeWidth:.5}),(0,f.jsx)(g,{ref:Z,intInfos:r,direction:l,transform:"translate(".concat(I*_,",-10.75)")})]}),d!==c.mV.none&&(0,f.jsx)("use",{xlinkHref:"#"+d,x:10*_,y:-30}),(0,f.jsxs)("g",{textAnchor:"l"===l?"start":"end",transform:"translate(".concat(v*_,",-14)"),children:[(0,f.jsx)(h,{ref:j,stnName:e,oneLine:u,directionPolarity:_,fill:-1===s?"gray":0===s?"red":"black"}),(null===(t=r[1])||void 0===t?void 0:t.length)>0&&(0,f.jsx)("g",{transform:"translate(".concat((I+z/2)*_,",-30)"),children:(0,f.jsx)(y,{osiInfos:r[1]})}),(0,o.Z)(r[2]||[]).length>0&&(0,f.jsx)("g",{transform:"translate(".concat((x+5)*_,",0)"),children:(0,f.jsx)(p,{osysiInfos:r[2],direction:n.direction})})]})]})},h=a.forwardRef((function(n,t){var e=n.stnName,c=n.oneLine,l=n.directionPolarity,m=(0,r.Z)(n,d),u=a.useRef(null),h=a.useState(0),x=(0,i.Z)(h,2),g=x[0],j=x[1];a.useEffect((function(){j(c?u.current.getBBox().width+5:0)}),[].concat((0,o.Z)(e),[c]));return(0,f.jsx)("g",(0,s.Z)((0,s.Z)({ref:t},m),{},{children:a.useMemo((function(){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("g",{ref:u,children:e[0].split("\\").map((function(n,t,r){return(0,f.jsx)("text",{className:"rmg-name__zh",dy:-20*(r.length-1-t)+(c?8:-8*(e[1].split("\\").length-1)),children:n},t)}))}),(0,f.jsx)("g",{fontSize:8,transform:"translate(".concat(g*l,",0)"),children:e[1].split("\\").map((function(n,t,e){return(0,f.jsx)("text",{className:"rmg-name__en",dy:-8*(e.length-2-t)+2,children:n},t)}))})]})}),[].concat((0,o.Z)(e),[c,g,l]))}))})),x=function(){var n=(0,l.Qy)((function(n){return n.param})).stn_list,t=[-1,35,50,75][new Set(Object.values(n).map((function(n){return n.services})).flat()).size];return(0,f.jsx)("g",{transform:"translate(0, ".concat(t,")"),children:(0,f.jsx)("text",{className:"rmg-name__zh",fill:"red",textAnchor:"middle",children:"\u672c\u7ad9"})})},g=a.forwardRef((function(n,t){var e,i=n.intInfos,a=(n.direction,(0,r.Z)(n,m)),c=[].concat((0,o.Z)(i[0]),(0,o.Z)(i[1]||[]),(0,o.Z)((null===(e=i[2])||void 0===e?void 0:e.filter((function(n){return Boolean(n[4].match(/^\u78c1(\u60ac)*\u6d6e/))})))||[])),l=0;return(0,f.jsx)("g",(0,s.Z)((0,s.Z)({ref:t,fontSize:14,textAnchor:"middle"},a),{},{children:c.map((function(t,e){var r=Boolean(t[4].match(/^\d.*$/)),i=Boolean(t[4].match(/^\u78c1(\u60ac)*\u6d6e/));"r"===n.direction&&(l-=(r||i?20:14*t[4].length+12)+(0===e?0:5));var s=(0,f.jsx)("g",{});return s=i?(0,f.jsx)("g",{transform:"translate(".concat(l,",-16)scale(0.1428571429)"),children:(0,f.jsx)(j,{info:t})},e):r?(0,f.jsx)("g",{transform:"translate(".concat(l,",0)"),children:(0,f.jsx)(_,{info:t})},e):(0,f.jsx)("g",{transform:"translate(".concat(l,",0)"),children:(0,f.jsx)(v,{info:t})},e),"l"===n.direction&&(l+=r||i?25:14*t[4].length+12+5),s}))}))})),j=a.memo((function(n){return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("use",{xlinkHref:"#intbox_maglev",fill:n.info[2],stroke:n.info[2]})})}),(function(n,t){return n.info.toString()===t.info.toString()})),_=a.memo((function(n){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("use",{xlinkHref:"#intbox_number",fill:n.info[2]}),(0,f.jsx)("text",{x:10,className:"rmg-name__zh",fill:n.info[3],dominantBaseline:"central",children:n.info[4].match(/(\d*)\w+/)[0]})]})}),(function(n,t){return n.info.toString()===t.info.toString()})),v=a.memo((function(n){var t=n.info[4].split("\\")[0].length;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("rect",{height:22,width:14*t+12,y:-11,fill:n.info[2]}),(0,f.jsx)("text",{x:7*t+6,className:"rmg-name__zh",fill:n.info[3],dominantBaseline:"central",children:n.info[4].split("\\")[0]})]})}),(function(n,t){return n.info.toString()===t.info.toString()})),y=function(n){var t=n.osiInfos.map((function(n){return n[4]})).join("\uff0c");return a.useMemo((function(){return(0,f.jsxs)("g",{textAnchor:"middle",fontSize:"50%",children:[(0,f.jsx)("text",{className:"rmg-name__zh",dy:-5,children:"\u6362\u4e58".concat(t)}),(0,f.jsx)("text",{className:"rmg-name__zh",dy:5,children:"\u4ec5\u9650\u516c\u5171\u4ea4\u901a\u5361"}),(0,f.jsx)("text",{className:"rmg-name__en",dy:12.5,fontSize:"75%",children:"Only for Public Transportation Card"})]})}),[t.toString()])},p=function(n){var t=n.osysiInfos.map((function(n){return n[4]})).join("\uff0c"),e=n.osysiInfos.map((function(n){return n[5]})).join(", ");return a.useMemo((function(){return(0,f.jsxs)("g",{textAnchor:"l"===n.direction?"start":"end",fontSize:"50%",children:[(0,f.jsxs)("text",{className:"rmg-name__zh",dy:3,children:["\u8f6c\u4e58",t]}),(0,f.jsxs)("text",{className:"rmg-name__en",dy:10,fontSize:"75%",children:["To ",e]})]})}),[n.osysiInfos.toString(),n.direction])}}}]);
//# sourceMappingURL=7250.c3341dc6.chunk.js.map