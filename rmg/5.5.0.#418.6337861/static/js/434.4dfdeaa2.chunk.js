"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[434,3824,2554],{23824:function(e,t,r){r.r(t),r.d(t,{adjacencyList:function(){return u},criticalPathMethod:function(){return d},getXShareMTR:function(){return f},getStnState:function(){return p},Stations:function(){return g},drawLine:function(){return x}});var n=r(29439),i=r(15671),a=r(43144),s=r(93433),c=r(37762),l=r(4942),o=r(1413),h=r(20713),u=function(e,t,r){return Object.keys(e).reduce((function(n,i){return(0,o.Z)((0,o.Z)({},n),{},(0,l.Z)({},i,e[i].children.reduce((function(n,a){return(0,o.Z)((0,o.Z)({},n),{},(0,l.Z)({},a,1+t(e,a)+r(e,i)))}),{})))}),{})},d=function e(t,r,n){if(t===r)return{len:0,nodes:[t]};var i=[],a=[];Object.keys(n[t]).forEach((function(s){var c=e(s,r,n);c.len<0||(i.push(n[t][s]+c.len),c.nodes.unshift(t),a.push(c.nodes))}));var s=Math.max.apply(Math,i);return{len:s,nodes:a[i.indexOf(s)]}},f=function(e,t,r){var n=d("linestart","lineend",t);if(n.nodes.includes(e))return d(n.nodes[1],e,t).len;for(var i=r.filter((function(t){return t.includes(e)}))[0],a=e;!n.nodes.includes(a);)a=i[i.indexOf(a)-1];for(var s=e;!n.nodes.includes(s);)s=i[i.indexOf(s)+1];var c="linestart"===a,l=[];return c||"lineend"===s?c?(l[0]=0,l[1]=d(n.nodes[1],s,t).len,l[2]=d(i[1],e,t).len,l[3]=d(e,s,t).len):(l[0]=d(n.nodes[1],a,t).len,l[1]=d(a,n.nodes.slice(-2)[0],t).len,l[2]=d(a,e,t).len,l[3]=d(e,i.slice(-2)[0],t).len):(l[0]=d(n.nodes[1],a,t).len,l[1]=d(a,s,t).len,l[2]=d(a,e,t).len,l[3]=d(e,s,t).len),l[0]+l[2]*l[1]/(l[2]+l[3])},p=function(e,t,r){var n;return console.log("computing stations' states"),(0,s.Z)(new Set((n=[]).concat.apply(n,(0,s.Z)(t)))).reduce((function(n,i){return(0,o.Z)((0,o.Z)({},n),{},(0,l.Z)({},i,i===e?0:(r===h.wA.right?function(e,t,r){var n,i=(0,c.Z)(r);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=a.indexOf(e),l=a.indexOf(t);if(-1!==s&&s<l)return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,i,t):function(e,t,r){var n,i=(0,c.Z)(r);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=a.indexOf(e),l=a.indexOf(t);if(-1!==l&&l<s)return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,i,t))?1:-1))}),{})},g=function(){function e(t){var r=this;(0,i.Z)(this,e),this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=function(e){return 0},this.rightWideFactor=function(e){return 0},this.pathTurnParams=function(e){var t=35-17.5*Math.sqrt(3),r=e-2*t;return{tr:35,dx_a:17.5,dy_a:t,dx_l:r*Math.sqrt(3),dy_l:r}},this.pathTurnSE=function(e){var t=r.pathTurnParams(e),n=t.tr,i=t.dx_a,a=t.dy_a,s=t.dx_l,c=t.dy_l;return"a ".concat(n,",").concat(n," 0 0,1 ").concat(i,",").concat(a," l ").concat(s,",").concat(c," a ").concat(n,",").concat(n," 0 0,0 ").concat(i,",").concat(a)},this.pathTurnNE=function(e){var t=r.pathTurnParams(e),n=t.tr,i=t.dx_a,a=t.dy_a,s=t.dx_l,c=t.dy_l;return"a ".concat(n,",").concat(n," 0 0,0 ").concat(i,",").concat(-a," l ").concat(s,",").concat(-c," a ").concat(n,",").concat(n," 0 0,1 ").concat(i,",").concat(-a)},this.stnList=t.stnList,this.criticalPath=t.criticalPath}return(0,a.Z)(e,[{key:"getYShare",value:function(e,t){if(e in this.yShares)return this.yShares[e];if(["linestart","lineend"].includes(e)||this.stnList[e].parents.length>1||this.stnList[e].children.length>1)return this.yShares[e]=0,0;var r=this.stnList[e].parents[0];if(r){if(1===this.stnList[r].children.length){var n=this.getYShare(r);return this.yShares[e]=n,n}var i=0===this.stnList[r].children.indexOf(e)?1:-1;return this.yShares[e]=i,i}return this.yShares[e]=0,0}},{key:"_linePath",value:function(e,t,r,i,a,s,c,l){var o=this,h=(0,n.Z)([],3),u=h[0],d=h[1],f=h[2],p=[],g=this.pathTurnParams(s),x=g.dx_a+g.dx_l/2,v=(t[1]-t[0])/c.len*2,m=((t[1]-t[0])/c.len-2*x)/2;return m+v<0&&console.warn("SVG width too small! ".concat(m+v)),e.forEach((function(t){var n=i[t],c=a[t];if(!d&&0!==d)return u=t,f=n,d=c,void(1===e.length?p.push("M ".concat(n,",").concat(c)):r[0].includes(t)?r[0].includes(e[1])?p.push("M ".concat(n,",").concat(c)):(i[e[1]]>0&&p.push("M ".concat(n,",").concat(c+l)),a[e[1]]<0&&p.push("M ".concat(n,",").concat(c-l))):p.push("M ".concat(n,",").concat(c)));c>d?(p.push("h ".concat(0===c?n-f-v*o.leftWideFactor(t)-m-2*x:v*o.rightWideFactor(u)+m)),p.push(o.pathTurnSE(s))):c<d&&(p.push("h ".concat(0===c?n-f-v*o.leftWideFactor(t)-m-2*x:v*o.rightWideFactor(u)+m)),p.push(o.pathTurnNE(s))),p.push("H ".concat(n)),u=t,f=n,d=c})),p.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}],[{key:"getYShares",value:function(e,t){console.log("computing y shares");var r=new this({stnList:e});return Object.keys(e).forEach((function(e){["linestart","lineend"].includes(e)||e in r.yShares||r.getYShare(e,t)})),r.yShares}}]),e}(),x=function(e,t){var r=(e=e.filter((function(e){return!["linestart","lineend"].includes(e)}))).filter((function(e){return t[e]>=0})),n=e.filter((function(e){return t[e]<=0}));return 1===r.length&&(n=e),0===r.filter((function(e){return-1!==n.indexOf(e)})).length&&r.length&&(n[0]===e[0]?n.push(r[0]):r[0]===e[0]&&r[r.length-1]===e[e.length-1]&&n.length?(n=e,r=[]):n.unshift(r[r.length-1])),{main:r,pass:n}}},79362:function(e,t,r){r.r(t),r.d(t,{default:function(){return u}});var n=r(72791),i=r(20713),a=r(61504),s=r(28271),c=r(37732),l=r(62554),o=r(80184),h=i.Ht.RailMap;function u(){var e=(0,c.Qy)((function(e){return e.app})).canvasScale,t=(0,c.Qy)((function(e){return e.param})),r=t.svgWidth,n=t.svg_height,u=t.theme,f=t.loop,p=t.loop_info.bank,g=r[h];return(0,o.jsxs)(l.default,{type:h,svgWidth:g,svgHeight:n,canvasScale:e,theme:u,children:[(0,o.jsx)(d,{}),f?(0,o.jsx)(s.default,{bank_angle:p,canvas:i.Ht.RailMap}):(0,o.jsx)(a.default,{}),(0,o.jsx)(a.DirectionElements,{})]})}var d=n.memo((function(){return(0,o.jsxs)("defs",{children:[(0,o.jsx)("circle",{id:"stn_sh",fill:"var(--rmg-white)",strokeWidth:2,r:5}),(0,o.jsx)("path",{id:"int2_sh",fill:"var(--rmg-white)",strokeWidth:2,d:"M -5,0 a 5,5 0 1 1 10,0 V10 a 5,5 0 1 1 -10,0Z"}),(0,o.jsx)("path",{id:"express_sh",fill:"var(--rmg-white)",strokeWidth:2,d:"M -5,0 a 5,5 0 1 1 10,0 V25 a 5,5 0 1 1 -10,0Z"}),(0,o.jsx)("path",{id:"direct_sh",fill:"var(--rmg-white)",strokeWidth:2,d:"M -5,0 a 5,5 0 1 1 10,0 V50 a 5,5 0 1 1 -10,0Z"}),(0,o.jsx)("rect",{id:"stn_sh_2020",stroke:"none",height:24,width:12,x:-6,y:-18}),(0,o.jsx)("rect",{id:"stn_sh_2020_express",stroke:"none",height:49,width:12,x:-6,y:-18}),(0,o.jsx)("rect",{id:"stn_sh_2020_direct",stroke:"none",height:74,width:12,x:-6,y:-18}),(0,o.jsx)("rect",{id:"intbox_number",height:22,width:20,y:-11}),(0,o.jsxs)("g",{id:"intbox_maglev",transform:"translate(-25,0)",children:[(0,o.jsx)("rect",{id:"maglev_5",height:144,width:130,y:"40",x:"30",strokeWidth:10}),(0,o.jsx)("path",{id:"maglev_3",fill:"var(--rmg-white)",d:"m90,55a40,5 0 0 0 -40,3a5,5 0 0 0 -5,5a5,60 0 0 0 -3,60a5,5 0 0 0 5,5l96,0a5,5 0 0 0 5,-5a5,60 0 0 0 -3,-60a5,5 0 0 0 -5,-5a40,5 0 0 0 -40,-3l-5,-10l-5,10"}),(0,o.jsx)("path",{id:"maglev_4",fill:"var(--rmg-white)",d:"m90,140l-40,0a10,5 0 0 1 -10,-5l0,25a10,15 0 0 0 10,15l15,0l0,-10l-15,0l0,-15l90,0l0,15l-15,0l0,10l15,0a10,15 0 0 0 10,-15l0,-25a10,5 0 0 1 -10,5l-50,0"}),(0,o.jsx)("rect",{id:"maglev_1",height:"25",width:"40",y:"80",x:"50"}),(0,o.jsx)("rect",{id:"maglev_2",height:"25",width:"40",y:"80",x:"100"})]}),(0,o.jsxs)("g",{id:"airport",transform:"scale(0.5)",children:[(0,o.jsx)("circle",{cx:"0",cy:"29.33899",r:"29.33899",fill:"var(--rmg-grey)"}),(0,o.jsx)("path",{id:"airport",d:"M28.9769,6.60134c1.711.013,3.111,2.53205,3.111,4.241v10.337s17.106,15.435,17.358,15.666a1.145,1.145,0,0,1,.488,1.152v2.833c0,.651-.451.61-.695.467-.334-.119-17.151-8.863-17.151-8.863-.004,1.458-.797,9.006-1.326,13.304,0,0,4.61,2.457,4.699,2.521.334.268.352.359.352.852v2.001c0,.477-.352.428-.51.324-.183-.062-5.693-1.921-5.693-1.921a2.56018,2.56018,0,0,0-.633-.127,2.31654,2.31654,0,0,0-.666.127s-5.477,1.859-5.672,1.921c-.185.104-.523.153-.523-.324v-2.001c0-.493.029-.584.367-.852.086-.064,4.678-2.521,4.678-2.521-.524-4.298-1.307-11.846-1.325-13.304,0,0-16.822,8.744-17.148,8.863-.217.143-.69.184-.69-.467v-2.833a1.16206,1.16206,0,0,1,.473-1.152c.276-.231,17.365-15.666,17.365-15.666v-10.337c0-1.709,1.403-4.228,3.14105-4.241",transform:"translate(-28.9697,0.14347)",fill:"var(--rmg-white)"})]}),(0,o.jsxs)("g",{id:"disney",transform:"scale(0.5)",children:[(0,o.jsx)("circle",{cx:"0",cy:"29.33899",r:"29.33899",fill:"var(--rmg-grey)"}),(0,o.jsx)("path",{fill:"var(--rmg-white)",d:"M45.6152,7.85015a9.80248,9.80248,0,0,0-9.79907,9.801,9.70059,9.70059,0,0,0,.342,2.582c.002.026.002.055.002.093a.31815.31815,0,0,1-.31494.318.67741.67741,0,0,1-.12806-.02,15.71521,15.71521,0,0,0-13.498,0,.61.61,0,0,1-.122.02.31841.31841,0,0,1-.322-.318v-.067a9.62553,9.62553,0,0,0,.35608-2.608,9.803,9.803,0,1,0-9.797,9.8,10.10364,10.10364,0,0,0,2.308-.271h.05493a.31113.31113,0,0,1,.31409.318.32433.32433,0,0,1-.019.12,15.72588,15.72588,0,1,0,29.703,7.216,15.83676,15.83676,0,0,0-1.746-7.23.18417.18417,0,0,1-.0271-.106.31612.31612,0,0,1,.32007-.318h.057a10.15953,10.15953,0,0,0,2.316.271,9.80051,9.80051,0,0,0,0-19.601",transform:"translate(-28.9697 0.13398)"})]}),(0,o.jsxs)("g",{id:"railway",children:[(0,o.jsx)("circle",{cx:"0",cy:"29.33899",r:"29.33899",fill:"var(--rmg-grey)",transform:"translate(0,-2)scale(0.5)"}),(0,o.jsx)("path",{fill:"var(--rmg-white)",d:"M169,273.5c0-19,14.7-34.8,33.7-36.3c18.9-1.5,38.1-2.2,57.4-2.2c19.3,0,38.4,0.8,57.3,2.2  c19,1.5,33.7,17.3,33.7,36.3v47.3l-51.3,14.7c-11.2,3.2-18.9,13.4-18.9,25v147.8c0,17.4,12.2,32.3,29.3,35.7l110.6,22.1  c4.9,1,8.4,5.2,8.4,10.2V599H91v-22.7c0-5,3.5-9.2,8.4-10.2L209.9,544c17-3.4,29.3-18.3,29.3-35.7V360.5c0-11.6-7.7-21.8-18.9-25  L169,320.8V273.5z M309.4,31.7c0.2-1.2,0.3-2.4,0.3-3.6c0-14-11.1-25.4-24.9-26C276.6,1.4,268.3,1,260,1c-8.3,0-16.6,0.4-24.7,1.1  c-13.9,0.6-24.9,12-24.9,26c0,1.2,0.1,2.5,0.3,3.6C90.6,54.8,0,160.3,0,287c0,97.2,53.4,182,132.4,226.6l36.8-48.1  C104.3,432.4,59.8,364.9,59.8,287c0-110.6,89.6-200.2,200.2-200.2S460.2,176.4,460.2,287c0,77.9-44.5,145.4-109.4,178.5  c15,19.6,25.6,33.5,36.8,48.1C466.6,469,520,384.2,520,287C520,160.3,429.4,54.8,309.4,31.7z",transform:"translate(-10,0)scale(0.04)"})]}),(0,o.jsx)("marker",{id:"arrow_gray",viewBox:"-1.5 0 3 1.5",refY:.5,children:(0,o.jsx)("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-grey)"})}),(0,o.jsx)("marker",{id:"arrow_theme_left",refX:1,refY:.5,children:(0,o.jsx)("path",{d:"M1,0L0,1H1z",fill:"var(--rmg-theme-colour)"})}),(0,o.jsx)("marker",{id:"arrow_theme_right",refY:.5,children:(0,o.jsx)("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})}),(0,o.jsx)("marker",{id:"arrow_theme",refX:1,refY:.5,children:(0,o.jsx)("path",{d:"M0,1H2L1,0z",fill:"var(--rmg-theme-colour)"})}),(0,o.jsx)("filter",{id:"contrast-direct",filterUnits:"userSpaceOnUse",children:(0,o.jsxs)("feComponentTransfer",{children:[(0,o.jsx)("feFuncR",{type:"linear",slope:.5,intercept:.25}),(0,o.jsx)("feFuncG",{type:"linear",slope:.5,intercept:.25}),(0,o.jsx)("feFuncB",{type:"linear",slope:.5,intercept:.25})]})}),(0,o.jsx)("filter",{id:"contrast-express",filterUnits:"userSpaceOnUse",children:(0,o.jsxs)("feComponentTransfer",{children:[(0,o.jsx)("feFuncR",{type:"linear",slope:.75,intercept:.125}),(0,o.jsx)("feFuncG",{type:"linear",slope:.75,intercept:.125}),(0,o.jsx)("feFuncB",{type:"linear",slope:.75,intercept:.125})]})}),(0,o.jsxs)("filter",{id:"pujiang_outline_railmap",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",x:"0",y:"-1000",width:"5000",height:"2000",children:[(0,o.jsxs)("feComponentTransfer",{in:"SourceGraphic",children:[(0,o.jsx)("feFuncR",{type:"discrete",tableValues:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"}),(0,o.jsx)("feFuncG",{type:"discrete",tableValues:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"}),(0,o.jsx)("feFuncB",{type:"discrete",tableValues:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"})]}),(0,o.jsx)("feColorMatrix",{type:"matrix",values:"1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 1 1 1 1 -3",result:"selectedColor1"}),(0,o.jsx)("feMorphology",{operator:"erode",in:"selectedColor1",radius:"0",result:"e1"}),(0,o.jsx)("feMorphology",{operator:"erode",in:"selectedColor1",radius:"1",result:"e2"}),(0,o.jsx)("feComposite",{in:"e1",in2:"e2",operator:"xor",result:"uncoloredOutline"}),(0,o.jsx)("feFlood",{floodColor:"rgb(0,0,0)"}),(0,o.jsx)("feComposite",{operator:"in",in2:"uncoloredOutline",result:"outline"}),(0,o.jsx)("feComposite",{in:"outline",in2:"selectedColor1",operator:"over",result:"result"}),(0,o.jsx)("feComposite",{in:"result",in2:"SourceGraphic",operator:"over"})]})]})}))},62554:function(e,t,r){r.r(t),r.d(t,{default:function(){return a}});var n=r(4942),i=(r(72791),r(80184));function a(e){var t,r=e.type,a=e.svgWidth,s=e.svgHeight,c=e.canvasScale,l=e.theme,o=e.children;return(0,i.jsxs)("svg",{id:r,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:s*c,viewBox:"0 0 ".concat(a," ").concat(s),colorInterpolationFilters:"sRGB",style:(t={},(0,n.Z)(t,"--rmg-svg-width",a+"px"),(0,n.Z)(t,"--rmg-svg-height",s+"px"),(0,n.Z)(t,"--rmg-theme-colour",l[2]),(0,n.Z)(t,"--rmg-theme-fg",l[3]),t),children:[(0,i.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),o,(0,i.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]})}},37762:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(40181);function i(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=(0,n.Z)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw s}}}}}}]);
//# sourceMappingURL=434.4dfdeaa2.chunk.js.map