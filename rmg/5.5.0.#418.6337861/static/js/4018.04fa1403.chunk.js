"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[4018,2554],{41552:function(t,e,n){n.r(e),n.d(e,{default:function(){return f},DefsSHMetro:function(){return x}});var r=n(4942),s=n(1413),i=n(72791),a=n(23824),c=n(25481),o=n(78359),l=n(20713),h=n(37732),d=n(28271),u=n(62554),g=n(80184),m=l.Ht.Indoor;function f(){var t=(0,h.Qy)((function(t){return t.app})).canvasScale,e=(0,h.Qy)((function(t){return t.param})),n=e.svgWidth,r=e.svg_height,s=e.theme,i=e.loop,a=n[m];return(0,g.jsxs)(u.default,{type:m,svgWidth:a,svgHeight:r,canvasScale:t,theme:s,children:[(0,g.jsx)(x,{}),i?(0,g.jsx)(d.default,{bank_angle:!1,canvas:l.Ht.Indoor}):(0,g.jsx)(p,{}),(0,g.jsx)(S,{})]})}var x=i.memo((function(){return(0,g.jsxs)("defs",{children:[(0,g.jsx)("circle",{id:"stn_indoor_sh",fill:"var(--rmg-white)",strokeWidth:5,r:8,transform:"scale(1.5)"}),(0,g.jsx)("path",{id:"int2_indoor_sh",fill:"var(--rmg-white)",transform:"translate(0, -10)scale(2)",strokeWidth:4,d:"M -5,0 a 5,5 0 1 1 10,0 V10 a 5,5 0 1 1 -10,0Z"}),(0,g.jsx)("path",{id:"express_indoor_sh",fill:"var(--rmg-white)",transform:"translate(0, -10)scale(2)",strokeWidth:4,d:"M -5,0 a 5,5 0 1 1 10,0 V25 a 5,5 0 1 1 -10,0Z"}),(0,g.jsx)("path",{id:"direct_indoor_sh",fill:"var(--rmg-white)",transform:"translate(0, -10)scale(2)",strokeWidth:4,d:"M -5,0 a 5,5 0 1 1 10,0 V40 a 5,5 0 1 1 -10,0Z"})]})})),v=function(t,e){var n=0;return 2===t[e].parents.length&&(n+=1),2===t[t[e].parents[0]].children.length&&(n+=1),n},_=function(t,e){var n=0;return 2===t[e].children.length&&(n+=1),2===t[t[e].children[0]].parents.length&&(n+=1),n},p=function(){var t=(0,h.Qy)((function(t){return t.helper})),e=t.routes,n=t.branches,c=t.depsStr,d=(0,h.Qy)((function(t){return t.param})),u=(0,a.adjacencyList)(d.stn_list,v,_),m=(0,a.criticalPathMethod)("linestart","lineend",u),f=(0,a.criticalPathMethod)(m.nodes[1],m.nodes.slice(-2)[0],u),x=i.useMemo((function(){return console.log("computing x shares"),Object.keys(d.stn_list).reduce((function(t,e){return(0,s.Z)((0,s.Z)({},t),{},(0,r.Z)({},e,(0,a.getXShareMTR)(e,u,n)))}),{})}),[n.toString(),JSON.stringify(u)]),p=[d.svgWidth.indoor*d.padding/100,d.svgWidth.indoor*(1-d.padding/100)],S=Object.keys(x).reduce((function(t,e){return(0,s.Z)((0,s.Z)({},t),{},(0,r.Z)({},e,p[0]+x[e]/f.len*(p[1]-p[0])))}),{}),w=(0,i.useMemo)((function(){return o.StationsSHMetro.getYShares(d.stn_list,n)}),[c]),k=Object.keys(w).reduce((function(t,e){return(0,s.Z)((0,s.Z)({},t),{},(0,r.Z)({},e,w[e]*d.branchSpacingPct*d.svg_height/200))}),{}),b=i.useMemo((function(){return(0,a.getStnState)(d.current_stn_idx,e,d.direction)}),[d.current_stn_idx,d.direction,e.toString()]),Z=Object.values(l.K9),z=Object.values(d.stn_list).map((function(t){return t.services})).flat().reduce((function(t,e){return t[Z.indexOf(e)]=!0,t}),[!1,!1,!1]).map((function(t,e){return[Z[e],t]})).filter((function(t){return t[1]})).map((function(t){return t[0]})),W=o.StationsSHMetro.drawLine(n,b,d.stn_list,p,S,k,d.branchSpacingPct*d.svg_height/200,m,0);return(0,g.jsxs)("g",{id:"main",transform:"translate(0,".concat(d.svg_height/2,")"),children:[(0,g.jsx)(j,{paths:W,services:z}),(0,g.jsx)(y,{xs:S,ys:k,services:z})]})},j=function(t){return(0,g.jsx)("g",{fill:"none",strokeWidth:12,stroke:"var(--rmg-theme-colour)",children:t.services.map((function(e,n){return(0,g.jsxs)("g",{transform:"translate(0, ".concat(30*n,")"),children:[t.paths.main.map((function(t,e){return(0,g.jsx)("path",{d:t},e)})),t.paths.pass.map((function(t,e){return(0,g.jsx)("path",{d:t},e)}))]},"indoor_line_".concat(n))}))})},y=function(t){var e=(0,h.Qy)((function(t){return t.helper})).branches,n=(0,h.Qy)((function(t){return t.param})),r=t.xs,s=t.ys,i=t.services;return(0,g.jsx)("g",{children:Object.keys(n.stn_list).filter((function(t){return!["linestart","lineend"].includes(t)})).filter((function(t){return 0!==n.stn_list[t].services.length})).map((function(t){return(0,g.jsx)("g",{transform:"translate(".concat(r[t],",").concat(s[t],")"),children:(0,g.jsx)(c.default,{stnId:t,nameDirection:e.filter((function(e){return e.includes(t)})).map((function(e){return e.indexOf(t)%2===0||i.length>1?"downward":"upward"}))[0],services:i})},t)}))})},S=function(){var t=(0,h.Qy)((function(t){return t.param}));return i.useMemo((function(){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("g",{transform:"translate(".concat(t.svgWidth.indoor/2,",50)"),children:(0,g.jsxs)("text",{textAnchor:"middle",fontSize:"30",className:"rmg-name__zh",children:["\u8f68\u9053\u4ea4\u901a",t.line_name[0],"\u8fd0\u8425\u7ebf\u8def\u793a\u610f\u56fe"]})}),(0,g.jsxs)("g",{transform:"translate(".concat(t.svgWidth.indoor/2,",").concat(t.svg_height-270,")"),children:[(0,g.jsx)("text",{textAnchor:"middle",fontSize:"18",className:"rmg-name__zh",dx:"-30",dy:"230",children:"\u53cb\u60c5\u63d0\u793a\uff1a\u8bf7\u7559\u610f\u60a8\u9700\u8981\u6362\u4e58\u7ebf\u8def\u7684\u9996\u672b\u73ed\u65f6\u95f4\uff0c\u4ee5\u514d\u803d\u8bef\u60a8\u7684\u51fa\u884c\uff0c\u672b\u73ed\u8f66\u8fdb\u7ad9\u524d\u4e09\u5206\u949f\u505c\u552e\u8be5\u672b\u73ed\u8f66\u8f66\u7968\u3002"}),(0,g.jsx)("text",{textAnchor:"middle",fontSize:"12",className:"rmg-name__en",dx:"10",dy:"250",children:"Please pay attention to the interchange schedule if you want to transfer to other lines. Stop selling tickets 3 minutes before the last train services."}),(0,g.jsxs)("g",{transform:"translate(-600,215)",children:[(0,g.jsx)("rect",{x:"-5",y:"-25",width:"100",height:"70",fill:"none",stroke:"black",rx:"5"}),(0,g.jsx)("line",{x1:"28",x2:"28",y1:"-20",y2:"40",stroke:"black"}),(0,g.jsx)("text",{className:"rmg-name__zh",dx:"3",fontSize:"18",children:"\u56fe"}),(0,g.jsx)("text",{className:"rmg-name__zh",dx:"3",dy:"18",fontSize:"18",children:"\u4f8b"}),(0,g.jsx)("text",{className:"rmg-name__en",dy:"35",fontSize:"8",children:"legend"}),(0,g.jsx)("use",{transform:"translate(45,10)",xlinkHref:"#int2_indoor_sh",stroke:"var(--rmg-theme-colour)"}),(0,g.jsx)("text",{className:"rmg-name__zh",dx:"60",dy:"10",fontSize:"10",children:"\u6362\u4e58\u7ad9"}),(0,g.jsx)("text",{className:"rmg-name__en",dx:"60",dy:"20",fontSize:"6",children:"Interchange"}),(0,g.jsx)("text",{className:"rmg-name__en",dx:"60",dy:"30",fontSize:"6",children:"Station"})]})]})]})}),[t.svgWidth.indoor,t.svg_height,t.line_name])}},62554:function(t,e,n){n.r(e),n.d(e,{default:function(){return i}});var r=n(4942),s=(n(72791),n(80184));function i(t){var e,n=t.type,i=t.svgWidth,a=t.svgHeight,c=t.canvasScale,o=t.theme,l=t.children;return(0,s.jsxs)("svg",{id:n,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:a*c,viewBox:"0 0 ".concat(i," ").concat(a),colorInterpolationFilters:"sRGB",style:(e={},(0,r.Z)(e,"--rmg-svg-width",i+"px"),(0,r.Z)(e,"--rmg-svg-height",a+"px"),(0,r.Z)(e,"--rmg-theme-colour",o[2]),(0,r.Z)(e,"--rmg-theme-fg",o[3]),e),children:[(0,s.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),l,(0,s.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]})}}}]);
//# sourceMappingURL=4018.04fa1403.chunk.js.map