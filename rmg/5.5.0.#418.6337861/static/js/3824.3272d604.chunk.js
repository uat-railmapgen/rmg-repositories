"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[3824],{23824:function(n,t,e){e.r(t),e.d(t,{adjacencyList:function(){return l},criticalPathMethod:function(){return f},getXShareMTR:function(){return d},getStnState:function(){return y},Stations:function(){return p},drawLine:function(){return v}});var r=e(29439),a=e(15671),i=e(43144),c=e(93433),o=e(37762),u=e(4942),s=e(1413),h=e(20713),l=function(n,t,e){return Object.keys(n).reduce((function(r,a){return(0,s.Z)((0,s.Z)({},r),{},(0,u.Z)({},a,n[a].children.reduce((function(r,i){return(0,s.Z)((0,s.Z)({},r),{},(0,u.Z)({},i,1+t(n,i)+e(n,a)))}),{})))}),{})},f=function n(t,e,r){if(t===e)return{len:0,nodes:[t]};var a=[],i=[];Object.keys(r[t]).forEach((function(c){var o=n(c,e,r);o.len<0||(a.push(r[t][c]+o.len),o.nodes.unshift(t),i.push(o.nodes))}));var c=Math.max.apply(Math,a);return{len:c,nodes:i[a.indexOf(c)]}},d=function(n,t,e){var r=f("linestart","lineend",t);if(r.nodes.includes(n))return f(r.nodes[1],n,t).len;for(var a=e.filter((function(t){return t.includes(n)}))[0],i=n;!r.nodes.includes(i);)i=a[a.indexOf(i)-1];for(var c=n;!r.nodes.includes(c);)c=a[a.indexOf(c)+1];var o="linestart"===i,u=[];return o||"lineend"===c?o?(u[0]=0,u[1]=f(r.nodes[1],c,t).len,u[2]=f(a[1],n,t).len,u[3]=f(n,c,t).len):(u[0]=f(r.nodes[1],i,t).len,u[1]=f(i,r.nodes.slice(-2)[0],t).len,u[2]=f(i,n,t).len,u[3]=f(n,a.slice(-2)[0],t).len):(u[0]=f(r.nodes[1],i,t).len,u[1]=f(i,c,t).len,u[2]=f(i,n,t).len,u[3]=f(n,c,t).len),u[0]+u[2]*u[1]/(u[2]+u[3])},y=function(n,t,e){var r;return console.log("computing stations' states"),(0,c.Z)(new Set((r=[]).concat.apply(r,(0,c.Z)(t)))).reduce((function(r,a){return(0,s.Z)((0,s.Z)({},r),{},(0,u.Z)({},a,a===n?0:(e===h.wA.right?function(n,t,e){var r,a=(0,o.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value,c=i.indexOf(n),u=i.indexOf(t);if(-1!==c&&c<u)return!0}}catch(s){a.e(s)}finally{a.f()}return!1}(n,a,t):function(n,t,e){var r,a=(0,o.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value,c=i.indexOf(n),u=i.indexOf(t);if(-1!==u&&u<c)return!0}}catch(s){a.e(s)}finally{a.f()}return!1}(n,a,t))?1:-1))}),{})},p=function(){function n(t){var e=this;(0,a.Z)(this,n),this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=function(n){return 0},this.rightWideFactor=function(n){return 0},this.pathTurnParams=function(n){var t=35-17.5*Math.sqrt(3),e=n-2*t;return{tr:35,dx_a:17.5,dy_a:t,dx_l:e*Math.sqrt(3),dy_l:e}},this.pathTurnSE=function(n){var t=e.pathTurnParams(n),r=t.tr,a=t.dx_a,i=t.dy_a,c=t.dx_l,o=t.dy_l;return"a ".concat(r,",").concat(r," 0 0,1 ").concat(a,",").concat(i," l ").concat(c,",").concat(o," a ").concat(r,",").concat(r," 0 0,0 ").concat(a,",").concat(i)},this.pathTurnNE=function(n){var t=e.pathTurnParams(n),r=t.tr,a=t.dx_a,i=t.dy_a,c=t.dx_l,o=t.dy_l;return"a ".concat(r,",").concat(r," 0 0,0 ").concat(a,",").concat(-i," l ").concat(c,",").concat(-o," a ").concat(r,",").concat(r," 0 0,1 ").concat(a,",").concat(-i)},this.stnList=t.stnList,this.criticalPath=t.criticalPath}return(0,i.Z)(n,[{key:"getYShare",value:function(n,t){if(n in this.yShares)return this.yShares[n];if(["linestart","lineend"].includes(n)||this.stnList[n].parents.length>1||this.stnList[n].children.length>1)return this.yShares[n]=0,0;var e=this.stnList[n].parents[0];if(e){if(1===this.stnList[e].children.length){var r=this.getYShare(e);return this.yShares[n]=r,r}var a=0===this.stnList[e].children.indexOf(n)?1:-1;return this.yShares[n]=a,a}return this.yShares[n]=0,0}},{key:"_linePath",value:function(n,t,e,a,i,c,o,u){var s=this,h=(0,r.Z)([],3),l=h[0],f=h[1],d=h[2],y=[],p=this.pathTurnParams(c),v=p.dx_a+p.dx_l/2,g=(t[1]-t[0])/o.len*2,S=((t[1]-t[0])/o.len-2*v)/2;return S+g<0&&console.warn("SVG width too small! ".concat(S+g)),n.forEach((function(t){var r=a[t],o=i[t];if(!f&&0!==f)return l=t,d=r,f=o,void(1===n.length?y.push("M ".concat(r,",").concat(o)):e[0].includes(t)?e[0].includes(n[1])?y.push("M ".concat(r,",").concat(o)):(a[n[1]]>0&&y.push("M ".concat(r,",").concat(o+u)),i[n[1]]<0&&y.push("M ".concat(r,",").concat(o-u))):y.push("M ".concat(r,",").concat(o)));o>f?(y.push("h ".concat(0===o?r-d-g*s.leftWideFactor(t)-S-2*v:g*s.rightWideFactor(l)+S)),y.push(s.pathTurnSE(c))):o<f&&(y.push("h ".concat(0===o?r-d-g*s.leftWideFactor(t)-S-2*v:g*s.rightWideFactor(l)+S)),y.push(s.pathTurnNE(c))),y.push("H ".concat(r)),l=t,d=r,f=o})),y.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}],[{key:"getYShares",value:function(n,t){console.log("computing y shares");var e=new this({stnList:n});return Object.keys(n).forEach((function(n){["linestart","lineend"].includes(n)||n in e.yShares||e.getYShare(n,t)})),e.yShares}}]),n}(),v=function(n,t){var e=(n=n.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),r=n.filter((function(n){return t[n]<=0}));return 1===e.length&&(r=n),0===e.filter((function(n){return-1!==r.indexOf(n)})).length&&e.length&&(r[0]===n[0]?r.push(e[0]):e[0]===n[0]&&e[e.length-1]===n[n.length-1]&&r.length?(r=n,e=[]):r.unshift(e[e.length-1])),{main:e,pass:r}}},37762:function(n,t,e){e.d(t,{Z:function(){return a}});var r=e(40181);function a(n,t){var e="undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=(0,r.Z)(n))||t&&n&&"number"===typeof n.length){e&&(n=e);var a=0,i=function(){};return{s:i,n:function(){return a>=n.length?{done:!0}:{done:!1,value:n[a++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,u=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return o=n.done,n},e:function(n){u=!0,c=n},f:function(){try{o||null==e.return||e.return()}finally{if(u)throw c}}}}}}]);
//# sourceMappingURL=3824.3272d604.chunk.js.map