"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[8359,6584,3824],{86584:function(n,t,e){e.r(t),e.d(t,{getStationYShare:function(){return i},getSidingPath:function(){return a}});var r=e(37762),i=function(n,t,e){var r=t[0];if(r.includes(n)){if(t.slice(1).find((function(t){return t.includes(n)})))return 0;var i=t.slice(1).find((function(t){var e="linestart"===t[0],i=r.indexOf(n)<r.indexOf(t.slice(-1)[0]),a="lineend"===t.slice(-1)[0],c=r.indexOf(n)>r.indexOf(t[0]);return e&&i||a&&c}));return i?1===e[i[0]].children.indexOf(i[1])?-1:1:0}var a=t.slice(1).find((function(t){return t.includes(n)}));return a?"linestart"!==a[0]&&"lineend"!==a.slice(-1)[0]?1===e[a[0]].children.indexOf(a[1])?1.2:-1.2:1===e[a[0]].children.indexOf(a[1])?1:-1:0},a=function(n){var t,e,i="a".concat(6,",").concat(6,",0,0,1,").concat(6,",").concat(6),a="a".concat(6,",").concat(6,",0,0,0,").concat(6,",").concat(6),c="a".concat(6,",").concat(6,",0,0,0,").concat(6,",-").concat(6),u="a".concat(6,",").concat(6,",0,0,1,").concat(6,",-").concat(6),s=[],o=(0,r.Z)(n);try{for(o.s();!(e=o.n()).done;){var l=e.value;if(t)if(l[1]===t[1])s.push("H"+l[0]);else{var h=(l[0]+t[0])/2-(0===t[1]?0:12);s.push("H"+h),l[1]>t[1]?(s.push(i),s.push("V"+(l[1]-6)),s.push(a)):(s.push(c),s.push("V"+(l[1]+6)),s.push(u)),s.push("H"+l[0])}else s.push("M"+l.join(","));t=l}}catch(f){o.e(f)}finally{o.f()}return s.join(" ").replace(/( H([\d.]+))+/g," H$2")}},78359:function(n,t,e){e.r(t),e.d(t,{leftWideFactor:function(){return o},rightWideFactor:function(){return l},StationsMTR:function(){return h},StationsSHMetro:function(){return f}});var r=e(15671),i=e(43144),a=e(60136),c=e(54062),u=e(23824),s=e(86584),o=function(n,t){var e=0,r=n[t].transfer,i=r.info.map((function(n){return n.length}));return"l"===r.tick_direc&&(!i[1]&&i[0]>1&&(e+=.8),!i[1]||1===i[0]&&2===i[1]||(e+=.8)),1===i[0]&&2===i[1]&&"linestart"!==n[t].parents[0]&&"lineend"!==n[t].children[0]&&(e+=.8),2===n[t].parents.length&&(e+=.2),2===n[n[t].parents[0]].children.length&&(e+=.4),e},l=function(n,t){var e=0,r=n[t].transfer,i=r.info.map((function(n){return n.length}));return"r"===r.tick_direc&&(!i[1]&&i[0]>1&&(e+=.8),!i[1]||1===i[0]&&2===i[1]||(e+=.8)),1===i[0]&&2===i[1]&&"linestart"!==n[t].parents[0]&&"lineend"!==n[t].children[0]&&(e+=.8),2===n[t].children.length&&(e+=.2),2===n[n[t].children[0]].parents.length&&(e+=.4),e},h=function(n){(0,a.Z)(e,n);var t=(0,c.Z)(e);function e(){var n;(0,r.Z)(this,e);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return(n=t.call.apply(t,[this].concat(a))).leftWideFactor=function(t){return o(n.stnList,t)},n.rightWideFactor=function(t){return l(n.stnList,t)},n}return(0,i.Z)(e,null,[{key:"drawLine",value:function(n,t,e,r,i,a,c,u){var o=this,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h={main:[],pass:[],sidingMain:[],sidingPass:[]};return n.forEach((function(f,d){var p="linestart"!==f[0]&&"lineend"!==f.slice(-1)[0],g=(f=f.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),v=f.filter((function(n){return t[n]<=0}));1===g.length&&(v=f),0===g.filter((function(n){return-1!==v.indexOf(n)})).length&&g.length&&(v[0]===f[0]?v.push(g[0]):g[0]===f[0]&&g[g.length-1]===f[f.length-1]&&v.length?(v=f,g=[]):v.unshift(g[g.length-1])),p?(h.sidingMain.push((0,s.getSidingPath)(g.map((function(n){return[i[n],a[n]]})))),h.sidingPass.push((0,s.getSidingPath)(v.map((function(n){return[i[n],a[n]]}))))):(h.main.push(new o({stnList:e,criticalPath:u})._linePath(g,r,n,i,a,c,u,l)),h.pass.push(new o({stnList:e,criticalPath:u})._linePath(v,r,n,i,a,c,u,l)))})),h}}]),e}(u.Stations),f=function(n){(0,a.Z)(e,n);var t=(0,c.Z)(e);function e(){return(0,r.Z)(this,e),t.apply(this,arguments)}return(0,i.Z)(e,null,[{key:"drawLine",value:function(n,t,e,r,i,a,c,u){var s=this,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l={main:[],pass:[],sidingMain:[],sidingPass:[]};return n.forEach((function(h,f){var d=(h=h.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),p=h.filter((function(n){return t[n]<=0}));1===d.length&&(p=h),0===d.filter((function(n){return-1!==p.indexOf(n)})).length&&d.length&&(p[0]===h[0]?p.push(d[0]):d[0]===h[0]&&d[d.length-1]===h[h.length-1]&&p.length?(p=h,d=[]):p.unshift(d[d.length-1])),l.main.push(new s({stnList:e,criticalPath:u})._linePath(d,r,n,i,a,c,u,o)),l.pass.push(new s({stnList:e,criticalPath:u})._linePath(p,r,n,i,a,c,u,o))})),l}}]),e}(h)},23824:function(n,t,e){e.r(t),e.d(t,{adjacencyList:function(){return h},criticalPathMethod:function(){return f},getXShareMTR:function(){return d},getStnState:function(){return p},Stations:function(){return g},drawLine:function(){return v}});var r=e(29439),i=e(15671),a=e(43144),c=e(93433),u=e(37762),s=e(4942),o=e(1413),l=e(20713),h=function(n,t,e){return Object.keys(n).reduce((function(r,i){return(0,o.Z)((0,o.Z)({},r),{},(0,s.Z)({},i,n[i].children.reduce((function(r,a){return(0,o.Z)((0,o.Z)({},r),{},(0,s.Z)({},a,1+t(n,a)+e(n,i)))}),{})))}),{})},f=function n(t,e,r){if(t===e)return{len:0,nodes:[t]};var i=[],a=[];Object.keys(r[t]).forEach((function(c){var u=n(c,e,r);u.len<0||(i.push(r[t][c]+u.len),u.nodes.unshift(t),a.push(u.nodes))}));var c=Math.max.apply(Math,i);return{len:c,nodes:a[i.indexOf(c)]}},d=function(n,t,e){var r=f("linestart","lineend",t);if(r.nodes.includes(n))return f(r.nodes[1],n,t).len;for(var i=e.filter((function(t){return t.includes(n)}))[0],a=n;!r.nodes.includes(a);)a=i[i.indexOf(a)-1];for(var c=n;!r.nodes.includes(c);)c=i[i.indexOf(c)+1];var u="linestart"===a,s=[];return u||"lineend"===c?u?(s[0]=0,s[1]=f(r.nodes[1],c,t).len,s[2]=f(i[1],n,t).len,s[3]=f(n,c,t).len):(s[0]=f(r.nodes[1],a,t).len,s[1]=f(a,r.nodes.slice(-2)[0],t).len,s[2]=f(a,n,t).len,s[3]=f(n,i.slice(-2)[0],t).len):(s[0]=f(r.nodes[1],a,t).len,s[1]=f(a,c,t).len,s[2]=f(a,n,t).len,s[3]=f(n,c,t).len),s[0]+s[2]*s[1]/(s[2]+s[3])},p=function(n,t,e){var r;return console.log("computing stations' states"),(0,c.Z)(new Set((r=[]).concat.apply(r,(0,c.Z)(t)))).reduce((function(r,i){return(0,o.Z)((0,o.Z)({},r),{},(0,s.Z)({},i,i===n?0:(e===l.wA.right?function(n,t,e){var r,i=(0,u.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,c=a.indexOf(n),s=a.indexOf(t);if(-1!==c&&c<s)return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(n,i,t):function(n,t,e){var r,i=(0,u.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,c=a.indexOf(n),s=a.indexOf(t);if(-1!==s&&s<c)return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(n,i,t))?1:-1))}),{})},g=function(){function n(t){var e=this;(0,i.Z)(this,n),this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=function(n){return 0},this.rightWideFactor=function(n){return 0},this.pathTurnParams=function(n){var t=35-17.5*Math.sqrt(3),e=n-2*t;return{tr:35,dx_a:17.5,dy_a:t,dx_l:e*Math.sqrt(3),dy_l:e}},this.pathTurnSE=function(n){var t=e.pathTurnParams(n),r=t.tr,i=t.dx_a,a=t.dy_a,c=t.dx_l,u=t.dy_l;return"a ".concat(r,",").concat(r," 0 0,1 ").concat(i,",").concat(a," l ").concat(c,",").concat(u," a ").concat(r,",").concat(r," 0 0,0 ").concat(i,",").concat(a)},this.pathTurnNE=function(n){var t=e.pathTurnParams(n),r=t.tr,i=t.dx_a,a=t.dy_a,c=t.dx_l,u=t.dy_l;return"a ".concat(r,",").concat(r," 0 0,0 ").concat(i,",").concat(-a," l ").concat(c,",").concat(-u," a ").concat(r,",").concat(r," 0 0,1 ").concat(i,",").concat(-a)},this.stnList=t.stnList,this.criticalPath=t.criticalPath}return(0,a.Z)(n,[{key:"getYShare",value:function(n,t){if(n in this.yShares)return this.yShares[n];if(["linestart","lineend"].includes(n)||this.stnList[n].parents.length>1||this.stnList[n].children.length>1)return this.yShares[n]=0,0;var e=this.stnList[n].parents[0];if(e){if(1===this.stnList[e].children.length){var r=this.getYShare(e);return this.yShares[n]=r,r}var i=0===this.stnList[e].children.indexOf(n)?1:-1;return this.yShares[n]=i,i}return this.yShares[n]=0,0}},{key:"_linePath",value:function(n,t,e,i,a,c,u,s){var o=this,l=(0,r.Z)([],3),h=l[0],f=l[1],d=l[2],p=[],g=this.pathTurnParams(c),v=g.dx_a+g.dx_l/2,y=(t[1]-t[0])/u.len*2,S=((t[1]-t[0])/u.len-2*v)/2;return S+y<0&&console.warn("SVG width too small! ".concat(S+y)),n.forEach((function(t){var r=i[t],u=a[t];if(!f&&0!==f)return h=t,d=r,f=u,void(1===n.length?p.push("M ".concat(r,",").concat(u)):e[0].includes(t)?e[0].includes(n[1])?p.push("M ".concat(r,",").concat(u)):(i[n[1]]>0&&p.push("M ".concat(r,",").concat(u+s)),a[n[1]]<0&&p.push("M ".concat(r,",").concat(u-s))):p.push("M ".concat(r,",").concat(u)));u>f?(p.push("h ".concat(0===u?r-d-y*o.leftWideFactor(t)-S-2*v:y*o.rightWideFactor(h)+S)),p.push(o.pathTurnSE(c))):u<f&&(p.push("h ".concat(0===u?r-d-y*o.leftWideFactor(t)-S-2*v:y*o.rightWideFactor(h)+S)),p.push(o.pathTurnNE(c))),p.push("H ".concat(r)),h=t,d=r,f=u})),p.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}],[{key:"getYShares",value:function(n,t){console.log("computing y shares");var e=new this({stnList:n});return Object.keys(n).forEach((function(n){["linestart","lineend"].includes(n)||n in e.yShares||e.getYShare(n,t)})),e.yShares}}]),n}(),v=function(n,t){var e=(n=n.filter((function(n){return!["linestart","lineend"].includes(n)}))).filter((function(n){return t[n]>=0})),r=n.filter((function(n){return t[n]<=0}));return 1===e.length&&(r=n),0===e.filter((function(n){return-1!==r.indexOf(n)})).length&&e.length&&(r[0]===n[0]?r.push(e[0]):e[0]===n[0]&&e[e.length-1]===n[n.length-1]&&r.length?(r=n,e=[]):r.unshift(e[e.length-1])),{main:e,pass:r}}},37762:function(n,t,e){e.d(t,{Z:function(){return i}});var r=e(40181);function i(n,t){var e="undefined"!==typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!e){if(Array.isArray(n)||(e=(0,r.Z)(n))||t&&n&&"number"===typeof n.length){e&&(n=e);var i=0,a=function(){};return{s:a,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,s=!1;return{s:function(){e=e.call(n)},n:function(){var n=e.next();return u=n.done,n},e:function(n){s=!0,c=n},f:function(){try{u||null==e.return||e.return()}finally{if(s)throw c}}}}}}]);
//# sourceMappingURL=8359.00d4a1a4.chunk.js.map