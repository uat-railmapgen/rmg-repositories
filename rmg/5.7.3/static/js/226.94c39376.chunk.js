"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[226],{90059:function(t,n,e){e.d(n,{Z:function(){return s}});var r=e(4942),a=(e(72791),e(80184));function s(t){var n,e=t.type,s=t.svgWidth,i=t.svgHeight,c=t.canvasScale,o=t.theme,l=t.children;return(0,a.jsxs)("svg",{id:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:i*c,viewBox:"0 0 ".concat(s," ").concat(i),colorInterpolationFilters:"sRGB",style:(n={},(0,r.Z)(n,"--rmg-svg-width",s+"px"),(0,r.Z)(n,"--rmg-svg-height",i+"px"),(0,r.Z)(n,"--rmg-theme-colour",o[2]),(0,r.Z)(n,"--rmg-theme-fg",o[3]),n),children:[(0,a.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),l,(0,a.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]})}},226:function(t,n,e){e.r(n),e.d(n,{default:function(){return mt}});var r=e(29439),a=e(45987),s=e(1413),i=e(4942),c=e(93433),o=e(72791),l=e(41125),u=e(80184),h=["num","inStrip"];function d(t){var n=t.num,e=t.inStrip,r=(0,a.Z)(t,h);return(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({textAnchor:"middle",fill:e?l.AJ.black:"var(--rmg-theme-fg)"},r),{},{children:[(0,u.jsx)("rect",{height:40,width:40,rx:4,x:-20,fill:e?"#fff":"var(--rmg-theme-colour)"}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:20,dy:12,children:n}),(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:12,dy:26,children:"\u5c4f\u853d\u95e8"}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:6.5,dy:36,children:"Screen Door"})]}))}var m=function(t){var n=function(t){switch(t){case"gz28":case"gz2otis":case"gz6":case"gzgf":return 60;case"gz1":case"gz3":return 40;case"gz4":case"gz5":case"gz1421":return 20;default:return 0}}(t.variant),e=o.useMemo((function(){switch(t.variant){case"gz1":return(0,u.jsx)("circle",{cy:-58,r:16,fill:"red"});case"gz28":case"gz2otis":return(0,u.jsx)("ellipse",{cy:-30,rx:24,ry:12,fill:"orange"});case"gz3":return(0,u.jsx)("rect",{x:-15,y:-55,height:30,width:30,fill:"red"});case"gz6":return(0,u.jsx)("ellipse",{cy:-30,rx:24,ry:12,fill:"white"});case"gz1421":return(0,u.jsx)("ellipse",{cy:-38,rx:24,ry:12,fill:"orange"});case"gz5":return(0,u.jsx)("rect",{x:-30,y:-70,height:30,width:60,fill:"orange"});case"gz4":return(0,u.jsx)("rect",{x:-50,y:-50,height:25,width:100,fill:"whitesmoke"});case"gzgf":return(0,u.jsx)("rect",{x:-30,y:-58,height:30,width:60,fill:"orange"});default:return(0,u.jsx)(u.Fragment,{})}}),[t.variant]);return(0,u.jsxs)("g",{transform:"translate(0,".concat("gz4"===t.variant?-20:0,")"),children:[(0,u.jsx)("rect",{id:"strip_gz",style:(0,i.Z)({},"--height","".concat(n,"px"))}),(0,u.jsx)("g",{style:{transform:"translate(calc(var(--rmg-svg-width) / 2),var(--rmg-svg-height))"},children:t.isShowLight&&e}),!1!==t.isShowPSD&&(0,u.jsx)(f,(0,s.Z)({},t))]})},f=o.memo((function(t){var n,e=["gz28","gz2otis","gz6","gzgf"].includes(t.variant),r=function(t){switch(t){case"gz1":case"gz3":return"82px";case"gz4":return"65px";case"gz5":return"80px";case"gz1421":return"62px";default:return"58px"}}(t.variant);return(0,u.jsx)(d,{num:t.isShowPSD,inStrip:e,style:(n={},(0,i.Z)(n,"--psd-dy",r),(0,i.Z)(n,"transform","translate(var(--translate-x), var(--translate-y))"),(0,i.Z)(n,"--translate-x","calc(var(--rmg-svg-width) / 2 + 80px)"),(0,i.Z)(n,"--translate-y","calc(var(--rmg-svg-height) - var(--psd-dy, 58px))"),n)})}),(function(t,n){return t.variant===n.variant&&t.isShowPSD===n.isShowPSD})),x=(0,o.memo)((function(t){var n=t.passed,e=t.large?"M0,12.95 V-12.95 H-12.95 a12.95,12.95 0 0,0 0,25.9 h25.9 a12.95,12.95 0 0,0 0,-25.9 H0":"M0,9.25 V-9.25 H-9.25 a9.25,9.25 0 0,0 0,18.5 h18.5 a9.25,9.25 0 0,0 0,-18.5 H0";return(0,u.jsx)("path",{d:e,fill:"#fff",strokeWidth:2,stroke:n?"#aaa":"var(--rmg-theme-colour)"})}),(function(t,n){return t.passed===n.passed&&t.large===n.large})),g=["lineNum","stnNum","passed","large"];function p(t){var n=t.lineNum,e=t.stnNum,i=t.passed,c=t.large,l=(0,a.Z)(t,g),h=(0,o.useRef)(null),d=(0,o.useRef)(null),m=(0,o.useState)({width:0}),f=(0,r.Z)(m,2),p=f[0],j=f[1],y=(0,o.useState)({width:0}),v=(0,r.Z)(y,2),_=v[0],S=v[1];(0,o.useEffect)((function(){j(h.current.getBBox()),S(d.current.getBBox())}),[n,e]);var w=15/Math.max(15,p.width),Z=2===n.length&&2===e.length?w:15/Math.max(15,_.width);return(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({},l),{},{children:[(0,u.jsx)(x,{passed:i,large:c}),(0,u.jsxs)("g",{textAnchor:"middle",fontSize:13.5,transform:c?"scale(1.4)":"",fill:i?"#aaa":"#000",children:[(0,u.jsx)("g",{transform:"translate(-9.25,0)scale(".concat(w,")"),children:(0,u.jsx)("text",{ref:h,className:"rmg-name__zh",children:n})}),(0,u.jsx)("g",{transform:"translate(9.25,0)scale(".concat(Z,")"),children:(0,u.jsx)("text",{ref:d,className:"rmg-name__zh",children:e})})]})]}))}var j=e(20713),y=e(37732),v=(0,o.memo)((function(t){var n=t.lineName,e=t.commonPart,a=(0,o.useRef)(null),s=(0,o.useState)({x:0,height:0,width:0}),i=(0,r.Z)(s,2),c=i[0],l=i[1];(0,o.useEffect)((function(){a.current&&l(a.current.getBBox())}),[n.toString()]);var h=S/Math.max(S,c.width),d=(-c.x-c.width/2)*h,m=c.height*(1-h)*1.2/2;return(0,u.jsx)("g",{ref:a,transform:"translate(".concat(d,",").concat(m,")scale(").concat(h,")"),children:(0,u.jsxs)("text",{className:"rmg-name__zh",fontSize:14,y:12,textAnchor:"end",children:[e,(0,u.jsx)("tspan",{className:"rmg-name__zh",fontSize:8,x:0,dy:-2,textAnchor:"start",children:n[0].slice(e.length).trim()}),(0,u.jsx)("tspan",{className:"rmg-name__en",fontSize:4,x:0,dy:6,textAnchor:"start",children:n[1].slice(e.length).trim()})]})})}),(function(t,n){return t.lineName.toString()===n.lineName.toString()}));function _(t){return(0,u.jsx)("rect",(0,s.Z)({x:-22.5,height:24,width:45,rx:4.5},t))}var S=42,w=(0,o.memo)((function(t){var n=t.lineName,e=t.foregroundColour,a=t.backgroundColour,s=t.passed,i=Z(n),c=(0,r.Z)(i,2),h=c[0],d=c[1],m=(0,o.useRef)(null),f=(0,o.useRef)(null),x=(0,o.useState)({width:0}),g=(0,r.Z)(x,2),p=g[0],j=g[1],y=(0,o.useState)({width:0}),w=(0,r.Z)(y,2),N=w[0],A=w[1];(0,o.useEffect)((function(){m.current&&j(m.current.getBBox()),f.current&&A(f.current.getBBox())}),[n.toString()]);var k=S/Math.max(S,p.width),Q=S/Math.max(S,N.width);return(0,u.jsxs)("g",{textAnchor:"middle",fill:s?l.AJ.white:e,children:[(0,u.jsx)(_,{fill:s?"#aaa":a}),2===h?(0,u.jsx)(v,{lineName:n,commonPart:d}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("text",{ref:m,y:z(h,"zh",k),className:"rmg-name__zh",fontSize:12,transform:"scale(".concat(k,")"),children:1===h?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("tspan",{fontSize:16,dy:.7,className:"rmg-name__zh",children:d}),(0,u.jsx)("tspan",{dy:-.7,className:"rmg-name__zh",children:n[0].slice(d.length)})]}):n[0]}),(0,u.jsx)("text",{ref:f,y:z(h,"en",Q),className:"rmg-name__en",fontSize:8,transform:"scale(".concat(Q,")"),children:n[1]})]})]})}),(function(t,n){return t.lineName.toString()===n.lineName.toString()&&t.foregroundColour===n.foregroundColour&&t.backgroundColour===n.backgroundColour&&t.passed===n.passed})),Z=function(t){var n=t[0].match(/^(\d+)\D+$/);if(n)return[1,n[1]];var e=t.map((function(t){return t.match(/^([\w\d]+).+$/)}));return e[0]&&e[1]&&e[0][1]===e[1][1]?[2,e[0][1]]:[3,""]},z=function(t,n,e){switch(t){case 1:return("zh"===n?7.3:19.5)*(2-e);case 2:return 0;case 3:return"zh"===n?8*(2-e):19.5+47.53125*(1-e)-(1===e?0:5.5)}},N=(0,o.memo)((function(t){var n=t.stnName,e=t.onUpdate,r=(0,o.useRef)(null);return(0,o.useEffect)((function(){e&&e(r.current.getBBox())}),[n.toString()]),(0,u.jsxs)("g",{ref:r,children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:18,children:n[0]}),(0,u.jsx)("g",{fontSize:10.5,children:n[1].split("\\").map((function(t,n){return(0,u.jsx)("text",{className:"rmg-name__en",dy:16+11*n,children:t},n)}))})]})}),(function(t,n){return t.stnName.toString()===n.stnName.toString()})),A=["stnName","onUpdate","passed"];function k(t){var n=t.stnName,e=t.onUpdate,i=t.passed,c=(0,a.Z)(t,A),l=(0,o.useRef)(null),h=(0,o.useState)({x:0,width:0}),d=(0,r.Z)(h,2),m=d[0],f=d[1];return(0,o.useEffect)((function(){var t=l.current.getBBox();f(t),e&&e(t)}),[n.toString()]),(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({fill:i?"#aaa":"#000"},c),{},{children:[(0,u.jsxs)("g",{transform:"translate(0,3)",fontSize:18,children:[(0,u.jsx)("text",{textAnchor:"end",x:m.x-3,className:"rmg-name__zh",children:"("}),(0,u.jsx)("text",{textAnchor:"start",x:m.width+m.x+3,className:"rmg-name__zh",children:")"})]}),(0,u.jsxs)("g",{ref:l,textAnchor:"middle",children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:13,children:n[0]}),(0,u.jsx)("text",{dy:10,className:"rmg-name__en",fontSize:6.5,children:n[1]})]})]}))}var Q=["passed"];function E(t){var n=t.passed,e=(0,a.Z)(t,Q);return(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({textAnchor:"middle",fill:n?"#aaa":"var(--rmg-theme-colour)"},e),{},{children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:13,children:"\u5feb\u8f66\u505c\u9760\u7ad9"}),(0,u.jsx)("text",{dy:10,className:"rmg-name__en",fontSize:6.5,children:"Express Station"})]}))}function R(t){var n=t.primaryName,e=t.secondaryName,a=t.stationState,s=t.flipped,i=t.express,c=(0,o.useState)({width:0}),l=(0,r.Z)(c,2),h=l[0],d=l[1],m=(0,o.useState)({x:0,width:-20}),f=(0,r.Z)(m,2),x=f[0],g=f[1],p=n[1].split("\\").length,y={g:{x:0,y:s?17.5:-20-14*p*Math.cos(-45)},StationSecondaryName:{x:(h.width+x.width/2+10)*(s?-1:1),y:2+5*(p-1)},ExpressTag:{x:(h.width+x.width+20+35)*(s?-1:1),y:2+5*(p-1)}};return(0,u.jsxs)("g",{textAnchor:s?"end":"start",fill:function(t){switch(t){case j.KR.PASSED:return"#aaa";case j.KR.CURRENT:return"#f00";case j.KR.FUTURE:return"#000"}}(a),transform:"translate(".concat(y.g.x,",").concat(y.g.y,")rotate(-45)"),children:[(0,u.jsx)(N,{stnName:n,onUpdate:d}),e&&(0,u.jsx)(k,{stnName:e,onUpdate:g,passed:a===j.KR.PASSED,transform:"translate(".concat(y.StationSecondaryName.x,",").concat(y.StationSecondaryName.y,")")}),i&&(0,u.jsx)(E,{passed:a===j.KR.PASSED,transform:"translate(".concat(y.ExpressTag.x,",").concat(y.ExpressTag.y,")")})]})}var H=["intInfos","stnState","tickRotation"],M=["intInfos","tickRotation","stnState"],B=function(t){var n=t.stnId,e=t.stnState,r=t.stnY,a=(0,y.Qy)((function(t){return t.param.theme})),s=(0,y.Qy)((function(t){return t.param.line_name})),i=(0,y.Qy)((function(t){return t.param.line_num})),o=(0,y.Qy)((function(t){return t.param.stn_list[n]})),l=2===o.parents.length||2===o.children.length,h=r>0||1===o.parents.indexOf(o.branch.left[1]||"")||1===o.children.indexOf(o.branch.right[1]||"")?180:0,d=o.name[1].split("\\").length,m=l?180===h?16+12*(d-1)*Math.cos(-45):-9:180===h?-6:(25+15*(d-1))*Math.cos(-45);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(b,{intInfos:l?[[a[0],a[1],"var(--rmg-theme-colour)","var(--rmg-theme-fg)"].concat((0,c.Z)(s))].concat(o.transfer.info[0]):o.transfer.info[0],stnState:e,tickRotation:h}),(0,u.jsx)(p,{lineNum:i,stnNum:o.num,passed:-1===e}),(0,u.jsx)("g",{transform:"translate(".concat(-m,",0)"),children:(0,u.jsx)(R,{primaryName:o.name,secondaryName:o.secondaryName||void 0,stationState:e,flipped:180===h,express:o.services.includes(j.K9.express)})})]})},b=function(t){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(I,(0,s.Z)({strokeWidth:4},t)),(0,u.jsx)(L,(0,s.Z)({transform:"translate(0,".concat(180===t.tickRotation?-47:23,")")},t))]})},I=function(t){var n=t.intInfos,e=t.stnState,r=t.tickRotation,i=(0,a.Z)(t,H);return(0,u.jsx)("g",(0,s.Z)((0,s.Z)({},i),{},{children:n.map((function(t,a){return(0,u.jsx)("use",{xlinkHref:"#inttick",stroke:-1===e?"#aaa":t[2],transform:"translate(".concat(-2*(n.length-1)+4*a,",0)rotate(").concat(180===r?180:0,")")},a)}))}))},L=function(t){var n=t.intInfos,e=t.tickRotation,r=t.stnState,i=(0,a.Z)(t,M);return(0,u.jsx)("g",(0,s.Z)((0,s.Z)({},i),{},{children:n.map((function(t,n){return(0,u.jsx)("g",{transform:"translate(0,".concat(28*n*(180===e?-1:1),")"),children:(0,u.jsx)(w,{lineName:[t[4],t[5]],foregroundColour:t[3],backgroundColour:t[2],passed:-1===r})},n)}))}))},O=e(23824),W=function(t,n){return 2===t[n].parents.length||2===t[n].children.length?.25:0},P=function(){var t,n=(0,y.Qy)((function(t){return t.helper})),e=n.branches,r=n.routes,a=n.depsStr,c=(0,y.Qy)((function(t){return t.param})),l=c.svgWidth,h=c.svg_height,d=c.y_pc,m=c.padding,f=c.branchSpacingPct,x=c.direction,g=c.line_name,p=c.current_stn_idx,v=c.stn_list,_=(0,O.Az)(v,W,W),S=(0,o.useMemo)((function(){return console.log("computing x shares"),Object.keys(v).reduce((function(t,n){return(0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},n,function(t,n,e){var r=(0,O.QE)("linestart","lineend",n);if(r.nodes.includes(t))return(0,O.QE)(r.nodes[1],t,n).len;for(var a=e.filter((function(n){return n.includes(t)}))[0],s=t;!r.nodes.includes(s);)s=a[a.indexOf(s)-1];for(var i=t;!r.nodes.includes(i);)i=a[a.indexOf(i)+1];var c="linestart"===s,o="lineend"===i;if(a.toString()===e[0].toString()){var l=[];return c||o?c?(l[0]=0,l[1]=(0,O.QE)(r.nodes[1],i,n).len,l[2]=(0,O.QE)(a[1],t,n).len,l[3]=(0,O.QE)(t,i,n).len):(l[0]=(0,O.QE)(r.nodes[1],s,n).len,l[1]=(0,O.QE)(s,r.nodes.slice(-2)[0],n).len,l[2]=(0,O.QE)(s,t,n).len,l[3]=(0,O.QE)(t,a.slice(-2)[0],n).len):(l[0]=(0,O.QE)(r.nodes[1],s,n).len,l[1]=(0,O.QE)(s,i,n).len,l[2]=(0,O.QE)(s,t,n).len,l[3]=(0,O.QE)(t,i,n).len),l[0]+l[2]*l[1]/(l[2]+l[3])}if(c||o)return c?(0,O.QE)(r.nodes[1],i,n).len-(0,O.QE)(t,i,n).len:(0,O.QE)(r.nodes[1],s,n).len+(0,O.QE)(s,t,n).len;var u=[];return u[0]=(0,O.QE)(r.nodes[1],s,n).len,u[1]=(0,O.QE)(s,i,n).len,u[2]=(0,O.QE)(s,t,n).len,u[3]=(0,O.QE)(t,i,n).len,u[0]+u[2]*u[1]/(u[2]+u[3])}(n,_,e)))}),{})}),[e.toString(),JSON.stringify(_)]),Z=(0,O.QE)("linestart","lineend",_),z=(0,O.QE)(Z.nodes[1],Z.nodes.slice(-2)[0],_),N=x===j.wA.right?[l[j.Ht.RailMap]*m/100+65,l[j.Ht.RailMap]*(1-m/100)-20]:[l[j.Ht.RailMap]*m/100,l[j.Ht.RailMap]*(1-m/100)-65],A=Object.keys(S).reduce((function(t,n){return(0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},n,N[0]+S[n]/z.len*(N[1]-N[0])))}),{}),k=(0,o.useMemo)((function(){return console.log("computing y shares"),Object.keys(v).reduce((function(t,n){if(e[0].includes(n))return(0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},n,0));var r=e.slice(1).filter((function(t){return t.includes(n)}))[0];return(0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},n,v[r[0]].children.indexOf(r[1])?-2:2))}),{})}),[a]),Q=Object.keys(k).reduce((function(t,n){return(0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},n,-k[n]*f*h/200))}),{}),E=(0,o.useMemo)((function(){return(0,O.h6)(p,r,x)}),[p,x,r.toString()]),R=e.map((function(t){return(0,O.pS)(t,E)})).reduce((function(t,n){return t.main.push(n.main),t.pass.push(n.pass),t}),{main:[],pass:[]}),H=Object.keys(R).reduce((function(t,n){return(0,s.Z)((0,s.Z)({},t),{},(0,i.Z)({},n,R[n].map((function(t){return T(t,A,Q)}))))}),{});return(0,u.jsxs)("g",{id:"main",style:(t={},(0,i.Z)(t,"--y-percentage",d),(0,i.Z)(t,"transform","translateY(calc(var(--y-percentage) * var(--rmg-svg-height) / 100))"),t),children:[(0,u.jsx)(F,{paths:H}),(0,u.jsx)(C,{xs:A,ys:Q,stnStates:E}),(0,u.jsx)("g",{id:"line_name",style:(0,i.Z)({},"--translate-x",x===j.wA.right?"".concat(N[0]-65,"px"):"".concat(N[1]+65,"px")),children:(0,u.jsx)(w,{lineName:g,foregroundColour:"var(--rmg-theme-fg)",backgroundColour:"var(--rmg-theme-colour)"})})]})},F=o.memo((function(t){return(0,u.jsxs)("g",{fill:"none",strokeWidth:4,children:[(0,u.jsx)("g",{stroke:"#aaa",strokeDasharray:4,children:t.paths.pass.map((function(t,n){return(0,u.jsx)("path",{d:t},n)}))}),(0,u.jsx)("g",{stroke:"var(--rmg-theme-colour)",children:t.paths.main.map((function(t,n){return(0,u.jsx)("path",{d:t},n)}))})]})}),(function(t,n){return JSON.stringify(t.paths)===JSON.stringify(n.paths)})),T=function(t,n,e){var r,a=[];return t.forEach((function(t){var s=n[t],i=e[t];if(!r&&0!==r)return r=i,void a.push("M ".concat(s,",").concat(i));0===i?(i<r&&a.push("H ".concat(s-40),"a 40,40 0 0,0 40,-40","V ".concat(i)),i>r&&a.push("H ".concat(s-40),"a 40,40 0 0,1 40,40","V ".concat(i))):(i<r&&a.push("V ".concat(i+40),"a 40,40 0 0,1 40,-40","H ".concat(s)),i>r&&a.push("V ".concat(i-40),"a 40,40 0 0,0 40,40","H ".concat(s))),a.push("H ".concat(s)),r=i})),a.join(" ").replace(/( H ([\d.]+))+/g," H $2")},C=function(t){var n=t.xs,e=t.ys,r=t.stnStates,a=(0,y.Qy)((function(t){return t.param.stn_list}));return(0,u.jsx)("g",{id:"stn_icons",children:Object.keys(a).filter((function(t){return!["linestart","lineend"].includes(t)})).map((function(t){return(0,u.jsx)("g",{style:{transform:"translate(".concat(n[t],"px,").concat(e[t],"px)")},children:(0,u.jsx)(B,{stnId:t,stnState:r[t],stnY:e[t]})},t)}))})},D=e(90059),U=["destIds"],V=["destIds"],Y=j.Ht.RailMap,G=function(){var t=(0,y.Qy)((function(t){return t.app})).canvasScale,n=(0,y.Qy)((function(t){return t.param})),e=n.svgWidth,r=n.svg_height,a=n.direction,s=n.psd_num,i=n.info_panel_type,c=n.notesGZMTR,o=n.current_stn_idx,l=n.stn_list,h=n.theme,d=e[Y],f=l[o];return(0,u.jsxs)(D.Z,{type:Y,svgWidth:d,svgHeight:r,canvasScale:t,theme:h,children:[(0,u.jsx)(K,{}),(0,u.jsx)(m,{variant:i,isShowLight:i===j.p.gz2otis,isShowPSD:i===j.p.gz2otis&&s}),a===j.wA.left&&f.parents.includes("linestart")||a===j.wA.right&&f.children.includes("lineend")?(0,u.jsx)(X,{}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(P,{}),(0,u.jsx)(J,{}),c.map((function(t,n){return(0,u.jsx)(tt,{note:t},n)}))]}),i===j.p.gz2otis&&(0,u.jsx)("line",{x2:d,transform:"translate(0,90)",strokeWidth:3,stroke:"black"})]})},K=(0,o.memo)((function(){return(0,u.jsxs)("defs",{children:[(0,u.jsx)("path",{id:"arrow_direction",d:"M 60,60 L 0,0 L 60,-60 H 100 L 55,-15 H 160 V 15 H 55 L 100,60z",fill:"black"}),(0,u.jsx)("path",{id:"inttick",d:"M 0,0 v 18",strokeLinecap:"square"})]})})),J=function(){var t,n=(0,y.Qy)((function(t){return t.helper})).routes,e=(0,y.Qy)((function(t){return t.param})),r=e.direction,a=e.direction_gz_x,l=e.direction_gz_y,h=e.current_stn_idx,d=(0,o.useMemo)((function(){return(0,c.Z)(new Set(n.reduce((function(t,n){return n.includes(h)?t.concat(n.filter((function(t){return!["linestart","lineend"].includes(t)})).slice(r===j.wA.left?0:-1)[0]):t}),[]).filter((function(t){return t!==h}))))}),[h,r,n.toString()]),m={textAnchor:r===j.wA.left?"start":"end",transform:"translate(".concat(r===j.wA.left?65:-65,",-5)"),destIds:d};return(0,u.jsxs)("g",{id:"direction_gz",style:(t={},(0,i.Z)(t,"--x-percentage",a),(0,i.Z)(t,"--y-percentage",l),t),children:[(0,u.jsx)("use",{xlinkHref:"#arrow_direction",style:(0,i.Z)({},"--rotate",r===j.wA.left?"0deg":"180deg")}),2!==d.length?(0,u.jsx)($,(0,s.Z)({},m)):(0,u.jsx)(q,(0,s.Z)({},m))]})},$=function(t){var n=t.destIds,e=(0,a.Z)(t,U),r=(0,y.Qy)((function(t){return t.param.stn_list}));return(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({},e),{},{children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:28,children:n.map((function(t){return r[t].name[0]})).join("/")+"\u65b9\u5411"}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:14,dy:22,children:"Towards "+n.map((function(t){return r[t].name[1].replace("\\"," ")})).join("/")})]}))},q=function(t){var n=t.destIds,e=(0,a.Z)(t,V),r=(0,y.Qy)((function(t){return t.param.direction})),i=(0,y.Qy)((function(t){return t.param.stn_list})),l=n.map((function(t){return i[t].name[0].length})),h=Math.min.apply(Math,(0,c.Z)(l)),d=h>1&&l[0]!==l[1]?Math.abs(l[0]-l[1])/(h-1):0;return(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({},e),{},{children:[n.map((function(t,n){return(0,u.jsxs)(o.Fragment,{children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:25,x:r===j.wA.left?0:-75,y:42*n-21,letterSpacing:l[n]>l[1-n]?"0em":"".concat(d,"em"),children:i[t].name[0]}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:11.5,x:r===j.wA.left?0:-75,y:42*n-1,children:"Towards "+i[t].name[1].replace("\\"," ")})]},t)})),(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:28,x:r===j.wA.left?25*(Math.max.apply(Math,(0,c.Z)(l))+1):0,y:5,children:"\u65b9\u5411"})]}))},X=o.memo((function(){return(0,u.jsxs)("g",{id:"terminus_gz",textAnchor:"middle",children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:90,children:"\u7ec8 \u70b9 \u7ad9"}),(0,u.jsx)("text",{dy:70,className:"rmg-name__en",fontSize:36,children:"Terminal"}),(0,u.jsxs)("g",{strokeWidth:8,stroke:"#000",children:[(0,u.jsx)("path",{d:"M -160,68 h -160"}),(0,u.jsx)("path",{d:"M 160,68 h 160"})]})]})})),tt=o.memo((function(t){var n,e=o.useRef(null),a=o.useState({width:0,height:0,y:0}),s=(0,r.Z)(a,2),c=s[0],l=s[1];return o.useEffect((function(){return l(e.current.getBBox())}),[t.note[0],t.note[1]]),(0,u.jsxs)("g",{className:"note-box",style:(n={},(0,i.Z)(n,"--x-percentage",t.note[2]),(0,i.Z)(n,"--y-percentage",t.note[3]),n),children:[t.note[4]&&(0,u.jsx)("rect",{height:c.height+4,width:c.width+4,x:-2,y:c.y-2,fill:"none",stroke:"black",strokeWidth:.5}),(0,u.jsxs)("g",{ref:e,children:[(0,u.jsx)("g",{fontSize:16,letterSpacing:1.2,children:t.note[0].split("\n").map((function(t,n){return(0,u.jsx)("text",{className:"rmg-name__zh",y:18*n,children:t},n)}))}),(0,u.jsx)("g",{fontSize:10,letterSpacing:.33,transform:"translate(0,".concat(18*t.note[0].split("\n").length,")"),children:t.note[1].split("\n").map((function(n,e){var r;return(0,u.jsx)("text",{className:"rmg-name__en",y:11*e,textLength:e<((null===(r=t.note[1].match(/\n/g))||void 0===r?void 0:r.length)||0)?c.width:navigator.userAgent.includes("Firefox")?-1:0,lengthAdjust:"spacing",children:n},e)}))})]})]})}),(function(t,n){return t.note.toString()===n.note.toString()})),nt=(0,o.memo)((function(t){var n=t.stnName,e=t.onUpdate,r=(0,o.useRef)(null);return(0,o.useEffect)((function(){null===e||void 0===e||e(r.current.getBBox())}),[n.toString()]),(0,u.jsxs)("g",{ref:r,children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:90,children:n[0]}),(0,u.jsx)("g",{fontSize:36,children:n[1].split("\\").map((function(t,n){return(0,u.jsx)("text",{className:"rmg-name__en",dy:70+36*n,children:t},n)}))})]})}),(function(t,n){return t.stnName.toString()===n.stnName.toString()})),et=function(t){var n=t.secondaryName,e=t.transform,a=(0,o.useRef)(null),s=(0,o.useState)({x:0,width:0}),i=(0,r.Z)(s,2),c=i[0],l=i[1];return(0,o.useEffect)((function(){return l(a.current.getBBox())}),[n.toString()]),(0,u.jsxs)("g",{transform:e,children:[(0,u.jsxs)("g",{transform:"translate(0,4.5)",fontSize:36,children:[(0,u.jsx)("text",{textAnchor:"end",x:c.x-3,className:"rmg-name__zh",children:"("}),(0,u.jsx)("text",{textAnchor:"start",x:c.width+c.x+3,className:"rmg-name__zh",children:")"})]}),(0,u.jsxs)("g",{ref:a,textAnchor:"middle",children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:26,children:n[0]}),(0,u.jsx)("text",{dy:22,className:"rmg-name__en",fontSize:14,children:n[1]})]})]})},rt=["secName"],at=function(){var t,n=(0,y.Qy)((function(t){return t.param.svg_height})),e=(0,y.Qy)((function(t){return t.param.svgWidth})),a=(0,y.Qy)((function(t){return t.param.direction})),s=(0,y.Qy)((function(t){return t.param.info_panel_type})),c=(0,y.Qy)((function(t){return t.param.line_num})),l=(0,y.Qy)((function(t){return t.param.current_stn_idx})),h=(0,y.Qy)((function(t){return t.param.stn_list[l]})),d=(0,o.useState)({width:0}),m=(0,r.Z)(d,2),f=m[0],x=m[1],g=h[a===j.wA.left?"parents":"children"],v={name:"translate(".concat((a===j.wA.left?1:-1)*e[j.Ht.RunIn]/4,",45)"),next:"translate(".concat((a===j.wA.left?1:-1)*e[j.Ht.RunIn]/10,",45)")},_={nameGroup:{x:e.runin/2,y:.5*n-50-18*(h.name[1].split("\\").length-1)-(h.secondaryName?29:0)},secondaryName:{x:0,y:70+36*h.name[1].split("\\").length}};return(0,u.jsxs)("g",{children:[(0,u.jsxs)("g",{transform:s===j.p.gz2otis?v.name:"",children:[(0,u.jsxs)("g",{textAnchor:"middle",transform:"translate(".concat(_.nameGroup.x,",").concat(_.nameGroup.y,")"),children:[(0,u.jsx)(nt,{stnName:h.name,onUpdate:x}),h.secondaryName&&(0,u.jsx)(et,{secondaryName:h.secondaryName,transform:"translate(".concat(_.secondaryName.x,",").concat(_.secondaryName.y,")")})]}),(0,u.jsx)(p,{lineNum:c,stnNum:h.num,style:(t={},(0,i.Z)(t,"--translate-x","".concat((e[j.Ht.RunIn]+f.width)/2+55,"px")),(0,i.Z)(t,"--translate-y","".concat(.5*n-30-18*(h.name[1].split("\\").length-1)-(h.secondaryName?29:0),"px")),(0,i.Z)(t,"transform","translate(var(--translate-x, 800px), var(--translate-y, 145px))"),t),large:!0})]}),(0,u.jsx)("g",{transform:s===j.p.gz2otis?v.next:"",children:!g||g.includes("linestart")||g.includes("lineend")?(0,u.jsx)(u.Fragment,{}):1===g.length?(0,u.jsx)(st,{nextId:g[0],nameBBox:f}):(0,u.jsx)(ct,{nextIds:g,nameBBox:f})})]})},st=function(t){var n,e=t.nextId,a=t.nameBBox,s=(0,y.Qy)((function(t){return t.param.svgWidth})),c=(0,y.Qy)((function(t){return t.param.direction})),l=(0,y.Qy)((function(t){return t.param.stn_list[e]})),h=l.name,d=l.secondaryName,m=(0,o.useState)({width:0}),f=(0,r.Z)(m,2),x=f[0],g=f[1],p=o.useRef(null);(0,o.useEffect)((function(){return g(p.current.getBBox())}),[h.toString()]);var v=h[0].length,_=(s[j.Ht.RunIn]-a.width)/2;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("g",{id:"big_next",children:[(0,u.jsxs)("g",{textAnchor:"middle",style:(0,i.Z)({},"--translate-x",c===j.wA.left?"80px":"".concat(v<=2?s[j.Ht.RunIn]-45-x.width-70:s[j.Ht.RunIn]-45-x.width-52.5,"px")),children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:35,children:"\u4e0b\u7ad9"}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:17,dy:30,children:"Next"})]}),(0,u.jsxs)("g",{textAnchor:"start",ref:p,style:(0,i.Z)({},"--translate-x",c===j.wA.left?"".concat(v<=2?150:132.5,"px"):"".concat(s[j.Ht.RunIn]-45-x.width,"px")),children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:35,children:h[0]}),(0,u.jsx)("g",{fontSize:17,children:h[1].split("\\").map((function(t,n){return(0,u.jsx)("text",{className:"rmg-name__en",dy:30+17*n,children:t},n)}))})]}),d&&(0,u.jsx)("g",{textAnchor:"middle",style:(0,i.Z)({},"--translate-x",c===j.wA.left?"".concat(v<=2?150:132.5,"px"):"".concat(s[j.Ht.RunIn]-45-x.width,"px")),children:(0,u.jsx)(it,{secName:d,transform:"translate(".concat(x.width/2,",").concat(30+17*h[1].split("\\").length+5,")")})})]}),(0,u.jsx)("path",{id:"arrow",d:"M 60,60 L 0,0 L 60,-60 H 100 L 55,-15 H 160 V 15 H 55 L 100,60z",fill:"black",style:(n={},(0,i.Z)(n,"--translate-x",c===j.wA.left?"".concat((115+35*((v<=2?1:.5)+v)+_)/2-20,"px"):"".concat((s[j.Ht.RunIn]-45-x.width-(v<=2?105:87.5)+_+t.nameBBox.width+55+25.9)/2+20,"px")),(0,i.Z)(n,"--rotate",c===j.wA.left?"0deg":"180deg"),n)})]})},it=function(t){var n=t.secName,e=(0,a.Z)(t,rt),i=(0,o.useRef)(null),c=(0,o.useState)({x:0,width:0}),l=(0,r.Z)(c,2),h=l[0],d=l[1];return(0,o.useEffect)((function(){return d(i.current.getBBox())}),[t.secName.toString()]),(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({},e),{},{children:[(0,u.jsxs)("g",{transform:"translate(0,2.5)",fontSize:25,children:[(0,u.jsx)("text",{textAnchor:"end",x:h.x-3,className:"rmg-name__zh",children:"("}),(0,u.jsx)("text",{textAnchor:"start",x:h.width+h.x+3,className:"rmg-name__zh",children:")"})]}),(0,u.jsxs)("g",{ref:i,children:[(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:18,children:n[0]}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:10,dy:15,children:n[1]})]})]}))},ct=function(t){var n,e=t.nextIds,a=t.nameBBox,l=(0,y.Qy)((function(t){return t.helper})).routes,h=(0,y.Qy)((function(t){return t.param.svgWidth})),d=(0,y.Qy)((function(t){return t.param.direction})),m=(0,y.Qy)((function(t){return t.param.stn_list})),f=e.map((function(t){return m[t].name})),x=(0,o.useState)({width:0}),g=(0,r.Z)(x,2),p=g[0],v=g[1],_=(0,o.useRef)([]);(0,o.useEffect)((function(){v((function(t){return(0,s.Z)((0,s.Z)({},t),{},{width:0})})),_.current.forEach((function(t){var n=null===t||void 0===t?void 0:t.getBBox();v((function(t){return n?t.width>n.width?t:n:t}))}))}),[f.toString()]);var S=t.nextIds.map((function(t){return l.reduce((function(n,e){return e.includes(t)?n.concat(e.filter((function(t){return!["linestart","lineend"].includes(t)})).slice(d===j.wA.left?0:-1)[0]):n}),[])})),w=Math.max.apply(Math,(0,c.Z)(f.map((function(t){return t[0].length})))),Z=(h[j.Ht.RunIn]-a.width)/2;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("g",{id:"big_next_2",children:f.map((function(t,n){return(0,u.jsxs)(o.Fragment,{children:[(0,u.jsxs)("g",{textAnchor:"middle",style:(0,i.Z)({},"--translate-x",d===j.wA.left?"72px":"".concat(h[j.Ht.RunIn]-45-p.width-41,"px")),children:[(0,u.jsx)("text",{className:"rmg-name__zh",children:"\u4e0b\u7ad9"}),(0,u.jsx)("text",{className:"rmg-name__en",y:22,children:"Next"})]}),(0,u.jsxs)("g",{ref:function(t){return _.current[n]=t},textAnchor:"start",style:(0,i.Z)({},"--translate-x",d===j.wA.left?"113px":"".concat(h[j.Ht.RunIn]-45-p.width,"px")),children:[(0,u.jsx)("text",{className:"rmg-name__zh",children:t[0]}),t[1].split("\\").map((function(t,n){return(0,u.jsx)("text",{className:"rmg-name__en",y:22+13*n,children:t},n)})),(0,u.jsx)("text",{className:"rmg-name__zh",y:-35,children:S[n].map((function(t){return m[t].name[0]})).join("/")+"\u65b9\u5411"}),(0,u.jsx)("text",{className:"rmg-name__en rmg-name__gzmtr--next2-dest",y:-20,children:"Towards "+S[n].map((function(t){return m[t].name[1]})).join("/").replace("\\"," ")})]})]},n)}))}),(0,u.jsx)("path",{id:"arrow",d:"M 60,60 L 0,0 L 60,-60 H 100 L 55,-15 H 160 V 15 H 55 L 100,60z",fill:"black",style:(n={},(0,i.Z)(n,"--translate-x",d===j.wA.left?"".concat((99+27*(1+w)+Z)/2-20,"px"):"".concat((h[j.Ht.RunIn]-45-p.width-41-27+Z+t.nameBBox.width+55+25.9)/2+20,"px")),(0,i.Z)(n,"--rotate",d===j.wA.left?"0deg":"180deg"),n)})]})},ot=["num"];function lt(t){var n=t.num,e=(0,a.Z)(t,ot);return(0,u.jsxs)("g",(0,s.Z)((0,s.Z)({textAnchor:"middle",fill:"var(--rmg-theme-fg)"},e),{},{children:[(0,u.jsx)("circle",{cx:0,cy:0,r:30,fill:"var(--rmg-theme-colour)"}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:38,dy:-9.5,children:n}),(0,u.jsx)("text",{className:"rmg-name__zh",fontSize:13,dy:10,children:"\u7ad9\u53f0"}),(0,u.jsx)("text",{className:"rmg-name__en",fontSize:9,dy:21,children:"Platform"})]}))}function ut(t){var n=t.canvasType,e=(0,y.Qy)((function(t){return t.param})),r=e.svgWidth,a=e.svg_height;return(0,u.jsxs)("g",{id:"otis_frame",strokeWidth:3,stroke:"black",children:[(0,u.jsx)("line",{y2:a,transform:"translate(".concat(r[n]/2,",0)")}),(0,u.jsx)("line",{x2:r[n],transform:"translate(0,90)"})]})}var ht=j.Ht.RunIn;function dt(){var t,n=(0,y.Qy)((function(t){return t.app})).canvasScale,e=(0,y.Qy)((function(t){return t.param})),r=e.svgWidth,a=e.svg_height,s=e.direction,c=e.info_panel_type,o=e.platform_num,l=e.psd_num,h=e.theme,d=r[ht],f={platform:"translate(".concat(s===j.wA.left?50:-50,",45)")};return(0,u.jsxs)(D.Z,{type:ht,svgWidth:d,svgHeight:a,canvasScale:n,theme:h,children:[(0,u.jsx)(m,{variant:c,isShowLight:c!==j.p.gz2otis,isShowPSD:c!==j.p.gz2otis&&l}),(0,u.jsx)("g",{transform:c===j.p.gz2otis?f.platform:"",children:(0,u.jsx)(lt,{num:o,style:(t={},(0,i.Z)(t,"--translate-x","".concat(s===j.wA.left?d-100:100,"px")),(0,i.Z)(t,"--translate-y","calc(var(--rmg-svg-height) / 2 - 30px)"),(0,i.Z)(t,"transform","translate(var(--translate-x, 100px), var(--translate-y))"),t)})}),(0,u.jsx)(at,{}),c===j.p.gz2otis&&(0,u.jsx)(ut,{canvasType:ht})]})}var mt={runin:(0,u.jsx)(dt,{}),railmap:(0,u.jsx)(G,{})}},23824:function(t,n,e){e.d(n,{Az:function(){return h},QE:function(){return d},ML:function(){return m},h6:function(){return f},LD:function(){return x},pS:function(){return g}});var r=e(29439),a=e(15671),s=e(43144),i=e(93433),c=e(37762),o=e(4942),l=e(1413),u=e(20713),h=function(t,n,e){return Object.keys(t).reduce((function(r,a){return(0,l.Z)((0,l.Z)({},r),{},(0,o.Z)({},a,t[a].children.reduce((function(r,s){return(0,l.Z)((0,l.Z)({},r),{},(0,o.Z)({},s,1+n(t,s)+e(t,a)))}),{})))}),{})},d=function t(n,e,r){if(n===e)return{len:0,nodes:[n]};var a=[],s=[];Object.keys(r[n]).forEach((function(i){var c=t(i,e,r);c.len<0||(a.push(r[n][i]+c.len),c.nodes.unshift(n),s.push(c.nodes))}));var i=Math.max.apply(Math,a);return{len:i,nodes:s[a.indexOf(i)]}},m=function(t,n,e){var r=d("linestart","lineend",n);if(r.nodes.includes(t))return d(r.nodes[1],t,n).len;for(var a=e.filter((function(n){return n.includes(t)}))[0],s=t;!r.nodes.includes(s);)s=a[a.indexOf(s)-1];for(var i=t;!r.nodes.includes(i);)i=a[a.indexOf(i)+1];var c="linestart"===s,o=[];return c||"lineend"===i?c?(o[0]=0,o[1]=d(r.nodes[1],i,n).len,o[2]=d(a[1],t,n).len,o[3]=d(t,i,n).len):(o[0]=d(r.nodes[1],s,n).len,o[1]=d(s,r.nodes.slice(-2)[0],n).len,o[2]=d(s,t,n).len,o[3]=d(t,a.slice(-2)[0],n).len):(o[0]=d(r.nodes[1],s,n).len,o[1]=d(s,i,n).len,o[2]=d(s,t,n).len,o[3]=d(t,i,n).len),o[0]+o[2]*o[1]/(o[2]+o[3])},f=function(t,n,e){var r;return console.log("computing stations' states"),(0,i.Z)(new Set((r=[]).concat.apply(r,(0,i.Z)(n)))).reduce((function(r,a){return(0,l.Z)((0,l.Z)({},r),{},(0,o.Z)({},a,a===t?0:(e===u.wA.right?function(t,n,e){var r,a=(0,c.Z)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,i=s.indexOf(t),o=s.indexOf(n);if(-1!==i&&i<o)return!0}}catch(l){a.e(l)}finally{a.f()}return!1}(t,a,n):function(t,n,e){var r,a=(0,c.Z)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,i=s.indexOf(t),o=s.indexOf(n);if(-1!==o&&o<i)return!0}}catch(l){a.e(l)}finally{a.f()}return!1}(t,a,n))?1:-1))}),{})},x=function(){function t(n){var e=this;(0,a.Z)(this,t),this.yShares={},this.xShares={},this.namePoss={},this.stnList={},this.criticalPath={},this.leftWideFactor=function(t){return 0},this.rightWideFactor=function(t){return 0},this.pathTurnParams=function(t){var n=35-17.5*Math.sqrt(3),e=t-2*n;return{tr:35,dx_a:17.5,dy_a:n,dx_l:e*Math.sqrt(3),dy_l:e}},this.pathTurnSE=function(t){var n=e.pathTurnParams(t),r=n.tr,a=n.dx_a,s=n.dy_a,i=n.dx_l,c=n.dy_l;return"a ".concat(r,",").concat(r," 0 0,1 ").concat(a,",").concat(s," l ").concat(i,",").concat(c," a ").concat(r,",").concat(r," 0 0,0 ").concat(a,",").concat(s)},this.pathTurnNE=function(t){var n=e.pathTurnParams(t),r=n.tr,a=n.dx_a,s=n.dy_a,i=n.dx_l,c=n.dy_l;return"a ".concat(r,",").concat(r," 0 0,0 ").concat(a,",").concat(-s," l ").concat(i,",").concat(-c," a ").concat(r,",").concat(r," 0 0,1 ").concat(a,",").concat(-s)},this.stnList=n.stnList,this.criticalPath=n.criticalPath}return(0,s.Z)(t,[{key:"getYShare",value:function(t,n){if(t in this.yShares)return this.yShares[t];if(["linestart","lineend"].includes(t)||this.stnList[t].parents.length>1||this.stnList[t].children.length>1)return this.yShares[t]=0,0;var e=this.stnList[t].parents[0];if(e){if(1===this.stnList[e].children.length){var r=this.getYShare(e);return this.yShares[t]=r,r}var a=0===this.stnList[e].children.indexOf(t)?1:-1;return this.yShares[t]=a,a}return this.yShares[t]=0,0}},{key:"_linePath",value:function(t,n,e,a,s,i,c,o){var l=this,u=(0,r.Z)([],3),h=u[0],d=u[1],m=u[2],f=[],x=this.pathTurnParams(i),g=x.dx_a+x.dx_l/2,p=(n[1]-n[0])/c.len*2,j=((n[1]-n[0])/c.len-2*g)/2;return j+p<0&&console.warn("SVG width too small! ".concat(j+p)),t.forEach((function(n){var r=a[n],c=s[n];if(!d&&0!==d)return h=n,m=r,d=c,void(1===t.length?f.push("M ".concat(r,",").concat(c)):e[0].includes(n)?e[0].includes(t[1])?f.push("M ".concat(r,",").concat(c)):(a[t[1]]>0&&f.push("M ".concat(r,",").concat(c+o)),s[t[1]]<0&&f.push("M ".concat(r,",").concat(c-o))):f.push("M ".concat(r,",").concat(c)));c>d?(f.push("h ".concat(0===c?r-m-p*l.leftWideFactor(n)-j-2*g:p*l.rightWideFactor(h)+j)),f.push(l.pathTurnSE(i))):c<d&&(f.push("h ".concat(0===c?r-m-p*l.leftWideFactor(n)-j-2*g:p*l.rightWideFactor(h)+j)),f.push(l.pathTurnNE(i))),f.push("H ".concat(r)),h=n,m=r,d=c})),f.join(" ").replace(/( H ([\d.]+))+/g," H $2")}}],[{key:"getYShares",value:function(t,n){console.log("computing y shares");var e=new this({stnList:t});return Object.keys(t).forEach((function(t){["linestart","lineend"].includes(t)||t in e.yShares||e.getYShare(t,n)})),e.yShares}}]),t}(),g=function(t,n){var e=(t=t.filter((function(t){return!["linestart","lineend"].includes(t)}))).filter((function(t){return n[t]>=0})),r=t.filter((function(t){return n[t]<=0}));return 1===e.length&&(r=t),0===e.filter((function(t){return-1!==r.indexOf(t)})).length&&e.length&&(r[0]===t[0]?r.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&r.length?(r=t,e=[]):r.unshift(e[e.length-1])),{main:e,pass:r}}}}]);
//# sourceMappingURL=226.94c39376.chunk.js.map