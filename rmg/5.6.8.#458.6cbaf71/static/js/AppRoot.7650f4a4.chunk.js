(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[2377],{74018:function(n,e,t){var r={"./1F1E6-1F1F9.svg":[89121,9121],"./1F1E6-1F1FF.svg":[89427,9427],"./1F1E7-1F1F7.svg":[97304,7304],"./1F1E8-1F1E6.svg":[80056,56],"./1F1E8-1F1F1.svg":[43450,3450],"./1F1E8-1F1F3.svg":[52537,2537],"./1F1E9-1F1EA.svg":[36311,6311],"./1F1E9-1F1F0.svg":[21890,1890],"./1F1EA-1F1EC.svg":[57365,7365],"./1F1EA-1F1F8.svg":[98721,8721],"./1F1EB-1F1F7.svg":[48514,8514],"./1F1EC-1F1F7.svg":[99515,9515],"./1F1ED-1F1F0.svg":[62248,2248],"./1F1ED-1F1FA.svg":[268,268],"./1F1EE-1F1E9.svg":[81370,1370],"./1F1EE-1F1F3.svg":[66236,6236],"./1F1EE-1F1F7.svg":[22617,2617],"./1F1EE-1F1F9.svg":[53541,3541],"./1F1EF-1F1F5.svg":[42741,2741],"./1F1F0-1F1F7.svg":[22255,2255],"./1F1F2-1F1F4.svg":[86435,6435],"./1F1F2-1F1FD.svg":[43086,3086],"./1F1F2-1F1FE.svg":[76082,6082],"./1F1F3-1F1F4.svg":[16095,6095],"./1F1F5-1F1EA.svg":[52955,2955],"./1F1F5-1F1F1.svg":[54700,4700],"./1F1F5-1F1F9.svg":[77791,7791],"./1F1F7-1F1F4.svg":[7224,7224],"./1F1F7-1F1FA.svg":[6031,6031],"./1F1F8-1F1E6.svg":[68600,8600],"./1F1F8-1F1EA.svg":[71550,1550],"./1F1F8-1F1EC.svg":[91229,1229],"./1F1F9-1F1ED.svg":[16203,6203],"./1F1F9-1F1F7.svg":[92237,2237],"./1F1F9-1F1FC.svg":[64252,4252],"./1F1FA-1F1F3.svg":[23353,3353],"./1F1FA-1F1F8.svg":[65439,5439],"./1F1FB-1F1F3.svg":[90419,3886],"./1F3F4-E0067-E0062-E0065-E006E-E0067-E007F.svg":[16129,6129],"./1F3F4-E0067-E0062-E0073-E0063-E0074-E007F.svg":[60138,138]};function i(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],i=e[0];return t.e(e[1]).then((function(){return t.t(i,17)}))}i.keys=function(){return Object.keys(r)},i.id=74018,n.exports=i},37827:function(n,e,t){var r={"./athens.js":[46128,6869],"./baku.js":[92481,6810],"./bangkok.js":[36870,5792],"./barcelona.js":[36340,2358],"./beijing.js":[32145,436],"./berlin.js":[37976,5520],"./bonn.js":[67933,1321],"./boston.js":[68835,5189],"./bucharest.js":[35249,6739],"./budapest.js":[68895,7599],"./cairo.js":[36509,7081],"./changchun.js":[97459,4874],"./changsha.js":[40574,9186],"./chengdu.js":[16312,8719],"./chongqing.js":[40300,7206],"./cologne.js":[6727,134],"./copenhagen.js":[47070,9770],"./daegu.js":[96995,8189],"./dalian.js":[65169,9898],"./delhi.js":[53707,4447],"./dongguan.js":[63280,1847],"./dortmund.js":[86079,6951],"./edinburgh.js":[70285,1392],"./eskisehir.js":[51686,5449],"./foshan.js":[73204,17],"./frankfurt.js":[12040,8237],"./glasgow.js":[34476,886],"./gothenburg.js":[66801,4788],"./guadalajara.js":[39399,3106],"./guangzhou.js":[65841,4073],"./hangzhou.js":[33427,5303],"./hanoi.js":[30507,310],"./harbin.js":[4826,5081],"./hefei.js":[82317,1951],"./hiroshima.js":[80916,8183],"./hochiminh.js":[46770,8140],"./hongkong.js":[54243,3417],"./istanbul.js":[73107,3875],"./jakarta.js":[58457,425],"./jinan.js":[5719,7826],"./kansai.js":[70382,2028],"./kaohsiung.js":[33037,9890],"./klangvalley.js":[20137,5944],"./kunming.js":[28852,4737],"./lima.js":[39118,3579],"./lisbon.js":[88814,8975],"./london.js":[38087,1614],"./macao.js":[18015,5066],"./madrid.js":[68020,2168],"./milan.js":[94410,743],"./montreal.js":[53678,8291],"./munich.js":[87368,8413],"./nanjing.js":[1664,6195],"./naples.js":[73738,441],"./newtaipei.js":[99114,6546],"./ningbo.js":[28820,5288],"./osaka.js":[11064,3658],"./oslo.js":[8057,2194],"./other.js":[77642,1342],"./ottawa.js":[40254,7153],"./paris.js":[22720,5885],"./qingdao.js":[57994,6977],"./rheinruhr.js":[86870,7719],"./rio.js":[94618,9],"./riyadh.js":[81e3,9450],"./sanfrancisco.js":[64747,1608],"./sanktpeterburg.js":[21832,2871],"./santiago.js":[12568,2832],"./saopaulo.js":[56956,1902],"./seoul.js":[23266,530],"./shanghai.js":[89656,7101],"./shaoxing.js":[84891,4111],"./shenyang.js":[22266,5418],"./shenzhen.js":[44691,2338],"./singapore.js":[32459,4760],"./stockholm.js":[14606,8759],"./suzhou.js":[99819,1568],"./taichung.js":[65230,5562],"./taipei.js":[89489,5436],"./tehran.js":[52573,4688],"./tianjin.js":[47942,5028],"./tokyo.js":[23762,9989],"./toronto.js":[18148,1134],"./tyneandwear.js":[9314,9327],"./vienna.js":[55252,8951],"./warsaw.js":[9727,5776],"./wuhan.js":[93742,8914],"./wuxi.js":[4099,1425],"./xiamen.js":[54610,2187],"./xian.js":[72591,1624],"./yokohama.js":[695,672],"./zhengzhou.js":[27357,3961]};function i(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],i=e[0];return t.e(e[1]).then((function(){return t(i)}))}i.keys=function(){return Object.keys(r)},i.id=37827,n.exports=i},91427:function(n,e,t){var r={"./basic/coline.json":[32401,8014],"./basic/default.json":[8453,8241],"./basic/loop.json":[8909,9410],"./bjsubway/bj1.json":[48741,6729],"./bjsubway/bj10.json":[48461,6230],"./bjsubway/bj11.json":[3279,7646],"./bjsubway/bj13.json":[67443,1188],"./bjsubway/bj14.json":[92906,9523],"./bjsubway/bj16.json":[47062,6698],"./bjsubway/bj17.json":[58241,8760],"./bjsubway/bj19.json":[87819,2773],"./bjsubway/bj2.json":[75176,6552],"./bjsubway/bj4.json":[56450,7680],"./bjsubway/bj5.json":[81834,5653],"./bjsubway/bj6.json":[12022,9259],"./bjsubway/bj7.json":[26061,5482],"./bjsubway/bj8.json":[69846,9797],"./bjsubway/bj9.json":[39422,4269],"./bjsubway/dae.json":[34852,3981],"./bjsubway/s1l.json":[42830,2381],"./bjsubway/t1l.json":[41057,7200],"./bjsubway/xjl.json":[14,1095],"./bjsubway/yzl.json":[56315,2244],"./company-config.json":[76605],"./fmetro/fs2.json":[61139,7149],"./fmetro/tgm1.json":[81558,7160],"./fmetro/tnh1.json":[17249,6452],"./gzmtr/apm.json":[45098,6354],"./gzmtr/gf.json":[30571,2200],"./gzmtr/gz1.json":[28161,3082],"./gzmtr/gz13.json":[14745,9950],"./gzmtr/gz14.json":[9447,7877],"./gzmtr/gz18.json":[79361,6583],"./gzmtr/gz2.json":[87119,7724],"./gzmtr/gz21.json":[24695,4015],"./gzmtr/gz22.json":[92671,9826],"./gzmtr/gz3.json":[20622,3084],"./gzmtr/gz4.json":[25440,3109],"./gzmtr/gz5.json":[93880,2846],"./gzmtr/gz6.json":[27426,9925],"./gzmtr/gz7.json":[73290,8924],"./gzmtr/gz8.json":[69045,7332],"./gzmtr/gz9.json":[78481,2100],"./gzmtr/thp1.json":[65227,9416],"./gzmtr/thz1.json":[82887,199],"./hrbmetro/hrb1.json":[13002,4557],"./hrbmetro/hrb2.json":[6635,8512],"./hrbmetro/hrb3.json":[20555,2658],"./kmrailtransit/km1.json":[43285,9655],"./kmrailtransit/km2.json":[84760,4250],"./kmrailtransit/km3.json":[327,6555],"./kmrailtransit/km4.json":[41302,9675],"./kmrailtransit/km5.json":[21672,2663],"./kmrailtransit/km6.json":[35903,113],"./kvtransit/klMonorail.json":[57749,6080],"./kvtransit/lrtAmpang.json":[81534,8766],"./kvtransit/lrtKelanaJaya.json":[94219,8724],"./kvtransit/lrtSriPataling.json":[38174,6862],"./kvtransit/mrtKajang.json":[49512,4694],"./mlm/taipa.json":[4435,5945],"./mtr/ael.json":[16215,5074],"./mtr/drl.json":[86083,5958],"./mtr/eal.json":[19800,4754],"./mtr/isl.json":[7314,6533],"./mtr/ktl.json":[1400,2490],"./mtr/sile.json":[37438,169],"./mtr/tcl.json":[74512,5910],"./mtr/tkl.json":[91257,4991],"./mtr/tml.json":[45339,403],"./mtr/twl.json":[15030,564],"./nbrailtransit/nb1.json":[49444,1180],"./nbrailtransit/nb2.json":[80011,7792],"./nbrailtransit/nb3.json":[1295,1899],"./nbrailtransit/nb4.json":[57155,3497],"./nbrailtransit/nb5.json":[71198,6899],"./njmetro/nj1.json":[72868,4092],"./njmetro/nj10.json":[28421,1471],"./njmetro/nj2.json":[74583,4138],"./njmetro/nj3.json":[33347,6293],"./njmetro/nj4.json":[57811,4402],"./qdmetro/qd11.json":[80186,5680],"./qdmetro/qd13.json":[99736,5325],"./qdmetro/qd2.json":[35582,852],"./qdmetro/qd3.json":[23457,6288],"./qdmetro/qd8.json":[67703,758],"./saopaulometro/sp1.json":[2702,9619],"./saopaulometro/sp10.json":[81443,7855],"./saopaulometro/sp11.json":[48362,2750],"./saopaulometro/sp12.json":[57393,4387],"./saopaulometro/sp13.json":[12794,153],"./saopaulometro/sp15.json":[56267,4996],"./saopaulometro/sp2.json":[67182,911],"./saopaulometro/sp3.json":[91102,6569],"./saopaulometro/sp4.json":[42489,6890],"./saopaulometro/sp5.json":[62103,3692],"./saopaulometro/sp7.json":[99021,856],"./saopaulometro/sp8.json":[21280,2791],"./saopaulometro/sp9.json":[74337,5941],"./shmetro/sh1.json":[55562,4254],"./shmetro/sh10.json":[26438,4605],"./shmetro/sh11.json":[96485,74],"./shmetro/sh12.json":[67048,2632],"./shmetro/sh13.json":[49155,3456],"./shmetro/sh14.json":[42243,5294],"./shmetro/sh15.json":[86484,7211],"./shmetro/sh16.json":[71465,6745],"./shmetro/sh17.json":[7079,7769],"./shmetro/sh18.json":[94120,3263],"./shmetro/sh2.json":[4580,1475],"./shmetro/sh3&4.json":[57225,8781],"./shmetro/sh3.json":[17439,7321],"./shmetro/sh4.json":[21088,5993],"./shmetro/sh5.json":[47346,7910],"./shmetro/sh6.json":[48358,6632],"./shmetro/sh7.json":[13095,6153],"./shmetro/sh8.json":[64409,5925],"./shmetro/sh9.json":[57345,6568],"./szmetro/sz1.json":[47109,9477],"./szmetro/sz2.json":[96531,8476],"./szmetro/sz3.json":[51862,2023],"./szmetro/sz4.json":[47789,8330],"./szmetro/sz8.json":[95508,7522],"./template-configs.json":[72722],"./torontosubway/ttc1.json":[12966,5515],"./torontosubway/ttc2.json":[33298,5797],"./torontosubway/ttc3.json":[78973,1325],"./torontosubway/ttc4.json":[76730,388],"./zzmetro/zz1.json":[44557,7985],"./zzmetro/zz14.json":[52049,1074],"./zzmetro/zz2.json":[36226,8418],"./zzmetro/zz3.json":[45090,3437],"./zzmetro/zz4.json":[92332,1281],"./zzmetro/zz5.json":[53790,6010],"./zzmetro/zz6.json":[55444,3574],"./zzmetro/zz9.json":[81393,5458]};function i(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],i=e[0];return Promise.all(e.slice(1).map(t.e)).then((function(){return t.t(i,19)}))}i.keys=function(){return Object.keys(r)},i.id=91427,n.exports=i},24838:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return ie}});var r=t(72791),i=t(22020),o=t(74190),s=t(48762),a=t(37732),l=t(85105),c=t(20713),u=t(59434),d=t(50533),h=t(57689),f=t(29439);var m=t(36538),p=t(80184),j={position:"relative",flexDirection:"row",overflowX:"auto","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}};function g(){var n=(0,h.TH)(),e=(0,h.s0)(),i=(0,u.I0)(),l=(0,a.Qy)((function(n){return n.app})),g=l.canvasToShow,x=l.canvasScale,v=(0,a.Qy)((function(n){return n.param})),b=v.svg_height,y=v.style,S=function(n){var e=(0,r.useState)({}),i=(0,f.Z)(e,2),o=i[0],s=i[1];return(0,r.useEffect)((function(){return t(33489)("./".concat(n,"/index")).then((function(n){s(n.default)})).catch((function(e){console.error("Failed to load canvas for style ".concat(n),e),s({})})),function(){s({})}}),[n]),o}(y);(0,r.useEffect)((function(){var t=n.pathname;if(console.log("SvgRouter:: requestedPath=".concat(t)),t!=="/"+y){var r=t.split("/").slice(-1)[0];Object.values(c.RM).includes(r)?(console.log("SvgRouter:: updating param style to ".concat(r)),i((0,d.yL)(r))):(console.log("SvgRouter:: updating path to /".concat(y)),e(y))}}),[]),(0,r.useEffect)((function(){document.getElementById("css_share").href="/rmg"+"/styles/share_".concat(y,".css"),m.ZP.event(c.zW.STYLE_CHANGE,{style:y})}),[y]);var C=Object.keys(S).filter((function(n){return g.includes(n)}));return(0,p.jsx)(o.kC,{sx:j,children:0===Object.keys(S).length?(0,p.jsx)(s.xG,{isIndeterminate:!0}):C.map((function(n){return(0,p.jsx)(s.sS,{sx:{minWidth:750,height:b*x},children:S[n]},n+y)}))})}function x(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.app.selectedStation}));console.log("InfoSection:: Rendering for",t);var r=(0,a.Qy)((function(n){return n.param.style})),l=(0,a.Qy)((function(n){return n.param.stn_list[t]})),u=l.num,h=l.name,f=l.secondaryName,m=[{type:"input",label:n("StationSidePanel.info.num"),value:u,placeholder:"01",onChange:function(n){return e((0,d.Uf)(t,n))},hidden:![c.RM.GZMTR].includes(r)},{type:"input",label:n("Chinese name"),value:h[0],onChange:function(n){return e((0,d.PD)(t,[n,h[1]]))}},{type:"input",label:n("English name"),value:h[1],onChange:function(n){return e((0,d.PD)(t,[h[0],n]))}},{type:"input",label:n("StationSidePanel.info.zhSecondary"),value:f?f[0]:"",placeholder:"1\u53f7\u822a\u7ad9\u697c",onChange:function(n){return e((0,d.uJ)(t,[n,f?f[1]:""]))},hidden:![c.RM.GZMTR].includes(r)},{type:"input",label:n("StationSidePanel.info.enSecondary"),value:f?f[1]:"",placeholder:"Terminal 1",onChange:function(n){return e((0,d.uJ)(t,[f?f[0]:"",n]))},hidden:![c.RM.GZMTR].includes(r)}];return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:n("StationSidePanel.info.title")}),(0,p.jsx)(s.M5,{fields:m,minW:130})]})}var v=t(75777),b=t(93433),y=t(27322),S=t(4942),C=t(40410),w=t(2656),Z=t(28678),z=t(19894),M=t(41125),k=t(84828);function A(n){var e=n.countryCode,i=n.svgFilename,o=(0,r.useState)(void 0),s=(0,f.Z)(o,2),a=s[0],l=s[1];return(0,r.useEffect)((function(){i&&t(74018)("./"+i).then((function(n){return n.default})).then(l).catch((function(n){return console.error("Failed to find SVG file ".concat(i," as ").concat(null===n||void 0===n?void 0:n.message))}))}),[i]),a?(0,p.jsx)(k.Ee,{src:a,alt:"Flag of ".concat(e),h:17,mr:1}):(0,p.jsx)(p.Fragment,{})}var O=t(47770);function P(n){var e=n.defaultValueId,t=n.onChange,r=(0,i.$)().i18n,o=e?M.nB.find((function(n){return n.id===e})):void 0,a=function(n){return r.languages.map((function(e){return n.name[e]})).find((function(n){return void 0!==n}))},l=M.nB.slice().sort((function(n,e){return n.id===M.jk.Other?1:e.id===M.jk.Other?-1:a(n).localeCompare(a(e),r.languages[0])}));return(0,p.jsx)(s.xL,{data:l,displayValue:a,displayHandler:function(n){var e,t,i="TW"===n.country&&[O.s.ChineseSimp,O.s.ChineseCN].includes(r.languages[0]),o=["Win32","Win64"].includes(navigator.platform),s=r.languages.map((function(e){return n.name[e]})).find((function(n){return void 0!==n})),a=null===(e=M.Jm.find((function(e){return e.id===n.country})))||void 0===e?void 0:e.flagSvg,l=null===(t=M.Jm.find((function(e){return e.id===n.country})))||void 0===t?void 0:t.flagEmoji;return(0,p.jsxs)(p.Fragment,{children:[i?(0,p.jsx)("span",{children:"\ud83c\udff4\xa0"}):o?(0,p.jsx)(A,{countryCode:n.country,svgFilename:a}):(0,p.jsxs)("span",{children:[l,"\xa0"]}),s]})},predicate:function(n,e){return Object.values(n.name).some((function(n){return n.includes(e)}))},defaultValue:o,onChange:function(n){return null===t||void 0===t?void 0:t(n.id)}})}function F(n){var e=n.city,o=n.defaultValueId,a=n.onChange,l=(0,i.$)().i18n,u=function(n){var e=(0,r.useState)([]),i=(0,f.Z)(e,2),o=i[0],s=i[1];return(0,r.useEffect)((function(){t(37827)("./".concat(n,".js")).then((function(n){return s(n.default)})).catch((function(){return s([])}))}),[n]),o}(e),d=o?u.find((function(n){return n.id===o})):void 0,h=function(n){return l.languages.map((function(e){return n.name[e]})).find((function(n){return void 0!==n}))};return(0,p.jsx)(s.xL,{data:u,displayValue:h,displayHandler:function(n){var e=h(n);return(0,p.jsx)(s.l2,{name:e,fg:n.fg||c.AJ.white,bg:n.colour})},predicate:function(n,e){return Object.values(n.name).some((function(n){return n.includes(e)}))},defaultValue:d,onChange:function(n){return null===a||void 0===a?void 0:a(n.id,n.colour,n.fg||c.AJ.white)}})}function E(n){var e,t=n.isOpen,a=n.onClose,l=n.defaultTheme,u=n.onUpdate,d=(0,i.$)().t,h=(0,C.ff)("primary.500","primary.300"),j=(0,r.useState)(null===l||void 0===l?void 0:l[0]),g=(0,f.Z)(j,2),x=g[0],b=g[1],k=(0,r.useState)(null===l||void 0===l?void 0:l[1]),A=(0,f.Z)(k,2),O=A[0],E=A[1],R=(0,r.useState)((null===l||void 0===l?void 0:l[2])||"#AAAAAA"),_=(0,f.Z)(R,2),N=_[0],T=_[1],B=(0,r.useState)((null===l||void 0===l?void 0:l[3])||c.AJ.white),U=(0,f.Z)(B,2),D=U[0],I=U[1];(0,r.useEffect)((function(){l&&(b(l[0]),E(l[1]),T(l[2]),I(l[3]))}),[t,null===l||void 0===l?void 0:l.toString()]);var W=[{type:"custom",label:d("ColourModal.city"),component:(0,p.jsx)(P,{defaultValueId:x,onChange:function(n){b(n),E(void 0),T("#AAAAAA"),I(c.AJ.white)}})},{type:"custom",label:d("ColourModal.line"),component:(0,p.jsx)(F,{city:x,defaultValueId:O,onChange:function(n,e,t){E(n),T(e),I(t)}})}],L=[{type:"input",label:d("ColourModal.bg"),variant:"color",value:N,placeholder:"#F3D03E",onChange:function(n){b(M.jk.Other),E("other"),T(n)}},{type:"select",label:d("ColourModal.fg"),value:D,options:(e={},(0,S.Z)(e,c.AJ.white,d("ColourModal.white")),(0,S.Z)(e,c.AJ.black,d("ColourModal.black")),e),onChange:function(n){b(M.jk.Other),E("other"),I(n)}}],Q=x&&O&&N&&D;return(0,p.jsxs)(w.u_,{isOpen:t,onClose:a,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[(0,p.jsx)(w.xB,{children:d("ColourModal.title")}),(0,p.jsx)(w.ol,{}),(0,p.jsx)(w.fe,{children:(0,p.jsxs)(o.gC,{children:[(0,p.jsx)(s.l2,{name:d("ColourModal.example"),fg:D,bg:N}),(0,p.jsxs)(Z.mQ,{isFitted:!0,colorScheme:"primary",w:"100%",defaultIndex:x===M.jk.Other?1:0,children:[(0,p.jsxs)(Z.td,{children:[(0,p.jsx)(Z.OK,{children:d("ColourModal.palette")}),(0,p.jsx)(Z.OK,{children:d("ColourModal.custom")})]}),(0,p.jsxs)(Z.nP,{children:[(0,p.jsx)(Z.x4,{children:(0,p.jsx)(s.M5,{fields:W})}),(0,p.jsx)(Z.x4,{children:(0,p.jsx)(s.M5,{fields:L})})]})]})]})}),(0,p.jsxs)(w.mz,{children:[(0,p.jsxs)(o.xv,{fontSize:"sm",marginRight:2,children:[d("ColourModal.seeAll"),(0,p.jsxs)(o.rU,{color:h,onClick:function(){m.ZP.isStandaloneWindow()?window.open("/rmg-palette","_blank"):m.ZP.openApp("rmg-palette")},children:[d("Palette")," ",(0,p.jsx)(z.JO,{as:y.jhj})]})]}),(0,p.jsx)(v.zx,{colorScheme:"primary",onClick:function(){Q&&(null===u||void 0===u||u([x,O,N,D]),a(),m.ZP.event(c.zW.SELECT_COLOUR,{cityCode:x,lineCode:O}))},disabled:!Q,children:d("Confirm")})]})]})]})}var R=t(15671),_=t(43144),N=function(){function n(){(0,R.Z)(this,n)}return(0,_.Z)(n,null,[{key:"hexToRgb",value:function(n){return[parseInt(n.slice(1,3),16),parseInt(n.slice(3,5),16),parseInt(n.slice(5,7),16)]}},{key:"fade",value:function(n,e){return"rgba(".concat([].concat((0,b.Z)(this.hexToRgb(n)),[e]).join(","),")")}},{key:"euclideanDistance",value:function(n,e){var t=this;return this.hexToRgb(n).reduce((function(n,r,i){return n+Math.pow(r-t.hexToRgb(e)[i],2)}),0)}}]),n}();function T(n){var e=n.theme,t=n.onClick,r=(0,i.$)().t;return(0,p.jsx)(v.hU,{size:"xs","aria-label":r("Colour"),mt:"0.45px",color:e[3],bg:e[2],_hover:{bg:N.fade(e[2],.7)},icon:(0,p.jsx)(y.uAz,{}),onClick:t})}function B(n){var e,t=n.interchangeList,l=n.onAdd,u=n.onDelete,d=n.onUpdate,h=(0,i.$)().t,m=(0,r.useState)(!1),j=(0,f.Z)(m,2),g=j[0],x=j[1],S=(0,r.useState)(0),C=(0,f.Z)(S,2),w=C[0],Z=C[1],z=(0,a.Qy)((function(n){return n.param})),M=z.theme,k=z.stn_list,A=Object.values(k).reduce((function(n,e){var t=(0,f.Z)(n,2),r=t[0],i=t[1];return[(0,b.Z)(new Set(r.concat(e.transfer.info.flat().map((function(n){return n[4]}))))),(0,b.Z)(new Set(i.concat(e.transfer.info.flat().map((function(n){return n[5]})))))]}),[[],[]]),O=t.map((function(n,e){return[{type:"input",label:h("Chinese name"),value:n[4],minW:"80px",onChange:function(t){return null===d||void 0===d?void 0:d(e,[n[0],n[1],n[2],n[3],t,n[5]])},optionList:A[0]},{type:"input",label:h("English name"),value:n[5],minW:"80px",onChange:function(t){return null===d||void 0===d?void 0:d(e,[n[0],n[1],n[2],n[3],n[4],t])},optionList:A[1]}]}));return(0,p.jsxs)(s.bg,{direction:"column",children:[0===t.length&&(0,p.jsxs)(o.Ug,{spacing:.5,"data-testid":"interchange-card-stack",children:[(0,p.jsx)(o.xv,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:h("StationSidePanel.interchange.noInterchanges")}),(0,p.jsx)(v.hU,{size:"sm",variant:"ghost","aria-label":h("StationSidePanel.interchange.add"),onClick:function(){return null===l||void 0===l?void 0:l([M[0],"","#aaaaaa",c.AJ.white,"",""])},icon:(0,p.jsx)(y.x06,{})})]}),t.map((function(n,e){return(0,p.jsxs)(o.Ug,{spacing:.5,"data-testid":"interchange-card-stack-".concat(e),children:[(0,p.jsx)(s.Nv,{label:h("Colour"),minW:"40px",noLabel:0!==e,children:(0,p.jsx)(T,{theme:[n[0],n[1],n[2],n[3]],onClick:function(){x(!0),Z(e)}})}),(0,p.jsx)(s.M5,{fields:O[e],noLabel:0!==e}),l&&e===O.length-1?(0,p.jsx)(v.hU,{size:"sm",variant:"ghost","aria-label":h("StationSidePanel.interchange.copy"),onClick:function(){return null===l||void 0===l?void 0:l(t.slice(-1)[0])},icon:(0,p.jsx)(y.Fqs,{})}):(0,p.jsx)(o.xu,{minW:8}),u&&(0,p.jsx)(v.hU,{size:"sm",variant:"ghost","aria-label":h("StationSidePanel.interchange.remove"),onClick:function(){return null===u||void 0===u?void 0:u(e)},icon:(0,p.jsx)(y.ZkW,{})})]},e)})),(0,p.jsx)(E,{isOpen:g,onClose:function(){return x(!1)},defaultTheme:null===(e=t[w])||void 0===e?void 0:e.slice(0,4),onUpdate:function(n){return null===d||void 0===d?void 0:d(w,[].concat((0,b.Z)(n),[t[w][4],t[w][5]]))}})]})}function U(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.app.selectedStation})),l=(0,a.Qy)((function(n){return n.param})),u=l.theme,h=l.style,f=(0,a.Qy)((function(n){return n.param.stn_list[t]})).transfer,m=function(r){var i,o;return[{type:"input",label:n("Station Chinese name"),value:null===(i=f.osi_names[r])||void 0===i?void 0:i[0],hidden:![c.RM.MTR].includes(h),onChange:function(n){var i;return e((0,d.fr)(t,r,[n,null===(i=f.osi_names[r])||void 0===i?void 0:i[1]]))}},{type:"input",label:n("Station English name"),value:null===(o=f.osi_names[r])||void 0===o?void 0:o[1],hidden:![c.RM.MTR].includes(h),onChange:function(n){var i;return e((0,d.fr)(t,r,[null===(i=f.osi_names[r])||void 0===i?void 0:i[0],n]))}},{type:"switch",label:n("Paid area"),isChecked:f.paid_area,onChange:function(n){return e((0,d.lL)(t,n))},hidden:![c.RM.MTR].includes(h)||0!==r,oneLine:!0}]},j=function(n){return function(r){e((0,d.Ui)(t,n,r))}},g=function(n){return function(r){e((0,d.SA)(t,n,r))}},x=function(n){return function(r,i){e((0,d.vM)(t,n,r,i))}};return(0,p.jsxs)(o.gC,{align:"flex-start",p:1,children:[(0,p.jsxs)(o.kC,{w:"100%",children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",mr:"auto",children:n("StationSidePanel.interchange.title")}),h===c.RM.MTR&&(0,p.jsx)(s.VC,{selections:[{label:n("Text on the left"),value:c.wA.left},{label:n("Text on the right"),value:c.wA.right}],defaultValue:f.tick_direc,onChange:function(n){return e((0,d.bC)(t,n))}})]}),f.info.map((function(e,t){return(0,p.jsxs)(r.Fragment,{children:[(0,p.jsx)(o.X6,{as:"h6",size:"xs",children:n(0===t?"StationSidePanel.interchange.within":1===t?"StationSidePanel.interchange.outStation":"StationSidePanel.interchange.outSystem")}),0!==t&&(0,p.jsx)(s.M5,{fields:m(t-1)}),(0,p.jsx)(B,{interchangeList:e,onAdd:j(t),onDelete:g(t),onUpdate:x(t)})]},t)})),f.info.length<3&&(0,p.jsx)(v.zx,{size:"xs",variant:"ghost",alignSelf:"flex-end",leftIcon:(0,p.jsx)(y.x06,{}),onClick:function(){e((0,d.Ui)(t,f.info.length,[u[0],"","#AAAAAA",c.AJ.white,"",""]))},children:n("StationSidePanel.interchange.addGroup")})]})}function D(){var n,e,t=(0,i.$)().t,r=(0,a.u5)(),l=(0,a.Qy)((function(n){return n.app.selectedStation})),u=(0,a.Qy)((function(n){return n.param})),h=u.style,f=u.loop,m=(0,a.Qy)((function(n){return n.param.stn_list[l]})),j=m.services,g=m.facility,x=m.loop_pivot,v=m.one_line,b=m.int_padding,y=Object.values(c.K9).map((function(n){return{label:t("StationSidePanel.more."+n),value:n,disabled:n===c.K9.local&&h!==c.RM.SHMetro}})),C=(n={},(0,S.Z)(n,c.mV.none,t("StationSidePanel.more.none")),(0,S.Z)(n,c.mV.airport,t("StationSidePanel.more.airport")),(0,S.Z)(n,c.mV.hsr,t("StationSidePanel.more.hsr")),(0,S.Z)(n,c.mV.disney,t("StationSidePanel.more.disney")),n),w=(e={},(0,S.Z)(e,c.mV.none,t("StationSidePanel.more.none")),(0,S.Z)(e,c.mV.airport,t("StationSidePanel.more.airport")),(0,S.Z)(e,c.mV.railway,t("StationSidePanel.more.railway")),(0,S.Z)(e,c.mV.disney,t("StationSidePanel.more.disney")),e),Z=[{type:"custom",label:t("StationSidePanel.more.service"),component:(0,p.jsx)(s.VC,{selections:y,defaultValue:j,onChange:function(n){return r((0,d.k6)(l,n))},multiSelect:!0}),hidden:![c.RM.GZMTR,c.RM.SHMetro].includes(h)},{type:"select",label:t("StationSidePanel.more.facility"),value:g,options:h===c.RM.MTR?C:w,onChange:function(n){return r((0,d.cm)(l,n))},hidden:![c.RM.MTR,c.RM.SHMetro].includes(h)},{type:"switch",label:t("StationSidePanel.more.pivot"),isChecked:x,onChange:function(n){return r((0,d.Hz)(l,n))},hidden:![c.RM.SHMetro].includes(h)||!f,minW:"full",oneLine:!0},{type:"switch",label:t("StationSidePanel.more.oneLine"),isChecked:v,onChange:function(n){return r((0,d.br)(l,n))},hidden:![c.RM.SHMetro].includes(h),minW:"full",oneLine:!0},{type:"input",label:t("StationSidePanel.more.intPadding"),value:b.toString(),validator:function(n){return Number.isInteger(n)},onChange:function(n){return r((0,d.j7)(l,Number(n)))},hidden:![c.RM.SHMetro].includes(h)},{type:"custom",label:t("StationSidePanel.more.intPaddingApplyGlobal"),component:(0,p.jsx)(s.VC,{selections:[{label:t("StationSidePanel.more.apply"),value:"",disabled:!1}],defaultValue:"",onChange:function(n){return r((0,d.M4)(l))}}),oneLine:!0,hidden:![c.RM.SHMetro].includes(h)}];return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:t("StationSidePanel.more.title")}),(0,p.jsx)(s.M5,{fields:Z})]})}var I=t(1413);function W(){var n,e=(0,i.$)().t,t=(0,a.u5)(),r=(0,a.Qy)((function(n){return n.app.selectedStation})),l=(0,a.Qy)((function(n){return n.param.stn_list})),u=l[r],h=u.parents,f=u.children,m=u.branch,j=(n={},(0,S.Z)(n,c.H_.through,e("StationSidePanel.branch.through")),(0,S.Z)(n,c.H_.nonThrough,e("StationSidePanel.branch.nonThrough")),n),g=function(n){return(n===c.Nm.left?h:f).reduce((function(n,e){return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e,l[e].name.join(" ")))}),{})},x={upper:e("StationSidePanel.branch.upper"),lower:e("StationSidePanel.branch.lower")},v=function(n){return m[n].length?[{type:"select",label:e("StationSidePanel.branch.type"),options:j,value:m[n][0],onChange:function(e){return t((0,d.kM)(r,n,e))}},{type:"select",label:e("StationSidePanel.branch.firstStation"),options:g(n),value:m[n][1],onChange:function(e){return t((0,d.B6)(r,n,e))}},{type:"select",label:e("StationSidePanel.branch.position"),options:x,value:0===(n===c.Nm.left?h:f).indexOf(m[n][1])?"upper":"lower",onChange:function(){return t((0,d.HT)(r,n))}}]:[]};return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:e("Branches")}),(0,p.jsx)(o.X6,{as:"h6",size:"xs",children:e("Branch on the left")}),(0,p.jsx)(s.bg,{direction:"column",children:2===h.length?(0,p.jsx)(s.M5,{fields:v(c.Nm.left)}):(0,p.jsx)(o.xv,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:e("No branches found")})}),(0,p.jsx)(o.X6,{as:"h6",size:"xs",children:e("Branch on the right")}),(0,p.jsx)(s.bg,{direction:"column",children:2===f.length?(0,p.jsx)(s.M5,{fields:v(c.Nm.right)}):(0,p.jsx)(o.xv,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:e("No branches found")})})]})}function L(){return(0,p.jsxs)(s.EI,{children:[(0,p.jsx)(x,{}),(0,p.jsx)(o.iz,{}),(0,p.jsx)(U,{}),(0,p.jsx)(o.iz,{}),(0,p.jsx)(W,{}),(0,p.jsx)(o.iz,{}),(0,p.jsx)(D,{})]})}function Q(){var n=(0,i.$)().t,e=(0,u.I0)(),t=(0,a.Qy)((function(n){return n.param})),r=t.style,l=t.svgWidth,h=t.svg_height,f=t.y_pc,m=t.branchSpacingPct,j=t.padding,g=t.direction_gz_x,x=t.direction_gz_y,v=t.loop,y=[].concat((0,b.Z)(c.tK[r].map((function(t){return{type:"input",label:n("StyleSidePanel.layout.".concat(t,"Width")),value:l[t].toString(),onChange:function(n){return e((0,d.gS)(Number(n),t))}}}))),[{type:"input",label:n("StyleSidePanel.layout.canvasHeight"),value:h.toString(),onChange:function(n){return e((0,d.K0)(Number(n)))}},{type:"slider",label:n("StyleSidePanel.layout.verticalPosition"),value:f,min:0,max:100,onChange:function(n){return e((0,d.Tt)(n))},hidden:![c.RM.MTR,c.RM.GZMTR].includes(r)},{type:"slider",label:n(v?"StyleSidePanel.layout.branchSpacingLoop":"Branch spacing"),value:m,min:0,max:v?50:100,onChange:function(n){return e((0,d.z2)(n))}},{type:"slider",label:n("StyleSidePanel.layout.padding"),value:j,min:0,max:50,onChange:function(n){return e((0,d.xd)(n))}},{type:"slider",label:n("StyleSidePanel.layout.directionGzX"),value:g,min:0,max:100,onChange:function(n){return e((0,d.$m)(n))},hidden:![c.RM.GZMTR].includes(r)},{type:"slider",label:n("StyleSidePanel.layout.directionGzY"),value:x,min:0,max:100,onChange:function(n){return e((0,d.rR)(n))},hidden:![c.RM.GZMTR].includes(r)}]);return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:n("StyleSidePanel.layout.title")}),(0,p.jsx)(s.M5,{fields:y,minW:130})]})}function H(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.param})),l=t.style,u=t.theme,h=t.line_name,m=t.line_num,j=t.direction,g=t.platform_num,x=t.psd_num,b=t.namePosMTR,C=t.customiseMTRDest,w=t.info_panel_type,Z=(0,r.useState)(!1),z=(0,f.Z)(Z,2),M=z[0],k=z[1],A=[{label:n("StyleSidePanel.design.left"),value:c.wA.left},{label:n("StyleSidePanel.design.right"),value:c.wA.right}],O=Object.values(c.p).reduce((function(e,t){return(0,I.Z)((0,I.Z)({},e),{},(0,S.Z)({},t,n("StyleSidePanel.design."+t)))}),{}),P=Object.values(c.hi).reduce((function(e,t){return(0,I.Z)((0,I.Z)({},e),{},(0,S.Z)({},t,n("StyleSidePanel.design."+t)))}),{}),F=[{type:"custom",label:n("Colour"),component:(0,p.jsx)(T,{theme:u,onClick:function(){return k(!0)}}),minW:"40px"},{type:"input",label:n("StyleSidePanel.design.zhLineName"),value:h[0],onChange:function(n){return e((0,d.il)([n,h[1]]))},minW:130},{type:"input",label:n("StyleSidePanel.design.enLineName"),value:h[1],onChange:function(n){return e((0,d.il)([h[0],n]))},minW:130},{type:"input",label:n("StyleSidePanel.design.lineNum"),value:m,onChange:function(n){return e((0,d.bh)(n))},hidden:![c.RM.GZMTR].includes(l)},{type:"input",label:n("StyleSidePanel.design.platformNum"),value:g||"",onChange:function(n){return e((0,d.VY)(n))}},{type:"input",label:n("StyleSidePanel.design.psdNum"),value:x,onChange:function(n){return e((0,d.lT)(n))},hidden:![c.RM.GZMTR].includes(l)},{type:"select",label:n("StyleSidePanel.design.panelType"),value:w,options:l===c.RM.GZMTR?O:P,onChange:function(n){return e((0,d.NQ)(n))},hidden:![c.RM.GZMTR,c.RM.SHMetro].includes(l)},{type:"custom",label:n("StyleSidePanel.design.direction"),component:(0,p.jsx)(s.VC,{selections:A,defaultValue:j,onChange:function(n){return e((0,d.mU)(n))}}),minW:"full",oneLine:!0}],R=[{label:n("StyleSidePanel.design.alternatively"),value:!0},{label:n("StyleSidePanel.design.onOneSide"),value:!1}],_=[{type:"custom",label:n("StyleSidePanel.design.nameDisplay"),component:(0,p.jsxs)(o.Ug,{children:[(0,p.jsx)(s.VC,{selections:R,defaultValue:b.isStagger,onChange:function(n){return e((0,d.gn)(n))}}),(0,p.jsx)(v.zx,{size:"xs",variant:"ghost",leftIcon:(0,p.jsx)(y.Llt,{}),onClick:function(){return e((0,d.jv)())},children:n("StyleSidePanel.design.flip")})]}),minW:"full",oneLine:!0,hidden:![c.RM.MTR].includes(l)},{type:"switch",label:n("StyleSidePanel.design.legacyDestination"),isChecked:C.isLegacy,onChange:function(n){return e((0,d.nR)(n))},hidden:![c.RM.MTR].includes(l),minW:"full",oneLine:!0},{type:"switch",label:n("StyleSidePanel.design.overrideTerminal"),isChecked:!1!==C.terminal,onChange:function(n){return e((0,d.An)(!!n&&["",""]))},hidden:![c.RM.MTR].includes(l),minW:"full",oneLine:!0},{type:"input",label:n("StyleSidePanel.design.terminalZhName"),value:C.terminal?C.terminal[0]:"",placeholder:"\u6a5f\u5834\u53ca\u535a\u89bd\u9928",onChange:function(n){return e((0,d.An)([n,C.terminal?C.terminal[1]:""]))},hidden:![c.RM.MTR].includes(l)||!1===C.terminal},{type:"input",label:n("StyleSidePanel.design.terminalEnName"),value:C.terminal?C.terminal[1]:"",placeholder:"Airport and AsiaWorld-Expo",onChange:function(n){return e((0,d.An)([C.terminal?C.terminal[0]:"",n]))},hidden:![c.RM.MTR].includes(l)||!1===C.terminal}];return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:n("StyleSidePanel.design.title")}),(0,p.jsx)(s.M5,{fields:[].concat(F,_),minW:130}),(0,p.jsx)(E,{isOpen:M,onClose:function(){return k(!1)},defaultTheme:u,onUpdate:function(n){return e((0,d.Dc)(n))}})]})}function V(){var n,e=(0,i.$)().t,t=(0,a.u5)(),r=(0,a.Qy)((function(n){return n.helper})).branches,l=(0,a.Qy)((function(n){return n.param})),c=l.loop,u=l.loop_info,h=u.bank,f=u.left_and_right_factor,m=u.bottom_factor,j=r.flat().filter((n={},function(e){return 2===(n[e]=(n[e]||0)+1)})).filter((function(n){return!["linestart","lineend"].includes(n)})),g=Math.abs(r[0].indexOf(j[0])-r[0].indexOf(j[1])),x=r.length>=2?(0,Math.min)(r[0].length-2-g,g):Math.floor((r[0].length-2-2*m)/2),v=[{type:"switch",label:e("StyleSidePanel.loop.isLoop"),isChecked:c,onChange:function(n){return t((0,d.rY)(n))},minW:"full",oneLine:!0},{type:"switch",label:e("StyleSidePanel.loop.isBank"),isChecked:h,onChange:function(n){return t((0,d.qi)(n))},minW:"full",oneLine:!0,hidden:!c},{type:"slider",label:e("StyleSidePanel.loop.leftRightFactor"),value:f,min:0,max:x,onChange:function(n){return t((0,d.lh)(Math.floor(n)))},hidden:!c},{type:"slider",label:e("StyleSidePanel.loop.bottomFactor"),value:m,min:0,max:Math.floor((r[0].length-2-2*f)/2),onChange:function(n){return t((0,d.Hv)(Math.floor(n)))},hidden:!c||c&&r.length>2}];return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:e("StyleSidePanel.loop.title")}),(0,p.jsx)(s.M5,{fields:v})]})}function G(n){var e=n.note,t=n.onUpdate,r=n.onDelete,a=(0,i.$)().t,l=[{type:"textarea",label:a("StyleSidePanel.note.zhNote"),value:e[0],onChange:function(n){return null===t||void 0===t?void 0:t([n,e[1],e[2],e[3],e[4]])}},{type:"textarea",label:a("StyleSidePanel.note.enNote"),value:e[1],onChange:function(n){return null===t||void 0===t?void 0:t([e[0],n,e[2],e[3],e[4]])}},{type:"switch",label:a("StyleSidePanel.note.border"),isChecked:e[4],onChange:function(n){return null===t||void 0===t?void 0:t([e[0],e[1],e[2],e[3],n])},oneLine:!0}],c=[{type:"slider",label:a("StyleSidePanel.note.positionX"),value:e[2],min:0,max:100,onChange:function(n){return null===t||void 0===t?void 0:t([e[0],e[1],n,e[3],e[4]])}},{type:"slider",label:a("StyleSidePanel.note.positionY"),value:e[3],min:0,max:100,onChange:function(n){return null===t||void 0===t?void 0:t([e[0],e[1],e[2],n,e[4]])}}];return(0,p.jsxs)(s.bg,{direction:"column",children:[(0,p.jsx)(s.M5,{fields:l,minW:"full"}),(0,p.jsxs)(o.Ug,{spacing:.5,sx:{"&>div":{flex:1}},children:[(0,p.jsx)(s.M5,{fields:c}),(0,p.jsx)(v.hU,{size:"sm",variant:"ghost","aria-label":a("StyleSidePanel.note.remove"),onClick:function(){return null===r||void 0===r?void 0:r()},icon:(0,p.jsx)(y.ZkW,{})})]})]})}function $(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.param.notesGZMTR}));return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:n("StyleSidePanel.note.title")}),(0,p.jsxs)(o.gC,{spacing:.5,children:[t.map((function(n,t){return(0,p.jsx)(G,{note:n,onUpdate:function(n){return e((0,d.Qk)(t,n))},onDelete:function(){return e((0,d.lj)(t))}},t)})),(0,p.jsx)(v.zx,{size:"xs",variant:"ghost",leftIcon:(0,p.jsx)(y.x06,{}),alignSelf:"flex-end",onClick:function(){return e((0,d.AL)())},children:n("StyleSidePanel.note.add")})]})]})}function J(){var n=(0,a.Qy)((function(n){return n.param})).style;return(0,p.jsxs)(s.EI,{children:[(0,p.jsx)(Q,{}),(0,p.jsx)(o.iz,{}),(0,p.jsx)(H,{}),n===c.RM.GZMTR&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.iz,{}),(0,p.jsx)($,{})]}),n===c.RM.SHMetro&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.iz,{}),(0,p.jsx)(V,{})]})]})}var q=t(98096),X=function n(e,t){if(["linestart","lineend"].includes(e)||t[e].parents.length>1||t[e].children.length>1)return 0;var r=t[e].parents[0];return r?1===t[r].children.length?n(r,t):0===t[r].children.indexOf(e)?1:-1:0},Y=t(36705);function K(n){var e=n.isOpen,t=n.onClose,s=(0,i.$)().t,u=(0,a.u5)(),h=(0,a.Qy)((function(n){return n.app.selectedStation})),j=(0,r.useState)(!1),g=(0,f.Z)(j,2),x=g[0],b=g[1];(0,r.useEffect)((function(){e||b(!1)}),[e]);return(0,p.jsxs)(w.u_,{isOpen:e,onClose:t,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[x&&(0,p.jsxs)(q.bZ,{status:"error",variant:"solid",size:"xs",children:[(0,p.jsx)(q.zM,{}),s("Unable to remove this station.")]}),(0,p.jsxs)(o.xu,{position:"relative",children:[(0,p.jsx)(w.xB,{children:s("Remove station")}),(0,p.jsx)(w.ol,{})]}),(0,p.jsx)(w.fe,{children:s("Are you sure to remove station? You cannot undo this action.")}),(0,p.jsxs)(w.mz,{children:[(0,p.jsx)(v.zx,{onClick:t,children:s("Cancel")}),(0,p.jsx)(v.zx,{colorScheme:"primary",onClick:function(){var n,e=u((n=h,function(e,t){var r=t().param,i=r.stn_list,o=r.current_stn_idx;if(n===o)return console.log("removeStation():: failed as current station cannot be deleted"),!1;var s=i[n],a=s.parents,l=s.children;return 4===Object.keys(i).length?(console.log("removeStation():: failed as only 2 stations remaining"),!1):2===a.length&&2===l.length?(console.log("removeStation():: failed as branches on both sides cannot be combined"),!1):!!Object.keys(i).some((function(e){return![n,"linestart","lineend"].includes(e)&&0===X(e,i)}))||(console.log("removeStation():: failed as selected station is the only station without siblings"),!1)}));e?(t(),u((0,l.B4)(c.Sg.CLOSE)),u((0,l.NQ)("linestart")),u((0,Y.NC)(h)),u(function(n){return function(e,t){var r=t().param.stn_list,i=r[n],o=i.parents,s=i.children,a=JSON.parse(JSON.stringify(r));if(2===o.length||2===s.length)o.forEach((function(n){a[n].children=s})),s.forEach((function(n){a[n].parents=o})),1===o.length&&(a[o[0]].branch.right=a[n].branch.right),1===s.length&&(a[s[0]].branch.left=a[n].branch.left);else if(2===r[o[0]].children.length&&2===r[s[0]].parents.length){var l;a=(0,I.Z)((0,I.Z)({},r),{},(l={},(0,S.Z)(l,o[0],(0,I.Z)((0,I.Z)({},r[o[0]]),{},{children:r[o[0]].children.filter((function(e){return e!==n})),branch:(0,I.Z)((0,I.Z)({},r[o[0]].branch),{},{right:[]})})),(0,S.Z)(l,s[0],(0,I.Z)((0,I.Z)({},r[s[0]]),{},{parents:r[s[0]].parents.filter((function(e){return e!==n})),branch:(0,I.Z)((0,I.Z)({},r[s[0]].branch),{},{left:[]})})),l))}else o.forEach((function(e){var t=a[e].children.indexOf(n);s.length?a[e].children[t]=s[0]:a[e].children.splice(t,1),a[e].branch.right[1]===n&&(a[e].branch.right[1]=s[0])})),s.forEach((function(e){var t=a[e].parents.indexOf(n);o.length?a[e].parents[t]=o[0]:a[e].parents.splice(t,1),a[e].branch.left[1]===n&&(a[e].branch.left[1]=o[0])}));delete a[n],e((0,d.BI)(a))}}(h))):b(!0),m.ZP.event(c.zW.REMOVE_STATION,{success:e})},ml:3,children:s("Confirm")})]})]})]})}function nn(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.app.selectedStation})),l=(0,r.useState)(!1),c=(0,f.Z)(l,2),u=c[0],h=c[1];return(0,p.jsxs)(s.B0,{children:[(0,p.jsxs)(o.Ug,{children:[(0,p.jsx)(v.zx,{size:"sm",variant:"outline",onClick:function(){return e((0,d.lS)(t))},children:n("StationSidePanel.footer.current")}),(0,p.jsx)(v.zx,{size:"sm",variant:"outline",onClick:function(){return h(!0)},children:n("StationSidePanel.footer.remove")})]}),(0,p.jsx)(K,{isOpen:u,onClose:function(){return h(!1)}})]})}function en(n){var e=n.colineInfo,t=n.routeOptions,a=n.onUpdateRoute,l=n.onUpdateColourInfo,c=n.onDelete,u=(0,i.$)().t,d=(0,r.useState)(!1),h=(0,f.Z)(d,2),m=h[0],j=h[1],g=[{type:"select",label:"Route",value:[e.from,e.to].join(","),options:t,onChange:function(n){return null===a||void 0===a?void 0:a(n)}}],x=[{type:"custom",label:u("Colour"),component:(0,p.jsx)(T,{theme:[e.colors[0][0],e.colors[0][1],e.colors[0][2],e.colors[0][3]],onClick:function(){return j(!0)}})},{type:"input",label:u("Chinese name"),value:e.colors[0][4],minW:120,onChange:function(n){return null===l||void 0===l?void 0:l([e.colors[0][0],e.colors[0][1],e.colors[0][2],e.colors[0][3],n,e.colors[0][5]])}},{type:"input",label:u("English name"),value:e.colors[0][5],minW:120,onChange:function(n){return null===l||void 0===l?void 0:l([e.colors[0][0],e.colors[0][1],e.colors[0][2],e.colors[0][3],e.colors[0][4],n])}}];return(0,p.jsxs)(s.bg,{direction:"column",children:[(0,p.jsx)(s.M5,{fields:g,minW:"full"}),(0,p.jsxs)(o.Ug,{spacing:.5,children:[(0,p.jsx)(s.M5,{fields:x}),(0,p.jsx)(v.hU,{size:"sm",variant:"ghost","aria-label":"Delete colour for route",onClick:function(){return null===c||void 0===c?void 0:c(0)},icon:(0,p.jsx)(y.ZkW,{})})]}),(0,p.jsx)(E,{isOpen:m,onClose:function(){return j(!1)},defaultTheme:e.colors[0].slice(0,4),onUpdate:function(n){return null===l||void 0===l?void 0:l([].concat((0,b.Z)(n),[e.colors[0][4],e.colors[0][5]]))}})]})}function tn(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.app.selectedBranch})),r=(0,a.Qy)((function(n){return n.param})),s=r.theme,u=r.stn_list,d=e((0,Y._G)(t)),h=e((0,Y.ku)(t)),m=h.reduce((function(n,e){return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e.join(","),e.map((function(n){return u[n].name.join(" - ")})).join(" ~ ")))}),{});return(0,p.jsxs)(o.gC,{align:"flex-start",p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:n("BranchSidePanel.coline.title")}),Object.entries(d).map((function(n){var t,r=(0,f.Z)(n,2),i=r[0],o=r[1];return(0,p.jsx)(en,{colineInfo:o,routeOptions:m,onUpdateRoute:(t=i,function(n){var r=n.split(","),i=(0,f.Z)(r,2),o=i[0],s=i[1];console.log("ColineSection.handleUpdateRoute():: Updating route, colineId=".concat(t,", from=").concat(o,", to=").concat(s));try{e((0,Y.l$)(t,o,s))}catch(a){e((0,l.bI)({status:"error",message:"Unable to draw this share track."}))}}),onUpdateColourInfo:function(n){return e((0,Y.Di)(i,0,n))},onDelete:function(n){return function(n,t){e((0,Y.wX)(n,t))}(i,n)}},i)})),(0===t||0===Object.keys(d).length)&&(0,p.jsx)(v.zx,{size:"xs",variant:"ghost",alignSelf:"flex-end",leftIcon:(0,p.jsx)(y.x06,{}),onClick:function(){console.log("ColineSection.handleAddTrackSharing():: Adding track sharing to branch ".concat(t," with default combination"),h[0]),e((0,Y._g)(h[0][0],h[0][1],[[s[0],"","#AAAAAA",c.AJ.white,"",""]]))},children:n("BranchSidePanel.coline.add")})]})}function rn(n){var e=n.isOpen,t=n.onClose,o=(0,i.$)().t,l=(0,a.u5)(),u=(0,a.Qy)((function(n){return n.app.selectedBranch})),h=(0,a.Qy)((function(n){return n.param})),j=h.style,g=h.stn_list,x=(0,a.Qy)((function(n){return n.helper.branches})),b=(0,r.useState)(u),y=(0,f.Z)(b,2),C=y[0],Z=y[1],z=(0,r.useState)("1"),M=(0,f.Z)(z,2),k=M[0],A=M[1],O=(0,r.useState)("2"),P=(0,f.Z)(O,2),F=P[0],E=P[1],R=(0,r.useState)("asc"),_=(0,f.Z)(R,2),N=_[0],T=_[1];(0,r.useEffect)((function(){Z(u)}),[u]);var B=[{type:"select",label:o("AutoNumModal.where"),value:C,options:(0,I.Z)({},x.reduce((function(n,e,t){return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},t,0===t?o("AutoNumModal.main"):j===c.RM.SHMetro&&(0,Y.Qo)(e,g)?o("AutoNumModal.external")+" "+t:o("AutoNumModal.branch")+" "+t))}),{})),onChange:function(n){return Z(n)}},{type:"input",label:o("AutoNumModal.from"),value:k,validator:function(n){return!isNaN(Number(n))},onChange:A,debouncedDelay:0},{type:"input",label:o("AutoNumModal.maxLength"),validator:function(n){return!isNaN(Number(n))},value:F,onChange:E,debouncedDelay:0},{type:"select",label:o("AutoNumModal.sort"),value:N,options:{asc:o("AutoNumModal.asc"),desc:o("AutoNumModal.desc")},onChange:function(n){return T(n)}}],U=!k||!F||isNaN(Number(k))||isNaN(Number(F));return(0,p.jsxs)(w.u_,{isOpen:e,onClose:t,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[(0,p.jsx)(w.xB,{children:o("AutoNumModal.title")}),(0,p.jsx)(w.ol,{}),(0,p.jsx)(w.fe,{children:(0,p.jsx)(s.M5,{fields:B})}),(0,p.jsx)(w.mz,{children:(0,p.jsx)(v.zx,{colorScheme:"primary",isDisabled:U,onClick:function(){l((0,d.av)(C,Number(k),Number(F),N)),t(),m.ZP.event(c.zW.AUTO_NUMBERING,{})},children:o("Confirm")})})]})]})}var on=function(n){return function(e,t){var r=t().helper.branches[n];return r.includes("linestart")||r.includes("lineend")?1:2}},sn=function(n){return function(e,t){var r=t().helper.branches,i=r[0],o=r[n];return i.slice(i.indexOf(o[0])+1,i.indexOf(o.slice(-1)[0]))}},an=function(n,e){return function(t,r){var i=t(function(n,e){return function(t){return 2===t(on(e))?(console.log("isStationValid2ConnectBranch():: failed as current branch has 2 connected ends"),!1):!!t(sn(e)).includes(n)||(console.log("isStationValid2ConnectBranch():: failed as the target station is invalid"),!1)}}(n,e));if(!i)return!1;var o=r().helper.branches,s=r().param.stn_list,a=o[e];if("linestart"===a[0]){var l,c=(0,I.Z)((0,I.Z)({},s),{},(l={},(0,S.Z)(l,a[1],(0,I.Z)((0,I.Z)({},s[a[1]]),{},{parents:[n]})),(0,S.Z)(l,n,(0,I.Z)((0,I.Z)({},s[n]),{},{children:s.linestart.children.map((function(e){return e===a[1]?e:s[n].children[0]})),branch:{left:[],right:s.linestart.branch.right}})),(0,S.Z)(l,"linestart",(0,I.Z)((0,I.Z)({},s.linestart),{},{children:s.linestart.children.filter((function(n){return n!==a[1]})),branch:{left:[],right:[]}})),l));return t((0,d.BI)(c)),!0}var u,h=a.slice(-2)[0],f=(0,I.Z)((0,I.Z)({},s),{},(u={},(0,S.Z)(u,h,(0,I.Z)((0,I.Z)({},s[h]),{},{children:[n]})),(0,S.Z)(u,n,(0,I.Z)((0,I.Z)({},s[n]),{},{parents:s.lineend.parents.map((function(e){return e===h?e:s[n].parents[0]})),branch:{right:[],left:s.lineend.branch.left}})),(0,S.Z)(u,"lineend",(0,I.Z)((0,I.Z)({},s.lineend),{},{parents:s.lineend.parents.filter((function(n){return n!==h})),branch:{left:[],right:[]}})),u));return t((0,d.BI)(f)),!0}},ln=function(n){return function(e,t){var r=t().helper.branches,i=t().param.stn_list,o=r[0],s=r[n];if(2!==e(on(n)))return console.log("getPossibleDirection():: failed as there is no possible direction"),[];var a=o.indexOf(s[0]),l=o.slice(0,a),u=o.indexOf(s.slice(-1)[0]),d=o.slice(u+1),h=l.every((function(n){return i[n].children.length<=1&&i[n].parents.length<=1})),f=d.every((function(n){return i[n].children.length<=1&&i[n].parents.length<=1}));return h?f?[c.Nm.left,c.Nm.right]:[c.Nm.left]:f?[c.Nm.right]:[]}};function cn(n){var e=n.direction,t=(0,i.$)().t,u=(0,a.u5)(),h=(0,a.Qy)((function(n){return n.helper})).branches,j=(0,a.Qy)((function(n){return n.app.selectedBranch})),g=(0,a.Qy)((function(n){return n.param})),x=g.style,b=g.stn_list,y=(0,r.useState)(!1),C=(0,f.Z)(y,2),w=C[0],Z=C[1],z=(0,r.useState)(""),M=(0,f.Z)(z,2),k=M[0],A=M[1],O=h[j].filter((function(n){return!["linestart","lineend"].includes(n)})),P=e===c.Nm.left?O[0]:O.slice(-1)[0],F=b[P],E=u(sn(j)),R=u(on(j)),_=u(ln(j)),N=1===R&&!h[0].includes(P),T=_.includes(e),B=E.reduce((function(n,e){var t;return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e,null===(t=b[e])||void 0===t?void 0:t.name.join(" - ")))}),{"":t("Please select...")});return(0,p.jsxs)(s.bg,{direction:"column",children:[(0,p.jsxs)(o.kC,{alignItems:"center",children:[(0,p.jsx)(s.Nv,{label:t("Station name"),flex:1,children:(0,p.jsx)(s.bV,{defaultValue:F.name.join(" "),isDisabled:!0})}),w?(0,p.jsx)(v.zx,{mx:1,size:"sm",variant:"outline",onClick:function(){return Z(!1)},children:t("Cancel")}):N?(0,p.jsx)(v.zx,{mx:1,size:"sm",variant:"solid",colorScheme:"primary",onClick:function(){return Z(!0)},children:t("Connect to main line")}):(0,p.jsx)(v.zx,{mx:1,size:"sm",variant:"solid",colorScheme:"primary",onClick:function(){var n=u(function(n,e){return function(t,r){if(!t(ln(e)).includes(n))return console.log("disconnectFromMainLine():: failed as the aim direction is not in the possible direction list"),!1;var i=r().helper.branches,o=r().param.stn_list,s=i[0],a=i[e];if(n===c.Nm.left){var l,u=a[0],h=(0,I.Z)((0,I.Z)({},o),{},(l={},(0,S.Z)(l,a[1],(0,I.Z)((0,I.Z)({},o[a[1]]),{},{parents:["linestart"]})),(0,S.Z)(l,u,(0,I.Z)((0,I.Z)({},o[u]),{},{children:o[u].children.filter((function(n){return n!==a[1]})),branch:{right:[],left:[]}})),(0,S.Z)(l,"linestart",(0,I.Z)((0,I.Z)({},o.linestart),{},{children:o[u].children.map((function(n){return n===a[1]?n:s[1]})),branch:{left:[],right:o[u].branch.right}})),l));return t((0,d.BI)(h)),!0}var f,m=a.slice(-1)[0],p=a.slice(-2)[0],j=(0,I.Z)((0,I.Z)({},o),{},(f={},(0,S.Z)(f,p,(0,I.Z)((0,I.Z)({},o[p]),{},{children:["lineend"]})),(0,S.Z)(f,m,(0,I.Z)((0,I.Z)({},o[m]),{},{parents:o[m].parents.filter((function(n){return n!==p})),branch:{right:[],left:[]}})),(0,S.Z)(f,"lineend",(0,I.Z)((0,I.Z)({},o.lineend),{},{parents:o[m].parents.map((function(n){return n===p?n:s.slice(-2)[0]})),branch:{right:[],left:o[m].branch.left}})),f));return t((0,d.BI)(j)),!0}}(e,j));n||u((0,l.bI)({status:"error",message:t("Unable to disconnect from main line.")})),m.ZP.event(c.zW.DISCONNECT_BRANCH,{style:x,success:n})},isDisabled:!T,children:t("Disconnect from main line")})]}),w&&(0,p.jsxs)(o.kC,{alignItems:"center",children:[(0,p.jsx)(s.Nv,{label:t("Target station"),flex:1,children:(0,p.jsx)(s.mg,{defaultValue:k,options:B,disabledOptions:[""],onChange:function(n){var e=n.target.value;return A(e)}})}),(0,p.jsx)(v.zx,{mx:1,size:"sm",variant:"solid",colorScheme:"primary",onClick:function(){var n=u(an(k,j));n?Z(!1):u((0,l.bI)({status:"error",message:t("Unable to connect to main line.")})),m.ZP.event(c.zW.CONNECT_BRANCH,{style:x,success:n})},isDisabled:!k,children:t("Confirm")})]})]})}function un(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.param.style})),s=(0,a.Qy)((function(n){return n.app.selectedBranch})),l=(0,r.useState)(!1),u=(0,f.Z)(l,2),h=u[0],j=u[1];return(0,p.jsxs)(o.xu,{p:1,children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",children:n("BranchSidePanel.action.title")}),(0,p.jsxs)(o.kC,{wrap:"wrap",sx:{p:1,"&> *":{flexShrink:0,flexBasis:"100%","&:not(:first-child)":{marginTop:2}}},children:[0!==s&&t!==c.RM.SHMetro&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.X6,{as:"h6",size:"xs",children:n("Branch left end")}),(0,p.jsx)(cn,{direction:c.Nm.left}),(0,p.jsx)(o.X6,{as:"h6",size:"xs",children:n("Branch right end")}),(0,p.jsx)(cn,{direction:c.Nm.right})]}),t===c.RM.GZMTR&&(0,p.jsx)(v.zx,{size:"sm",variant:"outline",leftIcon:(0,p.jsx)(y.OIZ,{}),alignSelf:"flex-end",onClick:function(){return j(!0)},children:n("BranchSidePanel.action.autoNum")}),(0,p.jsx)(v.zx,{size:"sm",variant:"outline",leftIcon:(0,p.jsx)(y.bef,{}),alignSelf:"flex-end",onClick:function(){e((0,d.iI)(t===c.RM.SHMetro)),m.ZP.event(c.zW.REVERSE_STATIONS,{style:t})},children:t===c.RM.SHMetro?n("BranchSidePanel.action.flip"):n("BranchSidePanel.action.reverse")})]}),(0,p.jsx)(rn,{isOpen:h,onClose:function(){return j(!1)}})]})}function dn(){var n=(0,a.Qy)((function(n){return n.app.selectedBranch})),e=(0,a.Qy)((function(n){return n.param})),t=e.style,r=e.stn_list,i=(0,a.Qy)((function(n){return n.helper.branches}));return(0,p.jsxs)(s.EI,{children:[t===c.RM.SHMetro&&(0===n||(0,Y.Qo)(i[n],r))&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(tn,{}),(0,p.jsx)(o.iz,{})]}),(0,p.jsx)(un,{})]})}function hn(){var n,e,t=(0,i.$)().t,r=(0,u.I0)(),o=(0,a.Qy)((function(n){return n.app})),d=o.sidePanelMode,h=o.selectedStation,f=(0,a.Qy)((function(n){var e;return null===(e=n.param.stn_list[h])||void 0===e?void 0:e.name})),m={STATION:{header:(0,p.jsx)(s.iR,{text:(null===f||void 0===f?void 0:f.join(" - "))||""}),body:(0,p.jsx)(L,{}),footer:(0,p.jsx)(nn,{})},STYLE:{header:t("StyleSidePanel.header"),body:(0,p.jsx)(J,{})},BRANCH:{header:t("BranchSidePanel.header"),body:(0,p.jsx)(dn,{})},CLOSE:{header:"Close"}};return(0,p.jsxs)(s.L$,{isOpen:d!==c.Sg.CLOSE,width:375,header:"Dummy header",children:[(0,p.jsx)(s.mQ,{onClose:function(){r((0,l.B4)(c.Sg.CLOSE))},children:m[d].header}),null===(n=m[d])||void 0===n?void 0:n.body,null===(e=m[d])||void 0===e?void 0:e.footer]})}var fn=t(70150),mn=function(n,e,t){var r=new Blob([t],{type:e});pn(n,r)},pn=function(n,e){var t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)},jn=function(n){return new Promise((function(e){var t=new FileReader;t.onloadend=function(){return e(t.result)},t.readAsText(n)}))},gn=function(){return navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},xn=t(15861),vn=t(64687),bn=t.n(vn),yn=t(95587),Sn=t.n(yn),Cn=function(){var n=(0,xn.Z)(bn().mark((function n(e,t,r,i,o){var s,a,l,u,d,h,m,p;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=["--rmg-svg-width","--rmg-svg-height"].map((function(n){return document.querySelector("svg#".concat(e)).style.getPropertyValue(n).match(/\d+/g)[0]})).map(Number),u=(0,f.Z)(l,2),d=u[1],(h=document.querySelector("svg#".concat(e)).cloneNode(!0)).setAttribute("height",(d*(o||100)/100).toString()),h.style.setProperty("all","initial"),["share"].map((function(n){var e;return(0,b.Z)((null===(e=(0,b.Z)(document.querySelectorAll("link")).filter((function(e){return e.id==="css_"+n}))[0])||void 0===e?void 0:e.sheet).cssRules).map((function(n){return n.cssText})).join(" ")})).forEach((function(n){var e=document.createElement("style");e.textContent=n,h.prepend(e)})),null===(s=h.querySelector("rect#canvas-border"))||void 0===s||s.setAttribute("stroke",i?"black":"none"),null===(a=h.querySelector("rect#canvas-bg"))||void 0===a||a.setAttribute("fill",r?"none":"white"),t!==c.RM.MTR){n.next=21;break}return n.prev=8,n.next=11,Zn(h);case 11:m=n.sent,(p=document.createElement("style")).textContent=m.join("\n"),h.prepend(p),n.next=21;break;case 17:n.prev=17,n.t0=n.catch(8),alert("Failed to fonts. Fonts in the exported PNG will be missing."),console.error(n.t0);case 21:return n.abrupt("return",h);case 22:case"end":return n.stop()}}),n,null,[[8,17]])})));return function(e,t,r,i,o){return n.apply(this,arguments)}}(),wn=function(n){return new Promise((function(e){var t=new FileReader;t.onloadend=function(){return e(t.result)},t.readAsDataURL(n)}))},Zn=function(){var n=(0,xn.Z)(bn().mark((function n(e){var t,r,i,o;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=Array.from(new Set([].concat((0,b.Z)(e.querySelectorAll(".rmg-name__zh")),(0,b.Z)(e.querySelectorAll(".rmg-name__en"))).map((function(n){return n.innerHTML})).join("").replace(/[\s]/g,""))).join(""),n.next=3,document.fonts.load("80px GenYoMin TW, Vegur",t);case 3:return r=n.sent,i=Array.from(document.querySelector("link#css_share").sheet.cssRules[0].styleSheet.cssRules),o=r.reduce((function(n,e){var t,r=(t=e,i.find((function(n){var e=n.style;return e.fontFamily.replace(/^"(.+)"$/,"$1")===t.family&&e.unicodeRange===t.unicodeRange})));return r?n.find((function(n){var e=n.style,t=r.style;return e.fontFamily===t.fontFamily&&e.unicodeRange===t.unicodeRange}))?n:n.concat(r):n}),[]),n.next=8,Promise.all(o.map(function(){var n=(0,xn.Z)(bn().mark((function n(e){var t,r;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(zn(e));case 3:return t=n.sent,n.t0=wn,n.next=7,t.blob();case 7:return n.t1=n.sent,n.next=10,(0,n.t0)(n.t1);case 10:return r=n.sent,n.abrupt("return",e.cssText.replace(/src:[ \w('",\-:/.)]+;/g,"src: url('".concat(r,"'); ")));case 14:return n.prev=14,n.t2=n.catch(0),console.error(n.t2),n.abrupt("return","");case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e){return n.apply(this,arguments)}}()));case 8:return n.abrupt("return",n.sent);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),zn=function(n){var e,t=n.style.src;return gn()?t.replace(/^url\("([\S]+)"\).*$/,"$1"):"/rmg/styles/"+(null===(e=t.match(/^url\("([\S*]+)"\)/))||void 0===e?void 0:e[1])},Mn=function(){var n=(0,xn.Z)(bn().mark((function n(e,t,r){var i,o,s,a;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.viewBox.baseVal.width,o=e.viewBox.baseVal.height,(s=document.querySelectorAll("canvas")[0]).width=Number(i)*window.devicePixelRatio*t,s.height=Number(o)*window.devicePixelRatio*t,e.setAttribute("width",s.width.toString()),e.setAttribute("height",s.height.toString()),(a=s.getContext("2d")).clearRect(0,0,s.width,s.height),e.querySelectorAll(".rmg-name__en.rmg-name__mtr--station").forEach((function(n){return n.setAttribute("font-size","11px")})),e.querySelectorAll(".rmg-name__en.rmg-name__gzmtr--next2-dest").forEach((function(n){return n.setAttribute("font-size","8.5px")})),e.querySelectorAll("text, tspan").forEach((function(n){var e=window.getComputedStyle(n);n.setAttribute("font-family",e.fontFamily),n.setAttribute("fill",e.fill),n.setAttribute("dominant-baseline",e.dominantBaseline),n.setAttribute("text-anchor",e.textAnchor||"")})),n.abrupt("return",new Promise((function(n,t){var i=new Image;i.onload=function(){setTimeout((function(){a.drawImage(i,0,0,s.width,s.height),s.toBlob((function(e){return n(e)}),"image/png")}),r?2e3:0)},i.onerror=t,i.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.outerHTML)))})));case 13:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}(),kn=t(17253);function An(n){var e=n.isOpen,t=n.onClose,u=(0,i.$)().t,h=(0,a.u5)(),j=(0,r.useState)(""),g=(0,f.Z)(j,2),x=g[0],b=g[1],y=(0,r.useState)(!1),C=(0,f.Z)(y,2),Z=C[0],z=C[1],M=(0,r.useState)(!1),k=(0,f.Z)(M,2),A=k[0],O=k[1],P=(0,r.useState)(100),F=(0,f.Z)(P,2),E=F[0],R=F[1],_=(0,r.useState)("png"),N=(0,f.Z)(_,2),T=N[0],B=N[1],U=(0,a.Qy)((function(n){return n.app.canvasToShow})),D=(0,a.Qy)((function(n){return n.param})),W=D.style,L=D.stn_list,Q=D.current_stn_idx,H=D.line_name;(0,r.useEffect)((function(){""===x||U.includes(x)||b("")}),[U]);var V=c.tK[W].reduce((function(n,e){return U.includes(e)?(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e,u("CanvasType."+e))):(0,I.Z)({},n)}),{"":u("DownloadModal.pleaseSelect")}),G=[25,33,50,67,75,80,90,100,110,125,150,175,200,250,300,400,500].reduce((function(n,e){return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e,"".concat(e,"%")))}),{}),$={png:u("DownloadModal.png"),svg:u("DownloadModal.svg")},J=[{type:"select",label:u("DownloadModal.canvas"),value:x,options:V,disabledOptions:[""],onChange:function(n){return b(n)},minW:"full"},{type:"switch",label:u("DownloadModal.transparent"),isChecked:Z,onChange:z,oneLine:!0,minW:"full"},{type:"switch",label:u("DownloadModal.showBorder"),isChecked:A,onChange:O,oneLine:!0,minW:"full"},{type:"select",label:u("DownloadModal.scale"),value:E,options:G,onChange:function(n){return R(n)}},{type:"select",label:u("DownloadModal.format"),value:T,options:$,onChange:function(n){return B(n)}}],q=function(){var n=(0,xn.Z)(bn().mark((function n(e){var r,i,o,s,a,u,f,p,j,g,v;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:h((0,l.ef)(0)),r="current"===e?[Q]:Object.keys(L).filter((function(n){return!["linestart","lineend"].includes(n)})),i=new(Sn()),n.t0=bn().keys(r);case 4:if((n.t1=n.t0()).done){n.next=28;break}return o=n.t1.value,h((0,l.ef)((Number(o)+1)/r.length*100)),s=r[o],h((0,d.lS)(s)),n.next=11,(0,kn.aA)(500);case 11:return n.next=13,Cn(x,W,Z,A,E);case 13:if(a=n.sent,document.body.appendChild(a),u="rmg.".concat(s,".").concat(L[s].name[0],".").concat(L[s].name[1]).replaceAll(/\\|\/|\||\*|:|\?|<|>|"/g,"_"),"png"!==T){n.next=24;break}return f=gn()&&"0"===o,n.next=20,Mn(a,E/100,f);case 20:p=n.sent,r.length>1?i.file("".concat(u,".png"),p):pn("".concat(u,".png"),p),n.next=25;break;case 24:"svg"===T&&(a.removeAttribute("height"),j="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a.outerHTML))),r.length>1?i.file("".concat(u,".svg"),j.split("base64,")[1],{base64:!0}):mn(u+".svg","image/svg+xml",a.outerHTML));case 25:document.body.removeChild(a),n.next=4;break;case 28:if(!(r.length>1)){n.next=34;break}return n.next=31,i.generateAsync({type:"blob"});case 31:g=n.sent,v="rmg.".concat(H[0],".").concat(H[1],".zip").replaceAll(" ","_"),pn(v,g);case 34:m.ZP.event(c.zW.DOWNLOAD_IMAGES,{canvasToDownload:x,style:W,option:e,format:T}),h((0,d.lS)(Q)),h((0,l.Vg)()),t();case 38:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,p.jsxs)(w.u_,{isOpen:e,onClose:t,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[(0,p.jsx)(w.xB,{children:u("DownloadModal.title")}),(0,p.jsx)(w.ol,{}),(0,p.jsx)(w.fe,{children:(0,p.jsx)(s.M5,{fields:J})}),(0,p.jsx)(w.mz,{children:(0,p.jsxs)(o.Ug,{children:[(0,p.jsx)(v.zx,{colorScheme:"primary",variant:"outline",size:"sm",onClick:function(){return q("current")},disabled:!x,children:u("DownloadModal.downloadOne")}),W!==c.RM.GZMTR&&(0,p.jsx)(v.zx,{colorScheme:"primary",variant:"outline",size:"sm",onClick:function(){return q("all")},disabled:!x,children:u("DownloadModal.downloadAll")})]})})]})]})}function On(){var n=(0,i.$)().t,e=(0,r.useState)(!1),t=(0,f.Z)(e,2),o=t[0],s=t[1],l=(0,a.Qy)((function(n){return n.param}));return(0,p.jsxs)(fn.v2,{children:[(0,p.jsx)(fn.j2,{as:v.zx,variant:"ghost",size:"sm",rightIcon:(0,p.jsx)(y.Yc6,{}),children:n("DownloadActions.downloads")}),(0,p.jsxs)(fn.qy,{children:[(0,p.jsx)(fn.sN,{onClick:function(){mn("RMG_".concat((new Date).valueOf(),".json"),"application/json",JSON.stringify(l)),m.ZP.event(c.zW.DOWNLOAD_PARAM,{style:l.style})},children:n("DownloadActions.configFile")}),(0,p.jsx)(fn.sN,{onClick:function(){return s(!0)},children:n("DownloadActions.images")})]}),(0,p.jsx)(An,{isOpen:o,onClose:function(){return s(!1)}})]})}function Pn(n){var e,t,r,o=n.isOpen,a=n.onClose,l=n.cancelRef,u=n.uploadedParam,d=n.onOpenParam,h=(0,i.$)().t;return(0,p.jsx)(w.aR,{isOpen:o,leastDestructiveRef:l,onClose:a,children:(0,p.jsx)(w.dh,{children:(0,p.jsxs)(w._T,{children:[(0,p.jsx)(w.fY,{fontSize:"lg",fontWeight:"bold",children:h("UploadConfirmModal.title")}),(0,p.jsxs)(w.iP,{children:[h("UploadConfirmModal.message1"),(0,p.jsx)(s.l2,{name:(null===u||void 0===u||null===(e=u.line_name)||void 0===e?void 0:e.join(" "))||"",fg:(null===u||void 0===u||null===(t=u.theme)||void 0===t?void 0:t[3])||c.AJ.white,bg:(null===u||void 0===u||null===(r=u.theme)||void 0===r?void 0:r[2])||"#AAAAAA"}),h("UploadConfirmModal.message2")+(u?Object.keys(u.stn_list).length-2:0)+h("UploadConfirmModal.message3")]}),(0,p.jsxs)(w.xo,{children:[(0,p.jsx)(v.zx,{ref:l,onClick:a,children:h("Cancel")}),(0,p.jsx)(v.zx,{colorScheme:"primary",onClick:function(){u&&d(u),a(),m.ZP.event(c.zW.UPLOAD_PARAM,{style:null===u||void 0===u?void 0:u.style})},ml:3,children:h("Confirm")})]})]})})})}var Fn=t(2858),En=t(69076),Rn={flexDirection:"column",justifyContent:"center",alignItems:"flex-start",h:10,overflow:"hidden","& span:first-of-type":{maxW:"100%",textOverflow:"ellipsis"},"& span:last-of-type":{fontWeight:"normal",fontSize:"2xs"}};function _n(n){var e=n.isOpen,r=n.onClose,s=n.onOpenParam,u=(0,i.$)().t,d=(0,a.u5)(),h=function(){var n=(0,xn.Z)(bn().mark((function n(e,r){var i;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return d((0,l.Av)()),n.next=3,t(91427)("./".concat(e,"/").concat(r,".json"));case 3:i=n.sent,s(i.default),m.ZP.event(c.zW.OPEN_TEMPLATE,{company:e,filename:r});case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return(0,p.jsxs)(w.u_,{isOpen:e,onClose:r,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[(0,p.jsx)(w.xB,{children:u("TemplateModal.title")}),(0,p.jsx)(w.ol,{}),(0,p.jsx)(w.fe,{children:(0,p.jsxs)(Z.mQ,{isLazy:!0,size:"sm",orientation:"vertical",colorScheme:"primary",children:[(0,p.jsx)(Z.td,{maxW:150,children:En.p.map((function(n){return(0,p.jsx)(Z.OK,{children:(0,Fn.O9)(n.name)},n.id)}))}),(0,p.jsx)(Z.nP,{maxW:250,children:Object.entries(En.Q).sort((function(n,e){return En.p.findIndex((function(e){return e.id===n[0]}))-En.p.findIndex((function(n){return n.id===e[0]}))})).map((function(n){var e=(0,f.Z)(n,2),t=e[0],r=e[1];return(0,p.jsx)(Z.x4,{as:o.kC,flexDirection:"column",py:0,px:1,children:r.map((function(n){var e;return(0,p.jsxs)(v.zx,{variant:"ghost",size:"sm",sx:Rn,onClick:function(){return h(t,n.filename)},children:[(0,p.jsx)("span",{children:(0,Fn.O9)(n.name)}),(0,p.jsxs)(o.xv,{as:"span",children:[u("by"),": ",null!==(e=n.uploadBy)&&void 0!==e?e:"Unknown"]})]},n.filename)}))},t)}))})]})})]})]})}var Nn=t(28986),Tn=t(33963);function Bn(){var n=(0,i.$)(),e=n.t,t=n.i18n,o=(0,a.u5)(),s=(0,a.Qy)((function(n){return n.param.style})),u=(0,r.useState)(!1),d=(0,f.Z)(u,2),h=d[0],m=d[1],j=(0,r.useState)(!1),g=(0,f.Z)(j,2),x=g[0],b=g[1],S=(0,r.useState)(void 0),C=(0,f.Z)(S,2),w=C[0],Z=C[1],z=(0,r.useRef)(null),M=(0,r.useRef)(null),k=function(){var n=(0,xn.Z)(bn().mark((function n(t){var r,i,s,a;return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null===(r=t.target.files)||void 0===r?void 0:r[0],console.log("OpenActions.handleUpload():: received file",i),"application/json"===(null===i||void 0===i?void 0:i.type)){n.next=6;break}o((0,l.bI)({status:"error",message:e("OpenActions.invalidType")})),n.next=19;break;case 6:return n.prev=6,n.next=9,jn(i);case 9:s=n.sent,a=(0,kn.db)(JSON.parse(s)),Z(a),m(!0),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(6),o((0,l.bI)({status:"error",message:e("OpenActions.unknownError")})),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",n.t0);case 19:t.target.value="";case 20:case"end":return n.stop()}}),n,null,[[6,15]])})));return function(e){return n.apply(this,arguments)}}(),A=function(n){o(function(n){return function(e,t){var r=(0,kn.db)(n);e((0,l.B4)(c.Sg.CLOSE)),e((0,l.NQ)("linestart"));var i=t().app.canvasToShow;c.tK[r.style].every((function(n){return!i.includes(n)}))&&e((0,l.a9)(Object.values(c.Ht))),(0,Nn.P)(r),e((0,l.Vg)())}}(n))};return(0,p.jsxs)(fn.v2,{children:[(0,p.jsx)(fn.j2,{as:v.zx,variant:"ghost",size:"sm",rightIcon:(0,p.jsx)(y.Yc6,{}),children:e("OpenActions.openFrom")}),(0,p.jsxs)(fn.qy,{children:[(0,p.jsx)(fn.sN,{icon:(0,p.jsx)(y.KVB,{}),onClick:function(){return A((0,Tn.R)(s,t.language))},children:e("Empty template")}),(0,p.jsx)("input",{ref:M,type:"file",accept:".json",hidden:!0,onChange:k,"data-testid":"file-upload"}),(0,p.jsx)(fn.sN,{icon:(0,p.jsx)(y.Ap8,{}),onClick:function(){var n;return null===M||void 0===M||null===(n=M.current)||void 0===n?void 0:n.click()},children:e("OpenActions.upload")}),(0,p.jsx)(fn.sN,{icon:(0,p.jsx)(y.uEt,{}),onClick:function(){return b(!0)},children:e("OpenActions.templates")})]}),(0,p.jsx)(Pn,{isOpen:h,onClose:function(){return m(!1)},cancelRef:z,uploadedParam:w,onOpenParam:A}),(0,p.jsx)(_n,{isOpen:x,onClose:function(){return b(!1)},onOpenParam:A})]})}function Un(){var n=(0,i.$)().t,e=(0,u.I0)();return(0,p.jsxs)(o.Ug,{ml:"auto",w:"fit-content",children:[(0,p.jsx)(On,{}),(0,p.jsx)(Bn,{}),(0,p.jsx)(v.zx,{variant:"solid",size:"sm",colorScheme:"primary",leftIcon:(0,p.jsx)(y.Zox,{}),onClick:function(){return e((0,l.B4)(c.Sg.STYLE))},children:n("HeaderActions.editStyle")})]})}function Dn(){var n=(0,i.$)().t,e=(0,h.s0)(),t=(0,a.u5)(),r=(0,a.Qy)((function(n){return n.app})),o=r.canvasToShow,u=r.canvasScale,f=(0,a.Qy)((function(n){return n.param.style})),m=Object.values(c.RM).reduce((function(e,t){return(0,I.Z)((0,I.Z)({},e),{},(0,S.Z)({},t,n("RmgStyle."+t)))}),{}),j=c.tK[f].map((function(e){return{label:n("CanvasType."+e),value:e}})),g=[{type:"select",label:n("Style"),value:f,options:m,onChange:function(n){return function(n){e("/"+n),t((0,d.yL)(n))}(n)}},{type:"custom",label:n("View"),component:(0,p.jsx)(s.ap,{displayValue:n("Select canvas"),selections:j,defaultValue:o,onChange:function(n){return t((0,l.a9)(n))}})},{type:"slider",label:n("Canvas scale"),value:u,min:.1,max:2,step:.1,onChange:function(n){return t((0,l.b5)(n))},leftIcon:(0,p.jsx)(y._a6,{}),rightIcon:(0,p.jsx)(y.Ers,{})}];return(0,p.jsxs)(s.ig,{children:[(0,p.jsx)(s.M5,{fields:g,minW:160}),(0,p.jsx)(Un,{})]})}var In=t(30606),Wn=t(77817),Ln=t(62157),Qn=["52PD","linchen1965"],Hn=["jealousyge","Jay20081229","clearng-kly","Dingdong2334","C1P918R","AnDanJuneUnderline","GrassRabbit1410","xiany114514","Andy1782010","Thomastzc","Tianxiu11111"];function Vn(n){var e=n.isOpen,t=n.onClose,r=(0,i.$)().t,s=(0,C.ff)("primary.500","primary.300");return(0,p.jsxs)(w.u_,{isOpen:e,onClose:t,size:"xl",scrollBehavior:"inside",children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[(0,p.jsx)(w.xB,{children:r("Help and support")}),(0,p.jsx)(w.ol,{}),(0,p.jsxs)(w.fe,{children:[(0,p.jsx)(o.X6,{as:"h5",size:"sm",mb:2,children:r("Terms and conditions")}),(0,p.jsxs)(o.GS,{children:[(0,p.jsxs)(o.HC,{children:["The layout of the elements on the signage or rail map, is designed by"," ",(0,p.jsxs)(o.rU,{color:s,href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",(0,p.jsx)(z.JO,{as:y.jhj})]}),", ",(0,p.jsxs)(o.rU,{color:s,href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",(0,p.jsx)(z.JO,{as:y.jhj})]})," or ",(0,p.jsxs)(o.rU,{color:s,href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",(0,p.jsx)(z.JO,{as:y.jhj})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",(0,p.jsx)("br",{}),"\u6a19\u8a8c\u7248\u6216\u8def\u7dda\u5716\u4e4b\u5143\u7d20\u4e4b\u4f48\u5c40\uff0c\u57fa\u65bc\u4f60\u6240\u9078\u64c7\u4e4b\u98a8\u683c\uff0c\u70ba",(0,p.jsxs)(o.rU,{color:s,href:"https://www.gzmtr.com/",isExternal:!0,children:["\u5ee3\u5dde\u5730\u9435\u96c6\u5718\u516c\u53f8 ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\uff0c",(0,p.jsxs)(o.rU,{color:s,href:"https://www.mtr.com.hk/",isExternal:!0,children:["\u6e2f\u9435\u516c\u53f8 ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\u6216",(0,p.jsxs)(o.rU,{color:s,href:"https://www.shmetro.com/",isExternal:!0,children:["\u4e0a\u6d77\u7533\u901a\u5730\u9435\u96c6\u5718 ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\u6240\u8a2d\u8a08\u3002\u5728\u7522\u751f\u4e4b\u5716\u50cf\u7528\u4f5c\u5546\u696d\u7528\u9014\u524d\uff0c\u4f60\u61c9\u5411\u76f8\u95dc\u516c\u53f8\u53d6\u5f97\u9069\u7576\u4e4b\u8a31\u53ef\u8b49\u6216\u6388\u6b0a\u3002"]}),(0,p.jsxs)(o.HC,{children:["The elements including shapes and lines on the image are drawn by"," ",(0,p.jsxs)(o.rU,{color:s,href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",(0,p.jsx)(z.JO,{as:y.jhj})]})," and ",(0,p.jsxs)(o.rU,{color:s,href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",(0,p.jsx)(z.JO,{as:y.jhj})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",(0,p.jsx)("br",{}),"\u5716\u50cf\u4e4b\u5143\u7d20\uff0c\u5305\u62ec\u5716\u5f62\u53ca\u7dda\u689d\uff0c\u5747\u7531",(0,p.jsxs)(o.rU,{color:s,href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\u53ca",(0,p.jsxs)(o.rU,{color:s,href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\u57fa\u65bc\u4e0a\u8ff0\u516c\u53f8\u4e4b\u8a2d\u8a08\u6a19\u6e96\u6216\u6e96\u5247\u7e6a\u88fd\u3002\u4f60\u53ef\u5c07\u5176\u7528\u65bc\u4efb\u4f55\u76ee\u7684\uff0c\u4f46\u6211\u5011\u5efa\u8b70\u4f60\u65bc\u4f7f\u7528\u540c\u6642\u9644\u4ee5\u6211\u5011\u4e4b\u540d\u5b57\u4ee5\u53ca\u8a72\u8edf\u4ef6\u4e4b\u9023\u7d50\u3002"]}),(0,p.jsxs)(o.HC,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Generator uses"," ",(0,p.jsxs)(o.rU,{color:s,href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",(0,p.jsx)(z.JO,{as:y.jhj})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",(0,p.jsx)("br",{}),"\u7531\u65bc\u8457\u4f5c\u6b0a\u53ca\u5176\u4ed6\u6cd5\u5f8b\u9650\u5236\uff0c\u9435\u8def\u8def\u7dda\u5716\u7522\u751f\u5668\u4f7f\u7528",(0,p.jsxs)(o.rU,{color:s,href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["\u7531ButTaiwan\u63d0\u4f9b\u4e4b\u6e90\u6a23\u660e\u9ad4 ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\uff0c\u4ee5\u53caVegur\uff0c\u4ee5\u4ee3\u66ff\u6e2f\u9435\u6a23\u5f0f\u6a19\u8a8c\u724c\u6240\u4f7f\u7528\u4e4b\u5730\u9435\u5b8b\u53caMyriad Pro\u3002\u5728\u7522\u751f\u4e4b\u5716\u50cf\u7528\u4f5c\u5546\u696d\u7528\u9014\u524d\uff0c\u4f60\u61c9\u5411\u5b57\u578b\u751f\u7522\u5ee0\u5546\u53d6\u5f97\u9069\u7576\u4e4b\u8a31\u53ef\u8b49\u6216\u6388\u6b0a\u3002"]}),(0,p.jsxs)(o.HC,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes, under the conditions above.",(0,p.jsx)("br",{}),"\u8f38\u51fa\u4e4bPNG\u6216SVG\u7a2e\u985e\u4e4b\u5716\u50cf\u53ef\u57fa\u65bc\u4e0a\u8ff0\u689d\u6b3e\uff0c\u7528\u65bc\u4fee\u6539\u3001\u767c\u884c\u6216\u5176\u4ed6\u7528\u9014\u3002"]}),(0,p.jsxs)(o.HC,{children:["All flag emojis shown on Windows platforms are designed by"," ",(0,p.jsxs)(o.rU,{color:s,href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",(0,p.jsx)(z.JO,{as:y.jhj})]})," ","\u2013 the open-source emoji and icon project. License:",(0,p.jsxs)(o.rU,{color:s,href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",(0,p.jsx)(z.JO,{as:y.jhj})]}),(0,p.jsx)("br",{}),"\u65bcWindows\u4f5c\u696d\u7cfb\u7d71\u4e0a\u986f\u793a\u4e4b\u65d7\u5e5fEmoji\u70ba",(0,p.jsxs)(o.rU,{color:s,href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"\u6240\u8a2d\u8a08\u3002\u8a31\u53ef\u8b49\uff1a",(0,p.jsxs)(o.rU,{color:s,href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",(0,p.jsx)(z.JO,{as:y.jhj})]})]}),(0,p.jsxs)(o.HC,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",(0,p.jsx)("br",{}),"\u6211\u5011\u4fdd\u7559\u4fee\u6539\u3001\u65b0\u589e\u6216\u79fb\u9664\u4e0a\u8ff0\u689d\u6b3e\u4e4b\u6b0a\u5229\uff0c\u800c\u7121\u9700\u53e6\u884c\u901a\u77e5\u3002\u4e2d\u6587\u8b6f\u672c\u50c5\u4f9b\u53c3\u8003\uff0c\u6587\u7fa9\u5982\u8207\u82f1\u6587\u6709\u6b67\u7570\uff0c\u6982\u4ee5\u82f1\u6587\u672c\u70ba\u6e96\u3002"]})]}),(0,p.jsx)(o.X6,{as:"h5",size:"sm",mt:3,mb:2,children:r("Contributors")}),(0,p.jsx)(o.X6,{as:"h6",size:"xs",my:1,children:r("Core contributors")}),(0,p.jsxs)(o.gC,{children:[(0,p.jsxs)(Wn.Vp,{size:"lg",minW:"80%",onClick:function(){return window.open("https://github.com/wongchito","_blank")},cursor:"pointer",children:[(0,p.jsx)(Ln.qE,{src:"https://github.com/wongchito.png",size:"lg",my:2,ml:-1,mr:2}),(0,p.jsxs)(Wn.Sn,{display:"block",children:[(0,p.jsx)(o.xv,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Chito Wong"}),(0,p.jsx)(o.xv,{fontSize:"sm",children:"Project initiator"}),(0,p.jsx)(o.xv,{fontSize:"sm",children:"Author of MTR and Guangzhou Metro styles"})]})]}),(0,p.jsxs)(Wn.Vp,{size:"lg",minW:"80%",onClick:function(){return window.open("https://github.com/thekingofcity","_blank")},cursor:"pointer",children:[(0,p.jsx)(Ln.qE,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),(0,p.jsxs)(Wn.Sn,{display:"block",children:[(0,p.jsx)(o.xv,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),(0,p.jsx)(o.xv,{fontSize:"sm",children:"Author of Shanghai Metro style"}),(0,p.jsx)(o.xv,{fontSize:"sm",children:"Desktop version (Electron) maintainer"})]})]})]}),(0,p.jsx)(o.X6,{as:"h6",size:"xs",my:1,children:r("Resource contributors")}),(0,p.jsxs)(o.kC,{wrap:"wrap",children:[Qn.map((function(n){return(0,p.jsxs)(Wn.Vp,{size:"lg",mb:1,mr:1,flex:"100%",onClick:function(){return window.open("https://github.com/railmapgen/rmg/issues?q=is:issue+author:".concat(n),"_blank")},cursor:"pointer",children:[(0,p.jsx)(Ln.qE,{src:"https://github.com/".concat(n,".png"),size:"xs",ml:-1,mr:2}),(0,p.jsx)(Wn.Sn,{children:n}),(0,p.jsx)(Wn.Sn,{flexGrow:1}),(0,p.jsx)(Wn.Sn,{children:(0,p.jsx)(o.xv,{fontSize:"sm",children:r("Resource Administrator")})})]},n)})),Hn.map((function(n){return(0,p.jsxs)(Wn.Vp,{size:"lg",mb:1,mr:1,onClick:function(){return window.open("https://github.com/railmapgen/rmg/issues?q=is:issue+author:".concat(n),"_blank")},cursor:"pointer",children:[(0,p.jsx)(Ln.qE,{src:"https://github.com/".concat(n,".png"),size:"xs",ml:-1,mr:2}),(0,p.jsx)(Wn.Sn,{children:n})]},n)}))]}),(0,p.jsxs)(o.xv,{children:[r("Visit")," ",(0,p.jsxs)(o.rU,{color:s,href:"https://github.com/railmapgen/rmg/wiki/How-to-add-color-palette-and-line-templates",isExternal:!0,children:[r("Contribution Wiki")," ",(0,p.jsx)(z.JO,{as:y.jhj})]}),r(", open an issue and join us today!")]})]}),(0,p.jsx)(w.mz,{children:(0,p.jsx)(v.zx,{colorScheme:"primary",onClick:function(){return window.open("https://github.com/railmapgen/rmg","_blank")},children:r("Visit GitHub")})})]})]})}function Gn(){var n=(0,i.$)().t,e=(0,C.ff)("primary.500","primary.300"),t=(0,r.useState)(!1),a=(0,f.Z)(t,2),l=a[0],c=a[1],u=m.ZP.getEnv(),d=m.ZP.getAppVersion(),h=function(){var n=(0,xn.Z)(bn().mark((function n(e){return bn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:m.ZP.setLanguage(e),(0,Fn.ix)(e);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),j=(0,p.jsxs)(In.c,{i18nKey:"WindowHeader.popoverHeader",environment:u,children:["You're on ",{environment:u}," environment!"]}),g=(0,p.jsxs)(In.c,{i18nKey:"WindowHeader.popoverBody",children:["This is a testing environment where we don't guarantee the stability and compatibility. Please switch back to"," ",(0,p.jsxs)(o.rU,{color:e,href:"https://railmapgen.github.io"+window.location.pathname,isExternal:!0,children:["Production environment ",(0,p.jsx)(z.JO,{as:y.jhj})]}),"."]});return(0,p.jsxs)(s.Td,{children:[(0,p.jsx)(o.X6,{as:"h4",size:"md",children:n("Rail Map Generator")}),(0,p.jsx)(s.xt,{environment:u,version:d,popoverHeader:u===m.Sy.PRD?void 0:j,popoverBody:u===m.Sy.PRD?void 0:g}),(0,p.jsxs)(o.Ug,{ml:"auto",children:[(0,p.jsxs)(fn.v2,{children:[(0,p.jsx)(fn.j2,{as:v.hU,icon:(0,p.jsx)(y.mp2,{}),variant:"ghost",size:"sm"}),(0,p.jsxs)(fn.qy,{children:[(0,p.jsx)(fn.sN,{onClick:function(){return h(O.s.English)},children:"English"}),(0,p.jsx)(fn.sN,{onClick:function(){return h(O.s.ChineseSimp)},children:"\u7b80\u4f53\u4e2d\u6587"}),(0,p.jsx)(fn.sN,{onClick:function(){return h(O.s.ChineseTrad)},children:"\u7e41\u9ad4\u4e2d\u6587"})]})]}),(0,p.jsx)(v.hU,{size:"sm",variant:"ghost","aria-label":"Help",icon:(0,p.jsx)(y.r$n,{}),onClick:function(){return c(!0)}})]}),(0,p.jsx)(Vn,{isOpen:l,onClose:function(){return c(!1)}})]})}var $n=t(47552),Jn=t(25984),qn=function(n,e,t,r){return function(i,o){for(var s=o().param.stn_list,a=(0,Jn.x0)(6);a in s;)a=(0,Jn.x0)(6);var l,u=(0,Tn.o)(a);if("new"!==n){var h,f=(0,I.Z)((0,I.Z)({},s),{},(h={},(0,S.Z)(h,e,(0,I.Z)((0,I.Z)({},s[e]),{},{children:s[e].children.map((function(n){return n===t?a:n})),branch:{left:s[e].branch.left,right:s[e].branch.right.length&&s[e].branch.right[1]===t?[s[e].branch.right[0],a]:s[e].branch.right}})),(0,S.Z)(h,t,(0,I.Z)((0,I.Z)({},s[t]),{},{parents:s[t].parents.map((function(n){return n===e?a:n})),branch:{left:s[t].branch.left.length&&s[t].branch.left[1]===e?[s[t].branch.left[0],a]:s[t].branch.left,right:s[t].branch.right}})),(0,S.Z)(h,a,(0,I.Z)((0,I.Z)({},u),{},{parents:[e],children:[t]})),h));return i((0,d.BI)(f)),a}if(!r)return!1;var m=(0,I.Z)((0,I.Z)({},s),{},(l={},(0,S.Z)(l,e,(0,I.Z)((0,I.Z)({},s[e]),{},{children:"upper"===r?[a,s[e].children[0]]:[s[e].children[0],a],branch:{left:s[e].branch.left,right:[c.H_.through,a]}})),(0,S.Z)(l,t,(0,I.Z)((0,I.Z)({},s[t]),{},{parents:"upper"===r?[a,s[t].parents[0]]:[s[t].parents[0],a],branch:{left:[c.H_.through,a],right:s[t].branch.right}})),(0,S.Z)(l,a,(0,I.Z)((0,I.Z)({},u),{},{parents:[e],children:[t]})),l));return i((0,d.BI)(m)),a}},Xn=function(n,e){return function(t,r){var i=r().param.stn_list,o=r().helper.branches;return o[0].includes(n)&&o[0].includes(e)?o[0].indexOf(n)>=o[0].indexOf(e)?"Not in correct ordering":"linestart"===n&&"lineend"===e?"Should not be parallel to main line":"linestart"===n&&1===o[0].indexOf(e)?"Branch should not be open jaw from the first station":"lineend"===e&&o[0].indexOf(n)===o[0].length-2?"Branch should not be open jaw from the last station":i[n].children.length>1||i[e].parents.length>1?"Branch already exist":o.slice(1).some((function(t){return t.slice(1,-1).includes(n)||t.slice(1,-1).includes(e)}))?"Cannot branch out from existing branch":o[0].slice(o[0].indexOf(n)+1,o[0].indexOf(e)).every((function(n){return 1===i[n].parents.length&&1===i[n].children.length}))?"":"One or more stations between both ends are branching out":"Branch should end at main line"}};function Yn(n){var e,t,u=n.isOpen,d=n.onClose,h=(0,i.$)().t,j=(0,a.u5)(),g=(0,a.Qy)((function(n){return n.app.selectedBranch})),x=(0,a.Qy)((function(n){return n.param})),b=x.style,y=x.stn_list,C=(0,a.Qy)((function(n){return n.helper.branches})),Z=(0,r.useState)(g),z=(0,f.Z)(Z,2),M=z[0],k=z[1],A=(0,r.useState)("before"),O=(0,f.Z)(A,2),P=O[0],F=O[1],E=(0,r.useState)(""),R=(0,f.Z)(E,2),_=R[0],N=R[1],T=(0,r.useState)(!1),B=(0,f.Z)(T,2),U=B[0],D=B[1];(0,r.useEffect)((function(){k(g)}),[g]),(0,r.useEffect)((function(){u||D(!1)}),[u]);var W,L=null!==(e=null===(t=C[Number(M)])||void 0===t?void 0:t.slice(1,-1))&&void 0!==e?e:[],Q=[{type:"select",label:h("AddStationModal.where"),value:M,options:(0,I.Z)({},C.reduce((function(n,e,t){return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},t,0===t?h("AddStationModal.main"):b===c.RM.SHMetro&&(0,Y.Qo)(e,y)?h("AddStationModal.external")+" "+t:h("AddStationModal.branch")+" "+t))}),{})),onChange:function(n){return H(n)},minW:"full"},{type:"select",label:h("AddStationModal.preposition"),value:P,options:{before:h("AddStationModal.before"),after:h("AddStationModal.after")},onChange:function(n){return F(n)}},{type:"select",label:h("AddStationModal.pivot"),value:_,options:(W=L,W.reduce((function(n,e){var t;return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e,null===(t=y[e])||void 0===t?void 0:t.name.join(" - ")))}),{"":h("AddStationModal.pleaseSelect")})),disabledOptions:[""],onChange:function(n){return N(n)}}],H=function(n){k(n),N("")};return(0,p.jsxs)(w.u_,{isOpen:u,onClose:d,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[U&&(0,p.jsxs)(q.bZ,{status:"error",variant:"solid",size:"xs",children:[(0,p.jsx)(q.zM,{}),h("AddStationModal.error")]}),(0,p.jsxs)(o.xu,{position:"relative",children:[(0,p.jsx)(w.xB,{children:h("AddStationModal.title")}),(0,p.jsx)(w.ol,{})]}),(0,p.jsx)(w.fe,{children:(0,p.jsx)(s.M5,{fields:Q})}),(0,p.jsx)(w.mz,{children:(0,p.jsx)(v.zx,{colorScheme:"primary",onClick:function(){var n=j(function(n,e,t){return function(r,i){var o=i().helper.branches[n];if(null!==o&&void 0!==o&&o.length){if("before"===e){var s=o[o.indexOf(t)-1];return r(qn(n.toString(),s,t))}var a=o[o.indexOf(t)+1];return r(qn(n.toString(),t,a))}return!1}}(M,P,_));n?(d(),j((0,l.NQ)(n)),j((0,l.B4)(c.Sg.STATION))):(console.log("false here"),D(!0)),m.ZP.event(c.zW.ADD_STATION,{style:b,branchIndex:M,success:n})},disabled:!_,children:h("Confirm")})})]})]})}function Kn(n){var e=n.isOpen,t=n.onClose,o=(0,i.$)().t,l=(0,a.u5)(),u=(0,r.useState)("new"),d=(0,f.Z)(u,2),h=d[0],j=d[1],g=(0,r.useState)(""),x=(0,f.Z)(g,2),b=x[0],y=x[1],C=(0,r.useState)(""),Z=(0,f.Z)(C,2),z=Z[0],M=Z[1],k=(0,r.useState)("upper"),A=(0,f.Z)(k,2),O=A[0],P=A[1],F=(0,r.useState)(""),E=(0,f.Z)(F,2),R=E[0],_=E[1],N=(0,r.useState)(""),T=(0,f.Z)(N,2),B=T[0],U=T[1],D=(0,a.Qy)((function(n){return n.param})),W=D.style,L=D.stn_list;(0,r.useEffect)((function(){e||(j("new"),y(""),M(""))}),[e]);var Q,H=(Q=l((function(n,e){var t=e().param.stn_list;return e().helper.branches[0].filter((function(n){var e=t[n].parents.length+t[n].children.length===4,r=0===X(n,t);return!e&&r}))})),Q.reduce((function(n,e){var t;return(0,I.Z)((0,I.Z)({},n),{},(0,S.Z)({},e,null===(t=L[e])||void 0===t?void 0:t.name.join(" - ")))}),{"":o("NewBranchModal.pleaseSelect")})),V=[{type:"select",label:o("NewBranchModal.where"),value:h,options:{new:o("NewBranchModal.new"),ext:o("NewBranchModal.ext")},disabledOptions:W===c.RM.SHMetro?[]:["ext"],onChange:function(n){return G(n)},minW:"full"},{type:"select",label:o("NewBranchModal.from"),value:b,options:H,disabledOptions:[""],onChange:function(n){return $(n)},isInvalid:Boolean(R)},{type:"select",label:o("NewBranchModal.to"),value:z,options:H,disabledOptions:[""],onChange:function(n){return J(n)},isInvalid:Boolean(B)},{type:"select",label:o("NewBranchModal.position"),value:O,options:{upper:o("NewBranchModal.upper"),lower:o("NewBranchModal.lower")},onChange:function(n){return P(n)},minW:"full",hidden:"new"!==h||W===c.RM.SHMetro}],G=function(n){j(n),y(""),M(""),_(""),U("")},$=function(n){y(n),_(""),n&&z&&U(l(Xn(n,z)))},J=function(n){M(n),U(""),b&&n&&_(l(Xn(b,n)))},q=Boolean(!b||!z||R||B);return(0,p.jsxs)(w.u_,{isOpen:e,onClose:t,children:[(0,p.jsx)(w.ZA,{}),(0,p.jsxs)(w.hz,{children:[(0,p.jsx)(w.xB,{children:o("NewBranchModal.title")}),(0,p.jsx)(w.ol,{}),(0,p.jsx)(w.fe,{children:(0,p.jsx)(s.M5,{fields:V})}),(0,p.jsx)(w.mz,{children:(0,p.jsx)(v.zx,{colorScheme:"primary",title:q?R||B:o("Confirm"),onClick:function(){("ext"===h?l(qn("new",b,z,"lower")):W===c.RM.SHMetro?l(qn("new",b,z,"upper")):l(qn("new",b,z,O)))&&(t(),m.ZP.event(c.zW.ADD_BRANCH,{style:W,where:h}))},disabled:q,children:o("Confirm")})})]})]})}var ne=(0,r.lazy)((function(){return Promise.all([t.e(2953),t.e(1985)]).then(t.bind(t,34523))}));function ee(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,r.useState)(!1),u=(0,f.Z)(t,2),d=u[0],h=u[1],m=(0,r.useState)(!1),j=(0,f.Z)(m,2),g=j[0],x=j[1],b=(0,a.Qy)((function(n){return n.app.selectedBranch})),S=(0,a.Qy)((function(n){return n.param})),C=S.style,w=S.stn_list,z=(0,a.Qy)((function(n){return n.helper.branches}));return(0,p.jsxs)(o.xu,{flex:1,overflow:"hidden",children:[(0,p.jsxs)(Z.mQ,{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",index:b,onChange:function(n){return e((0,l.Pg)(n))},children:[(0,p.jsxs)(Z.td,{children:[z.map((function(e,t){return 0===t?(0,p.jsx)(Z.OK,{children:n("GridTabs.main")},t):C===c.RM.SHMetro&&(0,Y.Qo)(e,w)?(0,p.jsx)(Z.OK,{children:n("GridTabs.external")+" "+t},t):(0,p.jsx)(Z.OK,{children:n("GridTabs.branch")+" "+t},t)})),(0,p.jsx)(v.hU,{size:"sm",variant:"ghost",alignSelf:"center","aria-label":"New branch",onClick:function(){return x(!0)},icon:(0,p.jsx)(y.x06,{})}),(0,p.jsxs)(o.Ug,{marginLeft:"auto",marginRight:1,children:[(0,p.jsx)(v.zx,{variant:"outline",size:"xs",leftIcon:(0,p.jsx)(y.x06,{}),onClick:function(){return h(!0)},children:n("GridTabs.addStation")}),(0,p.jsx)(v.zx,{size:"xs",colorScheme:"primary",onClick:function(){e((0,l.B4)(c.Sg.BRANCH))},children:n("GridTabs.editLine")})]})]}),(0,p.jsx)(Z.nP,{flex:1,overflowY:"auto",children:z.map((function(n,e){return(0,p.jsx)(Z.x4,{padding:0,h:"100%",children:(0,p.jsx)(s.sS,{suspenseFallback:(0,p.jsx)($n.Ex,{isIndeterminate:!0}),children:(0,p.jsx)(ne,{branchIndex:e})})},e)}))})]}),(0,p.jsx)(Yn,{isOpen:d,onClose:function(){return h(!1)}}),(0,p.jsx)(Kn,{isOpen:g,onClose:function(){return x(!1)}})]})}var te=t(73715);function re(){var n=(0,a.u5)(),e=(0,a.Qy)((function(n){return n.app.globalAlerts}));return(0,p.jsx)(p.Fragment,{children:Object.entries(e).map((function(e){var t=(0,f.Z)(e,2),r=t[0],i=t[1],s=i.message,a=i.url,c=i.linkedApp;return(0,p.jsxs)(q.bZ,{status:r,variant:"solid",size:"xs",pl:3,pr:1,py:0,children:[(0,p.jsx)(q.zM,{}),c?(0,p.jsx)(o.rU,{onClick:function(){return function(n){m.ZP.isStandaloneWindow()?window.open("/".concat(n),"_blank"):m.ZP.openApp(n)}(c)},children:s}):a?(0,p.jsx)(o.rU,{href:a,target:"_blank",children:s}):s,(0,p.jsx)(te.P,{ml:"auto",onClick:function(){return n((0,l.sy)(r))}})]},r)}))})}function ie(){var n=(0,i.$)().t,e=(0,a.u5)(),t=(0,a.Qy)((function(n){return n.app.isLoading}));return(0,r.useEffect)((function(){var t=setTimeout((function(){e((0,l.bI)({status:"info",message:n("rmpPromotion"),linkedApp:"rmp"}))}),1e3);return function(){return clearTimeout(t)}}),[]),(0,p.jsxs)(s.xA,{children:[t&&(0,p.jsx)(s.xG,{isIndeterminate:t<0,value:t>=0?t:void 0}),(0,p.jsx)(Gn,{}),(0,p.jsxs)(s.uo,{children:[(0,p.jsx)(Dn,{}),(0,p.jsx)(re,{}),(0,p.jsxs)(o.kC,{flex:1,overflow:"hidden",position:"relative",children:[(0,p.jsxs)(o.kC,{as:"section",direction:"column",flex:1,ml:1,mr:1,overflow:"hidden",children:[(0,p.jsx)(o.xu,{children:(0,p.jsx)(g,{})}),(0,p.jsx)(ee,{})]}),(0,p.jsx)(hn,{})]})]}),(0,p.jsx)("canvas",{style:{display:"none"}})]})}},36705:function(n,e,t){"use strict";t.d(e,{Qo:function(){return d},ku:function(){return f},z7:function(){return m},_G:function(){return j},NC:function(){return g},_g:function(){return x},l$:function(){return v},wX:function(){return b},Di:function(){return y}});var r=t(45987),i=t(49142),o=t(4942),s=t(1413),a=t(29439),l=t(93433),c=t(50533),u=t(25984);var d=function(n,e){return!!e[n[0]].children.indexOf(n[1])},h=function(n,e){return[n[0][1],n[0][n[0].length-2]].concat((0,l.Z)(n[0].filter((function(t){return n.slice(1).filter((function(n){return d(n,e)})).map((function(n){return n.filter((function(n){return!["linestart","lineend"].includes(n)}))})).map((function(n){return[n[0],n[n.length-1]]})).flat().includes(t)}))))},f=function(n){return function(e,t){var r=t().helper.branches;if(0===n){var i=t().param.stn_list,o=h(r,i);return function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.reduce((function(n,e){return n.map((function(n){return e.map((function(e){return n.concat([e])}))})).reduce((function(n,e){return n.concat(e)}),[])}),[[]])}(o,o).filter((function(n){return n[0]!==n[1]}))}var s=r[n];if(s){var a=s.filter((function(n){return!["linestart","lineend"].includes(n)}));return[[a[0],a.slice(-1)[0]]]}return[]}},m=function(n,e){return function(t,r){for(var i=r().param.coline,o=r().helper.branches[e],s=0,l=Object.entries(i);s<l.length;s++){var c=(0,a.Z)(l[s],2),u=c[0],d=c[1];if(d.from===n&&o.includes(d.to)){var h=o.indexOf(n),f=o.indexOf(d.to);if(f>h)return[f-h+1,u]}else if(d.to===n&&o.includes(d.to)){var m=o.indexOf(n),p=o.indexOf(d.from);if(p>m)return[p-m+1,u]}}return[0,void 0]}},p=function(n,e){return function(t,r){var i=r().param.stn_list,o=r().helper.branches;if(n===e)throw new Error("addColine():: failed for same stnId");var s=h(o,i).filter((function(t){return[n,e].includes(t)})),a=function(n,e){return n.slice(1).filter((function(n){return d(n,e)})).map((function(n){return n.filter((function(n){return!["linestart","lineend"].includes(n)}))})).map((function(n){return[n[0],n[n.length-1]]}))}(o,i).filter((function(t){return[n,e].every((function(n){return t.includes(n)}))}));if(2===s.length&&a.length>0)throw new Error("addColine():: main check failed for ".concat(n,", ").concat(e));if(2!==s.length&&1!==a.length)throw new Error("addColine():: branch check failed for ".concat(n,", ").concat(e))}},j=function(n){return function(e,t){var r=t().param.coline,i=t().helper.branches[n];return i?Object.entries(r).reduce((function(n,e){return i.includes(e[1].from)&&i.includes(e[1].to)?(0,s.Z)((0,s.Z)({},n),{},(0,o.Z)({},e[0],e[1])):(0,s.Z)({},n)}),{}):{}}},g=function(n){return function(e,t){var r=t().param.coline;if(0!==Object.keys(r).length){var i=Object.entries(r).reduce((function(e,t){return t[1].from!==n&&t[1].to!==n?(0,s.Z)((0,s.Z)({},e),{},(0,o.Z)({},t[0],t[1])):(0,s.Z)({},e)}),{});e((0,c.tA)(i))}}},x=function(n,e,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(i,a){var l=a().param.coline;i(p(n,e)),i((0,c.tA)((0,s.Z)((0,s.Z)({},l),{},(0,o.Z)({},(0,u.x0)(4),{from:n,to:e,colors:t,display:r}))))}},v=function(n,e,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(i,a){var l=a().param.coline;if(n in l){i(p(e,t));var u=(0,s.Z)((0,s.Z)({},l),{},(0,o.Z)({},n,(0,s.Z)((0,s.Z)({},l[n]),{},{from:e,to:t,display:r})));i((0,c.tA)(u))}}},b=function(n,e){return function(t,a){var l=a().param.coline;if(n in l&&l[n].colors.length>e){var u=l[n].colors.filter((function(n,t){return t!==e}));if(0===u.length){l[n];var d=(0,r.Z)(l,[n].map(i.Z));t((0,c.tA)(d))}else{var h=(0,s.Z)((0,s.Z)({},l),{},(0,o.Z)({},n,(0,s.Z)((0,s.Z)({},l[n]),{},{colors:u})));t((0,c.tA)(h))}}}},y=function(n,e,t){return function(r,i){var o=i().param.coline;n in o&&o[n].colors.length>e&&(o[n].colors=o[n].colors.map((function(n,r){return r===e?[0,1,2,3,4,5].map((function(e){return void 0===t[e]?n[e]:t[e]})):n})),r((0,c.tA)(o)))}}},33489:function(n,e,t){var r={"./gzmtr/index":[226,226],"./mtr/index":[31711,9014,1711],"./shmetro/index":[58049,9014,8049]};function i(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],i=e[0];return Promise.all(e.slice(1).map(t.e)).then((function(){return t(i)}))}i.keys=function(){return Object.keys(r)},i.id=33489,n.exports=i}}]);
//# sourceMappingURL=AppRoot.7650f4a4.chunk.js.map