(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[2377],{4018:function(n,e,t){var r={"./1F1E6-1F1F9.svg":[9121,9121],"./1F1E6-1F1FF.svg":[9427,9427],"./1F1E7-1F1F7.svg":[7304,7304],"./1F1E8-1F1E6.svg":[56,56],"./1F1E8-1F1F1.svg":[3450,3450],"./1F1E8-1F1F3.svg":[2537,2537],"./1F1E9-1F1EA.svg":[6311,6311],"./1F1EA-1F1EC.svg":[7365,7365],"./1F1EA-1F1F8.svg":[8721,8721],"./1F1EB-1F1F7.svg":[8514,8514],"./1F1EC-1F1F7.svg":[9515,9515],"./1F1ED-1F1F0.svg":[2248,2248],"./1F1ED-1F1FA.svg":[268,268],"./1F1EE-1F1F3.svg":[6236,6236],"./1F1EE-1F1F7.svg":[2617,2617],"./1F1EE-1F1F9.svg":[3541,3541],"./1F1EF-1F1F5.svg":[2741,2741],"./1F1F0-1F1F7.svg":[2255,2255],"./1F1F2-1F1F4.svg":[6435,6435],"./1F1F2-1F1FD.svg":[3086,3086],"./1F1F2-1F1FE.svg":[6082,6082],"./1F1F3-1F1F4.svg":[6095,6095],"./1F1F5-1F1EA.svg":[2955,2955],"./1F1F5-1F1F9.svg":[7791,7791],"./1F1F7-1F1F4.svg":[7224,7224],"./1F1F7-1F1FA.svg":[6031,6031],"./1F1F8-1F1EA.svg":[1550,1550],"./1F1F8-1F1EC.svg":[1229,1229],"./1F1F9-1F1F7.svg":[2237,2237],"./1F1F9-1F1FC.svg":[4252,4252],"./1F1FA-1F1F3.svg":[3353,3353],"./1F1FA-1F1F8.svg":[5439,5439],"./1F1FB-1F1F3.svg":[3886,3886],"./1F3F4-E0067-E0062-E0065-E006E-E0067-E007F.svg":[6129,6129],"./1F3F4-E0067-E0062-E0073-E0063-E0074-E007F.svg":[138,138]};function o(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],o=e[0];return t.e(e[1]).then((function(){return t.t(o,17)}))}o.keys=function(){return Object.keys(r)},o.id=4018,n.exports=o},7827:function(n,e,t){var r={"./athens.js":[6128,6869],"./baku.js":[2481,6810],"./barcelona.js":[6340,5792],"./beijing.js":[2145,2358],"./berlin.js":[7976,436],"./bucharest.js":[5249,5520],"./budapest.js":[8895,1321],"./cairo.js":[6509,5189],"./changsha.js":[574,6739],"./chengdu.js":[6312,7599],"./chongqing.js":[300,7081],"./daegu.js":[6995,4874],"./dalian.js":[5169,9186],"./delhi.js":[3707,8719],"./dongguan.js":[3280,7206],"./dortmund.js":[6079,134],"./edinburgh.js":[285,9770],"./eskisehir.js":[1686,8189],"./foshan.js":[3204,9898],"./frankfurt.js":[2040,4447],"./glasgow.js":[4476,1847],"./gothenburg.js":[6801,6951],"./guadalajara.js":[9399,1392],"./guangzhou.js":[5841,5449],"./hangzhou.js":[3427,17],"./hanoi.js":[507,8237],"./harbin.js":[4826,886],"./hochiminh.js":[6770,4788],"./hongkong.js":[4243,3106],"./istanbul.js":[3107,4073],"./jinan.js":[5719,5303],"./kansai.js":[382,310],"./kaohsiung.js":[3037,5081],"./klangvalley.js":[137,1951],"./kunming.js":[8852,8183],"./lima.js":[9118,8140],"./lisbon.js":[8814,3417],"./london.js":[8087,3875],"./macao.js":[8015,425],"./madrid.js":[8020,7826],"./milan.js":[4410,2028],"./munich.js":[7368,9890],"./nanjing.js":[1664,5944],"./naples.js":[3738,4737],"./newtaipei.js":[9114,3579],"./osaka.js":[1064,8975],"./oslo.js":[8057,1614],"./other.js":[7642,5066],"./ottawa.js":[254,2168],"./paris.js":[2720,743],"./qingdao.js":[7994,8291],"./rheinruhr.js":[6870,8413],"./sanfrancisco.js":[4747,6195],"./sanktpeterburg.js":[1832,441],"./santiago.js":[2568,6546],"./saopaulo.js":[6956,5288],"./seoul.js":[3266,3658],"./shanghai.js":[9656,2194],"./shenyang.js":[2266,1342],"./shenzhen.js":[4691,7153],"./singapore.js":[2459,5885],"./stockholm.js":[4606,6977],"./suzhou.js":[9819,7719],"./taichung.js":[5230,9],"./taipei.js":[9489,9450],"./tehran.js":[2573,1608],"./tianjin.js":[7942,2871],"./tokyo.js":[3762,2832],"./toronto.js":[8148,1902],"./tyneandwear.js":[9314,530],"./vienna.js":[5252,7101],"./wuhan.js":[3742,4111],"./wuxi.js":[4099,5418],"./xiamen.js":[4610,2338],"./xian.js":[2591,4760],"./zhengzhou.js":[7357,8759]};function o(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],o=e[0];return t.e(e[1]).then((function(){return t(o)}))}o.keys=function(){return Object.keys(r)},o.id=7827,n.exports=o},1427:function(n,e,t){var r={"./basic/coline.json":[2401,8014],"./basic/default.json":[8453,8241],"./basic/loop.json":[8909,9410],"./bjsubway/bj1.json":[8741,6729],"./bjsubway/bj10.json":[8461,6230],"./bjsubway/bj11.json":[3279,7646],"./bjsubway/bj13.json":[7443,1188],"./bjsubway/bj14.json":[2906,9523],"./bjsubway/bj16.json":[7062,6698],"./bjsubway/bj17.json":[8241,8760],"./bjsubway/bj2.json":[5176,2773],"./bjsubway/bj4.json":[8641,6552],"./bjsubway/bj5.json":[1834,7680],"./bjsubway/bj6.json":[2022,5653],"./bjsubway/bj7.json":[6061,9259],"./bjsubway/bj8.json":[9846,5482],"./bjsubway/bj9.json":[9422,9797],"./bjsubway/dae.json":[4852,4269],"./bjsubway/s1l.json":[2830,3981],"./bjsubway/t1l.json":[1057,2381],"./bjsubway/xjl.json":[14,7200],"./bjsubway/yzl.json":[6315,1095],"./company-config.json":[6605],"./fmetro/fs2.json":[1139,9447],"./fmetro/tgm1.json":[1558,7149],"./fmetro/tnh1.json":[7249,7160],"./gzmtr/apm.json":[5098,6452],"./gzmtr/gf.json":[571,6354],"./gzmtr/gz1.json":[8161,2200],"./gzmtr/gz13.json":[4745,3082],"./gzmtr/gz14.json":[9447,9950],"./gzmtr/gz18.json":[9361,7877],"./gzmtr/gz2.json":[7119,6583],"./gzmtr/gz21.json":[4695,7724],"./gzmtr/gz22.json":[2671,4015],"./gzmtr/gz3.json":[622,9826],"./gzmtr/gz4.json":[5440,3084],"./gzmtr/gz5.json":[3880,3109],"./gzmtr/gz6.json":[7426,2846],"./gzmtr/gz7.json":[3290,9925],"./gzmtr/gz8.json":[9045,8924],"./gzmtr/gz9.json":[8481,7332],"./gzmtr/thp1.json":[5227,2100],"./gzmtr/thz1.json":[2887,9416],"./hrbmetro/hrb1.json":[3002,199],"./hrbmetro/hrb2.json":[6635,4557],"./hrbmetro/hrb3.json":[555,8512],"./kmrailtransit/km1.json":[3285,2658],"./kmrailtransit/km2.json":[4760,9655],"./kmrailtransit/km3.json":[327,4250],"./kmrailtransit/km4.json":[1302,6555],"./kmrailtransit/km5.json":[1672,9675],"./kmrailtransit/km6.json":[5903,2663],"./kvtransit/klMonorail.json":[7749,113],"./kvtransit/lrtAmpang.json":[1534,6080],"./kvtransit/lrtKelanaJaya.json":[4219,8766],"./kvtransit/lrtSriPataling.json":[9311,8724],"./kvtransit/mrtKajang.json":[9512,6862],"./mlm/taipa.json":[4435,4694],"./mtr/ael.json":[6215,5945],"./mtr/drl.json":[6083,5074],"./mtr/eal.json":[9800,5958],"./mtr/isl.json":[7314,4754],"./mtr/ktl.json":[1400,6533],"./mtr/sile.json":[7438,2490],"./mtr/tcl.json":[4512,169],"./mtr/tkl.json":[1257,5910],"./mtr/tml.json":[5339,4991],"./mtr/twl.json":[5030,403],"./njmetro/nj1.json":[2868,564],"./njmetro/nj10.json":[8421,1180],"./njmetro/nj2.json":[4583,7792],"./njmetro/nj3.json":[3347,1899],"./njmetro/nj4.json":[7811,3497],"./qdmetro/qd11.json":[186,6899],"./qdmetro/qd13.json":[9736,4092],"./qdmetro/qd2.json":[5582,1471],"./qdmetro/qd3.json":[3457,4138],"./qdmetro/qd8.json":[7703,6293],"./saopaulometro/sp1.json":[2702,4402],"./saopaulometro/sp10.json":[1443,5680],"./saopaulometro/sp11.json":[8362,5325],"./saopaulometro/sp12.json":[7393,852],"./saopaulometro/sp13.json":[2794,6288],"./saopaulometro/sp15.json":[6267,758],"./saopaulometro/sp2.json":[7182,9619],"./saopaulometro/sp3.json":[1102,7855],"./saopaulometro/sp4.json":[2489,2750],"./saopaulometro/sp5.json":[2103,4387],"./saopaulometro/sp7.json":[9021,153],"./saopaulometro/sp8.json":[1280,4996],"./saopaulometro/sp9.json":[4337,911],"./shmetro/sh1.json":[5562,6569],"./shmetro/sh10.json":[6438,6890],"./shmetro/sh11.json":[6485,3692],"./shmetro/sh12.json":[7048,856],"./shmetro/sh13.json":[9155,2791],"./shmetro/sh14.json":[2243,5941],"./shmetro/sh15.json":[6484,4254],"./shmetro/sh16.json":[1465,4605],"./shmetro/sh17.json":[7079,74],"./shmetro/sh18.json":[4120,2632],"./shmetro/sh2.json":[4580,3456],"./shmetro/sh3&4.json":[7225,5294],"./shmetro/sh3.json":[7439,7211],"./shmetro/sh4.json":[1088,6745],"./shmetro/sh5.json":[7346,7769],"./shmetro/sh6.json":[8358,3263],"./shmetro/sh7.json":[3095,1475],"./shmetro/sh8.json":[4409,8781],"./shmetro/sh9.json":[7345,7321],"./szmetro/sz1.json":[7109,5993],"./szmetro/sz3.json":[1862,7910],"./szmetro/sz4.json":[7789,6632],"./template-configs.json":[2722],"./torontosubway/ttc1.json":[2966,5925],"./torontosubway/ttc2.json":[3298,6568],"./torontosubway/ttc3.json":[8973,9477],"./torontosubway/ttc4.json":[6730,8476],"./zzmetro/zz1.json":[4557,2023],"./zzmetro/zz14.json":[2049,8330],"./zzmetro/zz2.json":[6226,7522],"./zzmetro/zz3.json":[5090,8615],"./zzmetro/zz4.json":[2332,5515],"./zzmetro/zz5.json":[3790,5797],"./zzmetro/zz6.json":[5444,1325],"./zzmetro/zz9.json":[1393,388]};function o(n){if(!t.o(r,n))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[n],o=e[0];return Promise.all(e.slice(1).map(t.e)).then((function(){return t.t(o,19)}))}o.keys=function(){return Object.keys(r)},o.id=1427,n.exports=o},3603:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return pe}});var r=t(2791),o=t(4942),i=t(713),a=t(6169),s=t(4785),l=t(184);function c(n){var e,t=n.type,i=n.style,a=n.svgWidth,c=n.svgHeight,u=n.canvasScale,d=n.theme,h=n.children;return(0,r.useEffect)((function(){return document.getElementById("css_"+t).href="/rmg"+"/styles/".concat(t,"_").concat(i,".css"),function(){document.getElementById("css_"+t).href=""}}),[i]),(0,l.jsxs)("svg",{id:t,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",height:c*u,viewBox:"0 0 ".concat(a," ").concat(c),colorInterpolationFilters:"sRGB",style:(e={},(0,o.Z)(e,"--rmg-svg-width",a+"px"),(0,o.Z)(e,"--rmg-svg-height",c+"px"),(0,o.Z)(e,"--rmg-theme-colour",d[2]),(0,o.Z)(e,"--rmg-theme-fg",d[3]),e),children:[(0,l.jsx)("rect",{id:"canvas-bg",fill:"white",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}}),(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)(s.Z,{}),children:h}),(0,l.jsx)("rect",{id:"canvas-border",fill:"none",strokeWidth:3,stroke:"none",style:{height:"var(--rmg-svg-height)",width:"var(--rmg-svg-width)"}})]})}var u,d,h,f,m=t(6030),p=t(533),j=t(6871),g=t(8735),x=t(8228),v={flexDirection:"row",overflowX:"auto","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}};function b(){var n=(0,j.TH)(),e=(0,j.s0)(),t=(0,m.I0)(),o=(0,a.CG)((function(n){return n.app})),s=o.canvasToShow,u=o.canvasScale,d=(0,a.CG)((function(n){return n.param})),h=d.svgWidth,f=d.svg_height,b=d.style,y=d.theme;if(n.pathname!=="/"+b&&n.pathname!=="/v3/"+b){var S=n.pathname.split("/").slice(-1)[0];Object.values(i.RM).includes(S)?t((0,p.yL)(S)):e(b)}(0,r.useEffect)((function(){document.getElementById("css_share").href="/rmg"+"/styles/share_".concat(b,".css")}),[b]);var C=Object.keys(A[b]).filter((function(n){return"all"===s||s===n}));return(0,l.jsx)(g.kC,{sx:v,children:C.map((function(n){return(0,l.jsx)(x.Z,{style:{minWidth:750,height:f*u,overflowY:"auto"},children:(0,l.jsx)(c,{type:n,style:b,svgWidth:h[n],svgHeight:f,canvasScale:u,theme:y,children:A[b][n]})},n+b)}))})}var y=(0,r.lazy)((function(){return t.e(8506).then(t.bind(t,6787))})),S=(0,r.lazy)((function(){return t.e(4822).then(t.bind(t,5951))})),C=(0,r.lazy)((function(){return t.e(4555).then(t.bind(t,4990))})),w=(0,r.lazy)((function(){return t.e(3472).then(t.bind(t,5629))})),z=(0,r.lazy)((function(){return t.e(9586).then(t.bind(t,4074))})),M=(0,r.lazy)((function(){return t.e(1273).then(t.bind(t,5387))})),Z=(0,r.lazy)((function(){return Promise.all([t.e(2977),t.e(3957)]).then(t.bind(t,8076))})),k=(0,r.lazy)((function(){return Promise.all([t.e(2977),t.e(4880)]).then(t.bind(t,1552))})),A=(f={},(0,o.Z)(f,i.RM.GZMTR,(u={},(0,o.Z)(u,i.Ht.RunIn,(0,l.jsx)(y,{})),(0,o.Z)(u,i.Ht.RailMap,(0,l.jsx)(S,{})),u)),(0,o.Z)(f,i.RM.MTR,(d={},(0,o.Z)(d,i.Ht.Destination,(0,l.jsx)(C,{})),(0,o.Z)(d,i.Ht.RailMap,(0,l.jsx)(w,{})),d)),(0,o.Z)(f,i.RM.SHMetro,(h={},(0,o.Z)(h,i.Ht.Destination,(0,l.jsx)(z,{})),(0,o.Z)(h,i.Ht.RunIn,(0,l.jsx)(M,{})),(0,o.Z)(h,i.Ht.RailMap,(0,l.jsx)(Z,{})),(0,o.Z)(h,i.Ht.Indoor,(0,l.jsx)(k,{})),h)),f),O=t(8539),F=t(8332),R=t(2020);function P(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.app.selectedStation}));console.log("InfoSection:: Rendering for",t);var r=(0,a.CG)((function(n){return n.param.style})),o=(0,a.CG)((function(n){return n.param.stn_list[t]})),s=o.num,c=o.name,u=o.secondaryName,d=[{type:"input",label:n("StationSidePanel.info.num"),value:s,placeholder:"01",onChange:function(n){return e((0,p.Uf)(t,n))},hidden:![i.RM.GZMTR].includes(r)},{type:"input",label:n("Chinese name"),value:c[0],onChange:function(n){return e((0,p.PD)(t,[n,c[1]]))}},{type:"input",label:n("English name"),value:c[1],onChange:function(n){return e((0,p.PD)(t,[c[0],n]))}},{type:"input",label:n("StationSidePanel.info.zhSecondary"),value:u?u[0]:"",placeholder:"1\u53f7\u822a\u7ad9\u697c",onChange:function(n){return e((0,p.uJ)(t,[n,u?u[1]:""]))},hidden:![i.RM.GZMTR].includes(r)},{type:"input",label:n("StationSidePanel.info.enSecondary"),value:u?u[1]:"",placeholder:"Terminal 1",onChange:function(n){return e((0,p.uJ)(t,[u?u[0]:"",n]))},hidden:![i.RM.GZMTR].includes(r)}];return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:n("StationSidePanel.info.title")}),(0,l.jsx)(F.M5,{fields:d,minW:130})]})}var E=t(2504),T=t(3433),_=t(9439),N=t(7322),G=t(1564),U=t(3822),B=t(9113),I=t(1125),D=t(3046);function L(n){var e=n.countryCode,o=n.svgFilename,i=(0,r.useState)(void 0),a=(0,_.Z)(i,2),s=a[0],c=a[1];return(0,r.useEffect)((function(){o&&t(4018)("./"+o).then((function(n){return n.default})).then(c).catch((function(n){return console.error("Failed to find SVG file ".concat(o," as ").concat(null===n||void 0===n?void 0:n.message))}))}),[o]),s?(0,l.jsx)(D.Ee,{src:s,alt:"Flag of ".concat(e),h:17,mr:1}):(0,l.jsx)(l.Fragment,{})}function W(n){var e=n.defaultValueId,t=n.onChange,r=(0,R.$)().i18n,o=I.nB,a=e?o.find((function(n){return n.id===e})):void 0;return(0,l.jsx)(F.xL,{data:o,displayValue:function(n){return r.languages.map((function(e){return n.name[e]})).find((function(n){return void 0!==n}))},displayHandler:function(n){var e,t,o="TW"===n.country&&[i.sp.ChineseSimp,i.sp.ChineseCN].includes(r.language),a=["Win32","Win64"].includes(navigator.platform),s=r.languages.map((function(e){return n.name[e]})).find((function(n){return void 0!==n})),c=null===(e=I.Jm.find((function(e){return e.id===n.country})))||void 0===e?void 0:e.flagSvg,u=null===(t=I.Jm.find((function(e){return e.id===n.country})))||void 0===t?void 0:t.flagEmoji;return(0,l.jsxs)(l.Fragment,{children:[o?(0,l.jsx)("span",{children:"\ud83c\udff4\xa0"}):a?(0,l.jsx)(L,{countryCode:n.country,svgFilename:c}):(0,l.jsxs)("span",{children:[u,"\xa0"]}),s]})},predicate:function(n,e){return Object.values(n.name).some((function(n){return n.includes(e)}))},defaultValue:a,onChange:function(n){return null===t||void 0===t?void 0:t(n.id)}})}function H(n){var e=n.city,o=n.defaultValueId,a=n.onChange,s=(0,R.$)().i18n,c=function(n){var e=(0,r.useState)([]),o=(0,_.Z)(e,2),i=o[0],a=o[1];return(0,r.useEffect)((function(){t(7827)("./".concat(n,".js")).then((function(n){return a(n.default)})).catch((function(){return a([])}))}),[n]),i}(e),u=o?c.find((function(n){return n.id===o})):void 0,d=function(n){return s.languages.map((function(e){return n.name[e]})).find((function(n){return void 0!==n}))};return(0,l.jsx)(F.xL,{data:c,displayValue:d,displayHandler:function(n){var e=d(n);return(0,l.jsx)(F.l2,{name:e,fg:n.fg||i.AJ.white,bg:n.colour})},predicate:function(n,e){return Object.values(n.name).some((function(n){return n.includes(e)}))},defaultValue:u,onChange:function(n){return null===a||void 0===a?void 0:a(n.id,n.colour,n.fg||i.AJ.white)}})}function J(n){var e,t=n.isOpen,a=n.onClose,s=n.defaultTheme,c=n.onUpdate,u=(0,R.$)().t,d=(0,r.useState)(null===s||void 0===s?void 0:s[0]),h=(0,_.Z)(d,2),f=h[0],m=h[1],p=(0,r.useState)(null===s||void 0===s?void 0:s[1]),j=(0,_.Z)(p,2),x=j[0],v=j[1],b=(0,r.useState)((null===s||void 0===s?void 0:s[2])||"#AAAAAA"),y=(0,_.Z)(b,2),S=y[0],C=y[1],w=(0,r.useState)((null===s||void 0===s?void 0:s[3])||i.AJ.white),z=(0,_.Z)(w,2),M=z[0],Z=z[1];(0,r.useEffect)((function(){s&&(m(s[0]),v(s[1]),C(s[2]),Z(s[3]))}),[t,null===s||void 0===s?void 0:s.toString()]);var k=[{type:"custom",label:u("ColourModal.city"),component:(0,l.jsx)(W,{defaultValueId:f,onChange:function(n){m(n),v(void 0),C("#AAAAAA"),Z(i.AJ.white)}})},{type:"custom",label:u("ColourModal.line"),component:(0,l.jsx)(H,{city:f,defaultValueId:x,onChange:function(n,e,t){v(n),C(e),Z(t)}})}],A=[{type:"input",label:u("ColourModal.bg"),variant:"color",value:S,placeholder:"#F3D03E",onChange:function(n){m(I.jk.Other),v("other"),C(n)}},{type:"select",label:u("ColourModal.fg"),value:M,options:(e={},(0,o.Z)(e,i.AJ.white,u("ColourModal.white")),(0,o.Z)(e,i.AJ.black,u("ColourModal.black")),e),onChange:function(n){m(I.jk.Other),v("other"),Z(n)}}],O=f&&x&&S&&M;return(0,l.jsxs)(G.u_,{isOpen:t,onClose:a,children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[(0,l.jsx)(G.xB,{children:u("ColourModal.title")}),(0,l.jsx)(G.ol,{}),(0,l.jsx)(G.fe,{children:(0,l.jsxs)(g.gC,{children:[(0,l.jsx)(F.l2,{name:u("ColourModal.example"),fg:M,bg:S}),(0,l.jsxs)(U.mQ,{isFitted:!0,colorScheme:"teal",w:"100%",defaultIndex:f===I.jk.Other?1:0,children:[(0,l.jsxs)(U.td,{children:[(0,l.jsx)(U.OK,{children:u("ColourModal.palette")}),(0,l.jsx)(U.OK,{children:u("ColourModal.custom")})]}),(0,l.jsxs)(U.nP,{children:[(0,l.jsx)(U.x4,{children:(0,l.jsx)(F.M5,{fields:k})}),(0,l.jsx)(U.x4,{children:(0,l.jsx)(F.M5,{fields:A})})]})]})]})}),(0,l.jsxs)(G.mz,{children:[(0,l.jsxs)(g.xv,{fontSize:"sm",marginRight:2,children:[u("ColourModal.seeAll"),(0,l.jsxs)(g.rU,{color:"teal.500",href:"/rmg-palette",isExternal:!0,children:["RMG Palette ",(0,l.jsx)(B.JO,{as:N.jhj})]})]}),(0,l.jsx)(E.zx,{colorScheme:"teal",onClick:function(){O&&(null===c||void 0===c||c([f,x,S,M]),a())},disabled:!O,children:u("ColourModal.submit")})]})]})]})}var V=t(5671),$=t(3144),q=function(){function n(){(0,V.Z)(this,n)}return(0,$.Z)(n,null,[{key:"hexToRgb",value:function(n){return[parseInt(n.slice(1,3),16),parseInt(n.slice(3,5),16),parseInt(n.slice(5,7),16)]}},{key:"fade",value:function(n,e){return"rgba(".concat([].concat((0,T.Z)(this.hexToRgb(n)),[e]).join(","),")")}},{key:"euclideanDistance",value:function(n,e){var t=this;return this.hexToRgb(n).reduce((function(n,r,o){return n+Math.pow(r-t.hexToRgb(e)[o],2)}),0)}}]),n}();function X(n){var e=n.theme,t=n.onClick,r=(0,R.$)().t;return(0,l.jsx)(E.hU,{size:"xs","aria-label":r("Colour"),mt:"0.45px",color:e[3],bg:e[2],_hover:{bg:q.fade(e[2],.7)},icon:(0,l.jsx)(N.uAz,{}),onClick:t})}function Y(n){var e,t=n.interchangeList,o=n.onAdd,s=n.onDelete,c=n.onUpdate,u=(0,R.$)().t,d=(0,r.useState)(!1),h=(0,_.Z)(d,2),f=h[0],m=h[1],p=(0,r.useState)(0),j=(0,_.Z)(p,2),x=j[0],v=j[1],b=(0,a.CG)((function(n){return n.param})),y=b.theme,S=b.stn_list,C=Object.values(S).reduce((function(n,e){var t=(0,_.Z)(n,2),r=t[0],o=t[1];return[(0,T.Z)(new Set(r.concat(e.transfer.info.flat().map((function(n){return n[4]}))))),(0,T.Z)(new Set(o.concat(e.transfer.info.flat().map((function(n){return n[5]})))))]}),[[],[]]),w=t.map((function(n,e){return[{type:"input",label:u("Chinese name"),value:n[4],minW:"80px",onChange:function(t){return null===c||void 0===c?void 0:c(e,[n[0],n[1],n[2],n[3],t,n[5]])},optionList:C[0]},{type:"input",label:u("English name"),value:n[5],minW:"80px",onChange:function(t){return null===c||void 0===c?void 0:c(e,[n[0],n[1],n[2],n[3],n[4],t])},optionList:C[1]}]}));return(0,l.jsxs)(F.bg,{direction:"column",children:[0===t.length&&(0,l.jsxs)(g.Ug,{spacing:.5,"data-testid":"interchange-card-stack",children:[(0,l.jsx)(g.xv,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:u("StationSidePanel.interchange.noInterchanges")}),(0,l.jsx)(E.hU,{size:"sm",variant:"ghost","aria-label":u("StationSidePanel.interchange.add"),onClick:function(){return null===o||void 0===o?void 0:o([y[0],"","#aaaaaa",i.AJ.white,"",""])},icon:(0,l.jsx)(N.x06,{})})]}),t.map((function(n,e){return(0,l.jsxs)(g.Ug,{spacing:.5,"data-testid":"interchange-card-stack-".concat(e),children:[(0,l.jsx)(F.Nv,{label:u("Colour"),minW:"40px",noLabel:0!==e,children:(0,l.jsx)(X,{theme:[n[0],n[1],n[2],n[3]],onClick:function(){m(!0),v(e)}})}),(0,l.jsx)(F.M5,{fields:w[e],noLabel:0!==e}),o&&e===w.length-1?(0,l.jsx)(E.hU,{size:"sm",variant:"ghost","aria-label":u("StationSidePanel.interchange.copy"),onClick:function(){return null===o||void 0===o?void 0:o(t.slice(-1)[0])},icon:(0,l.jsx)(N.Fqs,{})}):(0,l.jsx)(g.xu,{minW:8}),s&&(0,l.jsx)(E.hU,{size:"sm",variant:"ghost","aria-label":u("StationSidePanel.interchange.remove"),onClick:function(){return null===s||void 0===s?void 0:s(e)},icon:(0,l.jsx)(N.ZkW,{})})]},e)})),(0,l.jsx)(J,{isOpen:f,onClose:function(){return m(!1)},defaultTheme:null===(e=t[x])||void 0===e?void 0:e.slice(0,4),onUpdate:function(n){return null===c||void 0===c?void 0:c(x,[].concat((0,T.Z)(n),[t[x][4],t[x][5]]))}})]})}function K(n){var e=n.selections,t=n.defaultValue,o=n.onChange,i=n.multiSelect,a=(0,r.useState)(t),s=(0,_.Z)(a,2),c=s[0],u=s[1];(0,r.useEffect)((function(){t.toString()&&u(t)}),[t.toString()]);return(0,l.jsx)(E.hE,{size:"xs",isAttached:!0,colorScheme:"teal",variant:"outline",children:e.map((function(n,t){var r="object"===typeof c&&c.includes(n.value)||c===n.value,a=t===e.length-1||r?void 0:"-px";return(0,l.jsx)(E.zx,{role:"checkbox","aria-checked":r,variant:r?"solid":"outline",mr:a,isDisabled:n.disabled,onClick:function(){return function(n){if(i){var e=c,t=e.includes(n)?e.filter((function(e){return e!==n})):[].concat((0,T.Z)(e),[n]);u(t),null===o||void 0===o||o(t)}else u(n),null===o||void 0===o||o(n)}(n.value)},children:n.label},n.value.toString())}))})}function Q(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.app.selectedStation})),o=(0,a.CG)((function(n){return n.param})),s=o.theme,c=o.style,u=(0,a.CG)((function(n){return n.param.stn_list[t]})).transfer,d=function(r){var o,a;return[{type:"input",label:n("Station Chinese name"),value:null===(o=u.osi_names[r])||void 0===o?void 0:o[0],hidden:![i.RM.MTR].includes(c),onChange:function(n){var o;return e((0,p.fr)(t,r,[n,null===(o=u.osi_names[r])||void 0===o?void 0:o[1]]))}},{type:"input",label:n("Station English name"),value:null===(a=u.osi_names[r])||void 0===a?void 0:a[1],hidden:![i.RM.MTR].includes(c),onChange:function(n){var o;return e((0,p.fr)(t,r,[null===(o=u.osi_names[r])||void 0===o?void 0:o[0],n]))}},{type:"switch",label:n("Paid area"),isChecked:u.paid_area,onChange:function(n){return e((0,p.lL)(t,n))},hidden:![i.RM.MTR].includes(c)||0!==r,oneLine:!0}]},h=function(n){return function(r){e((0,p.Ui)(t,n,r))}},f=function(n){return function(r){e((0,p.SA)(t,n,r))}},j=function(n){return function(r,o){e((0,p.vM)(t,n,r,o))}};return(0,l.jsxs)(g.gC,{align:"flex-start",p:1,children:[(0,l.jsxs)(g.kC,{w:"100%",children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",mr:"auto",children:n("StationSidePanel.interchange.title")}),c===i.RM.MTR&&(0,l.jsx)(K,{selections:[{label:n("Text on the left"),value:i.wA.left},{label:n("Text on the right"),value:i.wA.right}],defaultValue:u.tick_direc,onChange:function(n){return e((0,p.bC)(t,n))}})]}),u.info.map((function(e,t){return(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)(g.X6,{as:"h6",size:"xs",children:n(0===t?"StationSidePanel.interchange.within":1===t?"StationSidePanel.interchange.outStation":"StationSidePanel.interchange.outSystem")}),0!==t&&(0,l.jsx)(F.M5,{fields:d(t-1)}),(0,l.jsx)(Y,{interchangeList:e,onAdd:h(t),onDelete:f(t),onUpdate:j(t)})]},t)})),u.info.length<3&&(0,l.jsx)(E.zx,{size:"xs",variant:"ghost",alignSelf:"flex-end",leftIcon:(0,l.jsx)(N.x06,{}),onClick:function(){e((0,p.Ui)(t,u.info.length,[s[0],"","#AAAAAA",i.AJ.white,"",""]))},children:n("StationSidePanel.interchange.addGroup")})]})}function nn(){var n,e,t=(0,R.$)().t,r=(0,m.I0)(),s=(0,a.CG)((function(n){return n.app.selectedStation})),c=(0,a.CG)((function(n){return n.param.style})),u=(0,a.CG)((function(n){return n.param.stn_list[s]})),d=u.services,h=u.facility,f=u.loop_pivot,j=Object.values(i.K9).map((function(n){return{label:t("StationSidePanel.more."+n),value:n,disabled:n===i.K9.local&&c!==i.RM.SHMetro}})),x=(n={},(0,o.Z)(n,i.mV.none,t("StationSidePanel.more.none")),(0,o.Z)(n,i.mV.airport,t("StationSidePanel.more.airport")),(0,o.Z)(n,i.mV.hsr,t("StationSidePanel.more.hsr")),(0,o.Z)(n,i.mV.disney,t("StationSidePanel.more.disney")),n),v=(e={},(0,o.Z)(e,i.mV.none,t("StationSidePanel.more.none")),(0,o.Z)(e,i.mV.airport,t("StationSidePanel.more.airport")),(0,o.Z)(e,i.mV.railway,t("StationSidePanel.more.railway")),(0,o.Z)(e,i.mV.disney,t("StationSidePanel.more.disney")),e),b=[{type:"custom",label:t("StationSidePanel.more.service"),component:(0,l.jsx)(K,{selections:j,defaultValue:d,onChange:function(n){return r((0,p.k6)(s,n))},multiSelect:!0}),hidden:![i.RM.GZMTR,i.RM.SHMetro].includes(c)},{type:"select",label:t("StationSidePanel.more.facility"),value:h,options:c===i.RM.MTR?x:v,onChange:function(n){return r((0,p.cm)(s,n))},hidden:![i.RM.MTR,i.RM.SHMetro].includes(c)},{type:"switch",label:t("StationSidePanel.more.pivot"),isChecked:f,onChange:function(n){return r((0,p.Hz)(s,n))},hidden:![i.RM.SHMetro].includes(c),minW:"full",oneLine:!0}];return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:t("StationSidePanel.more.title")}),(0,l.jsx)(F.M5,{fields:b})]})}var en=t(1413);function tn(){var n,e=(0,R.$)().t,t=(0,m.I0)(),r=(0,a.CG)((function(n){return n.app.selectedStation})),s=(0,a.CG)((function(n){return n.param.stn_list})),c=s[r],u=c.parents,d=c.children,h=c.branch,f=(n={},(0,o.Z)(n,i.H_.through,e("StationSidePanel.branch.through")),(0,o.Z)(n,i.H_.nonThrough,e("StationSidePanel.branch.nonThrough")),n),j=function(n){return(n===i.Nm.left?u:d).reduce((function(n,e){return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},e,s[e].name.join(" ")))}),{})},x={upper:e("StationSidePanel.branch.upper"),lower:e("StationSidePanel.branch.lower")},v=function(n){return h[n].length?[{type:"select",label:e("StationSidePanel.branch.type"),options:f,value:h[n][0],onChange:function(e){return t((0,p.kM)(r,n,e))}},{type:"select",label:e("StationSidePanel.branch.firstStation"),options:j(n),value:h[n][1],onChange:function(e){return t((0,p.B6)(r,n,e))}},{type:"select",label:e("StationSidePanel.branch.position"),options:x,value:0===(n===i.Nm.left?u:d).indexOf(h[n][1])?"upper":"lower",onChange:function(){return t((0,p.HT)(r,n))}}]:[]};return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:e("Branches")}),(0,l.jsx)(g.X6,{as:"h6",size:"xs",children:e("Branch on the left")}),(0,l.jsx)(F.bg,{direction:"column",children:2===u.length?(0,l.jsx)(F.M5,{fields:v(i.Nm.left)}):(0,l.jsx)(g.xv,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:e("No branches found")})}),(0,l.jsx)(g.X6,{as:"h6",size:"xs",children:e("Branch on the right")}),(0,l.jsx)(F.bg,{direction:"column",children:2===d.length?(0,l.jsx)(F.M5,{fields:v(i.Nm.right)}):(0,l.jsx)(g.xv,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:e("No branches found")})})]})}function rn(){return(0,l.jsxs)(F.EI,{children:[(0,l.jsx)(P,{}),(0,l.jsx)(g.iz,{}),(0,l.jsx)(Q,{}),(0,l.jsx)(g.iz,{}),(0,l.jsx)(tn,{}),(0,l.jsx)(g.iz,{}),(0,l.jsx)(nn,{})]})}function on(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.param})),r=t.style,o=t.svgWidth,s=t.svg_height,c=t.y_pc,u=t.branch_spacing,d=t.padding,h=t.direction_gz_x,f=t.direction_gz_y,j=t.loop,x=[].concat((0,T.Z)(i.tK[r].map((function(t){return{type:"input",label:n("StyleSidePanel.layout.".concat(t,"Width")),value:o[t].toString(),onChange:function(n){return e((0,p.gS)(Number(n),t))}}}))),[{type:"input",label:n("StyleSidePanel.layout.canvasHeight"),value:s.toString(),onChange:function(n){return e((0,p.K0)(Number(n)))}},{type:"slider",label:n("StyleSidePanel.layout.verticalPosition"),value:c,min:0,max:100,onChange:function(n){return e((0,p.Tt)(n))},hidden:![i.RM.MTR,i.RM.GZMTR].includes(r)},{type:"slider",label:n(j?"StyleSidePanel.layout.branchSpacingLoop":"StyleSidePanel.layout.branchSpacing"),value:u,min:0,max:100,onChange:function(n){return e((0,p.J3)(n))}},{type:"slider",label:n("StyleSidePanel.layout.padding"),value:d,min:0,max:100,onChange:function(n){return e((0,p.xd)(n))}},{type:"slider",label:n("StyleSidePanel.layout.directionGzX"),value:h,min:0,max:100,onChange:function(n){return e((0,p.$m)(n))},hidden:![i.RM.GZMTR].includes(r)},{type:"slider",label:n("StyleSidePanel.layout.directionGzY"),value:f,min:0,max:100,onChange:function(n){return e((0,p.rR)(n))},hidden:![i.RM.GZMTR].includes(r)}]);return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:n("StyleSidePanel.layout.title")}),(0,l.jsx)(F.M5,{fields:x,minW:130})]})}function an(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.param})),s=t.style,c=t.theme,u=t.line_name,d=t.line_num,h=t.direction,f=t.platform_num,j=t.psd_num,x=t.namePosMTR,v=t.customiseMTRDest,b=t.info_panel_type,y=(0,r.useState)(!1),S=(0,_.Z)(y,2),C=S[0],w=S[1],z=[{label:n("StyleSidePanel.design.left"),value:i.wA.left},{label:n("StyleSidePanel.design.right"),value:i.wA.right}],M=Object.values(i.p).reduce((function(e,t){return(0,en.Z)((0,en.Z)({},e),{},(0,o.Z)({},t,n("StyleSidePanel.design."+t)))}),{}),Z=Object.values(i.hi).reduce((function(e,t){return(0,en.Z)((0,en.Z)({},e),{},(0,o.Z)({},t,n("StyleSidePanel.design."+t)))}),{}),k=[{type:"custom",label:n("Colour"),component:(0,l.jsx)(X,{theme:c,onClick:function(){return w(!0)}}),minW:"40px"},{type:"input",label:n("StyleSidePanel.design.zhLineName"),value:u[0],onChange:function(n){return e((0,p.il)([n,u[1]]))},minW:130},{type:"input",label:n("StyleSidePanel.design.enLineName"),value:u[1],onChange:function(n){return e((0,p.il)([u[0],n]))},minW:130},{type:"input",label:n("StyleSidePanel.design.lineNum"),value:d,onChange:function(n){return e((0,p.bh)(n))},hidden:![i.RM.GZMTR].includes(s)},{type:"input",label:n("StyleSidePanel.design.platformNum"),value:f||"",onChange:function(n){return e((0,p.VY)(n))}},{type:"input",label:n("StyleSidePanel.design.psdNum"),value:j,onChange:function(n){return e((0,p.lT)(n))},hidden:![i.RM.GZMTR].includes(s)},{type:"select",label:n("StyleSidePanel.design.panelType"),value:b,options:s===i.RM.GZMTR?M:Z,onChange:function(n){return e((0,p.NQ)(n))},hidden:![i.RM.GZMTR,i.RM.SHMetro].includes(s)},{type:"custom",label:n("StyleSidePanel.design.direction"),component:(0,l.jsx)(K,{selections:z,defaultValue:h,onChange:function(n){return e((0,p.mU)(n))}}),minW:"full",oneLine:!0}],A=[{label:n("StyleSidePanel.design.alternatively"),value:!0},{label:n("StyleSidePanel.design.onOneSide"),value:!1}],O=[{type:"custom",label:n("StyleSidePanel.design.nameDisplay"),component:(0,l.jsxs)(g.Ug,{children:[(0,l.jsx)(K,{selections:A,defaultValue:x.isStagger,onChange:function(n){return e((0,p.gn)(n))}}),(0,l.jsx)(E.zx,{size:"xs",variant:"ghost",leftIcon:(0,l.jsx)(N.Llt,{}),onClick:function(){return e((0,p.jv)())},children:n("StyleSidePanel.design.flip")})]}),minW:"full",oneLine:!0,hidden:![i.RM.MTR].includes(s)},{type:"switch",label:n("StyleSidePanel.design.legacyDestination"),isChecked:v.isLegacy,onChange:function(n){return e((0,p.nR)(n))},hidden:![i.RM.MTR].includes(s),minW:"full",oneLine:!0},{type:"switch",label:n("StyleSidePanel.design.overrideTerminal"),isChecked:!1!==v.terminal,onChange:function(n){return e((0,p.An)(!!n&&["",""]))},hidden:![i.RM.MTR].includes(s),minW:"full",oneLine:!0},{type:"input",label:n("StyleSidePanel.design.terminalZhName"),value:v.terminal?v.terminal[0]:"",placeholder:"\u6a5f\u5834\u53ca\u535a\u89bd\u9928",onChange:function(n){return e((0,p.An)([n,v.terminal?v.terminal[1]:""]))},hidden:![i.RM.MTR].includes(s)||!1===v.terminal},{type:"input",label:n("StyleSidePanel.design.terminalEnName"),value:v.terminal?v.terminal[1]:"",placeholder:"Airport and AsiaWorld-Expo",onChange:function(n){return e((0,p.An)([v.terminal?v.terminal[0]:"",n]))},hidden:![i.RM.MTR].includes(s)||!1===v.terminal}];return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:n("StyleSidePanel.design.title")}),(0,l.jsx)(F.M5,{fields:[].concat(k,O),minW:130}),(0,l.jsx)(J,{isOpen:C,onClose:function(){return w(!1)},defaultTheme:c,onUpdate:function(n){return e((0,p.Dc)(n))}})]})}function sn(){var n,e=(0,R.$)().t,t=(0,m.I0)(),r=(0,a.CG)((function(n){return n.helper})).branches,o=(0,a.CG)((function(n){return n.param})),i=o.loop,s=o.loop_info,c=s.bank,u=s.left_and_right_factor,d=s.bottom_factor,h=r.flat().filter((n={},function(e){return 2===(n[e]=(n[e]||0)+1)})).filter((function(n){return!["linestart","lineend"].includes(n)})),f=Math.abs(r[0].indexOf(h[0])-r[0].indexOf(h[1])),j=r.length>=2?(0,Math.min)(r[0].length-2-f,f):Math.floor((r[0].length-2-2*d)/2),x=[{type:"switch",label:e("StyleSidePanel.loop.isLoop"),isChecked:i,onChange:function(n){return t((0,p.rY)(n))},minW:"full",oneLine:!0},{type:"switch",label:e("StyleSidePanel.loop.isBank"),isChecked:c,onChange:function(n){return t((0,p.qi)(n))},minW:"full",oneLine:!0,hidden:!i},{type:"slider",label:e("StyleSidePanel.loop.leftRightFactor"),value:u,min:0,max:j,onChange:function(n){return t((0,p.lh)(Math.floor(n)))},hidden:!i},{type:"slider",label:e("StyleSidePanel.loop.bottomFactor"),value:d,min:0,max:Math.floor((r[0].length-2-2*u)/2),onChange:function(n){return t((0,p.Hv)(Math.floor(n)))},hidden:!i||i&&r.length>2}];return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:e("StyleSidePanel.loop.title")}),(0,l.jsx)(F.M5,{fields:x})]})}function ln(n){var e=n.note,t=n.onUpdate,r=n.onDelete,o=(0,R.$)().t,i=[{type:"textarea",label:o("StyleSidePanel.note.zhNote"),value:e[0],onChange:function(n){return null===t||void 0===t?void 0:t([n,e[1],e[2],e[3],e[4]])}},{type:"textarea",label:o("StyleSidePanel.note.enNote"),value:e[1],onChange:function(n){return null===t||void 0===t?void 0:t([e[0],n,e[2],e[3],e[4]])}},{type:"switch",label:o("StyleSidePanel.note.border"),isChecked:e[4],onChange:function(n){return null===t||void 0===t?void 0:t([e[0],e[1],e[2],e[3],n])},oneLine:!0}],a=[{type:"slider",label:o("StyleSidePanel.note.positionX"),value:e[2],min:0,max:100,onChange:function(n){return null===t||void 0===t?void 0:t([e[0],e[1],n,e[3],e[4]])}},{type:"slider",label:o("StyleSidePanel.note.positionY"),value:e[3],min:0,max:100,onChange:function(n){return null===t||void 0===t?void 0:t([e[0],e[1],e[2],n,e[4]])}}];return(0,l.jsxs)(F.bg,{direction:"column",children:[(0,l.jsx)(F.M5,{fields:i,minW:"full"}),(0,l.jsxs)(g.Ug,{spacing:.5,children:[(0,l.jsx)(F.M5,{fields:a}),(0,l.jsx)(E.hU,{size:"sm",variant:"ghost","aria-label":o("StyleSidePanel.note.remove"),onClick:function(){return null===r||void 0===r?void 0:r()},icon:(0,l.jsx)(N.ZkW,{})})]})]})}function cn(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.param.notesGZMTR}));return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:n("StyleSidePanel.note.title")}),(0,l.jsxs)(g.gC,{spacing:.5,children:[t.map((function(n,t){return(0,l.jsx)(ln,{note:n,onUpdate:function(n){return e((0,p.Qk)(t,n))},onDelete:function(){return e((0,p.lj)(t))}},t)})),(0,l.jsx)(E.zx,{size:"xs",variant:"ghost",leftIcon:(0,l.jsx)(N.x06,{}),alignSelf:"flex-end",onClick:function(){return e((0,p.AL)())},children:n("StyleSidePanel.note.add")})]})]})}function un(){var n=(0,a.CG)((function(n){return n.param})).style;return(0,l.jsxs)(F.EI,{children:[(0,l.jsx)(on,{}),(0,l.jsx)(g.iz,{}),(0,l.jsx)(an,{}),n===i.RM.GZMTR&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(g.iz,{}),(0,l.jsx)(cn,{})]}),n===i.RM.SHMetro&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(g.iz,{}),(0,l.jsx)(sn,{})]})]})}var dn=t(6705),hn=function n(e,t){if(["linestart","lineend"].includes(e)||t[e].parents.length>1||t[e].children.length>1)return 0;var r=t[e].parents[0];return r?1===t[r].children.length?n(r,t):0===t[r].children.indexOf(e)?1:-1:0};function fn(n){var e=n.isOpen,t=n.onClose,r=n.cancelRef,o=n.onConfirm,i=(0,R.$)().t;return(0,l.jsx)(G.aR,{isOpen:e,leastDestructiveRef:r,onClose:t,children:(0,l.jsx)(G.dh,{children:(0,l.jsxs)(G._T,{children:[(0,l.jsx)(G.fY,{fontSize:"lg",fontWeight:"bold",children:i("RemoveConfirmModal.title")}),(0,l.jsx)(G.iP,{children:"Are you sure to remove station? You cannot undo this action."}),(0,l.jsxs)(G.xo,{children:[(0,l.jsx)(E.zx,{ref:r,onClick:t,children:i("RemoveConfirmModal.cancel")}),(0,l.jsx)(E.zx,{colorScheme:"teal",onClick:o,ml:3,children:i("RemoveConfirmModal.confirm")})]})]})})})}function mn(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.app.selectedStation})),s=(0,r.useState)(!1),c=(0,_.Z)(s,2),u=c[0],d=c[1],h=(0,r.useRef)(null);return(0,l.jsxs)(F.B0,{children:[(0,l.jsxs)(g.Ug,{children:[(0,l.jsx)(E.zx,{size:"sm",variant:"outline",onClick:function(){return e((0,p.lS)(t))},children:n("StationSidePanel.footer.current")}),(0,l.jsx)(E.zx,{size:"sm",variant:"outline",onClick:function(){return d(!0)},children:n("StationSidePanel.footer.remove")})]}),(0,l.jsx)(fn,{isOpen:u,cancelRef:h,onClose:function(){return d(!1)},onConfirm:function(){var r;e((r=t,function(n,e){var t=e().param.stn_list,o=t[r],i=o.parents,a=o.children;return 4===Object.keys(t).length?(console.log("removeStation():: failed as only 2 stations remaining"),!1):2===i.length&&2===a.length?(console.log("removeStation():: failed as branches on both sides cannot be combined"),!1):!!Object.keys(t).some((function(n){return![r,"linestart","lineend"].includes(n)&&0===hn(n,t)}))||(console.log("removeStation():: failed as selected station is the only station without siblings"),!1)}))?(e((0,O.B4)(i.Sg.CLOSE)),e((0,O.NQ)("linestart")),e((0,dn.NC)(t)),e(function(n){return function(e,t){var r=t().param.stn_list,i=r[n],a=i.parents,s=i.children,l=JSON.parse(JSON.stringify(r));if(2===a.length||2===s.length)a.forEach((function(n){l[n].children=s})),s.forEach((function(n){l[n].parents=a})),1===a.length&&(l[a[0]].branch.right=l[n].branch.right),1===s.length&&(l[s[0]].branch.left=l[n].branch.left);else if(2===r[a[0]].children.length&&2===r[s[0]].parents.length){var c;l=(0,en.Z)((0,en.Z)({},r),{},(c={},(0,o.Z)(c,a[0],(0,en.Z)((0,en.Z)({},r[a[0]]),{},{children:r[a[0]].children.filter((function(e){return e!==n})),branch:(0,en.Z)((0,en.Z)({},r[a[0]].branch),{},{right:[]})})),(0,o.Z)(c,s[0],(0,en.Z)((0,en.Z)({},r[s[0]]),{},{parents:r[s[0]].parents.filter((function(e){return e!==n})),branch:(0,en.Z)((0,en.Z)({},r[s[0]].branch),{},{left:[]})})),c))}else a.forEach((function(e){var t=l[e].children.indexOf(n);s.length?l[e].children[t]=s[0]:l[e].children.splice(t,1),l[e].branch.right[1]===n&&(l[e].branch.right[1]=s[0])})),s.forEach((function(e){var t=l[e].parents.indexOf(n);a.length?l[e].parents[t]=a[0]:l[e].parents.splice(t,1),l[e].branch.left[1]===n&&(l[e].branch.left[1]=a[0])}));delete l[n],e((0,p.BI)(l))}}(t)),d(!1)):e((0,O.bI)("error",n("StationSidePanel.footer.errorOnRemove")))}})]})}function pn(n){var e=n.colineInfo,t=n.routeOptions,o=n.onUpdateRoute,i=n.onUpdateColourInfo,a=n.onDelete,s=(0,R.$)().t,c=(0,r.useState)(!1),u=(0,_.Z)(c,2),d=u[0],h=u[1],f=[{type:"select",label:"Route",value:[e.from,e.to].join(","),options:t,onChange:function(n){return null===o||void 0===o?void 0:o(n)}}],m=[{type:"custom",label:s("Colour"),component:(0,l.jsx)(X,{theme:[e.colors[0][0],e.colors[0][1],e.colors[0][2],e.colors[0][3]],onClick:function(){return h(!0)}})},{type:"input",label:s("Chinese name"),value:e.colors[0][4],minW:120,onChange:function(n){return null===i||void 0===i?void 0:i([e.colors[0][0],e.colors[0][1],e.colors[0][2],e.colors[0][3],n,e.colors[0][5]])}},{type:"input",label:s("English name"),value:e.colors[0][5],minW:120,onChange:function(n){return null===i||void 0===i?void 0:i([e.colors[0][0],e.colors[0][1],e.colors[0][2],e.colors[0][3],e.colors[0][4],n])}}];return(0,l.jsxs)(F.bg,{direction:"column",children:[(0,l.jsx)(F.M5,{fields:f,minW:"full"}),(0,l.jsxs)(g.Ug,{spacing:.5,children:[(0,l.jsx)(F.M5,{fields:m}),(0,l.jsx)(E.hU,{size:"sm",variant:"ghost","aria-label":"Delete colour for route",onClick:function(){return null===a||void 0===a?void 0:a(0)},icon:(0,l.jsx)(N.ZkW,{})})]}),(0,l.jsx)(J,{isOpen:d,onClose:function(){return h(!1)},defaultTheme:e.colors[0].slice(0,4),onUpdate:function(n){return null===i||void 0===i?void 0:i([].concat((0,T.Z)(n),[e.colors[0][4],e.colors[0][5]]))}})]})}function jn(){var n=(0,R.$)().t,e=(0,a.TL)(),t=(0,a.CG)((function(n){return n.app.selectedBranch})),r=(0,a.CG)((function(n){return n.param})),s=r.theme,c=r.stn_list,u=e((0,dn._G)(t)),d=e((0,dn.ku)(t)),h=d.reduce((function(n,e){return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},e.join(","),e.map((function(n){return c[n].name.join(" - ")})).join(" ~ ")))}),{});return(0,l.jsxs)(g.gC,{align:"flex-start",p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:n("BranchSidePanel.coline.title")}),Object.entries(u).map((function(n){var t,r=(0,_.Z)(n,2),o=r[0],i=r[1];return(0,l.jsx)(pn,{colineInfo:i,routeOptions:h,onUpdateRoute:(t=o,function(n){var r=n.split(","),o=(0,_.Z)(r,2),i=o[0],a=o[1];console.log("ColineSection.handleUpdateRoute():: Updating route, colineId=".concat(t,", from=").concat(i,", to=").concat(a));try{e((0,dn.l$)(t,i,a))}catch(s){e((0,O.bI)("error","Unable to draw this share track."))}}),onUpdateColourInfo:function(n){return e((0,dn.Di)(o,0,n))},onDelete:function(n){return function(n,t){e((0,dn.wX)(n,t))}(o,n)}},o)})),(0===t||0===Object.keys(u).length)&&(0,l.jsx)(E.zx,{size:"xs",variant:"ghost",alignSelf:"flex-end",leftIcon:(0,l.jsx)(N.x06,{}),onClick:function(){console.log("ColineSection.handleAddTrackSharing():: Adding track sharing to branch ".concat(t," with default combination"),d[0]),e((0,dn._g)(d[0][0],d[0][1],[[s[0],"","#AAAAAA",i.AJ.white,"",""]]))},children:n("BranchSidePanel.coline.add")})]})}function gn(n){var e=n.isOpen,t=n.onClose,s=(0,R.$)().t,c=(0,a.TL)(),u=(0,a.CG)((function(n){return n.app.selectedBranch})),d=(0,a.CG)((function(n){return n.param})),h=d.style,f=d.stn_list,m=(0,a.CG)((function(n){return n.helper.branches})),j=(0,r.useState)(u),g=(0,_.Z)(j,2),x=g[0],v=g[1],b=(0,r.useState)("1"),y=(0,_.Z)(b,2),S=y[0],C=y[1],w=(0,r.useState)("2"),z=(0,_.Z)(w,2),M=z[0],Z=z[1],k=(0,r.useState)("asc"),A=(0,_.Z)(k,2),O=A[0],P=A[1];(0,r.useEffect)((function(){v(u)}),[u]);var T=[{type:"select",label:s("AutoNumModal.where"),value:x,options:(0,en.Z)({},m.reduce((function(n,e,t){return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},t,0===t?s("AutoNumModal.main"):h===i.RM.SHMetro&&(0,dn.Qo)(e,f)?s("AutoNumModal.external")+" "+t:s("AutoNumModal.branch")+" "+t))}),{})),onChange:function(n){return v(n)}},{type:"input",label:s("AutoNumModal.from"),value:S,validator:function(n){return!isNaN(Number(n))},onChange:C,debouncedDelay:0},{type:"input",label:s("AutoNumModal.maxLength"),validator:function(n){return!isNaN(Number(n))},value:M,onChange:Z,debouncedDelay:0},{type:"select",label:s("AutoNumModal.sort"),value:O,options:{asc:s("AutoNumModal.asc"),desc:s("AutoNumModal.desc")},onChange:function(n){return P(n)}}],N=!S||!M||isNaN(Number(S))||isNaN(Number(M));return(0,l.jsxs)(G.u_,{isOpen:e,onClose:t,children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[(0,l.jsx)(G.xB,{children:s("AutoNumModal.title")}),(0,l.jsx)(G.ol,{}),(0,l.jsx)(G.fe,{children:(0,l.jsx)(F.M5,{fields:T})}),(0,l.jsx)(G.mz,{children:(0,l.jsx)(E.zx,{colorScheme:"teal",isDisabled:N,onClick:function(){c((0,p.av)(x,Number(S),Number(M),O)),t()},children:s("AutoNumModal.submit")})})]})]})}function xn(){var n=(0,R.$)().t,e=(0,a.TL)(),t=(0,a.CG)((function(n){return n.param.style})),o=(0,r.useState)(!1),s=(0,_.Z)(o,2),c=s[0],u=s[1];return(0,l.jsxs)(g.xu,{p:1,children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",children:n("BranchSidePanel.action.title")}),(0,l.jsxs)(g.kC,{wrap:"wrap",sx:{p:1,"&> *":{flexShrink:0,flexBasis:"100%","&:not(:first-child)":{marginTop:2}}},children:[t===i.RM.GZMTR&&(0,l.jsx)(E.zx,{size:"sm",variant:"outline",leftIcon:(0,l.jsx)(N.OIZ,{}),alignSelf:"flex-end",onClick:function(){return u(!0)},children:n("BranchSidePanel.action.autoNum")}),(0,l.jsx)(E.zx,{size:"sm",variant:"outline",leftIcon:(0,l.jsx)(N.bef,{}),alignSelf:"flex-end",onClick:function(){return e((0,p.iI)(t===i.RM.SHMetro))},children:t===i.RM.SHMetro?n("BranchSidePanel.action.flip"):n("BranchSidePanel.action.reverse")})]}),(0,l.jsx)(gn,{isOpen:c,onClose:function(){return u(!1)}})]})}function vn(){var n=(0,a.CG)((function(n){return n.app.selectedBranch})),e=(0,a.CG)((function(n){return n.param})),t=e.style,r=e.stn_list,o=(0,a.CG)((function(n){return n.helper.branches}));return(0,l.jsxs)(F.EI,{children:[t===i.RM.SHMetro&&(0===n||(0,dn.Qo)(o[n],r))&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(jn,{}),(0,l.jsx)(g.iz,{})]}),(0,l.jsx)(xn,{})]})}function bn(){var n,e,t=(0,R.$)().t,r=(0,m.I0)(),o=(0,a.CG)((function(n){return n.app})),s=o.sidePanelMode,c=o.selectedStation,u=(0,a.CG)((function(n){var e;return null===(e=n.param.stn_list[c])||void 0===e?void 0:e.name})),d={STATION:{header:(0,l.jsx)(F.iR,{text:(null===u||void 0===u?void 0:u.join(" - "))||""}),body:(0,l.jsx)(rn,{}),footer:(0,l.jsx)(mn,{})},STYLE:{header:t("StyleSidePanel.header"),body:(0,l.jsx)(un,{})},BRANCH:{header:t("BranchSidePanel.header"),body:(0,l.jsx)(vn,{})},CLOSE:{header:"Close"}};return(0,l.jsxs)(F.L$,{isOpen:s!==i.Sg.CLOSE,width:375,header:"Dummy header",children:[(0,l.jsx)(F.mQ,{onClose:function(){r((0,O.B4)(i.Sg.CLOSE))},children:d[s].header}),null===(n=d[s])||void 0===n?void 0:n.body,null===(e=d[s])||void 0===e?void 0:e.footer]})}var yn=t(1641),Sn=function(n,e,t){var r=new Blob([t],{type:e});Cn(n,r)},Cn=function(n,e){var t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)},wn=function(n){return new Promise((function(e){var t=new FileReader;t.onloadend=function(){return e(t.result)},t.readAsText(n)}))},zn=t(7762),Mn=t(5861),Zn=t(7757),kn=t.n(Zn),An=t(5587),On=t.n(An),Fn=function(){var n=(0,Mn.Z)(kn().mark((function n(e,t,r,o,a){var s,l,c,u,d,h,f,m;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=["--rmg-svg-width","--rmg-svg-height"].map((function(n){return document.querySelector("svg#".concat(e)).style.getPropertyValue(n).match(/\d+/g)[0]})).map(Number),u=(0,_.Z)(c,2),d=u[1],(h=document.querySelector("svg#".concat(e)).cloneNode(!0)).setAttribute("height",(d*(a||100)/100).toString()),h.style.setProperty("all","initial"),["share",e].map((function(n){var e;return(0,T.Z)((null===(e=(0,T.Z)(document.querySelectorAll("link")).filter((function(e){return e.id==="css_"+n}))[0])||void 0===e?void 0:e.sheet).cssRules).map((function(n){return n.cssText})).join(" ")})).forEach((function(n){var e=document.createElement("style");e.textContent=n,h.prepend(e)})),null===(s=h.querySelector("rect#canvas-border"))||void 0===s||s.setAttribute("stroke",o?"black":"none"),null===(l=h.querySelector("rect#canvas-bg"))||void 0===l||l.setAttribute("fill",r?"none":"white"),t!==i.RM.MTR){n.next=21;break}return n.prev=8,n.next=11,Pn(h);case 11:f=n.sent,(m=document.createElement("style")).textContent=f.join("\n"),h.prepend(m),n.next=21;break;case 17:n.prev=17,n.t0=n.catch(8),alert("Failed to fonts. Fonts in the exported PNG will be missing."),console.error(n.t0);case 21:return n.abrupt("return",h);case 22:case"end":return n.stop()}}),n,null,[[8,17]])})));return function(e,t,r,o,i){return n.apply(this,arguments)}}(),Rn=function(n){return new Promise((function(e){var t=new FileReader;t.onloadend=function(){return e(t.result)},t.readAsDataURL(n)}))},Pn=function(){var n=(0,Mn.Z)(kn().mark((function n(e){var t,r,o,i;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=Array.from(new Set([].concat((0,T.Z)(e.querySelectorAll(".rmg-name__zh")),(0,T.Z)(e.querySelectorAll(".rmg-name__en"))).map((function(n){return n.innerHTML})).join("").replace(/[\s]/g,""))).join(""),n.next=3,document.fonts.load("80px GenYoMin TW, Vegur",t);case 3:return r=n.sent,o=Array.from(document.querySelector("link#css_share").sheet.cssRules[0].styleSheet.cssRules),i=r.reduce((function(n,e){var t,r=(t=e,o.find((function(n){var e=n.style;return e.fontFamily.replace(/^"(.+)"$/,"$1")===t.family&&e.unicodeRange===t.unicodeRange})));return r?n.find((function(n){var e=n.style,t=r.style;return e.fontFamily===t.fontFamily&&e.unicodeRange===t.unicodeRange}))?n:n.concat(r):n}),[]),n.next=8,Promise.all(i.map(function(){var n=(0,Mn.Z)(kn().mark((function n(e){var t,r;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(En(e));case 3:return t=n.sent,n.t0=Rn,n.next=7,t.blob();case 7:return n.t1=n.sent,n.next=10,(0,n.t0)(n.t1);case 10:return r=n.sent,n.abrupt("return",e.cssText.replace(/src:[ \w('",\-:/.)]+;/g,"src: url('".concat(r,"'); ")));case 14:return n.prev=14,n.t2=n.catch(0),console.error(n.t2),n.abrupt("return","");case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e){return n.apply(this,arguments)}}()));case 8:return n.abrupt("return",n.sent);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),En=function(n){var e,t=n.style.src;return navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?t.replace(/^url\("([\S]+)"\).*$/,"$1"):"/rmg/styles/"+(null===(e=t.match(/^url\("([\S*]+)"\)/))||void 0===e?void 0:e[1])},Tn=function(){var n=(0,Mn.Z)(kn().mark((function n(e,t){var r,o,i,a;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.viewBox.baseVal.width,o=e.viewBox.baseVal.height,(i=document.querySelectorAll("canvas")[0]).width=Number(r)*window.devicePixelRatio*t,i.height=Number(o)*window.devicePixelRatio*t,e.setAttribute("width",i.width.toString()),e.setAttribute("height",i.height.toString()),(a=i.getContext("2d")).clearRect(0,0,i.width,i.height),e.querySelectorAll(".rmg-name__en.rmg-name__mtr--station").forEach((function(n){return n.setAttribute("font-size","11px")})),e.querySelectorAll(".rmg-name__en.rmg-name__gzmtr--next2-dest").forEach((function(n){return n.setAttribute("font-size","8.5px")})),e.querySelectorAll("text, tspan").forEach((function(n){var e=window.getComputedStyle(n);n.setAttribute("font-family",e.fontFamily),n.setAttribute("fill",e.fill),n.setAttribute("dominant-baseline",e.dominantBaseline),n.setAttribute("text-anchor",e.textAnchor||"")})),n.abrupt("return",new Promise((function(n,t){var r=new Image;r.onload=function(){a.drawImage(r,0,0,i.width,i.height),i.toBlob((function(e){return n(e)}),"image/png")},r.onerror=t,r.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.outerHTML)))})));case 13:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();function _n(n){var e=n.isOpen,t=n.onClose,s=(0,R.$)().t,c=(0,m.I0)(),u=(0,r.useState)(""),d=(0,_.Z)(u,2),h=d[0],f=d[1],j=(0,r.useState)(!1),x=(0,_.Z)(j,2),v=x[0],b=x[1],y=(0,r.useState)(!1),S=(0,_.Z)(y,2),C=S[0],w=S[1],z=(0,r.useState)(100),M=(0,_.Z)(z,2),Z=M[0],k=M[1],A=(0,r.useState)("png"),P=(0,_.Z)(A,2),T=P[0],N=P[1],U=(0,a.CG)((function(n){return n.app.canvasToShow})),B=(0,a.CG)((function(n){return n.param})),I=B.style,D=B.stn_list,L=B.current_stn_idx,W=B.line_name;(0,r.useEffect)((function(){"all"!==U&&""!==h&&U!==h&&f("")}),[U]);var H=i.tK[I].reduce((function(n,e){return"all"===U||e===U?(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},e,s("CanvasType."+e))):(0,en.Z)({},n)}),{"":s("DownloadModal.pleaseSelect")}),J=[25,33,50,67,75,80,90,100,110,125,150,175,200,250,300,400,500].reduce((function(n,e){return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},e,"".concat(e,"%")))}),{}),V={png:s("DownloadModal.png"),svg:s("DownloadModal.svg")},$=[{type:"select",label:s("DownloadModal.canvas"),value:h,options:H,disabledOptions:[""],onChange:function(n){return f(n)},minW:"full"},{type:"switch",label:s("DownloadModal.transparent"),isChecked:v,onChange:b,oneLine:!0,minW:"full"},{type:"switch",label:s("DownloadModal.showBorder"),isChecked:C,onChange:w,oneLine:!0,minW:"full"},{type:"select",label:s("DownloadModal.scale"),value:Z,options:J,onChange:function(n){return k(n)}},{type:"select",label:s("DownloadModal.format"),value:T,options:V,onChange:function(n){return N(n)}}],q=function(){var n=(0,Mn.Z)(kn().mark((function n(e){var r,o,i,a,s,l,u,d,f,m,j;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c((0,O.wt)(!0)),r="current"===e?[L]:Object.keys(D).filter((function(n){return!["linestart","lineend"].includes(n)})),o=new(On()),i=(0,zn.Z)(r),n.prev=4,i.s();case 6:if((a=i.n()).done){n.next=29;break}return s=a.value,n.next=10,c((0,p.lS)(s));case 10:return n.next=12,Fn(h,I,v,C,Z);case 12:if(l=n.sent,document.body.appendChild(l),u="rmg.".concat(s,".").concat(D[s].name[0],".").concat(D[s].name[1]).replaceAll(" ","_"),"png"!==T){n.next=25;break}return n.next=18,Tn(l,Z/100);case 18:if(d=n.sent,!navigator.userAgent.includes("Safari")||navigator.userAgent.includes("Chrome")){n.next=22;break}return n.next=22,new Promise((function(n){setTimeout((function(){console.log("Sleep 1 second for Safari"),n()}),1e3)}));case 22:r.length>1?o.file("".concat(u,".png"),d):Cn("".concat(u,".png"),d),n.next=26;break;case 25:"svg"===T&&(l.removeAttribute("height"),f="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(l.outerHTML))),r.length>1?o.file("".concat(u,".svg"),f.split("base64,")[1],{base64:!0}):Sn(u+".svg","image/svg+xml",l.outerHTML));case 26:document.body.removeChild(l);case 27:n.next=6;break;case 29:n.next=34;break;case 31:n.prev=31,n.t0=n.catch(4),i.e(n.t0);case 34:return n.prev=34,i.f(),n.finish(34);case 37:if(!(r.length>1)){n.next=43;break}return n.next=40,o.generateAsync({type:"blob"});case 40:m=n.sent,j="rmg.".concat(W[0],".").concat(W[1],".zip").replaceAll(" ","_"),Cn(j,m);case 43:return n.next=45,c((0,p.lS)(L));case 45:c((0,O.wt)(!1)),t();case 47:case"end":return n.stop()}}),n,null,[[4,31,34,37]])})));return function(e){return n.apply(this,arguments)}}();return(0,l.jsxs)(G.u_,{isOpen:e,onClose:t,children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[(0,l.jsx)(G.xB,{children:s("DownloadModal.title")}),(0,l.jsx)(G.ol,{}),(0,l.jsx)(G.fe,{children:(0,l.jsx)(F.M5,{fields:$})}),(0,l.jsx)(G.mz,{children:(0,l.jsxs)(g.Ug,{children:[(0,l.jsx)(E.zx,{colorScheme:"teal",variant:"outline",size:"sm",onClick:function(){return q("current")},disabled:!h,children:s("DownloadModal.downloadOne")}),I!==i.RM.GZMTR&&(0,l.jsx)(E.zx,{colorScheme:"teal",variant:"outline",size:"sm",onClick:function(){return q("all")},disabled:!h,children:s("DownloadModal.downloadAll")})]})})]})]})}function Nn(){var n=(0,R.$)().t,e=(0,r.useState)(!1),t=(0,_.Z)(e,2),o=t[0],i=t[1],s=(0,a.CG)((function(n){return n.param}));return(0,l.jsxs)(yn.v2,{children:[(0,l.jsx)(yn.j2,{as:E.zx,variant:"ghost",size:"sm",rightIcon:(0,l.jsx)(N.Yc6,{}),children:n("DownloadActions.downloads")}),(0,l.jsxs)(yn.qy,{children:[(0,l.jsx)(yn.sN,{onClick:function(){Sn("RMG_".concat((new Date).valueOf(),".json"),"application/json",JSON.stringify(s))},children:n("DownloadActions.configFile")}),(0,l.jsx)(yn.sN,{onClick:function(){return i(!0)},children:n("DownloadActions.images")})]}),(0,l.jsx)(_n,{isOpen:o,onClose:function(){return i(!1)}})]})}var Gn=t(7253);function Un(n){var e,t,r,o=n.isOpen,a=n.onClose,s=n.cancelRef,c=n.uploadedParam,u=n.onOpenParam,d=(0,R.$)().t;return(0,l.jsx)(G.aR,{isOpen:o,leastDestructiveRef:s,onClose:a,children:(0,l.jsx)(G.dh,{children:(0,l.jsxs)(G._T,{children:[(0,l.jsx)(G.fY,{fontSize:"lg",fontWeight:"bold",children:d("UploadConfirmModal.title")}),(0,l.jsxs)(G.iP,{children:[d("UploadConfirmModal.message1"),(0,l.jsx)(F.l2,{name:(null===c||void 0===c||null===(e=c.line_name)||void 0===e?void 0:e.join(" "))||"",fg:(null===c||void 0===c||null===(t=c.theme)||void 0===t?void 0:t[3])||i.AJ.white,bg:(null===c||void 0===c||null===(r=c.theme)||void 0===r?void 0:r[2])||"#AAAAAA"}),d("UploadConfirmModal.message2")+(c?Object.keys(c.stn_list).length-2:0)+d("UploadConfirmModal.message3")]}),(0,l.jsxs)(G.xo,{children:[(0,l.jsx)(E.zx,{ref:s,onClick:a,children:d("UploadConfirmModal.cancel")}),(0,l.jsx)(E.zx,{colorScheme:"teal",onClick:function(){c&&u(c),a()},ml:3,children:d("UploadConfirmModal.confirm")})]})]})})})}var Bn=t(6726),In=t(9076);function Dn(n){var e=n.isOpen,r=n.onClose,o=n.onOpenParam,i=(0,R.$)().t,s=(0,a.TL)(),c=function(){var n=(0,Mn.Z)(kn().mark((function n(e,r){var i;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s((0,O.wt)(!0)),n.next=3,t(1427)("./".concat(e,"/").concat(r,".json"));case 3:i=n.sent,o(i.default);case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return(0,l.jsxs)(G.u_,{isOpen:e,onClose:r,children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[(0,l.jsx)(G.xB,{children:i("TemplateModal.title")}),(0,l.jsx)(G.ol,{}),(0,l.jsx)(G.fe,{children:(0,l.jsxs)(U.mQ,{isLazy:!0,size:"sm",orientation:"vertical",children:[(0,l.jsx)(U.td,{maxW:150,children:In.p.map((function(n){return(0,l.jsx)(U.OK,{children:(0,Bn.O)(n.name)},n.id)}))}),(0,l.jsx)(U.nP,{maxW:250,children:Object.entries(In.Q).sort((function(n,e){return In.p.findIndex((function(e){return e.id===n[0]}))-In.p.findIndex((function(n){return n.id===e[0]}))})).map((function(n){var e=(0,_.Z)(n,2),t=e[0],r=e[1];return(0,l.jsx)(U.x4,{as:g.kC,flexDirection:"column",py:0,px:1,children:r.map((function(n){return(0,l.jsx)(E.zx,{variant:"ghost",size:"sm",justifyContent:"flex-start",overflow:"hidden",onClick:function(){return c(t,n.filename)},children:(0,Bn.O)(n.name)},n.filename)}))},t)}))})]})})]})]})}var Ln=t(3486),Wn=t(3963);function Hn(){var n=(0,R.$)(),e=n.t,t=n.i18n,o=(0,m.I0)(),s=(0,a.CG)((function(n){return n.param.style})),c=(0,r.useState)(!1),u=(0,_.Z)(c,2),d=u[0],h=u[1],f=(0,r.useState)(!1),p=(0,_.Z)(f,2),j=p[0],g=p[1],x=(0,r.useState)(void 0),v=(0,_.Z)(x,2),b=v[0],y=v[1],S=(0,r.useRef)(null),C=(0,r.useRef)(null),w=function(){var n=(0,Mn.Z)(kn().mark((function n(t){var r,i,a,s;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null===(r=t.target.files)||void 0===r?void 0:r[0],console.log("OpenActions.handleUpload():: received file",i),"application/json"===(null===i||void 0===i?void 0:i.type)){n.next=6;break}o((0,O.bI)("error",e("OpenActions.invalidType"))),n.next=19;break;case 6:return n.prev=6,n.next=9,wn(i);case 9:a=n.sent,s=(0,Gn.db)(JSON.parse(a)),y(s),h(!0),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(6),o((0,O.bI)("error",e("OpenActions.unknownError"))),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",n.t0);case 19:t.target.value="";case 20:case"end":return n.stop()}}),n,null,[[6,15]])})));return function(e){return n.apply(this,arguments)}}(),z=function(n){o(function(n){return function(){var e=(0,Mn.Z)(kn().mark((function e(t,r){var o,a,s;return kn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,Gn.db)(n),e.next=3,window.rmgStorage.writeFile("rmgParam",JSON.stringify(o));case 3:return t((0,O.B4)(i.Sg.CLOSE)),t((0,O.NQ)("linestart")),a=r().app.canvasToShow,s=i.tK[o.style].some((function(n){return n===a}))?a:i.iu,e.next=9,t((0,O.SC)(s));case 9:(0,Ln.P)(o),t((0,O.wt)(!1));case 11:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()}(n))};return(0,l.jsxs)(yn.v2,{children:[(0,l.jsx)(yn.j2,{as:E.zx,variant:"ghost",size:"sm",rightIcon:(0,l.jsx)(N.Yc6,{}),children:e("OpenActions.openFrom")}),(0,l.jsxs)(yn.qy,{children:[(0,l.jsx)(yn.sN,{icon:(0,l.jsx)(N.KVB,{}),onClick:function(){return z((0,Wn.R)(s,t.language))},children:e("Empty template")}),(0,l.jsx)("input",{ref:C,type:"file",accept:".json",hidden:!0,onChange:w,"data-testid":"file-upload"}),(0,l.jsx)(yn.sN,{icon:(0,l.jsx)(N.Ap8,{}),onClick:function(){var n;return null===C||void 0===C||null===(n=C.current)||void 0===n?void 0:n.click()},children:e("OpenActions.upload")}),(0,l.jsx)(yn.sN,{icon:(0,l.jsx)(N.uEt,{}),onClick:function(){return g(!0)},children:e("OpenActions.templates")})]}),(0,l.jsx)(Un,{isOpen:d,onClose:function(){return h(!1)},cancelRef:S,uploadedParam:b,onOpenParam:z}),(0,l.jsx)(Dn,{isOpen:j,onClose:function(){return g(!1)},onOpenParam:z})]})}function Jn(){var n=(0,R.$)().t,e=(0,m.I0)();return(0,l.jsxs)(g.Ug,{ml:"auto",children:[(0,l.jsx)(Nn,{}),(0,l.jsx)(Hn,{}),(0,l.jsx)(E.zx,{variant:"solid",size:"sm",colorScheme:"teal",leftIcon:(0,l.jsx)(N.Zox,{}),onClick:function(){return e((0,O.B4)(i.Sg.STYLE))},children:n("HeaderActions.editStyle")})]})}function Vn(){var n=(0,R.$)().t,e=(0,m.I0)(),t=(0,a.CG)((function(n){return n.app})),r=t.canvasToShow,o=t.canvasScale,s=(0,a.CG)((function(n){return n.param.style})),c=[i.iu].concat((0,T.Z)(i.tK[s])).map((function(e){return{label:n("CanvasType."+e),value:e}})),u=[{type:"custom",label:n("Canvas to show"),component:(0,l.jsx)(K,{selections:c,defaultValue:r,onChange:function(n){return e((0,O.SC)(n))}})},{type:"slider",label:n("Canvas scale"),value:o,min:.1,max:2,step:.1,onChange:function(n){return e((0,O.EO)(n))},leftIcon:(0,l.jsx)(N._a6,{}),rightIcon:(0,l.jsx)(N.Ers,{}),minW:160}];return(0,l.jsxs)(g.kC,{align:"center",wrap:"wrap",pl:2,pr:3,py:1,children:[(0,l.jsx)(F.M5,{fields:u}),(0,l.jsx)(Jn,{})]})}var $n,qn="5.2.14";!function(n){n.DEV="DEV",n.UAT="UAT",n.PRD="PRD"}($n||($n={}));var Xn=t(6899),Yn=t(3504),Kn=t(6450),Qn=t(6866),ne=["52PD","jealousyge","Jay20081229","clearng-kly","Dingdong2334","linchen1965","C1P918R","AnDanJuneUnderline","GrassRabbit1410","xiany114514","Andy1782010","Thomastzc","Tianxiu11111"];function ee(n){var e=n.isOpen,t=n.onClose,r=(0,R.$)().t;return(0,l.jsxs)(G.u_,{isOpen:e,onClose:t,size:"xl",scrollBehavior:"inside",children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[(0,l.jsx)(G.xB,{children:r("Help and support")}),(0,l.jsx)(G.ol,{}),(0,l.jsxs)(G.fe,{children:[(0,l.jsx)(g.X6,{as:"h5",size:"sm",mb:2,children:r("Terms and conditions")}),(0,l.jsxs)(g.GS,{children:[(0,l.jsxs)(g.HC,{children:["The layout of the elements on the signage or rail map, is designed by"," ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",(0,l.jsx)(B.JO,{as:N.jhj})]}),", ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",(0,l.jsx)(B.JO,{as:N.jhj})]})," or ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",(0,l.jsx)(B.JO,{as:N.jhj})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",(0,l.jsx)("br",{}),"\u6a19\u8a8c\u7248\u6216\u8def\u7dda\u5716\u4e4b\u5143\u7d20\u4e4b\u4f48\u5c40\uff0c\u57fa\u65bc\u4f60\u6240\u9078\u64c7\u4e4b\u98a8\u683c\uff0c\u70ba",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["\u5ee3\u5dde\u5730\u9435\u96c6\u5718\u516c\u53f8 ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\uff0c",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["\u6e2f\u9435\u516c\u53f8 ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\u6216",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["\u4e0a\u6d77\u7533\u901a\u5730\u9435\u96c6\u5718 ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\u6240\u8a2d\u8a08\u3002\u5728\u7522\u751f\u4e4b\u5716\u50cf\u7528\u4f5c\u5546\u696d\u7528\u9014\u524d\uff0c\u4f60\u61c9\u5411\u76f8\u95dc\u516c\u53f8\u53d6\u5f97\u9069\u7576\u4e4b\u8a31\u53ef\u8b49\u6216\u6388\u6b0a\u3002"]}),(0,l.jsxs)(g.HC,{children:["The elements including shapes and lines on the image are drawn by"," ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",(0,l.jsx)(B.JO,{as:N.jhj})]})," and ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",(0,l.jsx)(B.JO,{as:N.jhj})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",(0,l.jsx)("br",{}),"\u5716\u50cf\u4e4b\u5143\u7d20\uff0c\u5305\u62ec\u5716\u5f62\u53ca\u7dda\u689d\uff0c\u5747\u7531",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\u53ca",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\u57fa\u65bc\u4e0a\u8ff0\u516c\u53f8\u4e4b\u8a2d\u8a08\u6a19\u6e96\u6216\u6e96\u5247\u7e6a\u88fd\u3002\u4f60\u53ef\u5c07\u5176\u7528\u65bc\u4efb\u4f55\u76ee\u7684\uff0c\u4f46\u6211\u5011\u5efa\u8b70\u4f60\u65bc\u4f7f\u7528\u540c\u6642\u9644\u4ee5\u6211\u5011\u4e4b\u540d\u5b57\u4ee5\u53ca\u8a72\u8edf\u4ef6\u4e4b\u9023\u7d50\u3002"]}),(0,l.jsxs)(g.HC,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Generator uses"," ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",(0,l.jsx)(B.JO,{as:N.jhj})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",(0,l.jsx)("br",{}),"\u7531\u65bc\u8457\u4f5c\u6b0a\u53ca\u5176\u4ed6\u6cd5\u5f8b\u9650\u5236\uff0c\u9435\u8def\u8def\u7dda\u5716\u7522\u751f\u5668\u4f7f\u7528",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["\u7531ButTaiwan\u63d0\u4f9b\u4e4b\u6e90\u6a23\u660e\u9ad4 ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\uff0c\u4ee5\u53caVegur\uff0c\u4ee5\u4ee3\u66ff\u6e2f\u9435\u6a23\u5f0f\u6a19\u8a8c\u724c\u6240\u4f7f\u7528\u4e4b\u5730\u9435\u5b8b\u53caMyriad Pro\u3002\u5728\u7522\u751f\u4e4b\u5716\u50cf\u7528\u4f5c\u5546\u696d\u7528\u9014\u524d\uff0c\u4f60\u61c9\u5411\u5b57\u578b\u751f\u7522\u5ee0\u5546\u53d6\u5f97\u9069\u7576\u4e4b\u8a31\u53ef\u8b49\u6216\u6388\u6b0a\u3002"]}),(0,l.jsxs)(g.HC,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes, under the conditions above.",(0,l.jsx)("br",{}),"\u8f38\u51fa\u4e4bPNG\u6216SVG\u7a2e\u985e\u4e4b\u5716\u50cf\u53ef\u57fa\u65bc\u4e0a\u8ff0\u689d\u6b3e\uff0c\u7528\u65bc\u4fee\u6539\u3001\u767c\u884c\u6216\u5176\u4ed6\u7528\u9014\u3002"]}),(0,l.jsxs)(g.HC,{children:["All flag emojis shown on Windows platforms are designed by"," ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",(0,l.jsx)(B.JO,{as:N.jhj})]})," ","\u2013 the open-source emoji and icon project. License:",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",(0,l.jsx)(B.JO,{as:N.jhj})]}),(0,l.jsx)("br",{}),"\u65bcWindows\u4f5c\u696d\u7cfb\u7d71\u4e0a\u986f\u793a\u4e4b\u65d7\u5e5fEmoji\u70ba",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"\u6240\u8a2d\u8a08\u3002\u8a31\u53ef\u8b49\uff1a",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",(0,l.jsx)(B.JO,{as:N.jhj})]})]}),(0,l.jsxs)(g.HC,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",(0,l.jsx)("br",{}),"\u6211\u5011\u4fdd\u7559\u4fee\u6539\u3001\u65b0\u589e\u6216\u79fb\u9664\u4e0a\u8ff0\u689d\u6b3e\u4e4b\u6b0a\u5229\uff0c\u800c\u7121\u9700\u53e6\u884c\u901a\u77e5\u3002\u4e2d\u6587\u8b6f\u672c\u50c5\u4f9b\u53c3\u8003\uff0c\u6587\u7fa9\u5982\u8207\u82f1\u6587\u6709\u6b67\u7570\uff0c\u6982\u4ee5\u82f1\u6587\u672c\u70ba\u6e96\u3002"]})]}),(0,l.jsx)(g.X6,{as:"h5",size:"sm",mt:3,mb:2,children:r("Contributors")}),(0,l.jsx)(g.X6,{as:"h6",size:"xs",my:1,children:r("Core contributors")}),(0,l.jsxs)(g.gC,{children:[(0,l.jsxs)(Kn.Vp,{size:"lg",minW:"80%",onClick:function(){return window.open("https://github.com/wongchito","_blank")},cursor:"pointer",children:[(0,l.jsx)(Qn.qE,{src:"https://github.com/wongchito.png",size:"lg",my:2,ml:-1,mr:2}),(0,l.jsxs)(Kn.Sn,{children:[(0,l.jsx)(g.xv,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Chito Wong"}),(0,l.jsx)(g.xv,{fontSize:"sm",children:"Project initiator"}),(0,l.jsx)(g.xv,{fontSize:"sm",children:"Author of MTR and Guangzhou Metro styles"})]})]}),(0,l.jsxs)(Kn.Vp,{size:"lg",minW:"80%",onClick:function(){return window.open("https://github.com/thekingofcity","_blank")},cursor:"pointer",children:[(0,l.jsx)(Qn.qE,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),(0,l.jsxs)(Kn.Sn,{children:[(0,l.jsx)(g.xv,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),(0,l.jsx)(g.xv,{fontSize:"sm",children:"Author of Shanghai Metro style"}),(0,l.jsx)(g.xv,{fontSize:"sm",children:"Desktop version (Electron) maintainer"})]})]})]}),(0,l.jsx)(g.X6,{as:"h6",size:"xs",my:1,children:r("Other contributors")}),(0,l.jsx)(g.kC,{wrap:"wrap",children:ne.map((function(n){return(0,l.jsxs)(Kn.Vp,{size:"lg",mb:1,mr:1,onClick:function(){return window.open("https://github.com/railmapgen/rmg/issues?q=is:issue+author:".concat(n),"_blank")},cursor:"pointer",children:[(0,l.jsx)(Qn.qE,{src:"https://github.com/".concat(n,".png"),size:"xs",ml:-1,mr:2}),(0,l.jsx)(Kn.Sn,{children:n})]},n)}))}),(0,l.jsxs)(g.xv,{children:[r("Visit")," ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://github.com/railmapgen/rmg/wiki/How-to-add-color-palette-and-line-templates",isExternal:!0,children:[r("Contribution Wiki")," ",(0,l.jsx)(B.JO,{as:N.jhj})]}),r(", open an issue and join us today!")]})]}),(0,l.jsx)(G.mz,{children:(0,l.jsx)(E.zx,{colorScheme:"teal",onClick:function(){return window.open("https://github.com/railmapgen/rmg","_blank")},children:r("Visit GitHub")})})]})]})}function te(){var n=(0,R.$)(),e=n.t,t=n.i18n,o=(0,m.I0)(),a=(0,r.useState)(!1),s=(0,_.Z)(a,2),c=s[0],u=s[1],d="localhost"===window.location.hostname?$n.DEV:window.location.hostname.includes("uat")?$n.UAT:$n.PRD,h=function(){var n=(0,Mn.Z)(kn().mark((function n(e){var r;return kn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.changeLanguage(e);case 2:r=n.sent,document.documentElement.lang=e,document.title=r("WindowHeader.heading");case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,l.jsxs)(g.kC,{pl:2,pr:2,align:"center",children:[(0,l.jsx)(g.X6,{as:"h4",size:"md",children:e("WindowHeader.heading")}),(0,l.jsx)(F.xt,{environment:d,version:qn,popoverHeader:(0,l.jsxs)(Xn.c,{i18nKey:"WindowHeader.popoverHeader",environment:d,children:["You're on ",{environment:d}," environment!"]}),popoverBody:(0,l.jsxs)(Xn.c,{i18nKey:"WindowHeader.popoverBody",children:["This is a testing environment where we don't guarantee the stability and compatibility. Please switch back to"," ",(0,l.jsxs)(g.rU,{color:"teal.500",href:"https://railmapgen.github.io"+window.location.pathname,isExternal:!0,children:["Production environment ",(0,l.jsx)(B.JO,{as:N.jhj})]}),"."]})}),(0,l.jsxs)(g.Ug,{ml:"auto",children:[(0,l.jsxs)(yn.v2,{children:[(0,l.jsx)(yn.j2,{as:E.hU,icon:(0,l.jsx)(N.Ys1,{}),variant:"ghost",size:"sm"}),(0,l.jsx)(yn.qy,{children:Object.values(i.RM).map((function(n){return(0,l.jsx)(Yn.rU,{to:n,children:(0,l.jsx)(yn.sN,{onClick:function(){return o((0,p.yL)(n))},children:e("WindowHeader."+n)})},n)}))})]}),(0,l.jsxs)(yn.v2,{children:[(0,l.jsx)(yn.j2,{as:E.hU,icon:(0,l.jsx)(N.mp2,{}),variant:"ghost",size:"sm"}),(0,l.jsxs)(yn.qy,{children:[(0,l.jsx)(yn.sN,{onClick:function(){return h(i.sp.English)},children:"English"}),(0,l.jsx)(yn.sN,{onClick:function(){return h(i.sp.ChineseSimp)},children:"\u7b80\u4f53\u4e2d\u6587"}),(0,l.jsx)(yn.sN,{onClick:function(){return h(i.sp.ChineseTrad)},children:"\u7e41\u9ad4\u4e2d\u6587"})]})]}),(0,l.jsx)(E.hU,{size:"sm",variant:"ghost","aria-label":"Help",icon:(0,l.jsx)(N.r$n,{}),onClick:function(){return u(!0)}})]}),(0,l.jsx)(ee,{isOpen:c,onClose:function(){return u(!1)}})]})}var re=t(7279),oe=t(1762),ie=t(5984),ae=function(n,e,t,r){return function(a,s){for(var l=s().param.stn_list,c=(0,ie.x0)(6);c in l;)c=(0,ie.x0)(6);var u,d,h={name:["\u672a\u547d\u540d "+(u=c),"Unnamed "+u],secondaryName:!1,num:"00",services:[i.K9.local],parents:[],children:[],branch:{left:[],right:[]},transfer:{info:[[]],tick_direc:i.wA.right,paid_area:!0,osi_names:[]},facility:i.mV.none,loop_pivot:!1};if("new"!==n){var f,m=(0,en.Z)((0,en.Z)({},l),{},(f={},(0,o.Z)(f,e,(0,en.Z)((0,en.Z)({},l[e]),{},{children:l[e].children.map((function(n){return n===t?c:n})),branch:{left:l[e].branch.left,right:l[e].branch.right.length&&l[e].branch.right[1]===t?[l[e].branch.right[0],c]:l[e].branch.right}})),(0,o.Z)(f,t,(0,en.Z)((0,en.Z)({},l[t]),{},{parents:l[t].parents.map((function(n){return n===e?c:n})),branch:{left:l[t].branch.left.length&&l[t].branch.left[1]===e?[l[t].branch.left[0],c]:l[t].branch.left,right:l[t].branch.right}})),(0,o.Z)(f,c,(0,en.Z)((0,en.Z)({},h),{},{parents:[e],children:[t]})),f));return a((0,p.BI)(m)),c}if(!r)return!1;var j=(0,en.Z)((0,en.Z)({},l),{},(d={},(0,o.Z)(d,e,(0,en.Z)((0,en.Z)({},l[e]),{},{children:"upper"===r?[c,l[e].children[0]]:[l[e].children[0],c],branch:{left:l[e].branch.left,right:[i.H_.through,c]}})),(0,o.Z)(d,t,(0,en.Z)((0,en.Z)({},l[t]),{},{parents:"upper"===r?[c,l[t].parents[0]]:[l[t].parents[0],c],branch:{left:[i.H_.through,c],right:l[t].branch.right}})),(0,o.Z)(d,c,(0,en.Z)((0,en.Z)({},h),{},{parents:[e],children:[t]})),d));return a((0,p.BI)(j)),c}},se=function(n,e){return function(t,r){var o=r().param.stn_list,i=r().helper.branches;return i[0].includes(n)&&i[0].includes(e)?i[0].indexOf(n)>=i[0].indexOf(e)?"Not in correct ordering":"linestart"===n&&"lineend"===e?"Should not be parallel to main line":"linestart"===n&&1===i[0].indexOf(e)?"Branch should not be open jaw from the first station":"lineend"===e&&i[0].indexOf(n)===i[0].length-2?"Branch should not be open jaw from the last station":o[n].children.length>1||o[e].parents.length>1?"Branch already exist":i.slice(1).some((function(t){return t.slice(1,-1).includes(n)||t.slice(1,-1).includes(e)}))?"Cannot branch out from existing branch":i[0].slice(i[0].indexOf(n)+1,i[0].indexOf(e)).every((function(n){return 1===o[n].parents.length&&1===o[n].children.length}))?"":"One or more stations between both ends are branching out":"Branch should end at main line"}};function le(n){var e,t,s=n.isOpen,c=n.onClose,u=(0,R.$)().t,d=(0,a.TL)(),h=(0,a.CG)((function(n){return n.app.selectedBranch})),f=(0,a.CG)((function(n){return n.param})),m=f.style,p=f.stn_list,j=(0,a.CG)((function(n){return n.helper.branches})),x=(0,r.useState)(h),v=(0,_.Z)(x,2),b=v[0],y=v[1],S=(0,r.useState)("before"),C=(0,_.Z)(S,2),w=C[0],z=C[1],M=(0,r.useState)(""),Z=(0,_.Z)(M,2),k=Z[0],A=Z[1],P=(0,r.useState)(!1),T=(0,_.Z)(P,2),N=T[0],U=T[1];(0,r.useEffect)((function(){y(h)}),[h]),(0,r.useEffect)((function(){s||U(!1)}),[s]);var B,I=null!==(e=null===(t=j[Number(b)])||void 0===t?void 0:t.slice(1,-1))&&void 0!==e?e:[],D=[{type:"select",label:u("AddStationModal.where"),value:b,options:(0,en.Z)({},j.reduce((function(n,e,t){return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},t,0===t?u("AddStationModal.main"):m===i.RM.SHMetro&&(0,dn.Qo)(e,p)?u("AddStationModal.external")+" "+t:u("AddStationModal.branch")+" "+t))}),{})),onChange:function(n){return L(n)},minW:"full"},{type:"select",label:u("AddStationModal.preposition"),value:w,options:{before:u("AddStationModal.before"),after:u("AddStationModal.after")},onChange:function(n){return z(n)}},{type:"select",label:u("AddStationModal.pivot"),value:k,options:(B=I,B.reduce((function(n,e){var t;return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},e,null===(t=p[e])||void 0===t?void 0:t.name.join(" - ")))}),{"":u("AddStationModal.pleaseSelect")})),disabledOptions:[""],onChange:function(n){return A(n)}}],L=function(n){y(n),A("")};return(0,l.jsxs)(G.u_,{isOpen:s,onClose:c,children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[N&&(0,l.jsxs)(oe.bZ,{status:"error",variant:"solid",size:"xs",children:[(0,l.jsx)(oe.zM,{}),u("AddStationModal.error")]}),(0,l.jsxs)(g.xu,{position:"relative",children:[(0,l.jsx)(G.xB,{children:u("AddStationModal.title")}),(0,l.jsx)(G.ol,{})]}),(0,l.jsx)(G.fe,{children:(0,l.jsx)(F.M5,{fields:D})}),(0,l.jsx)(G.mz,{children:(0,l.jsx)(E.zx,{colorScheme:"teal",onClick:function(){var n=d(function(n,e,t){return function(r,o){var i=o().helper.branches[n];if(null!==i&&void 0!==i&&i.length){if("before"===e){var a=i[i.indexOf(t)-1];return r(ae(n.toString(),a,t))}var s=i[i.indexOf(t)+1];return r(ae(n.toString(),t,s))}return!1}}(b,w,k));n?(c(),d((0,O.NQ)(n)),d((0,O.B4)(i.Sg.STATION))):(console.log("false here"),U(!0))},disabled:!k,children:u("AddStationModal.submit")})})]})]})}function ce(n){var e=n.isOpen,t=n.onClose,s=(0,R.$)().t,c=(0,a.TL)(),u=(0,r.useState)("new"),d=(0,_.Z)(u,2),h=d[0],f=d[1],m=(0,r.useState)(""),p=(0,_.Z)(m,2),j=p[0],g=p[1],x=(0,r.useState)(""),v=(0,_.Z)(x,2),b=v[0],y=v[1],S=(0,r.useState)("upper"),C=(0,_.Z)(S,2),w=C[0],z=C[1],M=(0,r.useState)(""),Z=(0,_.Z)(M,2),k=Z[0],A=Z[1],O=(0,r.useState)(""),P=(0,_.Z)(O,2),T=P[0],N=P[1],U=(0,a.CG)((function(n){return n.param})),B=U.style,I=U.stn_list;(0,r.useEffect)((function(){e||(f("new"),g(""),y(""))}),[e]);var D,L=(D=c((function(n,e){var t=e().param.stn_list;return e().helper.branches[0].filter((function(n){var e=t[n].parents.length+t[n].children.length===4,r=0===hn(n,t);return!e&&r}))})),D.reduce((function(n,e){var t;return(0,en.Z)((0,en.Z)({},n),{},(0,o.Z)({},e,null===(t=I[e])||void 0===t?void 0:t.name.join(" - ")))}),{"":s("NewBranchModal.pleaseSelect")})),W=[{type:"select",label:s("NewBranchModal.where"),value:h,options:{new:s("NewBranchModal.new"),ext:s("NewBranchModal.ext")},disabledOptions:B===i.RM.SHMetro?[]:["ext"],onChange:function(n){return H(n)},minW:"full"},{type:"select",label:s("NewBranchModal.from"),value:j,options:L,disabledOptions:[""],onChange:function(n){return J(n)},isInvalid:Boolean(k)},{type:"select",label:s("NewBranchModal.to"),value:b,options:L,disabledOptions:[""],onChange:function(n){return V(n)},isInvalid:Boolean(T)},{type:"select",label:s("NewBranchModal.position"),value:w,options:{upper:s("NewBranchModal.upper"),lower:s("NewBranchModal.lower")},onChange:function(n){return z(n)},minW:"full",hidden:"new"!==h||B===i.RM.SHMetro}],H=function(n){f(n),g(""),y(""),A(""),N("")},J=function(n){g(n),A(""),n&&b&&N(c(se(n,b)))},V=function(n){y(n),N(""),j&&n&&A(c(se(j,n)))},$=Boolean(!j||!b||k||T);return(0,l.jsxs)(G.u_,{isOpen:e,onClose:t,children:[(0,l.jsx)(G.ZA,{}),(0,l.jsxs)(G.hz,{children:[(0,l.jsx)(G.xB,{children:s("NewBranchModal.title")}),(0,l.jsx)(G.ol,{}),(0,l.jsx)(G.fe,{children:(0,l.jsx)(F.M5,{fields:W})}),(0,l.jsx)(G.mz,{children:(0,l.jsx)(E.zx,{colorScheme:"teal",title:$?k||T:s("NewBranchModal.submit"),onClick:function(){("ext"===h?c(ae("new",j,b,"lower")):B===i.RM.SHMetro?c(ae("new",j,b,"upper")):c(ae("new",j,b,w)))&&t()},disabled:$,children:s("NewBranchModal.submit")})})]})]})}var ue=(0,r.lazy)((function(){return Promise.all([t.e(2953),t.e(1985)]).then(t.bind(t,4523))}));function de(){var n=(0,R.$)().t,e=(0,a.TL)(),t=(0,r.useState)(!1),o=(0,_.Z)(t,2),s=o[0],c=o[1],u=(0,r.useState)(!1),d=(0,_.Z)(u,2),h=d[0],f=d[1],m=(0,a.CG)((function(n){return n.app.selectedBranch})),p=(0,a.CG)((function(n){return n.param})),j=p.style,v=p.stn_list,b=(0,a.CG)((function(n){return n.helper.branches}));return(0,l.jsxs)(g.xu,{flex:1,overflow:"hidden",children:[(0,l.jsxs)(U.mQ,{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",index:m,onChange:function(n){return e((0,O.Pg)(n))},children:[(0,l.jsxs)(U.td,{children:[b.map((function(e,t){return 0===t?(0,l.jsx)(U.OK,{children:n("GridTabs.main")},t):j===i.RM.SHMetro&&(0,dn.Qo)(e,v)?(0,l.jsx)(U.OK,{children:n("GridTabs.external")+" "+t},t):(0,l.jsx)(U.OK,{children:n("GridTabs.branch")+" "+t},t)})),(0,l.jsx)(E.hU,{size:"sm",variant:"ghost",alignSelf:"center","aria-label":"New branch",onClick:function(){return f(!0)},icon:(0,l.jsx)(N.x06,{})}),(0,l.jsxs)(g.Ug,{marginLeft:"auto",marginRight:1,children:[(0,l.jsx)(E.zx,{variant:"outline",size:"xs",leftIcon:(0,l.jsx)(N.x06,{}),onClick:function(){return c(!0)},children:n("GridTabs.addStation")}),(0,l.jsx)(E.zx,{size:"xs",colorScheme:"teal",onClick:function(){e((0,O.B4)(i.Sg.BRANCH))},children:n("GridTabs.editLine")})]})]}),(0,l.jsx)(U.nP,{flex:1,overflowY:"auto",children:b.map((function(n,e){return(0,l.jsx)(U.x4,{padding:0,h:"100%",children:(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)(re.Ex,{isIndeterminate:!0}),children:(0,l.jsx)(x.Z,{children:(0,l.jsx)(ue,{branchIndex:e})})})},e)}))})]}),(0,l.jsx)(le,{isOpen:s,onClose:function(){return c(!1)}}),(0,l.jsx)(ce,{isOpen:h,onClose:function(){return f(!1)}})]})}function he(){var n=(0,a.CG)((function(n){return n.app.isLoading}));return(0,l.jsxs)(G.u_,{isOpen:n,onClose:function(){},children:[(0,l.jsx)(G.ZA,{}),(0,l.jsx)(g.kC,{position:"absolute",top:0,left:0,h:"100%",w:"100%",justifyContent:"center",alignItems:"center",zIndex:9999,children:(0,l.jsx)(re.D8,{isIndeterminate:!0,color:"teal"})})]})}var fe=t(3329);function me(){var n=(0,m.I0)(),e=(0,a.CG)((function(n){return n.app.globalAlerts}));return(0,l.jsx)(l.Fragment,{children:Object.entries(e).map((function(e){var t=(0,_.Z)(e,2),r=t[0],o=t[1],i=o.message,a=o.url;return(0,l.jsxs)(oe.bZ,{status:r,variant:"solid",size:"xs",pl:3,pr:1,py:0,children:[(0,l.jsx)(oe.zM,{}),a?(0,l.jsx)(g.rU,{href:a,target:"_blank",children:i}):i,(0,l.jsx)(fe.P,{ml:"auto",onClick:function(){return n((0,O.sy)(r))}})]},r)}))})}function pe(){var n=(0,a.CG)((function(n){return n.param})),e=JSON.stringify(n);return(0,r.useEffect)((function(){window.rmgStorage.writeFile("rmgParam",e).then()}),[e]),(0,l.jsxs)(g.kC,{direction:"column",height:"100%",overflow:"hidden",children:[(0,l.jsx)(he,{}),(0,l.jsx)(te,{}),(0,l.jsxs)(g.kC,{direction:"column",flex:1,overflow:"hidden",children:[(0,l.jsx)(Vn,{}),(0,l.jsx)(me,{}),(0,l.jsxs)(g.kC,{flex:1,overflow:"hidden",position:"relative",children:[(0,l.jsxs)(g.kC,{as:"section",direction:"column",flex:1,ml:1,mr:1,overflow:"hidden",children:[(0,l.jsx)(g.xu,{children:(0,l.jsx)(b,{})}),(0,l.jsx)(de,{})]}),(0,l.jsx)(bn,{})]})]}),(0,l.jsx)("canvas",{style:{display:"none"}})]})}},6705:function(n,e,t){"use strict";t.d(e,{Qo:function(){return d},ku:function(){return f},z7:function(){return m},_G:function(){return j},NC:function(){return g},_g:function(){return x},l$:function(){return v},wX:function(){return b},Di:function(){return y}});var r=t(5987),o=t(9142),i=t(4942),a=t(1413),s=t(9439),l=t(3433),c=t(533),u=t(5984);var d=function(n,e){return!!e[n[0]].children.indexOf(n[1])},h=function(n,e){return[n[0][1],n[0][n[0].length-2]].concat((0,l.Z)(n[0].filter((function(t){return n.slice(1).filter((function(n){return d(n,e)})).map((function(n){return n.filter((function(n){return!["linestart","lineend"].includes(n)}))})).map((function(n){return[n[0],n[n.length-1]]})).flat().includes(t)}))))},f=function(n){return function(e,t){var r=t().helper.branches;if(0===n){var o=t().param.stn_list,i=h(r,o);return function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.reduce((function(n,e){return n.map((function(n){return e.map((function(e){return n.concat([e])}))})).reduce((function(n,e){return n.concat(e)}),[])}),[[]])}(i,i).filter((function(n){return n[0]!==n[1]}))}var a=r[n];if(a){var s=a.filter((function(n){return!["linestart","lineend"].includes(n)}));return[[s[0],s.slice(-1)[0]]]}return[]}},m=function(n,e){return function(t,r){for(var o=r().param.coline,i=r().helper.branches[e],a=0,l=Object.entries(o);a<l.length;a++){var c=(0,s.Z)(l[a],2),u=c[0],d=c[1];if(d.from===n&&i.includes(d.to)){var h=i.indexOf(n),f=i.indexOf(d.to);if(f>h)return[f-h+1,u]}else if(d.to===n&&i.includes(d.to)){var m=i.indexOf(n),p=i.indexOf(d.from);if(p>m)return[p-m+1,u]}}return[0,void 0]}},p=function(n,e){return function(t,r){var o=r().param.stn_list,i=r().helper.branches;if(n===e)throw new Error("addColine():: failed for same stnId");var a=h(i,o).filter((function(t){return[n,e].includes(t)})),s=function(n,e){return n.slice(1).filter((function(n){return d(n,e)})).map((function(n){return n.filter((function(n){return!["linestart","lineend"].includes(n)}))})).map((function(n){return[n[0],n[n.length-1]]}))}(i,o).filter((function(t){return[n,e].every((function(n){return t.includes(n)}))}));if(2===a.length&&s.length>0)throw new Error("addColine():: main check failed for ".concat(n,", ").concat(e));if(2!==a.length&&1!==s.length)throw new Error("addColine():: branch check failed for ".concat(n,", ").concat(e))}},j=function(n){return function(e,t){var r=t().param.coline,o=t().helper.branches[n];return o?Object.entries(r).reduce((function(n,e){return o.includes(e[1].from)&&o.includes(e[1].to)?(0,a.Z)((0,a.Z)({},n),{},(0,i.Z)({},e[0],e[1])):(0,a.Z)({},n)}),{}):{}}},g=function(n){return function(e,t){var r=t().param.coline;if(0!==Object.keys(r).length){var o=Object.entries(r).reduce((function(e,t){return t[1].from!==n&&t[1].to!==n?(0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},t[0],t[1])):(0,a.Z)({},e)}),{});e((0,c.tA)(o))}}},x=function(n,e,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(o,s){var l=s().param.coline;o(p(n,e)),o((0,c.tA)((0,a.Z)((0,a.Z)({},l),{},(0,i.Z)({},(0,u.x0)(4),{from:n,to:e,colors:t,display:r}))))}},v=function(n,e,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(o,s){var l=s().param.coline;if(n in l){o(p(e,t));var u=(0,a.Z)((0,a.Z)({},l),{},(0,i.Z)({},n,(0,a.Z)((0,a.Z)({},l[n]),{},{from:e,to:t,display:r})));o((0,c.tA)(u))}}},b=function(n,e){return function(t,s){var l=s().param.coline;if(n in l&&l[n].colors.length>e){var u=l[n].colors.filter((function(n,t){return t!==e}));if(0===u.length){l[n];var d=(0,r.Z)(l,[n].map(o.Z));t((0,c.tA)(d))}else{var h=(0,a.Z)((0,a.Z)({},l),{},(0,i.Z)({},n,(0,a.Z)((0,a.Z)({},l[n]),{},{colors:u})));t((0,c.tA)(h))}}}},y=function(n,e,t){return function(r,o){var i=o().param.coline;n in i&&i[n].colors.length>e&&(i[n].colors=i[n].colors.map((function(n,r){return r===e?[0,1,2,3,4,5].map((function(e){return void 0===t[e]?n[e]:t[e]})):n})),r((0,c.tA)(i)))}}}}]);
//# sourceMappingURL=AppRoot.0efdcd60.chunk.js.map