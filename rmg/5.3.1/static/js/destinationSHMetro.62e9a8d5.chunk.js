"use strict";(self.webpackChunkrmg=self.webpackChunkrmg||[]).push([[9586],{4074:function(n,t,e){e.r(t);var r=e(9439),i=e(3433),o=e(2791),c=e(7732),a=e(6705),l=e(8306),s=e(184);t.default=(0,o.memo)((function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u,{}),(0,s.jsx)(f,{})]})}));var u=(0,o.memo)((function(){return(0,s.jsx)("defs",{children:(0,s.jsx)("marker",{id:"slope",viewBox:"-1.5 0 3 1.5",refY:.5,children:(0,s.jsx)("path",{d:"M0,0L1,1H-1z",fill:"var(--rmg-theme-colour)"})})})})),f=function(){var n=(0,c.Qy)((function(n){return n.helper})),t=n.routes,e=n.branches,o=(0,c.Qy)((function(n){return n.param})),u=o.line_name,f=o.theme,m=o.current_stn_idx,h=o.direction,x=o.stn_list,g=o.info_panel_type,_=o.loop,j=o.coline,p=function(n,t,e){return(0,i.Z)(new Set(n.filter((function(n){return n.includes(e)})).map((function(n){var e=n.filter((function(n){return!["linestart","lineend"].includes(n)}));return"l"===t?e[0]:e.reverse()[0]}))))},v=function(n,t){return t?[[n.map((function(n){return x[n].name[0]})).join("\uff0c"),n.map((function(n){return x[n].name[1]})).join(", ")].map((function(n){return n.replace("\\","")}))]:n.map((function(n){return x[n].name.map((function(n){return n.replace("\\","")}))}))},Z=_?(0,l.f2)(e,h,x,m):p(t,h,m),z=(_?p(t,h,m):Z).filter((function(n){return e.slice(1).filter((function(n){return(0,a.Qo)(n,x)})).some((function(t){return t.includes(n)}))})),w=v(Z.filter((function(n){return!z.includes(n)})),!_&&!("sh2020"===g));console.log(w);var S=v(z,!0),y=Object.fromEntries(z.map((function(n){return[n,Object.values(j).filter((function(t){return t.from===n||t.to===n})).at(0)]})).filter((function(n){var t=(0,r.Z)(n,2);t[0];return t[1]})));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{dest_names:w,line_name:u,line_color:[f[2],f[3]],coline:!!z.length,upper:!!z.length}),z.length&&z.map((function(n){var t,e,r;return(0,s.jsx)("g",{transform:"translate(0,".concat(-250,")"),children:(0,s.jsx)(d,{dest_names:[S.at(0)],line_name:null===(t=y[n])||void 0===t?void 0:t.colors.at(0).slice(4),line_color:[null===(e=y[n])||void 0===e?void 0:e.colors.at(0)[2],null===(r=y[n])||void 0===r?void 0:r.colors.at(0)[3]],coline:!0,upper:!1})},"coline_".concat(n))}))]})},d=function(n){var t=n.dest_names,e=n.line_name,i=n.line_color,a=n.coline,l=n.upper,u=(0,c.Qy)((function(n){return n.param})),f=u.current_stn_idx,d=u.direction,_=u.platform_num,j=u.svgWidth,p=u.svg_height,v=(0,o.useRef)(null),Z=(0,o.useState)({width:0}),z=(0,r.Z)(Z,2),w=z[0],S=z[1];(0,o.useEffect)((function(){return S(v.current.getBBox())}),[JSON.stringify(t),JSON.stringify(f)]);var y=j.destination/2,b=y-10-36-w.width>=162.5&&y-10-36-264>=162.5?y:"l"===d?(j.destination+w.width-264)/2:(j.destination-w.width+264)/2;return(0,s.jsxs)("g",{transform:"translate(0,".concat(p-300,")"),children:[(0,s.jsx)("path",{stroke:i[0],strokeWidth:12,d:"l"===d?"M".concat(j.destination-24,",16 H 36"):"M24,16 H ".concat(j.destination-36),transform:"translate(0,".concat(l?-20:220,")"),markerEnd:a?void 0:"url(#slope)"}),(0,s.jsx)(m,{ref:v,dest_names:t}),""!==_&&(0,s.jsx)("g",{transform:"translate(".concat(b,",0)"),children:(0,s.jsx)(h,{})}),e[0].match(/^[\w\d]+/)?(0,s.jsx)(g,{line_name:e,line_color:i}):(0,s.jsx)(x,{line_name:e,line_color:i})]})},m=(0,o.forwardRef)((function(n,t){var e=n.dest_names,r=(0,c.Qy)((function(n){return n.param})),i=r.direction,a=r.svgWidth;return(0,s.jsxs)("g",{ref:t,transform:"translate(".concat("l"===i?36:a.destination-36,",145)"),children:[(0,s.jsx)("g",{transform:"translate(0,".concat(2===e.length?-20:20,")"),children:(0,s.jsx)("path",{d:"M60,60L0,0L60-60H100L55-15H160V15H55L100,60z",fill:"black",transform:"rotate(".concat("l"===i?0:180,")scale(0.8)")})}),(0,s.jsx)("g",{textAnchor:"l"===i?"start":"end",transform:"translate(".concat("l"===i?148:-148,",25)"),children:e.map((function(n,t){return(0,s.jsxs)(o.Fragment,{children:[(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:70,dy:-100*t+7,children:"\u5f80"+n[0]},"zh".concat(t)),(0,s.jsx)("text",{className:"rmg-name__en",fontSize:25,dy:-100*t+40,children:"To "+n[1]},"en".concat(t))]},t)}))})]})})),h=function(){var n=(0,c.Qy)((function(n){return n.param})).platform_num;return(0,o.useMemo)((function(){return(0,s.jsxs)("g",{transform:"translate(".concat(-102.5,",150)"),children:[(0,s.jsx)("circle",{r:60,fill:"none",stroke:"black",strokeWidth:2}),(0,s.jsx)("text",{className:"rmg-name__en",dominantBaseline:"central",fontSize:120,textAnchor:"middle",children:n}),(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:100,dominantBaseline:"central",x:65,children:"\u7ad9\u53f0"})]})}),[n])},x=function(n){var t=n.line_name,e=n.line_color,a=(0,c.Qy)((function(n){return n.param})),l=a.direction,u=a.svgWidth,f="l"===l?u.destination-42:42,d=(0,o.useRef)(null),m=o.useState({width:0}),h=(0,r.Z)(m,2),x=h[0],g=h[1];o.useEffect((function(){return g(d.current.getBBox())}),(0,i.Z)(t));var _=("l"===l?-x.width:0)-6,j=("l"===l?-1:1)*x.width/2;return(0,o.useMemo)((function(){return(0,s.jsxs)("g",{transform:"translate(".concat(f,",92)"),children:[(0,s.jsx)("rect",{fill:e[0],x:_,width:x.width+10,height:120}),(0,s.jsxs)("g",{textAnchor:"r"===l?"start":"end",transform:"translate(0,68)",fill:e[1],children:[(0,s.jsx)("g",{ref:d,children:(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:68,children:t[0]})}),(0,s.jsx)("text",{className:"rmg-name__en",fontSize:30,textAnchor:"middle",x:j,dy:42,children:t[1]})]})]})}),[x].concat((0,i.Z)(t),(0,i.Z)(e),[l,u.destination]))},g=function(n){var t=n.line_name,e=n.line_color,a=(0,c.Qy)((function(n){return n.param})),l=a.direction,u=a.svgWidth,f=t[0].match(/^[\w\d]+|.+/g),d=(0,r.Z)(f,2),m=d[0],h=d[1],x="l"===l?u.destination-36-210:90;return(0,o.useMemo)((function(){return(0,s.jsxs)("g",{transform:"translate(".concat(x,",92)"),children:[(0,s.jsx)("rect",{fill:e[0],x:-54,width:108,height:120}),(0,s.jsx)("text",{className:"rmg-name__zh",fill:e[1],fontSize:96,textAnchor:"middle",dominantBaseline:"central",transform:"translate(0,60)",letterSpacing:-5,children:m}),(0,s.jsxs)("g",{textAnchor:"start",transform:"translate(74,68)",children:[(0,s.jsx)("text",{className:"rmg-name__zh",fontSize:68,children:h}),(0,s.jsx)("text",{className:"rmg-name__en",fontSize:30,dy:42,children:t[1]})]})]})}),[x].concat((0,i.Z)(t),(0,i.Z)(e),[l,u.destination]))}},8306:function(n,t,e){e.d(t,{cX:function(){return o},Xt:function(){return c},zS:function(){return a},Ft:function(){return l},f2:function(){return s}});var r=e(9439),i=e(3433),o=function(n,t,e,r){var o=n.length-2*r-e,c=n.findIndex((function(n){return n===t})),a=[].concat((0,i.Z)(n),(0,i.Z)(n),(0,i.Z)(n)),l=n.length+c-Math.floor(o/2)+(o%2===0?1:0),s=n.length+c+Math.floor(o/2);return{top:a.slice(l,s+1),left:a.slice(l-r,l),right:a.slice(s+1,s+1+r),bottom:a.slice(s+1+r,s+1+r+e)}},c=function(n,t,e,r){var o=n.length-2*r-e,c=[].concat((0,i.Z)(n),(0,i.Z)(n),(0,i.Z)(n)),a=n.length+n.findIndex((function(n){return n===t})),l=c[a+o-1],s=n.length+n.findIndex((function(n){return n===l}))+(a+o>2*n.length?n.length:0);return{top:c.slice(a,s+1),left:c.slice(a-r,a),right:c.slice(s+1,s+1+r),bottom:c.slice(s+1+r,s+1+r+e)}},a=function(n,t,e,i){var o=n.findIndex((function(n){return n===t[0]})),a=n.findIndex((function(n){return n===t[1]})),l=o>a?[a,o,t[1],t[0]]:[o,a,t[0],t[1]],s=(0,r.Z)(l,4);o=s[0],a=s[1],t[0]=s[2],t[1]=s[3];var u=n.slice(o,a+1),f=n.filter((function(n){return!u.filter((function(n){return!t.includes(n)})).includes(n)})),d=n.length-("major"===i?Math.max:Math.min)(u.length,f.length)-2*e,m="major"===i?u.length>f.length?t[0]:t[1]:u.length>f.length?t[1]:t[0];return c(n,m,d,e)},l=function(n,t){var e=Object.fromEntries(n.map((function(n){return[n,-1]}))),r=Object.fromEntries(n.map((function(n){return[n,-1]})));return t.top.forEach((function(n,i){e[n]=0+1/(t.top.length+1)*(i+1),r[n]=0})),t.right.forEach((function(n,i){e[n]=1,r[n]=0+1/(t.right.length+1)*(i+1)})),t.bottom.forEach((function(n,i){e[n]=1-1/(t.bottom.length+1)*(i+1),r[n]=1})),t.left.forEach((function(n,i){e[n]=0,r[n]=1-1/(t.left.length+1)*(i+1)})),{x_shares:e,y_shares:r}},s=function(n,t,e,r){var o=n[0].filter((function(n){return!["linestart","lineend"].includes(n)})),c=[].concat((0,i.Z)(o),(0,i.Z)(o),(0,i.Z)(o)),a="r"===t?c:c.reverse(),l=a.findIndex((function(n){return r===n}))+o.length;return a.slice(l+1).filter((function(n){return e[n].loop_pivot})).slice(void 0,2)}}}]);
//# sourceMappingURL=destinationSHMetro.62e9a8d5.chunk.js.map