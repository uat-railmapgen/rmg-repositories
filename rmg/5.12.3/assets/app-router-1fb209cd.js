import{j as p,a8 as wn,F as Pe,B as Se,a4 as ye,a9 as jn,y as An,a2 as Ze,M as He,a3 as Ge,s as $e,t as Ye,v as qe,aa as ht,ab as Jt,ac as Qt,ad as nt,ae as en,af as Et,x as Ke,w as st,z as Ve,a6 as kn,k as de,K as De,a7 as Ie,ag as Le,C as pt,D as mt,ah as On,ai as Cn,aj as Rn,ak as Mt,X as Pn,al as tn,b as In,am as Tn}from"./chakra-0b0a1fde.js";import{r as J,c as ct,g as Dn,u as Ln}from"./react-f83802c2.js";import{_ as j,u as ee,r as he,E as Ee,R as ft,a as nn,b as le,c as ge,d as Fn,e as Q,f as Vt,g as Nt,h as _e,i as Ut,C as Re,j as rn,k as Wt,M as xe,l as sn,m as zn,n as Bn,F as xt,o as ze,p as Te,q as St,s as Mn,t as Ct,v as at,S as Ne,w as Vn,x as Zt,y as Nn,z as Ht,A as Un,B as Wn,D as wt,G as Zn,H as Hn,I as Gn,J as $n,K as Yn,L as qn,N as ut,O as je,P as Kn,Q as Xn,T as Jn,U as Rt,V as Pt,W as It,X as Qn,Y as er,Z as tr,$ as jt,a0 as At,a1 as nr,a2 as Gt,a3 as rr,a4 as sr,a5 as an,a6 as on,a7 as ar,a8 as ln,a9 as cn,aa as $t,ab as ir,ac as or,ad as lr,ae as cr,af as dr,ag as ur,ah as hr,ai as pr,aj as mr,ak as vt,al as fr,am as _r,an as gr,ao as vr,ap as br,aq as yr,ar as Er,as as xr,at as Be,au as Ue,av as it,aw as We,ax as Me,ay as dn,az as Sr,aA as kt,aB as Ot,aC as wr,aD as jr,aE as Ar,aF as kr,aG as Or,aH as Cr,aI as Rr,aJ as Pr,aK as Yt,aL as Ir,aM as Tr,aN as Dr,aO as Lr,aP as un,aQ as Fr,aR as zr,aS as Br,aT as Mr,aU as Vr,aV as Nr,aW as Ur,aX as Wr,aY as Zr,aZ as Fe,a_ as hn,a$ as Hr,b0 as Gr,b1 as $r,b2 as Yr,b3 as bt,b4 as yt,b5 as qr,b6 as Kr}from"./index-b47975a7.js";import{i as pn,w as Xr,d as qt,a as mn,r as Jr,P as Qr,u as es}from"./param-updater-utils-67d44659.js";var ts=function(m){var _=m.text,n=m.delimiter;return p.jsx("span",{children:_.split(n||"\\").map(function(o,a){return a?[p.jsx(wn,{children:"⏎"},a),o]:o})})};const ns={mtr:()=>j(()=>import("./index-b14542e0.js"),["assets/index-b14542e0.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-b47975a7.js","assets/index-d22c1e14.css","assets/share-fbd51136.js","assets/mtr-0664a4d8.js","assets/param-updater-utils-67d44659.js"]),gzmtr:()=>j(()=>import("./index-78431ce5.js"),["assets/index-78431ce5.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-b47975a7.js","assets/index-d22c1e14.css","assets/share-fbd51136.js"]),shmetro:()=>j(()=>import("./index-146c183a.js"),["assets/index-146c183a.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-b47975a7.js","assets/index-d22c1e14.css","assets/share-fbd51136.js","assets/mtr-0664a4d8.js","assets/param-updater-utils-67d44659.js"])};function rs(m){const[_,n]=J.useState({});return J.useEffect(()=>(ns[m]().then(o=>{n(o.default)}).catch(o=>{console.error("Failed to load canvas for style ".concat(m),o),n({})}),()=>{n({})}),[m]),_}const ss={position:"relative",flexDirection:"row",overflowX:"auto","&::before, &::after":{content:'""',margin:"auto"},"& > svg":{flex:"0 0 auto",border:"1px solid black"}};function as(){const{canvasToShow:m,canvasScale:_}=ee(t=>t.app),{svg_height:n,style:o}=ee(t=>t.param),a=rs(o);J.useEffect(()=>{document.getElementById("css_share").href="/rmg/"+"styles/share_".concat(o,".css"),he.event(Ee.STYLE_CHANGE,{style:o})},[o]);const e=Object.keys(a).filter(t=>m.includes(t)),r=n*_;return p.jsx(Pe,{minH:r,sx:ss,children:Object.keys(a).length===0?p.jsx(ft,{isIndeterminate:!0}):e.map(t=>p.jsx(nn,{sx:{minWidth:750,height:r},children:a[t]},t+o))})}function is(){const{t:m}=le(),_=ge(),n=ee(i=>i.app.selectedStation);console.log("InfoSection:: Rendering for",n);const o=ee(i=>i.param.style),{num:a,name:e,secondaryName:r}=ee(i=>i.param.stn_list[n]),t=[{type:"input",label:m("StationSidePanel.info.num"),value:a,placeholder:"01",onChange:i=>_(Fn(n,i)),hidden:![Q.GZMTR].includes(o)},{type:"input",label:m("Chinese name"),value:e[0],onChange:i=>_(Vt(n,[i,e[1]]))},{type:"input",label:m("English name"),value:e[1],onChange:i=>_(Vt(n,[e[0],i]))},{type:"input",label:m("StationSidePanel.info.zhSecondary"),value:r?r[0]:"",placeholder:"1号航站楼",onChange:i=>_(Nt(n,[i,r?r[1]:""])),hidden:![Q.GZMTR].includes(o)},{type:"input",label:m("StationSidePanel.info.enSecondary"),value:r?r[1]:"",placeholder:"Terminal 1",onChange:i=>_(Nt(n,[r?r[0]:"",i])),hidden:![Q.GZMTR].includes(o)}];return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("StationSidePanel.info.title")}),p.jsx(_e,{fields:t,minW:130})]})}const fn=(m,_)=>{const n=m[_];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((o,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+_)))})};function os(m){const{countryCode:_,svgFilename:n}=m,[o,a]=J.useState(void 0);return J.useEffect(()=>{n&&fn(Object.assign({"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E6-1F1F7.svg":()=>j(()=>import("./1F1E6-1F1F7-249b5959.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E6-1F1F9.svg":()=>j(()=>import("./1F1E6-1F1F9-a3474a87.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E6-1F1FA.svg":()=>j(()=>import("./1F1E6-1F1FA-0fdfb9b9.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E6-1F1FF.svg":()=>j(()=>import("./1F1E6-1F1FF-c961f61f.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E7-1F1EA.svg":()=>j(()=>import("./1F1E7-1F1EA-87b63ce0.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E7-1F1F4.svg":()=>j(()=>import("./1F1E7-1F1F4-8e88acbd.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E7-1F1F7.svg":()=>j(()=>import("./1F1E7-1F1F7-2e5da46f.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E8-1F1E6.svg":()=>j(()=>import("./1F1E8-1F1E6-572cf376.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E8-1F1F1.svg":()=>j(()=>import("./1F1E8-1F1F1-bb957357.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E8-1F1F3.svg":()=>j(()=>import("./1F1E8-1F1F3-866d09b5.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E9-1F1EA.svg":()=>j(()=>import("./1F1E9-1F1EA-2bcac591.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1E9-1F1F0.svg":()=>j(()=>import("./1F1E9-1F1F0-130b3df9.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EA-1F1EC.svg":()=>j(()=>import("./1F1EA-1F1EC-190b639e.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EA-1F1F8.svg":()=>j(()=>import("./1F1EA-1F1F8-e9f6e238.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EB-1F1F7.svg":()=>j(()=>import("./1F1EB-1F1F7-12f823eb.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EC-1F1F7.svg":()=>j(()=>import("./1F1EC-1F1F7-d16bd178.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1ED-1F1F0.svg":()=>j(()=>import("./1F1ED-1F1F0-1346b158.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1ED-1F1FA.svg":()=>j(()=>import("./1F1ED-1F1FA-e44befe3.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EE-1F1E9.svg":()=>j(()=>import("./1F1EE-1F1E9-256ea73c.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EE-1F1EA.svg":()=>j(()=>import("./1F1EE-1F1EA-a47e0f5f.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EE-1F1F3.svg":()=>j(()=>import("./1F1EE-1F1F3-44d109aa.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EE-1F1F7.svg":()=>j(()=>import("./1F1EE-1F1F7-c924004a.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EE-1F1F9.svg":()=>j(()=>import("./1F1EE-1F1F9-38eff108.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1EF-1F1F5.svg":()=>j(()=>import("./1F1EF-1F1F5-93518547.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F0-1F1F5.svg":()=>j(()=>import("./1F1F0-1F1F5-c35a0536.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F0-1F1F7.svg":()=>j(()=>import("./1F1F0-1F1F7-4e778503.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F0-1F1FF.svg":()=>j(()=>import("./1F1F0-1F1FF-2f61e48a.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F2-1F1F4.svg":()=>j(()=>import("./1F1F2-1F1F4-bb2225c7.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F2-1F1FD.svg":()=>j(()=>import("./1F1F2-1F1FD-31d458ab.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F2-1F1FE.svg":()=>j(()=>import("./1F1F2-1F1FE-9d12ac27.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F3-1F1F1.svg":()=>j(()=>import("./1F1F3-1F1F1-d799cc7f.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F3-1F1F4.svg":()=>j(()=>import("./1F1F3-1F1F4-36b22a7a.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F5-1F1E6.svg":()=>j(()=>import("./1F1F5-1F1E6-a403b725.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F5-1F1EA.svg":()=>j(()=>import("./1F1F5-1F1EA-2359ab5b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F5-1F1F0.svg":()=>j(()=>import("./1F1F5-1F1F0-796e787d.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F5-1F1F1.svg":()=>j(()=>import("./1F1F5-1F1F1-56d472c9.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F5-1F1F9.svg":()=>j(()=>import("./1F1F5-1F1F9-48f96f04.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F7-1F1F4.svg":()=>j(()=>import("./1F1F7-1F1F4-a774c3a2.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F7-1F1FA.svg":()=>j(()=>import("./1F1F7-1F1FA-3b81f8de.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F8-1F1E6.svg":()=>j(()=>import("./1F1F8-1F1E6-481d8837.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F8-1F1EA.svg":()=>j(()=>import("./1F1F8-1F1EA-3583e0b5.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F8-1F1EC.svg":()=>j(()=>import("./1F1F8-1F1EC-2b92413d.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F9-1F1ED.svg":()=>j(()=>import("./1F1F9-1F1ED-0757641b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F9-1F1F7.svg":()=>j(()=>import("./1F1F9-1F1F7-f7cf6b4a.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1F9-1F1FC.svg":()=>j(()=>import("./1F1F9-1F1FC-82e8fcc5.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1FA-1F1E6.svg":()=>j(()=>import("./1F1FA-1F1E6-fc868471.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1FA-1F1F3.svg":()=>j(()=>import("./1F1FA-1F1F3-dddb091b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1FA-1F1F8.svg":()=>j(()=>import("./1F1FA-1F1F8-47f8491b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1FA-1F1FF.svg":()=>j(()=>import("./1F1FA-1F1FF-0989e0a8.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1FB-1F1EA.svg":()=>j(()=>import("./1F1FB-1F1EA-8edd6b29.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F1FB-1F1F3.svg":()=>j(()=>import("./1F1FB-1F1F3-2e88414b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F3F4-E0067-E0062-E0065-E006E-E0067-E007F.svg":()=>j(()=>import("./1F3F4-E0067-E0062-E0065-E006E-E0067-E007F-8302e24f.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/1F3F4-E0067-E0062-E0073-E0063-E0074-E007F.svg":()=>j(()=>import("./1F3F4-E0067-E0062-E0073-E0063-E0074-E007F-a5d75104.js"),[])}),"../../../../node_modules/@railmapgen/rmg-palette-resources/flags/".concat(n.slice(0,-4),".svg")).then(e=>e.default).then(a).catch(e=>console.error("Failed to find SVG file ".concat(n," as ").concat(e==null?void 0:e.message)))},[n]),o?p.jsx(jn,{src:o,alt:"Flag of ".concat(_),h:17,mr:1}):p.jsx(p.Fragment,{})}function ls(m){const{defaultValueId:_,onChange:n}=m,{i18n:o}=le(),a=_?Ut.find(d=>d.id===_):void 0,e=d=>{var b,f;return(f=(b=o.languages.map(h=>d.name[h]).find(h=>h!==void 0))!=null?b:d.name.en)!=null?f:""},r=d=>{var u,y;const b=d.country==="TW"&&["zh-Hans","zh-CN"].includes(o.languages[0]),f=["Win32","Win64"].includes(navigator.platform),h=o.languages.map(g=>d.name[g]).find(g=>g!==void 0),c=(u=Wt.find(g=>g.id===d.country))==null?void 0:u.flagSvg,v=(y=Wt.find(g=>g.id===d.country))==null?void 0:y.flagEmoji;return p.jsxs(p.Fragment,{children:[b?p.jsx("span",{children:"🏴 "}):f?p.jsx(os,{countryCode:d.country,svgFilename:c}):p.jsxs("span",{children:[v," "]}),h]})},t=(d,b)=>Object.values(d.name).some(f=>f.includes(b)),i=Ut.slice().sort((d,b)=>d.id===Re.Other?1:b.id===Re.Other?-1:e(d).localeCompare(e(b),o.languages[0]));return p.jsx(rn,{data:i,displayValue:e,displayHandler:r,predicate:t,defaultValue:a,onChange:d=>n==null?void 0:n(d.id)})}const cs=m=>{const[_,n]=J.useState([]);return J.useEffect(()=>{fn(Object.assign({"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/adelaide.js":()=>j(()=>import("./adelaide-74d00079.js"),["assets/adelaide-74d00079.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/almaty.js":()=>j(()=>import("./almaty-191ca98b.js"),["assets/almaty-191ca98b.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/amsterdam.js":()=>j(()=>import("./amsterdam-69a167c7.js"),["assets/amsterdam-69a167c7.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/ankara.js":()=>j(()=>import("./ankara-b4ae6b5e.js"),["assets/ankara-b4ae6b5e.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/athens.js":()=>j(()=>import("./athens-3554b512.js"),["assets/athens-3554b512.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/baku.js":()=>j(()=>import("./baku-bae24922.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/bangkok.js":()=>j(()=>import("./bangkok-7ea21449.js"),["assets/bangkok-7ea21449.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/barcelona.js":()=>j(()=>import("./barcelona-e7f689d4.js"),["assets/barcelona-e7f689d4.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/beijing.js":()=>j(()=>import("./beijing-8859825c.js"),["assets/beijing-8859825c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/berlin.js":()=>j(()=>import("./berlin-3c4a7630.js"),["assets/berlin-3c4a7630.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/bne.js":()=>j(()=>import("./bne-6e92a414.js"),["assets/bne-6e92a414.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/bonn.js":()=>j(()=>import("./bonn-0c15e51a.js"),["assets/bonn-0c15e51a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/boston.js":()=>j(()=>import("./boston-4f156dfe.js"),["assets/boston-4f156dfe.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/brussels.js":()=>j(()=>import("./brussels-eaa8e445.js"),["assets/brussels-eaa8e445.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/bucharest.js":()=>j(()=>import("./bucharest-dec16d21.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/budapest.js":()=>j(()=>import("./budapest-715484b8.js"),["assets/budapest-715484b8.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/buenosaires.js":()=>j(()=>import("./buenosaires-e0ca1481.js"),["assets/buenosaires-e0ca1481.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/busan.js":()=>j(()=>import("./busan-f6fc9aaa.js"),["assets/busan-f6fc9aaa.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/cairo.js":()=>j(()=>import("./cairo-9c4f12da.js"),["assets/cairo-9c4f12da.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/caracas.js":()=>j(()=>import("./caracas-d3e7846d.js"),["assets/caracas-d3e7846d.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/cbr.js":()=>j(()=>import("./cbr-71d9e72a.js"),["assets/cbr-71d9e72a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/changchun.js":()=>j(()=>import("./changchun-38ff1bce.js"),["assets/changchun-38ff1bce.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/changsha.js":()=>j(()=>import("./changsha-4f547f1a.js"),["assets/changsha-4f547f1a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/changzhou.js":()=>j(()=>import("./changzhou-730d017d.js"),["assets/changzhou-730d017d.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/chengdu.js":()=>j(()=>import("./chengdu-2fde8740.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/chennai.js":()=>j(()=>import("./chennai-36c1f57d.js"),["assets/chennai-36c1f57d.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/chongqing.js":()=>j(()=>import("./chongqing-ddff2e6a.js"),["assets/chongqing-ddff2e6a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/chuzhou.js":()=>j(()=>import("./chuzhou-80af39e2.js"),["assets/chuzhou-80af39e2.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/cochabamba.js":()=>j(()=>import("./cochabamba-216e15d8.js"),["assets/cochabamba-216e15d8.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/cologne.js":()=>j(()=>import("./cologne-2e637457.js"),["assets/cologne-2e637457.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/copenhagen.js":()=>j(()=>import("./copenhagen-96bffc1c.js"),["assets/copenhagen-96bffc1c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/daegu.js":()=>j(()=>import("./daegu-8f53d357.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/dalian.js":()=>j(()=>import("./dalian-08981d46.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/delhi.js":()=>j(()=>import("./delhi-eaa3d5a0.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/dongguan.js":()=>j(()=>import("./dongguan-9877cd9c.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/dortmund.js":()=>j(()=>import("./dortmund-d1d7aa28.js"),["assets/dortmund-d1d7aa28.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/dublin.js":()=>j(()=>import("./dublin-1669b554.js"),["assets/dublin-1669b554.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/edinburgh.js":()=>j(()=>import("./edinburgh-15007025.js"),["assets/edinburgh-15007025.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/eskisehir.js":()=>j(()=>import("./eskisehir-5404753b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/foshan.js":()=>j(()=>import("./foshan-4877921a.js"),["assets/foshan-4877921a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/frankfurt.js":()=>j(()=>import("./frankfurt-f1ee3295.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/fuzhou.js":()=>j(()=>import("./fuzhou-ffd59876.js"),["assets/fuzhou-ffd59876.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/glasgow.js":()=>j(()=>import("./glasgow-e714346d.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/gothenburg.js":()=>j(()=>import("./gothenburg-87d00976.js"),["assets/gothenburg-87d00976.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/guadalajara.js":()=>j(()=>import("./guadalajara-dc4a5f1d.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/guangzhou.js":()=>j(()=>import("./guangzhou-d198681a.js"),["assets/guangzhou-d198681a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/guiyang.js":()=>j(()=>import("./guiyang-77cacb92.js"),["assets/guiyang-77cacb92.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hamburg.js":()=>j(()=>import("./hamburg-718359df.js"),["assets/hamburg-718359df.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hangzhou.js":()=>j(()=>import("./hangzhou-49318ab1.js"),["assets/hangzhou-49318ab1.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hanoi.js":()=>j(()=>import("./hanoi-6c252433.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/harbin.js":()=>j(()=>import("./harbin-687d6138.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hefei.js":()=>j(()=>import("./hefei-8a924767.js"),["assets/hefei-8a924767.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hiroshima.js":()=>j(()=>import("./hiroshima-df702f5a.js"),["assets/hiroshima-df702f5a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hochiminh.js":()=>j(()=>import("./hochiminh-9f62b24b.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hohhot.js":()=>j(()=>import("./hohhot-95d408ef.js"),["assets/hohhot-95d408ef.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/hongkong.js":()=>j(()=>import("./hongkong-958ab1d2.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/iashi.js":()=>j(()=>import("./iashi-9857a8c4.js"),["assets/iashi-9857a8c4.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/istanbul.js":()=>j(()=>import("./istanbul-bdd10dbb.js"),["assets/istanbul-bdd10dbb.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/jakarta.js":()=>j(()=>import("./jakarta-8b57d78b.js"),["assets/jakarta-8b57d78b.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/jinan.js":()=>j(()=>import("./jinan-b6389b78.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/kansai.js":()=>j(()=>import("./kansai-d2208f2a.js"),["assets/kansai-d2208f2a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/kaohsiung.js":()=>j(()=>import("./kaohsiung-1a75e57f.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/kaosiung.js":()=>j(()=>import("./kaosiung-1f05a0fd.js"),["assets/kaosiung-1f05a0fd.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/kharkiv.js":()=>j(()=>import("./kharkiv-136aaa86.js"),["assets/kharkiv-136aaa86.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/klangvalley.js":()=>j(()=>import("./klangvalley-9114a5fa.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/kunming.js":()=>j(()=>import("./kunming-e6c2fcea.js"),["assets/kunming-e6c2fcea.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/kyiv.js":()=>j(()=>import("./kyiv-0b097fd1.js"),["assets/kyiv-0b097fd1.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lahore.js":()=>j(()=>import("./lahore-d626baef.js"),["assets/lahore-d626baef.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lanzhou.js":()=>j(()=>import("./lanzhou-c78eaf3a.js"),["assets/lanzhou-c78eaf3a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/liege.js":()=>j(()=>import("./liege-beb3a950.js"),["assets/liege-beb3a950.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lille.js":()=>j(()=>import("./lille-c1ef74c4.js"),["assets/lille-c1ef74c4.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lima.js":()=>j(()=>import("./lima-118ba6e3.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lisbon.js":()=>j(()=>import("./lisbon-82e2f436.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/littlerockcity.js":()=>j(()=>import("./littlerockcity-52345e0a.js"),["assets/littlerockcity-52345e0a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/london.js":()=>j(()=>import("./london-34cf9da4.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/losangeles.js":()=>j(()=>import("./losangeles-744eb37e.js"),["assets/losangeles-744eb37e.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lucknow.js":()=>j(()=>import("./lucknow-b4340f78.js"),["assets/lucknow-b4340f78.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/luoyang.js":()=>j(()=>import("./luoyang-53231203.js"),["assets/luoyang-53231203.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/lyon.js":()=>j(()=>import("./lyon-d2c03e08.js"),["assets/lyon-d2c03e08.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/macao.js":()=>j(()=>import("./macao-19ac9346.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/madrid.js":()=>j(()=>import("./madrid-27a855a1.js"),["assets/madrid-27a855a1.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/manchester.js":()=>j(()=>import("./manchester-4d80c84a.js"),["assets/manchester-4d80c84a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/marseille.js":()=>j(()=>import("./marseille-803c8e33.js"),["assets/marseille-803c8e33.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/melbourne.js":()=>j(()=>import("./melbourne-00bd92be.js"),["assets/melbourne-00bd92be.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/mexicocity.js":()=>j(()=>import("./mexicocity-6ac6a956.js"),["assets/mexicocity-6ac6a956.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/milan.js":()=>j(()=>import("./milan-57742f6d.js"),["assets/milan-57742f6d.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/monterrey.js":()=>j(()=>import("./monterrey-eb3ab1d8.js"),["assets/monterrey-eb3ab1d8.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/montreal.js":()=>j(()=>import("./montreal-ee9ef68e.js"),["assets/montreal-ee9ef68e.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/moscow.js":()=>j(()=>import("./moscow-9de6b152.js"),["assets/moscow-9de6b152.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/munich.js":()=>j(()=>import("./munich-d5649ad1.js"),["assets/munich-d5649ad1.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nagpur.js":()=>j(()=>import("./nagpur-eaea9435.js"),["assets/nagpur-eaea9435.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nanchang.js":()=>j(()=>import("./nanchang-c117b79b.js"),["assets/nanchang-c117b79b.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nanjing.js":()=>j(()=>import("./nanjing-9fddd9fa.js"),["assets/nanjing-9fddd9fa.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nanning.js":()=>j(()=>import("./nanning-ce8d312c.js"),["assets/nanning-ce8d312c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nantes.js":()=>j(()=>import("./nantes-ca868569.js"),["assets/nantes-ca868569.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nantong.js":()=>j(()=>import("./nantong-372d48bd.js"),["assets/nantong-372d48bd.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/naples.js":()=>j(()=>import("./naples-19d71e84.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/neworleans.js":()=>j(()=>import("./neworleans-a1841155.js"),["assets/neworleans-a1841155.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/newtaipei.js":()=>j(()=>import("./newtaipei-2d07dd7a.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/newyork.js":()=>j(()=>import("./newyork-e0af2067.js"),["assets/newyork-e0af2067.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/nice.js":()=>j(()=>import("./nice-c3a1dc2f.js"),["assets/nice-c3a1dc2f.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/ningbo.js":()=>j(()=>import("./ningbo-c94c7c7a.js"),["assets/ningbo-c94c7c7a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/novosibirsk.js":()=>j(()=>import("./novosibirsk-0a4088ee.js"),["assets/novosibirsk-0a4088ee.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/osaka.js":()=>j(()=>import("./osaka-873e704c.js"),["assets/osaka-873e704c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/oslo.js":()=>j(()=>import("./oslo-ae6470f6.js"),["assets/oslo-ae6470f6.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/other.js":()=>j(()=>import("./other-176be433.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/ottawa.js":()=>j(()=>import("./ottawa-c141a3c3.js"),["assets/ottawa-c141a3c3.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/panamacity.js":()=>j(()=>import("./panamacity-937be9d4.js"),["assets/panamacity-937be9d4.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/paris.js":()=>j(()=>import("./paris-217a298f.js"),["assets/paris-217a298f.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/perth.js":()=>j(()=>import("./perth-ffaf27be.js"),["assets/perth-ffaf27be.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/pyongyang.js":()=>j(()=>import("./pyongyang-9439bfc4.js"),["assets/pyongyang-9439bfc4.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/qingdao.js":()=>j(()=>import("./qingdao-57c94a6d.js"),["assets/qingdao-57c94a6d.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/rheinruhr.js":()=>j(()=>import("./rheinruhr-d291a748.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/rio.js":()=>j(()=>import("./rio-c755f52b.js"),["assets/rio-c755f52b.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/riyadh.js":()=>j(()=>import("./riyadh-76eaed95.js"),["assets/riyadh-76eaed95.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/rome.js":()=>j(()=>import("./rome-86e02a8c.js"),["assets/rome-86e02a8c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/rotterdam.js":()=>j(()=>import("./rotterdam-6ed9c71a.js"),["assets/rotterdam-6ed9c71a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/saltlakecity.js":()=>j(()=>import("./saltlakecity-583b2131.js"),["assets/saltlakecity-583b2131.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/samara.js":()=>j(()=>import("./samara-b09a4db5.js"),["assets/samara-b09a4db5.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/sanfrancisco.js":()=>j(()=>import("./sanfrancisco-e891209d.js"),["assets/sanfrancisco-e891209d.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/sanktpeterburg.js":()=>j(()=>import("./sanktpeterburg-87b7088d.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/santiago.js":()=>j(()=>import("./santiago-75995091.js"),["assets/santiago-75995091.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/saopaulo.js":()=>j(()=>import("./saopaulo-11de4de5.js"),["assets/saopaulo-11de4de5.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/seoul.js":()=>j(()=>import("./seoul-63569d40.js"),["assets/seoul-63569d40.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/sevilla.js":()=>j(()=>import("./sevilla-23dc725c.js"),["assets/sevilla-23dc725c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/shanghai.js":()=>j(()=>import("./shanghai-514a9d68.js"),["assets/shanghai-514a9d68.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/shaoxing.js":()=>j(()=>import("./shaoxing-51d603f3.js"),["assets/shaoxing-51d603f3.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/shenyang.js":()=>j(()=>import("./shenyang-1be252e8.js"),["assets/shenyang-1be252e8.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/shenzhen.js":()=>j(()=>import("./shenzhen-b201cede.js"),["assets/shenzhen-b201cede.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/shijiazhuang.js":()=>j(()=>import("./shijiazhuang-7359dd03.js"),["assets/shijiazhuang-7359dd03.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/shiraz.js":()=>j(()=>import("./shiraz-c931adf9.js"),["assets/shiraz-c931adf9.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/singapore.js":()=>j(()=>import("./singapore-9984801c.js"),["assets/singapore-9984801c.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/stlouis.js":()=>j(()=>import("./stlouis-b2ddfa19.js"),["assets/stlouis-b2ddfa19.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/stockholm.js":()=>j(()=>import("./stockholm-5eca41a9.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/suzhou.js":()=>j(()=>import("./suzhou-f4a77b55.js"),["assets/suzhou-f4a77b55.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/sydney.js":()=>j(()=>import("./sydney-fdf7d2b3.js"),["assets/sydney-fdf7d2b3.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/taichung.js":()=>j(()=>import("./taichung-a1448445.js"),["assets/taichung-a1448445.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/taipei.js":()=>j(()=>import("./taipei-af0a5b5f.js"),["assets/taipei-af0a5b5f.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/taiyuan.js":()=>j(()=>import("./taiyuan-dddb3861.js"),["assets/taiyuan-dddb3861.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/taoyuan.js":()=>j(()=>import("./taoyuan-fb9ec864.js"),["assets/taoyuan-fb9ec864.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/tashkent.js":()=>j(()=>import("./tashkent-ff9295b0.js"),["assets/tashkent-ff9295b0.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/tehran.js":()=>j(()=>import("./tehran-293c71a8.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/tianjin.js":()=>j(()=>import("./tianjin-85d6e19a.js"),["assets/tianjin-85d6e19a.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/tokyo.js":()=>j(()=>import("./tokyo-14b87b66.js"),["assets/tokyo-14b87b66.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/toronto.js":()=>j(()=>import("./toronto-d73f7125.js"),["assets/toronto-d73f7125.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/turin.js":()=>j(()=>import("./turin-df6a5baa.js"),["assets/turin-df6a5baa.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/tyneandwear.js":()=>j(()=>import("./tyneandwear-b3da8462.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/urumqi.js":()=>j(()=>import("./urumqi-737dc765.js"),["assets/urumqi-737dc765.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/vienna.js":()=>j(()=>import("./vienna-1e8eea57.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/warsaw.js":()=>j(()=>import("./warsaw-cdabd248.js"),["assets/warsaw-cdabd248.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/washington.js":()=>j(()=>import("./washington-4a9d0486.js"),["assets/washington-4a9d0486.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/wenzhou.js":()=>j(()=>import("./wenzhou-8ac01cc1.js"),["assets/wenzhou-8ac01cc1.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/wuhan.js":()=>j(()=>import("./wuhan-d1a2da48.js"),["assets/wuhan-d1a2da48.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/wuxi.js":()=>j(()=>import("./wuxi-68576026.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/xiamen.js":()=>j(()=>import("./xiamen-cca9c4f0.js"),[]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/xian.js":()=>j(()=>import("./xian-a6d20d22.js"),["assets/xian-a6d20d22.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/xuzhou.js":()=>j(()=>import("./xuzhou-be2d7dab.js"),["assets/xuzhou-be2d7dab.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/yekaterinburg.js":()=>j(()=>import("./yekaterinburg-34e20231.js"),["assets/yekaterinburg-34e20231.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/yevpatoria.js":()=>j(()=>import("./yevpatoria-f6003b38.js"),["assets/yevpatoria-f6003b38.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/yokohama.js":()=>j(()=>import("./yokohama-28976283.js"),["assets/yokohama-28976283.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"]),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/zhengzhou.js":()=>j(()=>import("./zhengzhou-b88c2468.js"),["assets/zhengzhou-b88c2468.js","assets/index-b47975a7.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-d22c1e14.css"])}),"../../../../node_modules/@railmapgen/rmg-palette-resources/palettes/".concat(m,".js")).then(o=>n(o.default)).catch(()=>n([]))},[m]),_};function ds(m){const{city:_,defaultValueId:n,onChange:o}=m,{i18n:a}=le(),e=cs(_),r=n?e.find(b=>b.id===n):void 0,t=b=>{var f;return(f=a.languages.map(h=>b.name[h]).find(h=>h!==void 0))!=null?f:""},i=b=>{const f=t(b);return p.jsx(sn,{name:f,fg:b.fg||xe.white,bg:b.colour})},d=(b,f)=>Object.values(b.name).some(h=>h.includes(f));return p.jsx(rn,{data:e,displayValue:t,displayHandler:i,predicate:d,defaultValue:r,onChange:b=>o==null?void 0:o(b.id,b.colour,b.fg||xe.white)})}function Tt(m){const{isOpen:_,onClose:n,defaultTheme:o,onUpdate:a}=m,{t:e}=le(),r=An("primary.500","primary.300"),[t,i]=J.useState(o==null?void 0:o[0]),[d,b]=J.useState(o==null?void 0:o[1]),[f,h]=J.useState((o==null?void 0:o[2])||"#AAAAAA"),[c,v]=J.useState((o==null?void 0:o[3])||xe.white);J.useEffect(()=>{o&&(i(o[0]),b(o[1]),h(o[2]),v(o[3]))},[_,o==null?void 0:o.toString()]);const u=[{type:"custom",label:e("ColourModal.city"),component:p.jsx(ls,{defaultValueId:t,onChange:w=>{i(w),b(void 0),h("#AAAAAA"),v(xe.white)}})},{type:"custom",label:e("ColourModal.line"),component:p.jsx(ds,{city:t,defaultValueId:d,onChange:(w,O,z)=>{b(w),h(O),v(z)}})}],y=[{type:"input",label:e("ColourModal.bg"),variant:"color",value:f,placeholder:"#F3D03E",onChange:w=>{i(Re.Other),b("other"),h(w)}},{type:"select",label:e("ColourModal.fg"),value:c,options:{[xe.white]:e("ColourModal.white"),[xe.black]:e("ColourModal.black")},onChange:w=>{i(Re.Other),b("other"),v(w)}}],g=()=>{he.isStandaloneWindow()?window.open("/rmg-palette","_blank"):he.openApp("rmg-palette")},E=t&&d&&f&&c,k=()=>{E&&(a==null||a([t,d,f,c]),n(),he.event(Ee.SELECT_COLOUR,{cityCode:t,lineCode:d}))};return p.jsxs(Ze,{isOpen:_,onClose:n,children:[p.jsx(He,{}),p.jsxs(Ge,{children:[p.jsx($e,{children:e("ColourModal.title")}),p.jsx(Ye,{}),p.jsx(qe,{children:p.jsxs(ht,{children:[p.jsx(sn,{name:e("ColourModal.example"),fg:c,bg:f}),p.jsxs(Jt,{isFitted:!0,colorScheme:"primary",w:"100%",defaultIndex:t===Re.Other?1:0,children:[p.jsxs(Qt,{children:[p.jsx(nt,{children:e("ColourModal.palette")}),p.jsx(nt,{children:e("ColourModal.custom")})]}),p.jsxs(en,{children:[p.jsx(Et,{children:p.jsx(_e,{fields:u})}),p.jsx(Et,{children:p.jsx(_e,{fields:y})})]})]})]})}),p.jsxs(Ke,{children:[p.jsxs(st,{fontSize:"sm",marginRight:2,children:[e("ColourModal.seeAll"),p.jsxs(Ve,{color:r,onClick:g,children:[e("Palette")," ",p.jsx(kn,{as:zn})]})]}),p.jsx(de,{colorScheme:"primary",onClick:k,isDisabled:!E,children:e("Confirm")})]})]})]})}class us{static hexToRgb(_){return[parseInt(_.slice(1,3),16),parseInt(_.slice(3,5),16),parseInt(_.slice(5,7),16)]}static fade(_,n){return"rgba(".concat([...this.hexToRgb(_),n].join(","),")")}static euclideanDistance(_,n){return this.hexToRgb(_).reduce((o,a,e)=>o+Math.pow(a-this.hexToRgb(n)[e],2),0)}}function Dt(m){var a;const{theme:_,onClick:n}=m,{t:o}=le();return p.jsx(De,{size:"xs","aria-label":o("Colour"),mt:"0.45px",color:_==null?void 0:_[3],bg:_==null?void 0:_[2],_hover:{bg:us.fade((a=_==null?void 0:_[2])!=null?a:"#aaaaaa",.7)},icon:p.jsx(Bn,{}),onClick:n})}function hs(m){var y;const{interchangeList:_,onAdd:n,onDelete:o,onUpdate:a}=m,{t:e}=le(),[r,t]=J.useState(!1),[i,d]=J.useState(0),{style:b,theme:f,stn_list:h}=ee(g=>g.param),c=Object.values(h).reduce((g,E)=>{const[k,w]=g;return[[...new Set(k.concat(E.transfer.groups.map(O=>O.lines.map(z=>z.name[0])).flat()))],[...new Set(w.concat(E.transfer.groups.map(O=>O.lines.map(z=>z.name[1])).flat()))]]},[[],[]]),v=Object.fromEntries(Object.entries(xt).filter(([g])=>!["railway"].includes(g)).map(([g,E])=>[g,e(E)])),u=_.map((g,E)=>[{type:"input",label:e("Chinese name"),value:g.name[0],onChange:k=>a==null?void 0:a(E,{...g,name:[k,g.name[1]]}),optionList:c[0]},{type:"input",label:e("English name"),value:g.name[1],onChange:k=>a==null?void 0:a(E,{...g,name:[g.name[0],k]}),optionList:c[1]},{type:"select",label:e("Line icon"),value:g.facility,options:v,onChange:k=>a==null?void 0:a(E,{...g,facility:k}),hidden:![Q.MTR].includes(b)}]);return p.jsxs(ze,{direction:"column",children:[_.length===0&&p.jsxs(Ie,{spacing:.5,"data-testid":"interchange-card-stack",children:[p.jsx(st,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:e("StationSidePanel.interchange.noInterchanges")}),p.jsx(De,{size:"sm",variant:"ghost","aria-label":e("StationSidePanel.interchange.add"),onClick:()=>n==null?void 0:n({theme:[f[0],"","#aaaaaa",xe.white],name:["",""]}),icon:p.jsx(Te,{})})]}),_.map((g,E)=>p.jsxs(Ie,{spacing:.5,"data-testid":"interchange-card-stack-".concat(E),children:[p.jsx(St,{label:e("Colour"),minW:"40px",noLabel:E!==0,children:p.jsx(Dt,{theme:g.theme,onClick:()=>{t(!0),d(E)}})}),p.jsx(_e,{fields:u[E],noLabel:E!==0}),n&&E===u.length-1?p.jsx(De,{size:"sm",variant:"ghost","aria-label":e("StationSidePanel.interchange.copy"),onClick:()=>n==null?void 0:n(_.slice(-1)[0]),icon:p.jsx(Mn,{})}):p.jsx(Se,{minW:8}),o&&p.jsx(De,{size:"sm",variant:"ghost","aria-label":e("StationSidePanel.interchange.remove"),onClick:()=>o==null?void 0:o(E),icon:p.jsx(Ct,{})})]},E)),p.jsx(Tt,{isOpen:r,onClose:()=>t(!1),defaultTheme:(y=_[i])==null?void 0:y.theme,onUpdate:g=>a==null?void 0:a(i,{..._[i],theme:g})})]})}function ps(){const{t:m}=le(),_=ge(),n=ee(f=>f.app.selectedStation),{theme:o,style:a}=ee(f=>f.param),{transfer:e}=ee(f=>f.param.stn_list[n]),r=f=>{var h,c,v,u;return[{type:"input",label:m("Station Chinese name"),value:(c=(h=e.groups[f].name)==null?void 0:h[0])!=null?c:"",hidden:![Q.MTR].includes(a),onChange:y=>{var g,E;return _(Zt(n,f,[y,(E=(g=e.groups[f].name)==null?void 0:g[1])!=null?E:""]))}},{type:"input",label:m("Station English name"),value:(u=(v=e.groups[f].name)==null?void 0:v[1])!=null?u:"",hidden:![Q.MTR].includes(a),onChange:y=>{var g,E;return _(Zt(n,f,[(E=(g=e.groups[f].name)==null?void 0:g[0])!=null?E:"",y]))}},{type:"switch",label:m("Paid area"),isChecked:e.paid_area,onChange:y=>_(Nn(n,y)),hidden:![Q.MTR].includes(a)||f===0,oneLine:!0}]},t=f=>h=>{_(Ht(n,f,h))},i=f=>h=>{_(Un(n,f,h))},d=f=>(h,c)=>{_(Wn(n,f,h,c))},b=()=>{_(Ht(n,e.groups.length,{theme:[o[0],"","#AAAAAA",xe.white],name:["",""]}))};return p.jsxs(ht,{align:"flex-start",p:1,children:[p.jsxs(Pe,{w:"100%",children:[p.jsx(ye,{as:"h5",size:"sm",mr:"auto",children:m("StationSidePanel.interchange.title")}),a===Q.MTR&&p.jsx(at,{selections:[{label:m("Text on the left"),value:Ne.left},{label:m("Text on the right"),value:Ne.right}],defaultValue:e.tick_direc,onChange:f=>_(Vn(n,f))})]}),e.groups.map((f,h)=>p.jsxs(J.Fragment,{children:[p.jsx(ye,{as:"h6",size:"xs",children:m(h===0?"StationSidePanel.interchange.within":h===1?"StationSidePanel.interchange.outStation":"StationSidePanel.interchange.outSystem")}),h!==0&&p.jsx(_e,{fields:r(h)}),p.jsx(hs,{interchangeList:f.lines,onAdd:t(h),onDelete:i(h),onUpdate:d(h)})]},h)),e.groups.length<3&&p.jsx(de,{size:"xs",variant:"ghost",alignSelf:"flex-end",leftIcon:p.jsx(Te,{}),onClick:b,children:m("StationSidePanel.interchange.addGroup")})]})}function ms(){const{t:m}=le(),_=ge(),n=ee(v=>v.app.selectedStation),{style:o,loop:a}=ee(v=>v.param),{services:e,facility:r,loop_pivot:t,one_line:i,int_padding:d}=ee(v=>v.param.stn_list[n]),b=Object.values(wt).map(v=>({label:m("StationSidePanel.more."+v),value:v,disabled:v===wt.local&&o!==Q.SHMetro})),f=Object.fromEntries(Object.entries(xt).filter(([v])=>!["railway"].includes(v)).map(([v,u])=>[v,m(u)])),h=Object.fromEntries(Object.entries(xt).filter(([v])=>!["np360"].includes(v)).map(([v,u])=>[v,m(u)])),c=[{type:"custom",label:m("StationSidePanel.more.service"),component:p.jsx(at,{selections:b,defaultValue:e,onChange:v=>_(Zn(n,v)),multiSelect:!0}),hidden:![Q.GZMTR,Q.SHMetro].includes(o)},{type:"select",label:m("StationSidePanel.more.facility"),value:r,options:o===Q.MTR?f:h,onChange:v=>_(Hn(n,v)),hidden:![Q.MTR,Q.SHMetro].includes(o)},{type:"switch",label:m("StationSidePanel.more.pivot"),isChecked:t,onChange:v=>_(Gn(n,v)),hidden:![Q.SHMetro].includes(o)||!a,minW:"full",oneLine:!0},{type:"switch",label:m("StationSidePanel.more.oneLine"),isChecked:i,onChange:v=>_($n(n,v)),hidden:![Q.SHMetro].includes(o),minW:"full",oneLine:!0},{type:"input",label:m("StationSidePanel.more.intPadding"),value:d.toString(),validator:v=>Number.isInteger(v),onChange:v=>_(Yn(n,Number(v))),hidden:![Q.SHMetro].includes(o)},{type:"custom",label:m("StationSidePanel.more.intPaddingApplyGlobal"),component:p.jsx(at,{selections:[{label:m("StationSidePanel.more.apply"),value:"",disabled:!1}],defaultValue:"",onChange:v=>_(qn(n))}),oneLine:!0,hidden:![Q.SHMetro].includes(o)}];return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("StationSidePanel.more.title")}),p.jsx(_e,{fields:c})]})}function fs(){const{t:m}=le(),_=ge(),n=ee(f=>f.app.selectedStation),o=ee(f=>f.param.stn_list),{parents:a,children:e,branch:r}=o[n],t={[ut.through]:m("StationSidePanel.branch.through"),[ut.nonThrough]:m("StationSidePanel.branch.nonThrough")},i=f=>(f===je.left?a:e).reduce((h,c)=>({...h,[c]:o[c].name.join(" ")}),{}),d={upper:m("StationSidePanel.branch.upper"),lower:m("StationSidePanel.branch.lower")},b=f=>r[f].length?[{type:"select",label:m("StationSidePanel.branch.type"),options:t,value:r[f][0],onChange:h=>_(Kn(n,f,h))},{type:"select",label:m("StationSidePanel.branch.firstStation"),options:i(f),value:r[f][1],onChange:h=>_(Xn(n,f,h))},{type:"select",label:m("StationSidePanel.branch.position"),options:d,value:(f===je.left?a:e)[0]===r[f][1]?"upper":"lower",onChange:()=>_(Jn(n,f))}]:[];return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("Branches")}),p.jsx(ye,{as:"h6",size:"xs",children:m("Branch on the left")}),p.jsx(ze,{direction:"column",children:a.length===2?p.jsx(_e,{fields:b(je.left)}):p.jsx(st,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:m("No branches found")})}),p.jsx(ye,{as:"h6",size:"xs",children:m("Branch on the right")}),p.jsx(ze,{direction:"column",children:e.length===2?p.jsx(_e,{fields:b(je.right)}):p.jsx(st,{as:"i",flex:1,align:"center",fontSize:"md",colorScheme:"gray",children:m("No branches found")})})]})}function _s(){return p.jsxs(Rt,{children:[p.jsx(is,{}),p.jsx(Le,{}),p.jsx(ps,{}),p.jsx(Le,{}),p.jsx(fs,{}),p.jsx(Le,{}),p.jsx(ms,{})]})}function gs(){const{t:m}=le(),_=Pt(),{style:n,svgWidth:o,svg_height:a,y_pc:e,branchSpacingPct:r,padding:t,direction_gz_x:i,direction_gz_y:d,loop:b}=ee(h=>h.param),f=[...It[n].map(h=>({type:"input",label:m("StyleSidePanel.layout.".concat(h,"Width")),value:o[h].toString(),onChange:c=>_(Qn(Number(c),h))})),{type:"input",label:m("StyleSidePanel.layout.canvasHeight"),value:a.toString(),onChange:h=>_(er(Number(h)))},{type:"slider",label:m("StyleSidePanel.layout.verticalPosition"),value:e,min:0,max:100,onChange:h=>_(tr(h)),leftIcon:p.jsx(jt,{}),rightIcon:p.jsx(At,{}),hidden:![Q.MTR,Q.GZMTR].includes(n)},{type:"slider",label:m(b?"StyleSidePanel.layout.branchSpacingLoop":"Branch spacing"),value:r,min:0,max:b?50:100,onChange:h=>_(nr(h)),leftIcon:p.jsx(Gt,{}),rightIcon:p.jsx(Te,{})},{type:"slider",label:m("StyleSidePanel.layout.padding"),value:t,min:0,max:50,onChange:h=>_(rr(h)),leftIcon:p.jsx(Gt,{}),rightIcon:p.jsx(Te,{})},{type:"slider",label:m("StyleSidePanel.layout.directionGzX"),value:i,min:0,max:100,onChange:h=>_(sr(h)),leftIcon:p.jsx(an,{}),rightIcon:p.jsx(on,{}),hidden:![Q.GZMTR].includes(n)},{type:"slider",label:m("StyleSidePanel.layout.directionGzY"),value:d,min:0,max:100,onChange:h=>_(ar(h)),leftIcon:p.jsx(jt,{}),rightIcon:p.jsx(At,{}),hidden:![Q.GZMTR].includes(n)}];return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("StyleSidePanel.layout.title")}),p.jsx(_e,{fields:f,minW:130})]})}function vs(){const{t:m}=le(),_=ge(),{style:n,theme:o,line_name:a,line_num:e,direction:r,platform_num:t,psd_num:i,namePosMTR:d,customiseMTRDest:b,info_panel_type:f}=ee(w=>w.param),[h,c]=J.useState(!1),v=[{label:m("StyleSidePanel.design.left"),value:Ne.left},{label:m("StyleSidePanel.design.right"),value:Ne.right}],u=Object.values(ln).reduce((w,O)=>({...w,[O]:m("StyleSidePanel.design."+O)}),{}),y=Object.values(cn).reduce((w,O)=>({...w,[O]:m("StyleSidePanel.design."+O)}),{}),g=[{type:"custom",label:m("Colour"),component:p.jsx(Dt,{theme:o,onClick:()=>c(!0)}),minW:"40px"},{type:"input",label:m("StyleSidePanel.design.zhLineName"),value:a[0],onChange:w=>_($t([w,a[1]])),minW:130},{type:"input",label:m("StyleSidePanel.design.enLineName"),value:a[1],onChange:w=>_($t([a[0],w])),minW:130},{type:"input",label:m("StyleSidePanel.design.lineNum"),value:e,onChange:w=>_(ir(w)),hidden:![Q.GZMTR].includes(n)},{type:"input",label:m("StyleSidePanel.design.platformNum"),value:t||"",onChange:w=>_(or(w))},{type:"input",label:m("StyleSidePanel.design.psdNum"),value:i,onChange:w=>_(lr(w)),hidden:![Q.GZMTR].includes(n)},{type:"select",label:m("StyleSidePanel.design.panelType"),value:f,options:n===Q.GZMTR?u:y,onChange:w=>_(cr(w)),hidden:![Q.GZMTR,Q.SHMetro].includes(n)},{type:"custom",label:m("StyleSidePanel.design.direction"),component:p.jsx(at,{selections:v,defaultValue:r,onChange:w=>_(dr(w))}),minW:"full",oneLine:!0}],E=[{label:m("StyleSidePanel.design.alternatively"),value:!0},{label:m("StyleSidePanel.design.onOneSide"),value:!1}],k=[{type:"custom",label:m("StyleSidePanel.design.nameDisplay"),component:p.jsxs(Ie,{spacing:.5,children:[p.jsx(De,{size:"xs",variant:"ghost","aria-label":m("StyleSidePanel.design.flip"),title:m("StyleSidePanel.design.flip"),icon:p.jsx(ur,{}),onClick:()=>_(hr())}),p.jsx(at,{selections:E,defaultValue:d.isStagger,onChange:w=>_(pr(w))})]}),minW:"full",oneLine:!0,hidden:![Q.MTR].includes(n)},{type:"switch",label:m("StyleSidePanel.design.legacyDestination"),isChecked:b.isLegacy,onChange:w=>_(mr(w)),hidden:![Q.MTR].includes(n),minW:"full",oneLine:!0},{type:"switch",label:m("StyleSidePanel.design.overrideTerminal"),isChecked:b.terminal!==!1,onChange:w=>_(vt(w?["",""]:!1)),hidden:![Q.MTR].includes(n),minW:"full",oneLine:!0},{type:"input",label:m("StyleSidePanel.design.terminalZhName"),value:b.terminal?b.terminal[0]:"",placeholder:"機場及博覽館",onChange:w=>_(vt([w,b.terminal?b.terminal[1]:""])),hidden:![Q.MTR].includes(n)||b.terminal===!1},{type:"input",label:m("StyleSidePanel.design.terminalEnName"),value:b.terminal?b.terminal[1]:"",placeholder:"Airport and AsiaWorld-Expo",onChange:w=>_(vt([b.terminal?b.terminal[0]:"",w])),hidden:![Q.MTR].includes(n)||b.terminal===!1}];return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("StyleSidePanel.design.title")}),p.jsx(_e,{fields:[...g,...k],minW:130}),p.jsx(Tt,{isOpen:h,onClose:()=>c(!1),defaultTheme:o,onUpdate:w=>_(fr(w))})]})}function bs(){const{t:m}=le(),_=ge(),{branches:n}=ee(h=>h.helper),{loop:o,loop_info:a}=ee(h=>h.param),{bank:e,left_and_right_factor:r,bottom_factor:t}=a,i=n.flat().filter((h=>c=>(h[c]=(h[c]||0)+1)===2)({})).filter(h=>!["linestart","lineend"].includes(h)),d=Math.abs(n[0].indexOf(i[0])-n[0].indexOf(i[1])),b=n.length>=2?(0,Math.min)(n[0].length-2-d,d):Math.floor((n[0].length-2-t*2)/2),f=[{type:"switch",label:m("StyleSidePanel.loop.isLoop"),isChecked:o,onChange:h=>_(_r(h)),minW:"full",oneLine:!0},{type:"switch",label:m("StyleSidePanel.loop.isBank"),isChecked:e,onChange:h=>_(gr(h)),minW:"full",oneLine:!0,hidden:!o},{type:"slider",label:m("StyleSidePanel.loop.leftRightFactor"),value:r,min:0,max:b,onChange:h=>_(vr(Math.floor(h))),hidden:!o},{type:"slider",label:m("StyleSidePanel.loop.bottomFactor"),value:t,min:0,max:Math.floor((n[0].length-2-r*2)/2),onChange:h=>_(br(Math.floor(h))),hidden:!o||o&&n.length>2}];return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("StyleSidePanel.loop.title")}),p.jsx(_e,{fields:f})]})}function ys(m){const{note:_,onUpdate:n,onDelete:o}=m,{t:a}=le(),e=[{type:"textarea",label:a("StyleSidePanel.note.zhNote"),value:_[0],onChange:t=>n==null?void 0:n([t,_[1],_[2],_[3],_[4]])},{type:"textarea",label:a("StyleSidePanel.note.enNote"),value:_[1],onChange:t=>n==null?void 0:n([_[0],t,_[2],_[3],_[4]])},{type:"switch",label:a("StyleSidePanel.note.border"),isChecked:_[4],onChange:t=>n==null?void 0:n([_[0],_[1],_[2],_[3],t]),oneLine:!0}],r=[{type:"slider",label:a("StyleSidePanel.note.positionX"),value:_[2],min:0,max:100,onChange:t=>n==null?void 0:n([_[0],_[1],t,_[3],_[4]]),leftIcon:p.jsx(an,{}),rightIcon:p.jsx(on,{})},{type:"slider",label:a("StyleSidePanel.note.positionY"),value:_[3],min:0,max:100,onChange:t=>n==null?void 0:n([_[0],_[1],_[2],t,_[4]]),leftIcon:p.jsx(jt,{}),rightIcon:p.jsx(At,{})}];return p.jsxs(ze,{direction:"column",children:[p.jsx(_e,{fields:e,minW:"full"}),p.jsxs(Ie,{spacing:.5,sx:{"&>div":{flex:1}},children:[p.jsx(_e,{fields:r}),p.jsx(De,{size:"sm",variant:"ghost","aria-label":a("StyleSidePanel.note.remove"),onClick:()=>o==null?void 0:o(),icon:p.jsx(Ct,{})})]})]})}function Es(){const{t:m}=le(),_=ge(),n=ee(o=>o.param.notesGZMTR);return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("StyleSidePanel.note.title")}),p.jsxs(ht,{spacing:.5,children:[n.map((o,a)=>p.jsx(ys,{note:o,onUpdate:e=>_(yr(a,e)),onDelete:()=>_(Er(a))},a)),p.jsx(de,{size:"xs",variant:"ghost",leftIcon:p.jsx(Te,{}),alignSelf:"flex-end",onClick:()=>_(xr()),children:m("StyleSidePanel.note.add")})]})]})}function xs(){const{style:m}=ee(_=>_.param);return p.jsxs(Rt,{children:[p.jsx(gs,{}),p.jsx(Le,{}),p.jsx(vs,{}),m===Q.GZMTR&&p.jsxs(p.Fragment,{children:[p.jsx(Le,{}),p.jsx(Es,{})]}),m===Q.SHMetro&&p.jsxs(p.Fragment,{children:[p.jsx(Le,{}),p.jsx(bs,{})]})]})}const Lt=(m,_)=>{if(["linestart","lineend"].includes(m)||_[m].parents.length>1||_[m].children.length>1)return 0;const n=_[m].parents[0];return n?_[n].children.length===1?Lt(n,_):_[n].children.indexOf(m)===0?1:-1:0},Ss=m=>(_,n)=>{const{stn_list:o,current_stn_idx:a}=n().param;if(m===a)return console.log("removeStation():: failed as current station cannot be deleted"),!1;const{parents:e,children:r}=o[m];return Object.keys(o).length===4?(console.log("removeStation():: failed as only 2 stations remaining"),!1):e.length===2&&r.length===2?(console.log("removeStation():: failed as branches on both sides cannot be combined"),!1):Object.keys(o).some(i=>![m,"linestart","lineend"].includes(i)&&Lt(i,o)===0)?!0:(console.log("removeStation():: failed as selected station is the only station without siblings"),!1)},ws=m=>(_,n)=>{const o=n().param.stn_list,{parents:a,children:e}=o[m];let r=JSON.parse(JSON.stringify(o));a.length===2||e.length===2?(a.forEach(t=>{r[t].children=e}),e.forEach(t=>{r[t].parents=a}),a.length===1&&(r[a[0]].branch.right=r[m].branch.right),e.length===1&&(r[e[0]].branch.left=r[m].branch.left)):o[a[0]].children.length===2&&o[e[0]].parents.length===2?r={...o,[a[0]]:{...o[a[0]],children:o[a[0]].children.filter(t=>t!==m),branch:{...o[a[0]].branch,right:[]}},[e[0]]:{...o[e[0]],parents:o[e[0]].parents.filter(t=>t!==m),branch:{...o[e[0]].branch,left:[]}}}:(a.forEach(t=>{const i=r[t].children.indexOf(m);e.length?r[t].children[i]=e[0]:r[t].children.splice(i,1),r[t].branch.right[1]===m&&(r[t].branch.right[1]=e[0])}),e.forEach(t=>{const i=r[t].parents.indexOf(m);a.length?r[t].parents[i]=a[0]:r[t].parents.splice(i,1),r[t].branch.left[1]===m&&(r[t].branch.left[1]=a[0])})),delete r[m],_(Be(r))};function js(...m){return m.reduce((_,n)=>_.map(o=>n.map(a=>o.concat([a]))).reduce((o,a)=>o.concat(a),[]),[[]])}const Xe=(m,_)=>!!_[m[0]].children.indexOf(m[1]),_n=(m,_)=>[m[0][1],m[0][m[0].length-2],...m[0].filter(n=>m.slice(1).filter(o=>Xe(o,_)).map(o=>o.filter(a=>!["linestart","lineend"].includes(a))).map(o=>[o[0],o[o.length-1]]).flat().includes(n))],As=(m,_)=>m.slice(1).filter(n=>Xe(n,_)).map(n=>n.filter(o=>!["linestart","lineend"].includes(o))).map(n=>[n[0],n[n.length-1]]),ks=m=>(_,n)=>{const o=n().helper.branches;if(m===0){const a=n().param.stn_list,e=_n(o,a);return js(e,e).filter(r=>r[0]!==r[1])}else{const a=o[m];if(a){const e=a.filter(r=>!["linestart","lineend"].includes(r));return[[e[0],e.slice(-1)[0]]]}else return[]}},Oa=(m,_)=>(n,o)=>{const a=o().param.coline,e=o().helper.branches[_];for(const[r,t]of Object.entries(a))if(t.from===m&&e.includes(t.to)){const i=e.indexOf(m),d=e.indexOf(t.to);if(d>i)return[d-i+1,r]}else if(t.to===m&&e.includes(t.to)){const i=e.indexOf(m),d=e.indexOf(t.from);if(d>i)return[d-i+1,r]}return[0,void 0]},gn=(m,_)=>(n,o)=>{const a=o().param.stn_list,e=o().helper.branches;if(m===_)throw new Error("addColine():: failed for same stnId");const r=_n(e,a).filter(i=>[m,_].includes(i)),t=As(e,a).filter(i=>[m,_].every(d=>i.includes(d)));if(r.length===2&&t.length>0)throw new Error("addColine():: main check failed for ".concat(m,", ").concat(_));if(r.length!==2&&t.length!==1)throw new Error("addColine():: branch check failed for ".concat(m,", ").concat(_))},Os=m=>(_,n)=>{const o=n().param.coline,e=n().helper.branches[m];return e?Object.entries(o).reduce((r,t)=>e.includes(t[1].from)&&e.includes(t[1].to)?{...r,[t[0]]:t[1]}:{...r},{}):{}},Cs=m=>(_,n)=>{const o=n().param.coline;if(Object.keys(o).length===0)return;const a=Object.entries(o).reduce((e,r)=>r[1].from!==m&&r[1].to!==m?{...e,[r[0]]:r[1]}:{...e},{});_(Ue(a))},Rs=(m,_,n,o=!0)=>(a,e)=>{const r=e().param.coline;a(gn(m,_)),a(Ue({...r,[it(4)]:{from:m,to:_,colors:n,display:o}}))},Ps=(m,_,n,o=!0)=>(a,e)=>{const r=e().param.coline;if(m in r){a(gn(_,n));const t={...r,[m]:{...r[m],from:_,to:n,display:o}};a(Ue(t))}},Is=(m,_)=>(n,o)=>{const a=o().param.coline;if(m in a&&a[m].colors.length>_){const e=a[m].colors.filter((r,t)=>t!==_);if(e.length===0){const{[m]:r,...t}=a;n(Ue(t))}else{const r={...a,[m]:{...a[m],colors:e}};n(Ue(r))}}},Ts=(m,_,n)=>(o,a)=>{const e=a().param.coline;m in e&&e[m].colors.length>_&&(e[m].colors=e[m].colors.map((r,t)=>t===_?[0,1,2,3,4,5].map(i=>n[i]===void 0?r[i]:n[i]):r),o(Ue(e)))};function Ds(m){const{isOpen:_,onClose:n}=m,{t:o}=le(),a=ge(),e=ee(d=>d.app.selectedStation),[r,t]=J.useState(!1);J.useEffect(()=>{_||t(!1)},[_]);const i=()=>{const d=a(Ss(e));d?(n(),a(We(Me.CLOSE)),a(dn("linestart")),a(Cs(e)),a(ws(e))):t(!0),he.event(Ee.REMOVE_STATION,{success:d})};return p.jsxs(Ze,{isOpen:_,onClose:n,children:[p.jsx(He,{}),p.jsxs(Ge,{children:[r&&p.jsxs(pt,{status:"error",variant:"solid",size:"xs",children:[p.jsx(mt,{}),o("Unable to remove this station.")]}),p.jsxs(Se,{position:"relative",children:[p.jsx($e,{children:o("Remove station")}),p.jsx(Ye,{})]}),p.jsx(qe,{children:o("Are you sure to remove station? You cannot undo this action.")}),p.jsxs(Ke,{children:[p.jsx(de,{onClick:n,children:o("Cancel")}),p.jsx(de,{colorScheme:"primary",onClick:i,ml:3,children:o("Confirm")})]})]})]})}function Ls(){const{t:m}=le(),_=ge(),n=ee(e=>e.app.selectedStation),[o,a]=J.useState(!1);return p.jsxs(Sr,{children:[p.jsxs(Ie,{children:[p.jsx(de,{size:"sm",variant:"outline",onClick:()=>_(kt(n)),children:m("StationSidePanel.footer.current")}),p.jsx(de,{size:"sm",variant:"outline",onClick:()=>a(!0),children:m("StationSidePanel.footer.remove")})]}),p.jsx(Ds,{isOpen:o,onClose:()=>a(!1)})]})}function Fs(m){const{colineInfo:_,routeOptions:n,onUpdateRoute:o,onUpdateColourInfo:a,onDelete:e}=m,{t:r}=le(),[t,i]=J.useState(!1),d=[{type:"select",label:"Route",value:[_.from,_.to].join(","),options:n,onChange:f=>o==null?void 0:o(f)}],b=[{type:"custom",label:r("Colour"),component:p.jsx(Dt,{theme:[_.colors[0][0],_.colors[0][1],_.colors[0][2],_.colors[0][3]],onClick:()=>i(!0)})},{type:"input",label:r("Chinese name"),value:_.colors[0][4],minW:120,onChange:f=>a==null?void 0:a([_.colors[0][0],_.colors[0][1],_.colors[0][2],_.colors[0][3],f,_.colors[0][5]])},{type:"input",label:r("English name"),value:_.colors[0][5],minW:120,onChange:f=>a==null?void 0:a([_.colors[0][0],_.colors[0][1],_.colors[0][2],_.colors[0][3],_.colors[0][4],f])}];return p.jsxs(ze,{direction:"column",children:[p.jsx(_e,{fields:d,minW:"full"}),p.jsxs(Ie,{spacing:.5,children:[p.jsx(_e,{fields:b}),p.jsx(De,{size:"sm",variant:"ghost","aria-label":"Delete colour for route",onClick:()=>e==null?void 0:e(0),icon:p.jsx(Ct,{})})]}),p.jsx(Tt,{isOpen:t,onClose:()=>i(!1),defaultTheme:_.colors[0].slice(0,4),onUpdate:f=>a==null?void 0:a([...f,_.colors[0][4],_.colors[0][5]])})]})}function zs(){const{t:m}=le(),_=ge(),n=ee(h=>h.app.selectedBranch),{theme:o,stn_list:a}=ee(h=>h.param),e=_(Os(n)),r=_(ks(n)),t=h=>h.map(c=>a[c].name.join(" - ")).join(" ~ "),i=r.reduce((h,c)=>({...h,[c.join(",")]:t(c)}),{}),d=()=>{console.log("ColineSection.handleAddTrackSharing():: Adding track sharing to branch ".concat(n," with default combination"),r[0]),_(Rs(r[0][0],r[0][1],[[o[0],"","#AAAAAA",xe.white,"",""]]))},b=h=>c=>{const[v,u]=c.split(",");console.log("ColineSection.handleUpdateRoute():: Updating route, colineId=".concat(h,", from=").concat(v,", to=").concat(u));try{_(Ps(h,v,u))}catch(y){_(Ot({status:"error",message:"Unable to draw this share track."}))}},f=(h,c)=>{_(Is(h,c))};return p.jsxs(ht,{align:"flex-start",p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("BranchSidePanel.coline.title")}),Object.entries(e).map(([h,c])=>p.jsx(Fs,{colineInfo:c,routeOptions:i,onUpdateRoute:b(h),onUpdateColourInfo:v=>_(Ts(h,0,v)),onDelete:v=>f(h,v)},h)),(n===0||Object.keys(e).length===0)&&p.jsx(de,{size:"xs",variant:"ghost",alignSelf:"flex-end",leftIcon:p.jsx(Te,{}),onClick:d,children:m("BranchSidePanel.coline.add")})]})}function Bs(m){const{isOpen:_,onClose:n}=m,{t:o}=le(),a=ge(),e=ee(w=>w.app.selectedBranch),{style:r,stn_list:t}=ee(w=>w.param),i=ee(w=>w.helper.branches),[d,b]=J.useState(e),[f,h]=J.useState("1"),[c,v]=J.useState("2"),[u,y]=J.useState("asc");J.useEffect(()=>{b(e)},[e]);const g=[{type:"select",label:o("AutoNumModal.where"),value:d,options:{...i.reduce((w,O,z)=>({...w,[z]:z===0?o("AutoNumModal.main"):r!==Q.SHMetro||!Xe(O,t)?o("AutoNumModal.branch")+" "+z:o("AutoNumModal.external")+" "+z}),{})},onChange:w=>b(w)},{type:"input",label:o("AutoNumModal.from"),value:f,validator:w=>!isNaN(Number(w)),onChange:h,debouncedDelay:0},{type:"input",label:o("AutoNumModal.maxLength"),validator:w=>!isNaN(Number(w)),value:c,onChange:v,debouncedDelay:0},{type:"select",label:o("AutoNumModal.sort"),value:u,options:{asc:o("AutoNumModal.asc"),desc:o("AutoNumModal.desc")},onChange:w=>y(w)}],E=()=>{a(wr(d,Number(f),Number(c),u)),n(),he.event(Ee.AUTO_NUMBERING,{})},k=!f||!c||isNaN(Number(f))||isNaN(Number(c));return p.jsxs(Ze,{isOpen:_,onClose:n,children:[p.jsx(He,{}),p.jsxs(Ge,{children:[p.jsx($e,{children:o("AutoNumModal.title")}),p.jsx(Ye,{}),p.jsx(qe,{children:p.jsx(_e,{fields:g})}),p.jsx(Ke,{children:p.jsx(de,{colorScheme:"primary",isDisabled:k,onClick:E,children:o("Confirm")})})]})]})}const Ft=m=>(_,n)=>{const a=n().helper.branches[m];return a.includes("linestart")||a.includes("lineend")?1:2},vn=m=>(_,n)=>{const{branches:o}=n().helper,a=o[0],e=o[m];return a.slice(a.indexOf(e[0])+1,a.indexOf(e.slice(-1)[0]))},Ms=(m,_)=>n=>n(Ft(_))===2?(console.log("isStationValid2ConnectBranch():: failed as current branch has 2 connected ends"),!1):n(vn(_)).includes(m)?!0:(console.log("isStationValid2ConnectBranch():: failed as the target station is invalid"),!1),Vs=(m,_)=>(n,o)=>{if(!n(Ms(m,_)))return!1;const{branches:e}=o().helper,r=o().param.stn_list,t=e[_];if(t[0]==="linestart"){const i={...r,[t[1]]:{...r[t[1]],parents:[m]},[m]:{...r[m],children:r.linestart.children.map(d=>d===t[1]?d:r[m].children[0]),branch:{left:[],right:r.linestart.branch.right}},linestart:{...r.linestart,children:r.linestart.children.filter(d=>d!==t[1]),branch:{left:[],right:[]}}};return n(Be(i)),!0}else{const i=t.slice(-2)[0],d={...r,[i]:{...r[i],children:[m]},[m]:{...r[m],parents:r.lineend.parents.map(b=>b===i?b:r[m].parents[0]),branch:{right:[],left:r.lineend.branch.left}},lineend:{...r.lineend,parents:r.lineend.parents.filter(b=>b!==i),branch:{left:[],right:[]}}};return n(Be(d)),!0}},bn=m=>(_,n)=>{const{branches:o}=n().helper,a=n().param.stn_list,e=o[0],r=o[m];if(_(Ft(m))!==2)return console.log("getPossibleDirection():: failed as there is no possible direction"),[];const i=e.indexOf(r[0]),d=e.slice(0,i),b=e.indexOf(r.slice(-1)[0]),f=e.slice(b+1),h=d.every(v=>a[v].children.length<=1&&a[v].parents.length<=1),c=f.every(v=>a[v].children.length<=1&&a[v].parents.length<=1);return h?c?[je.left,je.right]:[je.left]:c?[je.right]:[]},Ns=(m,_)=>(n,o)=>{if(!n(bn(_)).includes(m))return console.log("disconnectFromMainLine():: failed as the aim direction is not in the possible direction list"),!1;const{branches:e}=o().helper,r=o().param.stn_list,t=e[0],i=e[_];if(m===je.left){const d=i[0],b={...r,[i[1]]:{...r[i[1]],parents:["linestart"]},[d]:{...r[d],children:r[d].children.filter(f=>f!==i[1]),branch:{right:[],left:[]}},linestart:{...r.linestart,children:r[d].children.map(f=>f===i[1]?f:t[1]),branch:{left:[],right:r[d].branch.right}}};return n(Be(b)),!0}else{const d=i.slice(-1)[0],b=i.slice(-2)[0],f={...r,[b]:{...r[b],children:["lineend"]},[d]:{...r[d],parents:r[d].parents.filter(h=>h!==b),branch:{right:[],left:[]}},lineend:{...r.lineend,parents:r[d].parents.map(h=>h===b?h:t.slice(-2)[0]),branch:{right:[],left:r[d].branch.left}}};return n(Be(f)),!0}};function Kt(m){const{direction:_}=m,{t:n}=le(),o=ge(),{branches:a}=ee(T=>T.helper),e=ee(T=>T.app.selectedBranch),{style:r,stn_list:t}=ee(T=>T.param),[i,d]=J.useState(!1),[b,f]=J.useState(""),h=a[e].filter(T=>!["linestart","lineend"].includes(T)),c=_===je.left?h[0]:h.slice(-1)[0],v=t[c],u=o(vn(e)),y=o(Ft(e)),g=o(bn(e)),E=y===1&&!a[0].includes(c),k=g.includes(_),w=u.reduce((T,B)=>{var P;return{...T,[B]:(P=t[B])==null?void 0:P.name.join(" - ")}},{"":n("Please select...")}),O=()=>{const T=o(Vs(b,e));T?d(!1):o(Ot({status:"error",message:n("Unable to connect to main line.")})),he.event(Ee.CONNECT_BRANCH,{style:r,success:T})},z=()=>{const T=o(Ns(_,e));T||o(Ot({status:"error",message:n("Unable to disconnect from main line.")})),he.event(Ee.DISCONNECT_BRANCH,{style:r,success:T})};return p.jsxs(ze,{direction:"column",children:[p.jsxs(Pe,{alignItems:"center",children:[p.jsx(St,{label:n("Station name"),flex:1,children:p.jsx(jr,{defaultValue:v.name.join(" "),isDisabled:!0})}),i?p.jsx(de,{mx:1,size:"sm",variant:"outline",onClick:()=>d(!1),children:n("Cancel")}):E?p.jsx(de,{mx:1,size:"sm",variant:"solid",colorScheme:"primary",onClick:()=>d(!0),children:n("Connect to main line")}):p.jsx(de,{mx:1,size:"sm",variant:"solid",colorScheme:"primary",onClick:z,isDisabled:!k,children:n("Disconnect from main line")})]}),i&&p.jsxs(Pe,{alignItems:"center",children:[p.jsx(St,{label:n("Target station"),flex:1,children:p.jsx(Ar,{defaultValue:b,options:w,disabledOptions:[""],onChange:({target:{value:T}})=>f(T)})}),p.jsx(de,{mx:1,size:"sm",variant:"solid",colorScheme:"primary",onClick:O,isDisabled:!b,children:n("Confirm")})]})]})}function Us(){const{t:m}=le(),_=ge(),n=ee(t=>t.param.style),o=ee(t=>t.app.selectedBranch),[a,e]=J.useState(!1),r=()=>{_(Cr(n===Q.SHMetro)),he.event(Ee.REVERSE_STATIONS,{style:n})};return p.jsxs(Se,{p:1,children:[p.jsx(ye,{as:"h5",size:"sm",children:m("BranchSidePanel.action.title")}),p.jsxs(Pe,{wrap:"wrap",sx:{p:1,"&> *":{flexShrink:0,flexBasis:"100%","&:not(:first-of-type)":{marginTop:2}}},children:[o!==0&&n!==Q.SHMetro&&p.jsxs(p.Fragment,{children:[p.jsx(ye,{as:"h6",size:"xs",children:m("Branch left end")}),p.jsx(Kt,{direction:je.left}),p.jsx(ye,{as:"h6",size:"xs",children:m("Branch right end")}),p.jsx(Kt,{direction:je.right})]}),n===Q.GZMTR&&p.jsx(de,{size:"sm",variant:"outline",leftIcon:p.jsx(kr,{}),alignSelf:"flex-end",onClick:()=>e(!0),children:m("BranchSidePanel.action.autoNum")}),p.jsx(de,{size:"sm",variant:"outline",leftIcon:p.jsx(Or,{}),alignSelf:"flex-end",onClick:r,children:n===Q.SHMetro?m("BranchSidePanel.action.flip"):m("BranchSidePanel.action.reverse")})]}),p.jsx(Bs,{isOpen:a,onClose:()=>e(!1)})]})}function Ws(){const m=ee(a=>a.app.selectedBranch),{style:_,stn_list:n}=ee(a=>a.param),o=ee(a=>a.helper.branches);return p.jsxs(Rt,{children:[_===Q.SHMetro&&(m===0||Xe(o[m],n))&&p.jsxs(p.Fragment,{children:[p.jsx(zs,{}),p.jsx(Le,{})]}),p.jsx(Us,{})]})}const Zs=410;function Hs(){var t,i;const{t:m}=le(),_=Pt(),{sidePanelMode:n,selectedStation:o}=ee(d=>d.app),a=ee(d=>{var b;return(b=d.param.stn_list[o])==null?void 0:b.name}),e={STATION:{header:p.jsx(ts,{text:(a==null?void 0:a.join(" - "))||""}),body:p.jsx(_s,{}),footer:p.jsx(Ls,{})},STYLE:{header:m("StyleSidePanel.header"),body:p.jsx(xs,{})},BRANCH:{header:m("BranchSidePanel.header"),body:p.jsx(Ws,{})},CLOSE:{header:"Close"}},r=()=>{_(We(Me.CLOSE))};return p.jsxs(Rr,{isOpen:n!==Me.CLOSE,width:Zs,header:"Dummy header",children:[p.jsx(Pr,{onClose:r,children:e[n].header}),(t=e[n])==null?void 0:t.body,(i=e[n])==null?void 0:i.footer]})}function dt(m){throw new Error('Could not dynamically require "'+m+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yn={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(m,_){(function(n){m.exports=n()})(function(){return function n(o,a,e){function r(d,b){if(!a[d]){if(!o[d]){var f=typeof dt=="function"&&dt;if(!b&&f)return f(d,!0);if(t)return t(d,!0);var h=new Error("Cannot find module '"+d+"'");throw h.code="MODULE_NOT_FOUND",h}var c=a[d]={exports:{}};o[d][0].call(c.exports,function(v){var u=o[d][1][v];return r(u||v)},c,c.exports,n,o,a,e)}return a[d].exports}for(var t=typeof dt=="function"&&dt,i=0;i<e.length;i++)r(e[i]);return r}({1:[function(n,o,a){var e=n("./utils"),r=n("./support"),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(i){for(var d,b,f,h,c,v,u,y=[],g=0,E=i.length,k=E,w=e.getTypeOf(i)!=="string";g<i.length;)k=E-g,f=w?(d=i[g++],b=g<E?i[g++]:0,g<E?i[g++]:0):(d=i.charCodeAt(g++),b=g<E?i.charCodeAt(g++):0,g<E?i.charCodeAt(g++):0),h=d>>2,c=(3&d)<<4|b>>4,v=1<k?(15&b)<<2|f>>6:64,u=2<k?63&f:64,y.push(t.charAt(h)+t.charAt(c)+t.charAt(v)+t.charAt(u));return y.join("")},a.decode=function(i){var d,b,f,h,c,v,u=0,y=0,g="data:";if(i.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var E,k=3*(i=i.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(i.charAt(i.length-1)===t.charAt(64)&&k--,i.charAt(i.length-2)===t.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(E=r.uint8array?new Uint8Array(0|k):new Array(0|k);u<i.length;)d=t.indexOf(i.charAt(u++))<<2|(h=t.indexOf(i.charAt(u++)))>>4,b=(15&h)<<4|(c=t.indexOf(i.charAt(u++)))>>2,f=(3&c)<<6|(v=t.indexOf(i.charAt(u++))),E[y++]=d,c!==64&&(E[y++]=b),v!==64&&(E[y++]=f);return E}},{"./support":30,"./utils":32}],2:[function(n,o,a){var e=n("./external"),r=n("./stream/DataWorker"),t=n("./stream/Crc32Probe"),i=n("./stream/DataLengthProbe");function d(b,f,h,c,v){this.compressedSize=b,this.uncompressedSize=f,this.crc32=h,this.compression=c,this.compressedContent=v}d.prototype={getContentWorker:function(){var b=new r(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),f=this;return b.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new r(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(b,f,h){return b.pipe(new t).pipe(new i("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new i("compressedSize")).withStreamInfo("compression",f)},o.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,o,a){var e=n("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new e("STORE compression")},uncompressWorker:function(){return new e("STORE decompression")}},a.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,o,a){var e=n("./utils"),r=function(){for(var t,i=[],d=0;d<256;d++){t=d;for(var b=0;b<8;b++)t=1&t?3988292384^t>>>1:t>>>1;i[d]=t}return i}();o.exports=function(t,i){return t!==void 0&&t.length?e.getTypeOf(t)!=="string"?function(d,b,f,h){var c=r,v=h+f;d^=-1;for(var u=h;u<v;u++)d=d>>>8^c[255&(d^b[u])];return-1^d}(0|i,t,t.length,0):function(d,b,f,h){var c=r,v=h+f;d^=-1;for(var u=h;u<v;u++)d=d>>>8^c[255&(d^b.charCodeAt(u))];return-1^d}(0|i,t,t.length,0):0}},{"./utils":32}],5:[function(n,o,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(n,o,a){var e=null;e=typeof Promise<"u"?Promise:n("lie"),o.exports={Promise:e}},{lie:37}],7:[function(n,o,a){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=n("pako"),t=n("./utils"),i=n("./stream/GenericWorker"),d=e?"uint8array":"array";function b(f,h){i.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}a.magic="\b\0",t.inherits(b,i),b.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(t.transformTo(d,f.data),!1)},b.prototype.flush=function(){i.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},a.compressWorker=function(f){return new b("Deflate",f)},a.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,o,a){function e(c,v){var u,y="";for(u=0;u<v;u++)y+=String.fromCharCode(255&c),c>>>=8;return y}function r(c,v,u,y,g,E){var k,w,O=c.file,z=c.compression,T=E!==d.utf8encode,B=t.transformTo("string",E(O.name)),P=t.transformTo("string",d.utf8encode(O.name)),N=O.comment,Y=t.transformTo("string",E(N)),A=t.transformTo("string",d.utf8encode(N)),F=P.length!==O.name.length,l=A.length!==N.length,M="",re="",Z="",ae=O.dir,H=O.date,se={crc32:0,compressedSize:0,uncompressedSize:0};v&&!u||(se.crc32=c.crc32,se.compressedSize=c.compressedSize,se.uncompressedSize=c.uncompressedSize);var D=0;v&&(D|=8),T||!F&&!l||(D|=2048);var I=0,ne=0;ae&&(I|=16),g==="UNIX"?(ne=798,I|=function(q,pe){var be=q;return q||(be=pe?16893:33204),(65535&be)<<16}(O.unixPermissions,ae)):(ne=20,I|=function(q){return 63&(q||0)}(O.dosPermissions)),k=H.getUTCHours(),k<<=6,k|=H.getUTCMinutes(),k<<=5,k|=H.getUTCSeconds()/2,w=H.getUTCFullYear()-1980,w<<=4,w|=H.getUTCMonth()+1,w<<=5,w|=H.getUTCDate(),F&&(re=e(1,1)+e(b(B),4)+P,M+="up"+e(re.length,2)+re),l&&(Z=e(1,1)+e(b(Y),4)+A,M+="uc"+e(Z.length,2)+Z);var K="";return K+="\n\0",K+=e(D,2),K+=z.magic,K+=e(k,2),K+=e(w,2),K+=e(se.crc32,4),K+=e(se.compressedSize,4),K+=e(se.uncompressedSize,4),K+=e(B.length,2),K+=e(M.length,2),{fileRecord:f.LOCAL_FILE_HEADER+K+B+M,dirRecord:f.CENTRAL_FILE_HEADER+e(ne,2)+K+e(Y.length,2)+"\0\0\0\0"+e(I,4)+e(y,4)+B+M+Y}}var t=n("../utils"),i=n("../stream/GenericWorker"),d=n("../utf8"),b=n("../crc32"),f=n("../signature");function h(c,v,u,y){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=u,this.encodeFileName=y,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}t.inherits(h,i),h.prototype.push=function(c){var v=c.meta.percent||0,u=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,i.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:u?(v+100*(u-y-1))/u:100}}))},h.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var v=this.streamFiles&&!c.file.dir;if(v){var u=r(c,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:u.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(c){this.accumulate=!1;var v=this.streamFiles&&!c.file.dir,u=r(c,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(u.dirRecord),v)this.push({data:function(y){return f.DATA_DESCRIPTOR+e(y.crc32,4)+e(y.compressedSize,4)+e(y.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:u.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var c=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var u=this.bytesWritten-c,y=function(g,E,k,w,O){var z=t.transformTo("string",O(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+e(g,2)+e(g,2)+e(E,4)+e(k,4)+e(z.length,2)+z}(this.dirRecords.length,u,c,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(c){this._sources.push(c);var v=this;return c.on("data",function(u){v.processChunk(u)}),c.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),c.on("error",function(u){v.error(u)}),this},h.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(c){var v=this._sources;if(!i.prototype.error.call(this,c))return!1;for(var u=0;u<v.length;u++)try{v[u].error(c)}catch(y){}return!0},h.prototype.lock=function(){i.prototype.lock.call(this);for(var c=this._sources,v=0;v<c.length;v++)c[v].lock()},o.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,o,a){var e=n("../compressions"),r=n("./ZipFileWorker");a.generateWorker=function(t,i,d){var b=new r(i.streamFiles,d,i.platform,i.encodeFileName),f=0;try{t.forEach(function(h,c){f++;var v=function(E,k){var w=E||k,O=e[w];if(!O)throw new Error(w+" is not a valid compression method !");return O}(c.options.compression,i.compression),u=c.options.compressionOptions||i.compressionOptions||{},y=c.dir,g=c.date;c._compressWorker(v,u).withStreamInfo("file",{name:h,dir:y,date:g,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(b)}),b.entriesCount=f}catch(h){b.error(h)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,o,a){function e(){if(!(this instanceof e))return new e;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new e;for(var t in this)typeof this[t]!="function"&&(r[t]=this[t]);return r}}(e.prototype=n("./object")).loadAsync=n("./load"),e.support=n("./support"),e.defaults=n("./defaults"),e.version="3.10.1",e.loadAsync=function(r,t){return new e().loadAsync(r,t)},e.external=n("./external"),o.exports=e},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,o,a){var e=n("./utils"),r=n("./external"),t=n("./utf8"),i=n("./zipEntries"),d=n("./stream/Crc32Probe"),b=n("./nodejsUtils");function f(h){return new r.Promise(function(c,v){var u=h.decompressed.getContentWorker().pipe(new d);u.on("error",function(y){v(y)}).on("end",function(){u.streamInfo.crc32!==h.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}o.exports=function(h,c){var v=this;return c=e.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:t.utf8decode}),b.isNode&&b.isStream(h)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",h,!0,c.optimizedBinaryString,c.base64).then(function(u){var y=new i(c);return y.load(u),y}).then(function(u){var y=[r.Promise.resolve(u)],g=u.files;if(c.checkCRC32)for(var E=0;E<g.length;E++)y.push(f(g[E]));return r.Promise.all(y)}).then(function(u){for(var y=u.shift(),g=y.files,E=0;E<g.length;E++){var k=g[E],w=k.fileNameStr,O=e.resolve(k.fileNameStr);v.file(O,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:c.createFolders}),k.dir||(v.file(O).unsafeOriginalName=w)}return y.zipComment.length&&(v.comment=y.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,o,a){var e=n("../utils"),r=n("../stream/GenericWorker");function t(i,d){r.call(this,"Nodejs stream input adapter for "+i),this._upstreamEnded=!1,this._bindStream(d)}e.inherits(t,r),t.prototype._bindStream=function(i){var d=this;(this._stream=i).pause(),i.on("data",function(b){d.push({data:b,meta:{percent:0}})}).on("error",function(b){d.isPaused?this.generatedError=b:d.error(b)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},t.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},t.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=t},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,o,a){var e=n("readable-stream").Readable;function r(t,i,d){e.call(this,i),this._helper=t;var b=this;t.on("data",function(f,h){b.push(f)||b._helper.pause(),d&&d(h)}).on("error",function(f){b.emit("error",f)}).on("end",function(){b.push(null)})}n("../utils").inherits(r,e),r.prototype._read=function(){this._helper.resume()},o.exports=r},{"../utils":32,"readable-stream":16}],14:[function(n,o,a){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,r);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,r)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var r=new Buffer(e);return r.fill(0),r},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}},{}],15:[function(n,o,a){function e(O,z,T){var B,P=t.getTypeOf(z),N=t.extend(T||{},b);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&16384&N.unixPermissions&&(N.dir=!0),N.dosPermissions&&16&N.dosPermissions&&(N.dir=!0),N.dir&&(O=g(O)),N.createFolders&&(B=y(O))&&E.call(this,B,!0);var Y=P==="string"&&N.binary===!1&&N.base64===!1;T&&T.binary!==void 0||(N.binary=!Y),(z instanceof f&&z.uncompressedSize===0||N.dir||!z||z.length===0)&&(N.base64=!1,N.binary=!0,z="",N.compression="STORE",P="string");var A=null;A=z instanceof f||z instanceof i?z:v.isNode&&v.isStream(z)?new u(O,z):t.prepareContent(O,z,N.binary,N.optimizedBinaryString,N.base64);var F=new h(O,A,N);this.files[O]=F}var r=n("./utf8"),t=n("./utils"),i=n("./stream/GenericWorker"),d=n("./stream/StreamHelper"),b=n("./defaults"),f=n("./compressedObject"),h=n("./zipObject"),c=n("./generate"),v=n("./nodejsUtils"),u=n("./nodejs/NodejsStreamInputAdapter"),y=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var z=O.lastIndexOf("/");return 0<z?O.substring(0,z):""},g=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},E=function(O,z){return z=z!==void 0?z:b.createFolders,O=g(O),this.files[O]||e.call(this,O,null,{dir:!0,createFolders:z}),this.files[O]};function k(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var z,T,B;for(z in this.files)B=this.files[z],(T=z.slice(this.root.length,z.length))&&z.slice(0,this.root.length)===this.root&&O(T,B)},filter:function(O){var z=[];return this.forEach(function(T,B){O(T,B)&&z.push(B)}),z},file:function(O,z,T){if(arguments.length!==1)return O=this.root+O,e.call(this,O,z,T),this;if(k(O)){var B=O;return this.filter(function(N,Y){return!Y.dir&&B.test(N)})}var P=this.files[this.root+O];return P&&!P.dir?P:null},folder:function(O){if(!O)return this;if(k(O))return this.filter(function(P,N){return N.dir&&O.test(P)});var z=this.root+O,T=E.call(this,z),B=this.clone();return B.root=T.name,B},remove:function(O){O=this.root+O;var z=this.files[O];if(z||(O.slice(-1)!=="/"&&(O+="/"),z=this.files[O]),z&&!z.dir)delete this.files[O];else for(var T=this.filter(function(P,N){return N.name.slice(0,O.length)===O}),B=0;B<T.length;B++)delete this.files[T[B].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var z,T={};try{if((T=t.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");t.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var B=T.comment||this.comment||"";z=c.generateWorker(this,T,B)}catch(P){(z=new i("error")).error(P)}return new d(z,T.type||"string",T.mimeType)},generateAsync:function(O,z){return this.generateInternalStream(O).accumulate(z)},generateNodeStream:function(O,z){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(z)}};o.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,o,a){o.exports=n("stream")},{stream:void 0}],17:[function(n,o,a){var e=n("./DataReader");function r(t){e.call(this,t);for(var i=0;i<this.data.length;i++)t[i]=255&t[i]}n("../utils").inherits(r,e),r.prototype.byteAt=function(t){return this.data[this.zero+t]},r.prototype.lastIndexOfSignature=function(t){for(var i=t.charCodeAt(0),d=t.charCodeAt(1),b=t.charCodeAt(2),f=t.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===i&&this.data[h+1]===d&&this.data[h+2]===b&&this.data[h+3]===f)return h-this.zero;return-1},r.prototype.readAndCheckSignature=function(t){var i=t.charCodeAt(0),d=t.charCodeAt(1),b=t.charCodeAt(2),f=t.charCodeAt(3),h=this.readData(4);return i===h[0]&&d===h[1]&&b===h[2]&&f===h[3]},r.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},o.exports=r},{"../utils":32,"./DataReader":18}],18:[function(n,o,a){var e=n("../utils");function r(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var i,d=0;for(this.checkOffset(t),i=this.index+t-1;i>=this.index;i--)d=(d<<8)+this.byteAt(i);return this.index+=t,d},readString:function(t){return e.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},o.exports=r},{"../utils":32}],19:[function(n,o,a){var e=n("./Uint8ArrayReader");function r(t){e.call(this,t)}n("../utils").inherits(r,e),r.prototype.readData=function(t){this.checkOffset(t);var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},o.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,o,a){var e=n("./DataReader");function r(t){e.call(this,t)}n("../utils").inherits(r,e),r.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},r.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},r.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},r.prototype.readData=function(t){this.checkOffset(t);var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},o.exports=r},{"../utils":32,"./DataReader":18}],21:[function(n,o,a){var e=n("./ArrayReader");function r(t){e.call(this,t)}n("../utils").inherits(r,e),r.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var i=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},o.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(n,o,a){var e=n("../utils"),r=n("../support"),t=n("./ArrayReader"),i=n("./StringReader"),d=n("./NodeBufferReader"),b=n("./Uint8ArrayReader");o.exports=function(f){var h=e.getTypeOf(f);return e.checkSupport(h),h!=="string"||r.uint8array?h==="nodebuffer"?new d(f):r.uint8array?new b(e.transformTo("uint8array",f)):new t(e.transformTo("array",f)):new i(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,o,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,o,a){var e=n("./GenericWorker"),r=n("../utils");function t(i){e.call(this,"ConvertWorker to "+i),this.destType=i}r.inherits(t,e),t.prototype.processChunk=function(i){this.push({data:r.transformTo(this.destType,i.data),meta:i.meta})},o.exports=t},{"../utils":32,"./GenericWorker":28}],25:[function(n,o,a){var e=n("./GenericWorker"),r=n("../crc32");function t(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(t,e),t.prototype.processChunk=function(i){this.streamInfo.crc32=r(i.data,this.streamInfo.crc32||0),this.push(i)},o.exports=t},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,o,a){var e=n("../utils"),r=n("./GenericWorker");function t(i){r.call(this,"DataLengthProbe for "+i),this.propName=i,this.withStreamInfo(i,0)}e.inherits(t,r),t.prototype.processChunk=function(i){if(i){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+i.data.length}r.prototype.processChunk.call(this,i)},o.exports=t},{"../utils":32,"./GenericWorker":28}],27:[function(n,o,a){var e=n("../utils"),r=n("./GenericWorker");function t(i){r.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,i.then(function(b){d.dataIsReady=!0,d.data=b,d.max=b&&b.length||0,d.type=e.getTypeOf(b),d.isPaused||d._tickAndRepeat()},function(b){d.error(b)})}e.inherits(t,r),t.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},t.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},t.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},t.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var i=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":i=this.data.substring(this.index,d);break;case"uint8array":i=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":i=this.data.slice(this.index,d)}return this.index=d,this.push({data:i,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=t},{"../utils":32,"./GenericWorker":28}],28:[function(n,o,a){function e(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}e.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,t){return this._listeners[r].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,t){if(this._listeners[r])for(var i=0;i<this._listeners[r].length;i++)this._listeners[r][i].call(this,t)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var t=this;return r.on("data",function(i){t.processChunk(i)}),r.on("end",function(){t.end()}),r.on("error",function(i){t.error(i)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,t){return this.extraStreamInfo[r]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},o.exports=e},{}],29:[function(n,o,a){var e=n("../utils"),r=n("./ConvertWorker"),t=n("./GenericWorker"),i=n("../base64"),d=n("../support"),b=n("../external"),f=null;if(d.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch(v){}function h(v,u){return new b.Promise(function(y,g){var E=[],k=v._internalType,w=v._outputType,O=v._mimeType;v.on("data",function(z,T){E.push(z),u&&u(T)}).on("error",function(z){E=[],g(z)}).on("end",function(){try{var z=function(T,B,P){switch(T){case"blob":return e.newBlob(e.transformTo("arraybuffer",B),P);case"base64":return i.encode(B);default:return e.transformTo(T,B)}}(w,function(T,B){var P,N=0,Y=null,A=0;for(P=0;P<B.length;P++)A+=B[P].length;switch(T){case"string":return B.join("");case"array":return Array.prototype.concat.apply([],B);case"uint8array":for(Y=new Uint8Array(A),P=0;P<B.length;P++)Y.set(B[P],N),N+=B[P].length;return Y;case"nodebuffer":return Buffer.concat(B);default:throw new Error("concat : unsupported type '"+T+"'")}}(k,E),O);y(z)}catch(T){g(T)}E=[]}).resume()})}function c(v,u,y){var g=u;switch(u){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=u,this._mimeType=y,e.checkSupport(g),this._worker=v.pipe(new r(g)),v.lock()}catch(E){this._worker=new t("error"),this._worker.error(E)}}c.prototype={accumulate:function(v){return h(this,v)},on:function(v,u){var y=this;return v==="data"?this._worker.on(v,function(g){u.call(y,g.data,g.meta)}):this._worker.on(v,function(){e.delay(u,arguments,y)}),this},resume:function(){return e.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(e.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},v)}},o.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,o,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var e=new ArrayBuffer(0);try{a.blob=new Blob([e],{type:"application/zip"}).size===0}catch(t){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(e),a.blob=r.getBlob("application/zip").size===0}catch(i){a.blob=!1}}}try{a.nodestream=!!n("readable-stream").Readable}catch(t){a.nodestream=!1}},{"readable-stream":16}],31:[function(n,o,a){for(var e=n("./utils"),r=n("./support"),t=n("./nodejsUtils"),i=n("./stream/GenericWorker"),d=new Array(256),b=0;b<256;b++)d[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;d[254]=d[254]=1;function f(){i.call(this,"utf-8 decode"),this.leftOver=null}function h(){i.call(this,"utf-8 encode")}a.utf8encode=function(c){return r.nodebuffer?t.newBufferFrom(c,"utf-8"):function(v){var u,y,g,E,k,w=v.length,O=0;for(E=0;E<w;E++)(64512&(y=v.charCodeAt(E)))==55296&&E+1<w&&(64512&(g=v.charCodeAt(E+1)))==56320&&(y=65536+(y-55296<<10)+(g-56320),E++),O+=y<128?1:y<2048?2:y<65536?3:4;for(u=r.uint8array?new Uint8Array(O):new Array(O),E=k=0;k<O;E++)(64512&(y=v.charCodeAt(E)))==55296&&E+1<w&&(64512&(g=v.charCodeAt(E+1)))==56320&&(y=65536+(y-55296<<10)+(g-56320),E++),y<128?u[k++]=y:(y<2048?u[k++]=192|y>>>6:(y<65536?u[k++]=224|y>>>12:(u[k++]=240|y>>>18,u[k++]=128|y>>>12&63),u[k++]=128|y>>>6&63),u[k++]=128|63&y);return u}(c)},a.utf8decode=function(c){return r.nodebuffer?e.transformTo("nodebuffer",c).toString("utf-8"):function(v){var u,y,g,E,k=v.length,w=new Array(2*k);for(u=y=0;u<k;)if((g=v[u++])<128)w[y++]=g;else if(4<(E=d[g]))w[y++]=65533,u+=E-1;else{for(g&=E===2?31:E===3?15:7;1<E&&u<k;)g=g<<6|63&v[u++],E--;1<E?w[y++]=65533:g<65536?w[y++]=g:(g-=65536,w[y++]=55296|g>>10&1023,w[y++]=56320|1023&g)}return w.length!==y&&(w.subarray?w=w.subarray(0,y):w.length=y),e.applyFromCharCode(w)}(c=e.transformTo(r.uint8array?"uint8array":"array",c))},e.inherits(f,i),f.prototype.processChunk=function(c){var v=e.transformTo(r.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var u=v;(v=new Uint8Array(u.length+this.leftOver.length)).set(this.leftOver,0),v.set(u,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var y=function(E,k){var w;for((k=k||E.length)>E.length&&(k=E.length),w=k-1;0<=w&&(192&E[w])==128;)w--;return w<0||w===0?k:w+d[E[w]]>k?w:k}(v),g=v;y!==v.length&&(r.uint8array?(g=v.subarray(0,y),this.leftOver=v.subarray(y,v.length)):(g=v.slice(0,y),this.leftOver=v.slice(y,v.length))),this.push({data:a.utf8decode(g),meta:c.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=f,e.inherits(h,i),h.prototype.processChunk=function(c){this.push({data:a.utf8encode(c.data),meta:c.meta})},a.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,o,a){var e=n("./support"),r=n("./base64"),t=n("./nodejsUtils"),i=n("./external");function d(u){return u}function b(u,y){for(var g=0;g<u.length;++g)y[g]=255&u.charCodeAt(g);return y}n("setimmediate"),a.newBlob=function(u,y){a.checkSupport("blob");try{return new Blob([u],{type:y})}catch(E){try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(u),g.getBlob(y)}catch(k){throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(u,y,g){var E=[],k=0,w=u.length;if(w<=g)return String.fromCharCode.apply(null,u);for(;k<w;)y==="array"||y==="nodebuffer"?E.push(String.fromCharCode.apply(null,u.slice(k,Math.min(k+g,w)))):E.push(String.fromCharCode.apply(null,u.subarray(k,Math.min(k+g,w)))),k+=g;return E.join("")},stringifyByChar:function(u){for(var y="",g=0;g<u.length;g++)y+=String.fromCharCode(u[g]);return y},applyCanBeUsed:{uint8array:function(){try{return e.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(u){return!1}}(),nodebuffer:function(){try{return e.nodebuffer&&String.fromCharCode.apply(null,t.allocBuffer(1)).length===1}catch(u){return!1}}()}};function h(u){var y=65536,g=a.getTypeOf(u),E=!0;if(g==="uint8array"?E=f.applyCanBeUsed.uint8array:g==="nodebuffer"&&(E=f.applyCanBeUsed.nodebuffer),E)for(;1<y;)try{return f.stringifyByChunk(u,g,y)}catch(k){y=Math.floor(y/2)}return f.stringifyByChar(u)}function c(u,y){for(var g=0;g<u.length;g++)y[g]=u[g];return y}a.applyFromCharCode=h;var v={};v.string={string:d,array:function(u){return b(u,new Array(u.length))},arraybuffer:function(u){return v.string.uint8array(u).buffer},uint8array:function(u){return b(u,new Uint8Array(u.length))},nodebuffer:function(u){return b(u,t.allocBuffer(u.length))}},v.array={string:h,array:d,arraybuffer:function(u){return new Uint8Array(u).buffer},uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return t.newBufferFrom(u)}},v.arraybuffer={string:function(u){return h(new Uint8Array(u))},array:function(u){return c(new Uint8Array(u),new Array(u.byteLength))},arraybuffer:d,uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return t.newBufferFrom(new Uint8Array(u))}},v.uint8array={string:h,array:function(u){return c(u,new Array(u.length))},arraybuffer:function(u){return u.buffer},uint8array:d,nodebuffer:function(u){return t.newBufferFrom(u)}},v.nodebuffer={string:h,array:function(u){return c(u,new Array(u.length))},arraybuffer:function(u){return v.nodebuffer.uint8array(u).buffer},uint8array:function(u){return c(u,new Uint8Array(u.length))},nodebuffer:d},a.transformTo=function(u,y){if(y=y||"",!u)return y;a.checkSupport(u);var g=a.getTypeOf(y);return v[g][u](y)},a.resolve=function(u){for(var y=u.split("/"),g=[],E=0;E<y.length;E++){var k=y[E];k==="."||k===""&&E!==0&&E!==y.length-1||(k===".."?g.pop():g.push(k))}return g.join("/")},a.getTypeOf=function(u){return typeof u=="string"?"string":Object.prototype.toString.call(u)==="[object Array]"?"array":e.nodebuffer&&t.isBuffer(u)?"nodebuffer":e.uint8array&&u instanceof Uint8Array?"uint8array":e.arraybuffer&&u instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(u){if(!e[u.toLowerCase()])throw new Error(u+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(u){var y,g,E="";for(g=0;g<(u||"").length;g++)E+="\\x"+((y=u.charCodeAt(g))<16?"0":"")+y.toString(16).toUpperCase();return E},a.delay=function(u,y,g){setImmediate(function(){u.apply(g||null,y||[])})},a.inherits=function(u,y){function g(){}g.prototype=y.prototype,u.prototype=new g},a.extend=function(){var u,y,g={};for(u=0;u<arguments.length;u++)for(y in arguments[u])Object.prototype.hasOwnProperty.call(arguments[u],y)&&g[y]===void 0&&(g[y]=arguments[u][y]);return g},a.prepareContent=function(u,y,g,E,k){return i.Promise.resolve(y).then(function(w){return e.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new i.Promise(function(O,z){var T=new FileReader;T.onload=function(B){O(B.target.result)},T.onerror=function(B){z(B.target.error)},T.readAsArrayBuffer(w)}):w}).then(function(w){var O=a.getTypeOf(w);return O?(O==="arraybuffer"?w=a.transformTo("uint8array",w):O==="string"&&(k?w=r.decode(w):g&&E!==!0&&(w=function(z){return b(z,e.uint8array?new Uint8Array(z.length):new Array(z.length))}(w))),w):i.Promise.reject(new Error("Can't read the data of '"+u+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,o,a){var e=n("./reader/readerFor"),r=n("./utils"),t=n("./signature"),i=n("./zipEntry"),d=n("./support");function b(f){this.files=[],this.loadOptions=f}b.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(h)+", expected "+r.pretty(f)+")")}},isSignature:function(f,h){var c=this.reader.index;this.reader.setIndex(f);var v=this.reader.readString(4)===h;return this.reader.setIndex(c),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=d.uint8array?"uint8array":"array",c=r.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,c,v=this.zip64EndOfCentralSize-44;0<v;)f=this.reader.readInt(2),h=this.reader.readInt(4),c=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(t.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(t.CENTRAL_FILE_HEADER);)(f=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(t.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,t.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(t.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,t.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var v=h-c;if(0<v)this.isSignature(h,t.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(f){this.reader=e(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,o,a){var e=n("./reader/readerFor"),r=n("./utils"),t=n("./compressedObject"),i=n("./crc32"),d=n("./utf8"),b=n("./compressions"),f=n("./support");function h(c,v){this.options=c,this.loadOptions=v}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var v,u;if(c.skip(22),this.fileNameLength=c.readInt(2),u=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(u),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=function(y){for(var g in b)if(Object.prototype.hasOwnProperty.call(b,g)&&b[g].magic===y)return b[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new t(this.compressedSize,this.uncompressedSize,this.crc32,v,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var v=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(v),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=e(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var v,u,y,g=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<g;)v=c.readInt(2),u=c.readInt(2),y=c.readData(u),this.extraFields[v]={id:v,length:u,value:y};c.setIndex(g)},handleUTF8:function(){var c=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var u=r.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(u)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var g=r.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var v=e(c.value);return v.readInt(1)!==1||i(this.fileName)!==v.readInt(4)?null:d.utf8decode(v.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var v=e(c.value);return v.readInt(1)!==1||i(this.fileComment)!==v.readInt(4)?null:d.utf8decode(v.readData(c.length-5))}return null}},o.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,o,a){function e(v,u,y){this.name=v,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=u,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var r=n("./stream/StreamHelper"),t=n("./stream/DataWorker"),i=n("./utf8"),d=n("./compressedObject"),b=n("./stream/GenericWorker");e.prototype={internalStream:function(v){var u=null,y="string";try{if(!v)throw new Error("No output type specified.");var g=(y=v.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),u=this._decompressWorker();var E=!this._dataBinary;E&&!g&&(u=u.pipe(new i.Utf8EncodeWorker)),!E&&g&&(u=u.pipe(new i.Utf8DecodeWorker))}catch(k){(u=new b("error")).error(k)}return new r(u,y,"")},async:function(v,u){return this.internalStream(v).accumulate(u)},nodeStream:function(v,u){return this.internalStream(v||"nodebuffer").toNodejsStream(u)},_compressWorker:function(v,u){if(this._data instanceof d&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new i.Utf8EncodeWorker)),d.createWorkerFrom(y,v,u)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof b?this._data:new t(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<f.length;c++)e.prototype[f[c]]=h;o.exports=e},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,o,a){(function(e){var r,t,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var d=0,b=new i(v),f=e.document.createTextNode("");b.observe(f,{characterData:!0}),r=function(){f.data=d=++d%2}}else if(e.setImmediate||e.MessageChannel===void 0)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var u=e.document.createElement("script");u.onreadystatechange=function(){v(),u.onreadystatechange=null,u.parentNode.removeChild(u),u=null},e.document.documentElement.appendChild(u)}:function(){setTimeout(v,0)};else{var h=new e.MessageChannel;h.port1.onmessage=v,r=function(){h.port2.postMessage(0)}}var c=[];function v(){var u,y;t=!0;for(var g=c.length;g;){for(y=c,c=[],u=-1;++u<g;)y[u]();g=c.length}t=!1}o.exports=function(u){c.push(u)!==1||t||r()}}).call(this,typeof ct<"u"?ct:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,o,a){var e=n("immediate");function r(){}var t={},i=["REJECTED"],d=["FULFILLED"],b=["PENDING"];function f(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,g!==r&&u(this,g)}function h(g,E,k){this.promise=g,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function c(g,E,k){e(function(){var w;try{w=E(k)}catch(O){return t.reject(g,O)}w===g?t.reject(g,new TypeError("Cannot resolve promise with itself")):t.resolve(g,w)})}function v(g){var E=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof E=="function")return function(){E.apply(g,arguments)}}function u(g,E){var k=!1;function w(T){k||(k=!0,t.reject(g,T))}function O(T){k||(k=!0,t.resolve(g,T))}var z=y(function(){E(O,w)});z.status==="error"&&w(z.value)}function y(g,E){var k={};try{k.value=g(E),k.status="success"}catch(w){k.status="error",k.value=w}return k}(o.exports=f).prototype.finally=function(g){if(typeof g!="function")return this;var E=this.constructor;return this.then(function(k){return E.resolve(g()).then(function(){return k})},function(k){return E.resolve(g()).then(function(){throw k})})},f.prototype.catch=function(g){return this.then(null,g)},f.prototype.then=function(g,E){if(typeof g!="function"&&this.state===d||typeof E!="function"&&this.state===i)return this;var k=new this.constructor(r);return this.state!==b?c(k,this.state===d?g:E,this.outcome):this.queue.push(new h(k,g,E)),k},h.prototype.callFulfilled=function(g){t.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){c(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){t.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){c(this.promise,this.onRejected,g)},t.resolve=function(g,E){var k=y(v,E);if(k.status==="error")return t.reject(g,k.value);var w=k.value;if(w)u(g,w);else{g.state=d,g.outcome=E;for(var O=-1,z=g.queue.length;++O<z;)g.queue[O].callFulfilled(E)}return g},t.reject=function(g,E){g.state=i,g.outcome=E;for(var k=-1,w=g.queue.length;++k<w;)g.queue[k].callRejected(E);return g},f.resolve=function(g){return g instanceof this?g:t.resolve(new this(r),g)},f.reject=function(g){var E=new this(r);return t.reject(E,g)},f.all=function(g){var E=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=g.length,w=!1;if(!k)return this.resolve([]);for(var O=new Array(k),z=0,T=-1,B=new this(r);++T<k;)P(g[T],T);return B;function P(N,Y){E.resolve(N).then(function(A){O[Y]=A,++z!==k||w||(w=!0,t.resolve(B,O))},function(A){w||(w=!0,t.reject(B,A))})}},f.race=function(g){var E=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=g.length,w=!1;if(!k)return this.resolve([]);for(var O=-1,z=new this(r);++O<k;)T=g[O],E.resolve(T).then(function(B){w||(w=!0,t.resolve(z,B))},function(B){w||(w=!0,t.reject(z,B))});var T;return z}},{immediate:36}],38:[function(n,o,a){var e={};(0,n("./lib/utils/common").assign)(e,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),o.exports=e},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,o,a){var e=n("./zlib/deflate"),r=n("./utils/common"),t=n("./utils/strings"),i=n("./zlib/messages"),d=n("./zlib/zstream"),b=Object.prototype.toString,f=0,h=-1,c=0,v=8;function u(g){if(!(this instanceof u))return new u(g);this.options=r.assign({level:h,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},g||{});var E=this.options;E.raw&&0<E.windowBits?E.windowBits=-E.windowBits:E.gzip&&0<E.windowBits&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(k!==f)throw new Error(i[k]);if(E.header&&e.deflateSetHeader(this.strm,E.header),E.dictionary){var w;if(w=typeof E.dictionary=="string"?t.string2buf(E.dictionary):b.call(E.dictionary)==="[object ArrayBuffer]"?new Uint8Array(E.dictionary):E.dictionary,(k=e.deflateSetDictionary(this.strm,w))!==f)throw new Error(i[k]);this._dict_set=!0}}function y(g,E){var k=new u(E);if(k.push(g,!0),k.err)throw k.msg||i[k.err];return k.result}u.prototype.push=function(g,E){var k,w,O=this.strm,z=this.options.chunkSize;if(this.ended)return!1;w=E===~~E?E:E===!0?4:0,typeof g=="string"?O.input=t.string2buf(g):b.call(g)==="[object ArrayBuffer]"?O.input=new Uint8Array(g):O.input=g,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new r.Buf8(z),O.next_out=0,O.avail_out=z),(k=e.deflate(O,w))!==1&&k!==f)return this.onEnd(k),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(t.buf2binstring(r.shrinkBuf(O.output,O.next_out))):this.onData(r.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&k!==1);return w===4?(k=e.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===f):w!==2||(this.onEnd(f),!(O.avail_out=0))},u.prototype.onData=function(g){this.chunks.push(g)},u.prototype.onEnd=function(g){g===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Deflate=u,a.deflate=y,a.deflateRaw=function(g,E){return(E=E||{}).raw=!0,y(g,E)},a.gzip=function(g,E){return(E=E||{}).gzip=!0,y(g,E)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,o,a){var e=n("./zlib/inflate"),r=n("./utils/common"),t=n("./utils/strings"),i=n("./zlib/constants"),d=n("./zlib/messages"),b=n("./zlib/zstream"),f=n("./zlib/gzheader"),h=Object.prototype.toString;function c(u){if(!(this instanceof c))return new c(u);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},u||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||u&&u.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var g=e.inflateInit2(this.strm,y.windowBits);if(g!==i.Z_OK)throw new Error(d[g]);this.header=new f,e.inflateGetHeader(this.strm,this.header)}function v(u,y){var g=new c(y);if(g.push(u,!0),g.err)throw g.msg||d[g.err];return g.result}c.prototype.push=function(u,y){var g,E,k,w,O,z,T=this.strm,B=this.options.chunkSize,P=this.options.dictionary,N=!1;if(this.ended)return!1;E=y===~~y?y:y===!0?i.Z_FINISH:i.Z_NO_FLUSH,typeof u=="string"?T.input=t.binstring2buf(u):h.call(u)==="[object ArrayBuffer]"?T.input=new Uint8Array(u):T.input=u,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new r.Buf8(B),T.next_out=0,T.avail_out=B),(g=e.inflate(T,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&P&&(z=typeof P=="string"?t.string2buf(P):h.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,g=e.inflateSetDictionary(this.strm,z)),g===i.Z_BUF_ERROR&&N===!0&&(g=i.Z_OK,N=!1),g!==i.Z_STREAM_END&&g!==i.Z_OK)return this.onEnd(g),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&g!==i.Z_STREAM_END&&(T.avail_in!==0||E!==i.Z_FINISH&&E!==i.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=t.utf8border(T.output,T.next_out),w=T.next_out-k,O=t.buf2string(T.output,k),T.next_out=w,T.avail_out=B-w,w&&r.arraySet(T.output,T.output,k,w,0),this.onData(O)):this.onData(r.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(N=!0)}while((0<T.avail_in||T.avail_out===0)&&g!==i.Z_STREAM_END);return g===i.Z_STREAM_END&&(E=i.Z_FINISH),E===i.Z_FINISH?(g=e.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===i.Z_OK):E!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(T.avail_out=0))},c.prototype.onData=function(u){this.chunks.push(u)},c.prototype.onEnd=function(u){u===i.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},a.Inflate=c,a.inflate=v,a.inflateRaw=function(u,y){return(y=y||{}).raw=!0,v(u,y)},a.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,o,a){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(i){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var b=d.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var f in b)b.hasOwnProperty(f)&&(i[f]=b[f])}}return i},a.shrinkBuf=function(i,d){return i.length===d?i:i.subarray?i.subarray(0,d):(i.length=d,i)};var r={arraySet:function(i,d,b,f,h){if(d.subarray&&i.subarray)i.set(d.subarray(b,b+f),h);else for(var c=0;c<f;c++)i[h+c]=d[b+c]},flattenChunks:function(i){var d,b,f,h,c,v;for(d=f=0,b=i.length;d<b;d++)f+=i[d].length;for(v=new Uint8Array(f),d=h=0,b=i.length;d<b;d++)c=i[d],v.set(c,h),h+=c.length;return v}},t={arraySet:function(i,d,b,f,h){for(var c=0;c<f;c++)i[h+c]=d[b+c]},flattenChunks:function(i){return[].concat.apply([],i)}};a.setTyped=function(i){i?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,r)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,t))},a.setTyped(e)},{}],42:[function(n,o,a){var e=n("./common"),r=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch(f){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(f){t=!1}for(var i=new e.Buf8(256),d=0;d<256;d++)i[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function b(f,h){if(h<65537&&(f.subarray&&t||!f.subarray&&r))return String.fromCharCode.apply(null,e.shrinkBuf(f,h));for(var c="",v=0;v<h;v++)c+=String.fromCharCode(f[v]);return c}i[254]=i[254]=1,a.string2buf=function(f){var h,c,v,u,y,g=f.length,E=0;for(u=0;u<g;u++)(64512&(c=f.charCodeAt(u)))==55296&&u+1<g&&(64512&(v=f.charCodeAt(u+1)))==56320&&(c=65536+(c-55296<<10)+(v-56320),u++),E+=c<128?1:c<2048?2:c<65536?3:4;for(h=new e.Buf8(E),u=y=0;y<E;u++)(64512&(c=f.charCodeAt(u)))==55296&&u+1<g&&(64512&(v=f.charCodeAt(u+1)))==56320&&(c=65536+(c-55296<<10)+(v-56320),u++),c<128?h[y++]=c:(c<2048?h[y++]=192|c>>>6:(c<65536?h[y++]=224|c>>>12:(h[y++]=240|c>>>18,h[y++]=128|c>>>12&63),h[y++]=128|c>>>6&63),h[y++]=128|63&c);return h},a.buf2binstring=function(f){return b(f,f.length)},a.binstring2buf=function(f){for(var h=new e.Buf8(f.length),c=0,v=h.length;c<v;c++)h[c]=f.charCodeAt(c);return h},a.buf2string=function(f,h){var c,v,u,y,g=h||f.length,E=new Array(2*g);for(c=v=0;c<g;)if((u=f[c++])<128)E[v++]=u;else if(4<(y=i[u]))E[v++]=65533,c+=y-1;else{for(u&=y===2?31:y===3?15:7;1<y&&c<g;)u=u<<6|63&f[c++],y--;1<y?E[v++]=65533:u<65536?E[v++]=u:(u-=65536,E[v++]=55296|u>>10&1023,E[v++]=56320|1023&u)}return b(E,v)},a.utf8border=function(f,h){var c;for((h=h||f.length)>f.length&&(h=f.length),c=h-1;0<=c&&(192&f[c])==128;)c--;return c<0||c===0?h:c+i[f[c]]>h?c:h}},{"./common":41}],43:[function(n,o,a){o.exports=function(e,r,t,i){for(var d=65535&e|0,b=e>>>16&65535|0,f=0;t!==0;){for(t-=f=2e3<t?2e3:t;b=b+(d=d+r[i++]|0)|0,--f;);d%=65521,b%=65521}return d|b<<16|0}},{}],44:[function(n,o,a){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,o,a){var e=function(){for(var r,t=[],i=0;i<256;i++){r=i;for(var d=0;d<8;d++)r=1&r?3988292384^r>>>1:r>>>1;t[i]=r}return t}();o.exports=function(r,t,i,d){var b=e,f=d+i;r^=-1;for(var h=d;h<f;h++)r=r>>>8^b[255&(r^t[h])];return-1^r}},{}],46:[function(n,o,a){var e,r=n("../utils/common"),t=n("./trees"),i=n("./adler32"),d=n("./crc32"),b=n("./messages"),f=0,h=4,c=0,v=-2,u=-1,y=4,g=2,E=8,k=9,w=286,O=30,z=19,T=2*w+1,B=15,P=3,N=258,Y=N+P+1,A=42,F=113,l=1,M=2,re=3,Z=4;function ae(s,V){return s.msg=b[V],V}function H(s){return(s<<1)-(4<s?9:0)}function se(s){for(var V=s.length;0<=--V;)s[V]=0}function D(s){var V=s.state,L=V.pending;L>s.avail_out&&(L=s.avail_out),L!==0&&(r.arraySet(s.output,V.pending_buf,V.pending_out,L,s.next_out),s.next_out+=L,V.pending_out+=L,s.total_out+=L,s.avail_out-=L,V.pending-=L,V.pending===0&&(V.pending_out=0))}function I(s,V){t._tr_flush_block(s,0<=s.block_start?s.block_start:-1,s.strstart-s.block_start,V),s.block_start=s.strstart,D(s.strm)}function ne(s,V){s.pending_buf[s.pending++]=V}function K(s,V){s.pending_buf[s.pending++]=V>>>8&255,s.pending_buf[s.pending++]=255&V}function q(s,V){var L,S,x=s.max_chain_length,C=s.strstart,U=s.prev_length,W=s.nice_match,R=s.strstart>s.w_size-Y?s.strstart-(s.w_size-Y):0,G=s.window,X=s.w_mask,$=s.prev,te=s.strstart+N,ue=G[C+U-1],oe=G[C+U];s.prev_length>=s.good_match&&(x>>=2),W>s.lookahead&&(W=s.lookahead);do if(G[(L=V)+U]===oe&&G[L+U-1]===ue&&G[L]===G[C]&&G[++L]===G[C+1]){C+=2,L++;do;while(G[++C]===G[++L]&&G[++C]===G[++L]&&G[++C]===G[++L]&&G[++C]===G[++L]&&G[++C]===G[++L]&&G[++C]===G[++L]&&G[++C]===G[++L]&&G[++C]===G[++L]&&C<te);if(S=N-(te-C),C=te-N,U<S){if(s.match_start=V,W<=(U=S))break;ue=G[C+U-1],oe=G[C+U]}}while((V=$[V&X])>R&&--x!=0);return U<=s.lookahead?U:s.lookahead}function pe(s){var V,L,S,x,C,U,W,R,G,X,$=s.w_size;do{if(x=s.window_size-s.lookahead-s.strstart,s.strstart>=$+($-Y)){for(r.arraySet(s.window,s.window,$,$,0),s.match_start-=$,s.strstart-=$,s.block_start-=$,V=L=s.hash_size;S=s.head[--V],s.head[V]=$<=S?S-$:0,--L;);for(V=L=$;S=s.prev[--V],s.prev[V]=$<=S?S-$:0,--L;);x+=$}if(s.strm.avail_in===0)break;if(U=s.strm,W=s.window,R=s.strstart+s.lookahead,G=x,X=void 0,X=U.avail_in,G<X&&(X=G),L=X===0?0:(U.avail_in-=X,r.arraySet(W,U.input,U.next_in,X,R),U.state.wrap===1?U.adler=i(U.adler,W,X,R):U.state.wrap===2&&(U.adler=d(U.adler,W,X,R)),U.next_in+=X,U.total_in+=X,X),s.lookahead+=L,s.lookahead+s.insert>=P)for(C=s.strstart-s.insert,s.ins_h=s.window[C],s.ins_h=(s.ins_h<<s.hash_shift^s.window[C+1])&s.hash_mask;s.insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[C+P-1])&s.hash_mask,s.prev[C&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=C,C++,s.insert--,!(s.lookahead+s.insert<P)););}while(s.lookahead<Y&&s.strm.avail_in!==0)}function be(s,V){for(var L,S;;){if(s.lookahead<Y){if(pe(s),s.lookahead<Y&&V===f)return l;if(s.lookahead===0)break}if(L=0,s.lookahead>=P&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+P-1])&s.hash_mask,L=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),L!==0&&s.strstart-L<=s.w_size-Y&&(s.match_length=q(s,L)),s.match_length>=P)if(S=t._tr_tally(s,s.strstart-s.match_start,s.match_length-P),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=P){for(s.match_length--;s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+P-1])&s.hash_mask,L=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart,--s.match_length!=0;);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else S=t._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(S&&(I(s,!1),s.strm.avail_out===0))return l}return s.insert=s.strstart<P-1?s.strstart:P-1,V===h?(I(s,!0),s.strm.avail_out===0?re:Z):s.last_lit&&(I(s,!1),s.strm.avail_out===0)?l:M}function ie(s,V){for(var L,S,x;;){if(s.lookahead<Y){if(pe(s),s.lookahead<Y&&V===f)return l;if(s.lookahead===0)break}if(L=0,s.lookahead>=P&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+P-1])&s.hash_mask,L=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=P-1,L!==0&&s.prev_length<s.max_lazy_match&&s.strstart-L<=s.w_size-Y&&(s.match_length=q(s,L),s.match_length<=5&&(s.strategy===1||s.match_length===P&&4096<s.strstart-s.match_start)&&(s.match_length=P-1)),s.prev_length>=P&&s.match_length<=s.prev_length){for(x=s.strstart+s.lookahead-P,S=t._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-P),s.lookahead-=s.prev_length-1,s.prev_length-=2;++s.strstart<=x&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+P-1])&s.hash_mask,L=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),--s.prev_length!=0;);if(s.match_available=0,s.match_length=P-1,s.strstart++,S&&(I(s,!1),s.strm.avail_out===0))return l}else if(s.match_available){if((S=t._tr_tally(s,0,s.window[s.strstart-1]))&&I(s,!1),s.strstart++,s.lookahead--,s.strm.avail_out===0)return l}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(S=t._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<P-1?s.strstart:P-1,V===h?(I(s,!0),s.strm.avail_out===0?re:Z):s.last_lit&&(I(s,!1),s.strm.avail_out===0)?l:M}function ce(s,V,L,S,x){this.good_length=s,this.max_lazy=V,this.nice_length=L,this.max_chain=S,this.func=x}function ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*T),this.dyn_dtree=new r.Buf16(2*(2*O+1)),this.bl_tree=new r.Buf16(2*(2*z+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(B+1),this.heap=new r.Buf16(2*w+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*w+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function me(s){var V;return s&&s.state?(s.total_in=s.total_out=0,s.data_type=g,(V=s.state).pending=0,V.pending_out=0,V.wrap<0&&(V.wrap=-V.wrap),V.status=V.wrap?A:F,s.adler=V.wrap===2?0:1,V.last_flush=f,t._tr_init(V),c):ae(s,v)}function ke(s){var V=me(s);return V===c&&function(L){L.window_size=2*L.w_size,se(L.head),L.max_lazy_match=e[L.level].max_lazy,L.good_match=e[L.level].good_length,L.nice_match=e[L.level].nice_length,L.max_chain_length=e[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=P-1,L.match_available=0,L.ins_h=0}(s.state),V}function Ae(s,V,L,S,x,C){if(!s)return v;var U=1;if(V===u&&(V=6),S<0?(U=0,S=-S):15<S&&(U=2,S-=16),x<1||k<x||L!==E||S<8||15<S||V<0||9<V||C<0||y<C)return ae(s,v);S===8&&(S=9);var W=new ve;return(s.state=W).strm=s,W.wrap=U,W.gzhead=null,W.w_bits=S,W.w_size=1<<W.w_bits,W.w_mask=W.w_size-1,W.hash_bits=x+7,W.hash_size=1<<W.hash_bits,W.hash_mask=W.hash_size-1,W.hash_shift=~~((W.hash_bits+P-1)/P),W.window=new r.Buf8(2*W.w_size),W.head=new r.Buf16(W.hash_size),W.prev=new r.Buf16(W.w_size),W.lit_bufsize=1<<x+6,W.pending_buf_size=4*W.lit_bufsize,W.pending_buf=new r.Buf8(W.pending_buf_size),W.d_buf=1*W.lit_bufsize,W.l_buf=3*W.lit_bufsize,W.level=V,W.strategy=C,W.method=L,ke(s)}e=[new ce(0,0,0,0,function(s,V){var L=65535;for(L>s.pending_buf_size-5&&(L=s.pending_buf_size-5);;){if(s.lookahead<=1){if(pe(s),s.lookahead===0&&V===f)return l;if(s.lookahead===0)break}s.strstart+=s.lookahead,s.lookahead=0;var S=s.block_start+L;if((s.strstart===0||s.strstart>=S)&&(s.lookahead=s.strstart-S,s.strstart=S,I(s,!1),s.strm.avail_out===0)||s.strstart-s.block_start>=s.w_size-Y&&(I(s,!1),s.strm.avail_out===0))return l}return s.insert=0,V===h?(I(s,!0),s.strm.avail_out===0?re:Z):(s.strstart>s.block_start&&(I(s,!1),s.strm.avail_out),l)}),new ce(4,4,8,4,be),new ce(4,5,16,8,be),new ce(4,6,32,32,be),new ce(4,4,16,16,ie),new ce(8,16,32,32,ie),new ce(8,16,128,128,ie),new ce(8,32,128,256,ie),new ce(32,128,258,1024,ie),new ce(32,258,258,4096,ie)],a.deflateInit=function(s,V){return Ae(s,V,E,15,8,0)},a.deflateInit2=Ae,a.deflateReset=ke,a.deflateResetKeep=me,a.deflateSetHeader=function(s,V){return s&&s.state?s.state.wrap!==2?v:(s.state.gzhead=V,c):v},a.deflate=function(s,V){var L,S,x,C;if(!s||!s.state||5<V||V<0)return s?ae(s,v):v;if(S=s.state,!s.output||!s.input&&s.avail_in!==0||S.status===666&&V!==h)return ae(s,s.avail_out===0?-5:v);if(S.strm=s,L=S.last_flush,S.last_flush=V,S.status===A)if(S.wrap===2)s.adler=0,ne(S,31),ne(S,139),ne(S,8),S.gzhead?(ne(S,(S.gzhead.text?1:0)+(S.gzhead.hcrc?2:0)+(S.gzhead.extra?4:0)+(S.gzhead.name?8:0)+(S.gzhead.comment?16:0)),ne(S,255&S.gzhead.time),ne(S,S.gzhead.time>>8&255),ne(S,S.gzhead.time>>16&255),ne(S,S.gzhead.time>>24&255),ne(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),ne(S,255&S.gzhead.os),S.gzhead.extra&&S.gzhead.extra.length&&(ne(S,255&S.gzhead.extra.length),ne(S,S.gzhead.extra.length>>8&255)),S.gzhead.hcrc&&(s.adler=d(s.adler,S.pending_buf,S.pending,0)),S.gzindex=0,S.status=69):(ne(S,0),ne(S,0),ne(S,0),ne(S,0),ne(S,0),ne(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),ne(S,3),S.status=F);else{var U=E+(S.w_bits-8<<4)<<8;U|=(2<=S.strategy||S.level<2?0:S.level<6?1:S.level===6?2:3)<<6,S.strstart!==0&&(U|=32),U+=31-U%31,S.status=F,K(S,U),S.strstart!==0&&(K(S,s.adler>>>16),K(S,65535&s.adler)),s.adler=1}if(S.status===69)if(S.gzhead.extra){for(x=S.pending;S.gzindex<(65535&S.gzhead.extra.length)&&(S.pending!==S.pending_buf_size||(S.gzhead.hcrc&&S.pending>x&&(s.adler=d(s.adler,S.pending_buf,S.pending-x,x)),D(s),x=S.pending,S.pending!==S.pending_buf_size));)ne(S,255&S.gzhead.extra[S.gzindex]),S.gzindex++;S.gzhead.hcrc&&S.pending>x&&(s.adler=d(s.adler,S.pending_buf,S.pending-x,x)),S.gzindex===S.gzhead.extra.length&&(S.gzindex=0,S.status=73)}else S.status=73;if(S.status===73)if(S.gzhead.name){x=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>x&&(s.adler=d(s.adler,S.pending_buf,S.pending-x,x)),D(s),x=S.pending,S.pending===S.pending_buf_size)){C=1;break}C=S.gzindex<S.gzhead.name.length?255&S.gzhead.name.charCodeAt(S.gzindex++):0,ne(S,C)}while(C!==0);S.gzhead.hcrc&&S.pending>x&&(s.adler=d(s.adler,S.pending_buf,S.pending-x,x)),C===0&&(S.gzindex=0,S.status=91)}else S.status=91;if(S.status===91)if(S.gzhead.comment){x=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>x&&(s.adler=d(s.adler,S.pending_buf,S.pending-x,x)),D(s),x=S.pending,S.pending===S.pending_buf_size)){C=1;break}C=S.gzindex<S.gzhead.comment.length?255&S.gzhead.comment.charCodeAt(S.gzindex++):0,ne(S,C)}while(C!==0);S.gzhead.hcrc&&S.pending>x&&(s.adler=d(s.adler,S.pending_buf,S.pending-x,x)),C===0&&(S.status=103)}else S.status=103;if(S.status===103&&(S.gzhead.hcrc?(S.pending+2>S.pending_buf_size&&D(s),S.pending+2<=S.pending_buf_size&&(ne(S,255&s.adler),ne(S,s.adler>>8&255),s.adler=0,S.status=F)):S.status=F),S.pending!==0){if(D(s),s.avail_out===0)return S.last_flush=-1,c}else if(s.avail_in===0&&H(V)<=H(L)&&V!==h)return ae(s,-5);if(S.status===666&&s.avail_in!==0)return ae(s,-5);if(s.avail_in!==0||S.lookahead!==0||V!==f&&S.status!==666){var W=S.strategy===2?function(R,G){for(var X;;){if(R.lookahead===0&&(pe(R),R.lookahead===0)){if(G===f)return l;break}if(R.match_length=0,X=t._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++,X&&(I(R,!1),R.strm.avail_out===0))return l}return R.insert=0,G===h?(I(R,!0),R.strm.avail_out===0?re:Z):R.last_lit&&(I(R,!1),R.strm.avail_out===0)?l:M}(S,V):S.strategy===3?function(R,G){for(var X,$,te,ue,oe=R.window;;){if(R.lookahead<=N){if(pe(R),R.lookahead<=N&&G===f)return l;if(R.lookahead===0)break}if(R.match_length=0,R.lookahead>=P&&0<R.strstart&&($=oe[te=R.strstart-1])===oe[++te]&&$===oe[++te]&&$===oe[++te]){ue=R.strstart+N;do;while($===oe[++te]&&$===oe[++te]&&$===oe[++te]&&$===oe[++te]&&$===oe[++te]&&$===oe[++te]&&$===oe[++te]&&$===oe[++te]&&te<ue);R.match_length=N-(ue-te),R.match_length>R.lookahead&&(R.match_length=R.lookahead)}if(R.match_length>=P?(X=t._tr_tally(R,1,R.match_length-P),R.lookahead-=R.match_length,R.strstart+=R.match_length,R.match_length=0):(X=t._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++),X&&(I(R,!1),R.strm.avail_out===0))return l}return R.insert=0,G===h?(I(R,!0),R.strm.avail_out===0?re:Z):R.last_lit&&(I(R,!1),R.strm.avail_out===0)?l:M}(S,V):e[S.level].func(S,V);if(W!==re&&W!==Z||(S.status=666),W===l||W===re)return s.avail_out===0&&(S.last_flush=-1),c;if(W===M&&(V===1?t._tr_align(S):V!==5&&(t._tr_stored_block(S,0,0,!1),V===3&&(se(S.head),S.lookahead===0&&(S.strstart=0,S.block_start=0,S.insert=0))),D(s),s.avail_out===0))return S.last_flush=-1,c}return V!==h?c:S.wrap<=0?1:(S.wrap===2?(ne(S,255&s.adler),ne(S,s.adler>>8&255),ne(S,s.adler>>16&255),ne(S,s.adler>>24&255),ne(S,255&s.total_in),ne(S,s.total_in>>8&255),ne(S,s.total_in>>16&255),ne(S,s.total_in>>24&255)):(K(S,s.adler>>>16),K(S,65535&s.adler)),D(s),0<S.wrap&&(S.wrap=-S.wrap),S.pending!==0?c:1)},a.deflateEnd=function(s){var V;return s&&s.state?(V=s.state.status)!==A&&V!==69&&V!==73&&V!==91&&V!==103&&V!==F&&V!==666?ae(s,v):(s.state=null,V===F?ae(s,-3):c):v},a.deflateSetDictionary=function(s,V){var L,S,x,C,U,W,R,G,X=V.length;if(!s||!s.state||(C=(L=s.state).wrap)===2||C===1&&L.status!==A||L.lookahead)return v;for(C===1&&(s.adler=i(s.adler,V,X,0)),L.wrap=0,X>=L.w_size&&(C===0&&(se(L.head),L.strstart=0,L.block_start=0,L.insert=0),G=new r.Buf8(L.w_size),r.arraySet(G,V,X-L.w_size,L.w_size,0),V=G,X=L.w_size),U=s.avail_in,W=s.next_in,R=s.input,s.avail_in=X,s.next_in=0,s.input=V,pe(L);L.lookahead>=P;){for(S=L.strstart,x=L.lookahead-(P-1);L.ins_h=(L.ins_h<<L.hash_shift^L.window[S+P-1])&L.hash_mask,L.prev[S&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=S,S++,--x;);L.strstart=S,L.lookahead=P-1,pe(L)}return L.strstart+=L.lookahead,L.block_start=L.strstart,L.insert=L.lookahead,L.lookahead=0,L.match_length=L.prev_length=P-1,L.match_available=0,s.next_in=W,s.input=R,s.avail_in=U,L.wrap=C,c},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,o,a){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,o,a){o.exports=function(e,r){var t,i,d,b,f,h,c,v,u,y,g,E,k,w,O,z,T,B,P,N,Y,A,F,l,M;t=e.state,i=e.next_in,l=e.input,d=i+(e.avail_in-5),b=e.next_out,M=e.output,f=b-(r-e.avail_out),h=b+(e.avail_out-257),c=t.dmax,v=t.wsize,u=t.whave,y=t.wnext,g=t.window,E=t.hold,k=t.bits,w=t.lencode,O=t.distcode,z=(1<<t.lenbits)-1,T=(1<<t.distbits)-1;e:do{k<15&&(E+=l[i++]<<k,k+=8,E+=l[i++]<<k,k+=8),B=w[E&z];t:for(;;){if(E>>>=P=B>>>24,k-=P,(P=B>>>16&255)===0)M[b++]=65535&B;else{if(!(16&P)){if(!(64&P)){B=w[(65535&B)+(E&(1<<P)-1)];continue t}if(32&P){t.mode=12;break e}e.msg="invalid literal/length code",t.mode=30;break e}N=65535&B,(P&=15)&&(k<P&&(E+=l[i++]<<k,k+=8),N+=E&(1<<P)-1,E>>>=P,k-=P),k<15&&(E+=l[i++]<<k,k+=8,E+=l[i++]<<k,k+=8),B=O[E&T];n:for(;;){if(E>>>=P=B>>>24,k-=P,!(16&(P=B>>>16&255))){if(!(64&P)){B=O[(65535&B)+(E&(1<<P)-1)];continue n}e.msg="invalid distance code",t.mode=30;break e}if(Y=65535&B,k<(P&=15)&&(E+=l[i++]<<k,(k+=8)<P&&(E+=l[i++]<<k,k+=8)),c<(Y+=E&(1<<P)-1)){e.msg="invalid distance too far back",t.mode=30;break e}if(E>>>=P,k-=P,(P=b-f)<Y){if(u<(P=Y-P)&&t.sane){e.msg="invalid distance too far back",t.mode=30;break e}if(F=g,(A=0)===y){if(A+=v-P,P<N){for(N-=P;M[b++]=g[A++],--P;);A=b-Y,F=M}}else if(y<P){if(A+=v+y-P,(P-=y)<N){for(N-=P;M[b++]=g[A++],--P;);if(A=0,y<N){for(N-=P=y;M[b++]=g[A++],--P;);A=b-Y,F=M}}}else if(A+=y-P,P<N){for(N-=P;M[b++]=g[A++],--P;);A=b-Y,F=M}for(;2<N;)M[b++]=F[A++],M[b++]=F[A++],M[b++]=F[A++],N-=3;N&&(M[b++]=F[A++],1<N&&(M[b++]=F[A++]))}else{for(A=b-Y;M[b++]=M[A++],M[b++]=M[A++],M[b++]=M[A++],2<(N-=3););N&&(M[b++]=M[A++],1<N&&(M[b++]=M[A++]))}break}}break}}while(i<d&&b<h);i-=N=k>>3,E&=(1<<(k-=N<<3))-1,e.next_in=i,e.next_out=b,e.avail_in=i<d?d-i+5:5-(i-d),e.avail_out=b<h?h-b+257:257-(b-h),t.hold=E,t.bits=k}},{}],49:[function(n,o,a){var e=n("../utils/common"),r=n("./adler32"),t=n("./crc32"),i=n("./inffast"),d=n("./inftrees"),b=1,f=2,h=0,c=-2,v=1,u=852,y=592;function g(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function E(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(A){var F;return A&&A.state?(F=A.state,A.total_in=A.total_out=F.total=0,A.msg="",F.wrap&&(A.adler=1&F.wrap),F.mode=v,F.last=0,F.havedict=0,F.dmax=32768,F.head=null,F.hold=0,F.bits=0,F.lencode=F.lendyn=new e.Buf32(u),F.distcode=F.distdyn=new e.Buf32(y),F.sane=1,F.back=-1,h):c}function w(A){var F;return A&&A.state?((F=A.state).wsize=0,F.whave=0,F.wnext=0,k(A)):c}function O(A,F){var l,M;return A&&A.state?(M=A.state,F<0?(l=0,F=-F):(l=1+(F>>4),F<48&&(F&=15)),F&&(F<8||15<F)?c:(M.window!==null&&M.wbits!==F&&(M.window=null),M.wrap=l,M.wbits=F,w(A))):c}function z(A,F){var l,M;return A?(M=new E,(A.state=M).window=null,(l=O(A,F))!==h&&(A.state=null),l):c}var T,B,P=!0;function N(A){if(P){var F;for(T=new e.Buf32(512),B=new e.Buf32(32),F=0;F<144;)A.lens[F++]=8;for(;F<256;)A.lens[F++]=9;for(;F<280;)A.lens[F++]=7;for(;F<288;)A.lens[F++]=8;for(d(b,A.lens,0,288,T,0,A.work,{bits:9}),F=0;F<32;)A.lens[F++]=5;d(f,A.lens,0,32,B,0,A.work,{bits:5}),P=!1}A.lencode=T,A.lenbits=9,A.distcode=B,A.distbits=5}function Y(A,F,l,M){var re,Z=A.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new e.Buf8(Z.wsize)),M>=Z.wsize?(e.arraySet(Z.window,F,l-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(M<(re=Z.wsize-Z.wnext)&&(re=M),e.arraySet(Z.window,F,l-M,re,Z.wnext),(M-=re)?(e.arraySet(Z.window,F,l-M,M,0),Z.wnext=M,Z.whave=Z.wsize):(Z.wnext+=re,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=re))),0}a.inflateReset=w,a.inflateReset2=O,a.inflateResetKeep=k,a.inflateInit=function(A){return z(A,15)},a.inflateInit2=z,a.inflate=function(A,F){var l,M,re,Z,ae,H,se,D,I,ne,K,q,pe,be,ie,ce,ve,me,ke,Ae,s,V,L,S,x=0,C=new e.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return c;(l=A.state).mode===12&&(l.mode=13),ae=A.next_out,re=A.output,se=A.avail_out,Z=A.next_in,M=A.input,H=A.avail_in,D=l.hold,I=l.bits,ne=H,K=se,V=h;e:for(;;)switch(l.mode){case v:if(l.wrap===0){l.mode=13;break}for(;I<16;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(2&l.wrap&&D===35615){C[l.check=0]=255&D,C[1]=D>>>8&255,l.check=t(l.check,C,2,0),I=D=0,l.mode=2;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&D)<<8)+(D>>8))%31){A.msg="incorrect header check",l.mode=30;break}if((15&D)!=8){A.msg="unknown compression method",l.mode=30;break}if(I-=4,s=8+(15&(D>>>=4)),l.wbits===0)l.wbits=s;else if(s>l.wbits){A.msg="invalid window size",l.mode=30;break}l.dmax=1<<s,A.adler=l.check=1,l.mode=512&D?10:12,I=D=0;break;case 2:for(;I<16;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(l.flags=D,(255&l.flags)!=8){A.msg="unknown compression method",l.mode=30;break}if(57344&l.flags){A.msg="unknown header flags set",l.mode=30;break}l.head&&(l.head.text=D>>8&1),512&l.flags&&(C[0]=255&D,C[1]=D>>>8&255,l.check=t(l.check,C,2,0)),I=D=0,l.mode=3;case 3:for(;I<32;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}l.head&&(l.head.time=D),512&l.flags&&(C[0]=255&D,C[1]=D>>>8&255,C[2]=D>>>16&255,C[3]=D>>>24&255,l.check=t(l.check,C,4,0)),I=D=0,l.mode=4;case 4:for(;I<16;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}l.head&&(l.head.xflags=255&D,l.head.os=D>>8),512&l.flags&&(C[0]=255&D,C[1]=D>>>8&255,l.check=t(l.check,C,2,0)),I=D=0,l.mode=5;case 5:if(1024&l.flags){for(;I<16;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}l.length=D,l.head&&(l.head.extra_len=D),512&l.flags&&(C[0]=255&D,C[1]=D>>>8&255,l.check=t(l.check,C,2,0)),I=D=0}else l.head&&(l.head.extra=null);l.mode=6;case 6:if(1024&l.flags&&(H<(q=l.length)&&(q=H),q&&(l.head&&(s=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),e.arraySet(l.head.extra,M,Z,q,s)),512&l.flags&&(l.check=t(l.check,M,q,Z)),H-=q,Z+=q,l.length-=q),l.length))break e;l.length=0,l.mode=7;case 7:if(2048&l.flags){if(H===0)break e;for(q=0;s=M[Z+q++],l.head&&s&&l.length<65536&&(l.head.name+=String.fromCharCode(s)),s&&q<H;);if(512&l.flags&&(l.check=t(l.check,M,q,Z)),H-=q,Z+=q,s)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=8;case 8:if(4096&l.flags){if(H===0)break e;for(q=0;s=M[Z+q++],l.head&&s&&l.length<65536&&(l.head.comment+=String.fromCharCode(s)),s&&q<H;);if(512&l.flags&&(l.check=t(l.check,M,q,Z)),H-=q,Z+=q,s)break e}else l.head&&(l.head.comment=null);l.mode=9;case 9:if(512&l.flags){for(;I<16;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(D!==(65535&l.check)){A.msg="header crc mismatch",l.mode=30;break}I=D=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),A.adler=l.check=0,l.mode=12;break;case 10:for(;I<32;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}A.adler=l.check=g(D),I=D=0,l.mode=11;case 11:if(l.havedict===0)return A.next_out=ae,A.avail_out=se,A.next_in=Z,A.avail_in=H,l.hold=D,l.bits=I,2;A.adler=l.check=1,l.mode=12;case 12:if(F===5||F===6)break e;case 13:if(l.last){D>>>=7&I,I-=7&I,l.mode=27;break}for(;I<3;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}switch(l.last=1&D,I-=1,3&(D>>>=1)){case 0:l.mode=14;break;case 1:if(N(l),l.mode=20,F!==6)break;D>>>=2,I-=2;break e;case 2:l.mode=17;break;case 3:A.msg="invalid block type",l.mode=30}D>>>=2,I-=2;break;case 14:for(D>>>=7&I,I-=7&I;I<32;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if((65535&D)!=(D>>>16^65535)){A.msg="invalid stored block lengths",l.mode=30;break}if(l.length=65535&D,I=D=0,l.mode=15,F===6)break e;case 15:l.mode=16;case 16:if(q=l.length){if(H<q&&(q=H),se<q&&(q=se),q===0)break e;e.arraySet(re,M,Z,q,ae),H-=q,Z+=q,se-=q,ae+=q,l.length-=q;break}l.mode=12;break;case 17:for(;I<14;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(l.nlen=257+(31&D),D>>>=5,I-=5,l.ndist=1+(31&D),D>>>=5,I-=5,l.ncode=4+(15&D),D>>>=4,I-=4,286<l.nlen||30<l.ndist){A.msg="too many length or distance symbols",l.mode=30;break}l.have=0,l.mode=18;case 18:for(;l.have<l.ncode;){for(;I<3;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}l.lens[U[l.have++]]=7&D,D>>>=3,I-=3}for(;l.have<19;)l.lens[U[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,L={bits:l.lenbits},V=d(0,l.lens,0,19,l.lencode,0,l.work,L),l.lenbits=L.bits,V){A.msg="invalid code lengths set",l.mode=30;break}l.have=0,l.mode=19;case 19:for(;l.have<l.nlen+l.ndist;){for(;ce=(x=l.lencode[D&(1<<l.lenbits)-1])>>>16&255,ve=65535&x,!((ie=x>>>24)<=I);){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(ve<16)D>>>=ie,I-=ie,l.lens[l.have++]=ve;else{if(ve===16){for(S=ie+2;I<S;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(D>>>=ie,I-=ie,l.have===0){A.msg="invalid bit length repeat",l.mode=30;break}s=l.lens[l.have-1],q=3+(3&D),D>>>=2,I-=2}else if(ve===17){for(S=ie+3;I<S;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}I-=ie,s=0,q=3+(7&(D>>>=ie)),D>>>=3,I-=3}else{for(S=ie+7;I<S;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}I-=ie,s=0,q=11+(127&(D>>>=ie)),D>>>=7,I-=7}if(l.have+q>l.nlen+l.ndist){A.msg="invalid bit length repeat",l.mode=30;break}for(;q--;)l.lens[l.have++]=s}}if(l.mode===30)break;if(l.lens[256]===0){A.msg="invalid code -- missing end-of-block",l.mode=30;break}if(l.lenbits=9,L={bits:l.lenbits},V=d(b,l.lens,0,l.nlen,l.lencode,0,l.work,L),l.lenbits=L.bits,V){A.msg="invalid literal/lengths set",l.mode=30;break}if(l.distbits=6,l.distcode=l.distdyn,L={bits:l.distbits},V=d(f,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,L),l.distbits=L.bits,V){A.msg="invalid distances set",l.mode=30;break}if(l.mode=20,F===6)break e;case 20:l.mode=21;case 21:if(6<=H&&258<=se){A.next_out=ae,A.avail_out=se,A.next_in=Z,A.avail_in=H,l.hold=D,l.bits=I,i(A,K),ae=A.next_out,re=A.output,se=A.avail_out,Z=A.next_in,M=A.input,H=A.avail_in,D=l.hold,I=l.bits,l.mode===12&&(l.back=-1);break}for(l.back=0;ce=(x=l.lencode[D&(1<<l.lenbits)-1])>>>16&255,ve=65535&x,!((ie=x>>>24)<=I);){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(ce&&!(240&ce)){for(me=ie,ke=ce,Ae=ve;ce=(x=l.lencode[Ae+((D&(1<<me+ke)-1)>>me)])>>>16&255,ve=65535&x,!(me+(ie=x>>>24)<=I);){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}D>>>=me,I-=me,l.back+=me}if(D>>>=ie,I-=ie,l.back+=ie,l.length=ve,ce===0){l.mode=26;break}if(32&ce){l.back=-1,l.mode=12;break}if(64&ce){A.msg="invalid literal/length code",l.mode=30;break}l.extra=15&ce,l.mode=22;case 22:if(l.extra){for(S=l.extra;I<S;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}l.length+=D&(1<<l.extra)-1,D>>>=l.extra,I-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=23;case 23:for(;ce=(x=l.distcode[D&(1<<l.distbits)-1])>>>16&255,ve=65535&x,!((ie=x>>>24)<=I);){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(!(240&ce)){for(me=ie,ke=ce,Ae=ve;ce=(x=l.distcode[Ae+((D&(1<<me+ke)-1)>>me)])>>>16&255,ve=65535&x,!(me+(ie=x>>>24)<=I);){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}D>>>=me,I-=me,l.back+=me}if(D>>>=ie,I-=ie,l.back+=ie,64&ce){A.msg="invalid distance code",l.mode=30;break}l.offset=ve,l.extra=15&ce,l.mode=24;case 24:if(l.extra){for(S=l.extra;I<S;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}l.offset+=D&(1<<l.extra)-1,D>>>=l.extra,I-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){A.msg="invalid distance too far back",l.mode=30;break}l.mode=25;case 25:if(se===0)break e;if(q=K-se,l.offset>q){if((q=l.offset-q)>l.whave&&l.sane){A.msg="invalid distance too far back",l.mode=30;break}pe=q>l.wnext?(q-=l.wnext,l.wsize-q):l.wnext-q,q>l.length&&(q=l.length),be=l.window}else be=re,pe=ae-l.offset,q=l.length;for(se<q&&(q=se),se-=q,l.length-=q;re[ae++]=be[pe++],--q;);l.length===0&&(l.mode=21);break;case 26:if(se===0)break e;re[ae++]=l.length,se--,l.mode=21;break;case 27:if(l.wrap){for(;I<32;){if(H===0)break e;H--,D|=M[Z++]<<I,I+=8}if(K-=se,A.total_out+=K,l.total+=K,K&&(A.adler=l.check=l.flags?t(l.check,re,K,ae-K):r(l.check,re,K,ae-K)),K=se,(l.flags?D:g(D))!==l.check){A.msg="incorrect data check",l.mode=30;break}I=D=0}l.mode=28;case 28:if(l.wrap&&l.flags){for(;I<32;){if(H===0)break e;H--,D+=M[Z++]<<I,I+=8}if(D!==(4294967295&l.total)){A.msg="incorrect length check",l.mode=30;break}I=D=0}l.mode=29;case 29:V=1;break e;case 30:V=-3;break e;case 31:return-4;case 32:default:return c}return A.next_out=ae,A.avail_out=se,A.next_in=Z,A.avail_in=H,l.hold=D,l.bits=I,(l.wsize||K!==A.avail_out&&l.mode<30&&(l.mode<27||F!==4))&&Y(A,A.output,A.next_out,K-A.avail_out)?(l.mode=31,-4):(ne-=A.avail_in,K-=A.avail_out,A.total_in+=ne,A.total_out+=K,l.total+=K,l.wrap&&K&&(A.adler=l.check=l.flags?t(l.check,re,K,A.next_out-K):r(l.check,re,K,A.next_out-K)),A.data_type=l.bits+(l.last?64:0)+(l.mode===12?128:0)+(l.mode===20||l.mode===15?256:0),(ne==0&&K===0||F===4)&&V===h&&(V=-5),V)},a.inflateEnd=function(A){if(!A||!A.state)return c;var F=A.state;return F.window&&(F.window=null),A.state=null,h},a.inflateGetHeader=function(A,F){var l;return A&&A.state&&2&(l=A.state).wrap?((l.head=F).done=!1,h):c},a.inflateSetDictionary=function(A,F){var l,M=F.length;return A&&A.state?(l=A.state).wrap!==0&&l.mode!==11?c:l.mode===11&&r(1,F,M,0)!==l.check?-3:Y(A,F,M,M)?(l.mode=31,-4):(l.havedict=1,h):c},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,o,a){var e=n("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],t=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(b,f,h,c,v,u,y,g){var E,k,w,O,z,T,B,P,N,Y=g.bits,A=0,F=0,l=0,M=0,re=0,Z=0,ae=0,H=0,se=0,D=0,I=null,ne=0,K=new e.Buf16(16),q=new e.Buf16(16),pe=null,be=0;for(A=0;A<=15;A++)K[A]=0;for(F=0;F<c;F++)K[f[h+F]]++;for(re=Y,M=15;1<=M&&K[M]===0;M--);if(M<re&&(re=M),M===0)return v[u++]=20971520,v[u++]=20971520,g.bits=1,0;for(l=1;l<M&&K[l]===0;l++);for(re<l&&(re=l),A=H=1;A<=15;A++)if(H<<=1,(H-=K[A])<0)return-1;if(0<H&&(b===0||M!==1))return-1;for(q[1]=0,A=1;A<15;A++)q[A+1]=q[A]+K[A];for(F=0;F<c;F++)f[h+F]!==0&&(y[q[f[h+F]]++]=F);if(T=b===0?(I=pe=y,19):b===1?(I=r,ne-=257,pe=t,be-=257,256):(I=i,pe=d,-1),A=l,z=u,ae=F=D=0,w=-1,O=(se=1<<(Z=re))-1,b===1&&852<se||b===2&&592<se)return 1;for(;;){for(B=A-ae,N=y[F]<T?(P=0,y[F]):y[F]>T?(P=pe[be+y[F]],I[ne+y[F]]):(P=96,0),E=1<<A-ae,l=k=1<<Z;v[z+(D>>ae)+(k-=E)]=B<<24|P<<16|N|0,k!==0;);for(E=1<<A-1;D&E;)E>>=1;if(E!==0?(D&=E-1,D+=E):D=0,F++,--K[A]==0){if(A===M)break;A=f[h+y[F]]}if(re<A&&(D&O)!==w){for(ae===0&&(ae=re),z+=l,H=1<<(Z=A-ae);Z+ae<M&&!((H-=K[Z+ae])<=0);)Z++,H<<=1;if(se+=1<<Z,b===1&&852<se||b===2&&592<se)return 1;v[w=D&O]=re<<24|Z<<16|z-u|0}}return D!==0&&(v[z+D]=A-ae<<24|64<<16|0),g.bits=re,0}},{"../utils/common":41}],51:[function(n,o,a){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,o,a){var e=n("../utils/common"),r=0,t=1;function i(x){for(var C=x.length;0<=--C;)x[C]=0}var d=0,b=29,f=256,h=f+1+b,c=30,v=19,u=2*h+1,y=15,g=16,E=7,k=256,w=16,O=17,z=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],B=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=new Array(2*(h+2));i(Y);var A=new Array(2*c);i(A);var F=new Array(512);i(F);var l=new Array(256);i(l);var M=new Array(b);i(M);var re,Z,ae,H=new Array(c);function se(x,C,U,W,R){this.static_tree=x,this.extra_bits=C,this.extra_base=U,this.elems=W,this.max_length=R,this.has_stree=x&&x.length}function D(x,C){this.dyn_tree=x,this.max_code=0,this.stat_desc=C}function I(x){return x<256?F[x]:F[256+(x>>>7)]}function ne(x,C){x.pending_buf[x.pending++]=255&C,x.pending_buf[x.pending++]=C>>>8&255}function K(x,C,U){x.bi_valid>g-U?(x.bi_buf|=C<<x.bi_valid&65535,ne(x,x.bi_buf),x.bi_buf=C>>g-x.bi_valid,x.bi_valid+=U-g):(x.bi_buf|=C<<x.bi_valid&65535,x.bi_valid+=U)}function q(x,C,U){K(x,U[2*C],U[2*C+1])}function pe(x,C){for(var U=0;U|=1&x,x>>>=1,U<<=1,0<--C;);return U>>>1}function be(x,C,U){var W,R,G=new Array(y+1),X=0;for(W=1;W<=y;W++)G[W]=X=X+U[W-1]<<1;for(R=0;R<=C;R++){var $=x[2*R+1];$!==0&&(x[2*R]=pe(G[$]++,$))}}function ie(x){var C;for(C=0;C<h;C++)x.dyn_ltree[2*C]=0;for(C=0;C<c;C++)x.dyn_dtree[2*C]=0;for(C=0;C<v;C++)x.bl_tree[2*C]=0;x.dyn_ltree[2*k]=1,x.opt_len=x.static_len=0,x.last_lit=x.matches=0}function ce(x){8<x.bi_valid?ne(x,x.bi_buf):0<x.bi_valid&&(x.pending_buf[x.pending++]=x.bi_buf),x.bi_buf=0,x.bi_valid=0}function ve(x,C,U,W){var R=2*C,G=2*U;return x[R]<x[G]||x[R]===x[G]&&W[C]<=W[U]}function me(x,C,U){for(var W=x.heap[U],R=U<<1;R<=x.heap_len&&(R<x.heap_len&&ve(C,x.heap[R+1],x.heap[R],x.depth)&&R++,!ve(C,W,x.heap[R],x.depth));)x.heap[U]=x.heap[R],U=R,R<<=1;x.heap[U]=W}function ke(x,C,U){var W,R,G,X,$=0;if(x.last_lit!==0)for(;W=x.pending_buf[x.d_buf+2*$]<<8|x.pending_buf[x.d_buf+2*$+1],R=x.pending_buf[x.l_buf+$],$++,W===0?q(x,R,C):(q(x,(G=l[R])+f+1,C),(X=T[G])!==0&&K(x,R-=M[G],X),q(x,G=I(--W),U),(X=B[G])!==0&&K(x,W-=H[G],X)),$<x.last_lit;);q(x,k,C)}function Ae(x,C){var U,W,R,G=C.dyn_tree,X=C.stat_desc.static_tree,$=C.stat_desc.has_stree,te=C.stat_desc.elems,ue=-1;for(x.heap_len=0,x.heap_max=u,U=0;U<te;U++)G[2*U]!==0?(x.heap[++x.heap_len]=ue=U,x.depth[U]=0):G[2*U+1]=0;for(;x.heap_len<2;)G[2*(R=x.heap[++x.heap_len]=ue<2?++ue:0)]=1,x.depth[R]=0,x.opt_len--,$&&(x.static_len-=X[2*R+1]);for(C.max_code=ue,U=x.heap_len>>1;1<=U;U--)me(x,G,U);for(R=te;U=x.heap[1],x.heap[1]=x.heap[x.heap_len--],me(x,G,1),W=x.heap[1],x.heap[--x.heap_max]=U,x.heap[--x.heap_max]=W,G[2*R]=G[2*U]+G[2*W],x.depth[R]=(x.depth[U]>=x.depth[W]?x.depth[U]:x.depth[W])+1,G[2*U+1]=G[2*W+1]=R,x.heap[1]=R++,me(x,G,1),2<=x.heap_len;);x.heap[--x.heap_max]=x.heap[1],function(oe,we){var Je,Oe,Qe,fe,ot,gt,Ce=we.dyn_tree,zt=we.max_code,En=we.stat_desc.static_tree,xn=we.stat_desc.has_stree,Sn=we.stat_desc.extra_bits,Bt=we.stat_desc.extra_base,et=we.stat_desc.max_length,lt=0;for(fe=0;fe<=y;fe++)oe.bl_count[fe]=0;for(Ce[2*oe.heap[oe.heap_max]+1]=0,Je=oe.heap_max+1;Je<u;Je++)et<(fe=Ce[2*Ce[2*(Oe=oe.heap[Je])+1]+1]+1)&&(fe=et,lt++),Ce[2*Oe+1]=fe,zt<Oe||(oe.bl_count[fe]++,ot=0,Bt<=Oe&&(ot=Sn[Oe-Bt]),gt=Ce[2*Oe],oe.opt_len+=gt*(fe+ot),xn&&(oe.static_len+=gt*(En[2*Oe+1]+ot)));if(lt!==0){do{for(fe=et-1;oe.bl_count[fe]===0;)fe--;oe.bl_count[fe]--,oe.bl_count[fe+1]+=2,oe.bl_count[et]--,lt-=2}while(0<lt);for(fe=et;fe!==0;fe--)for(Oe=oe.bl_count[fe];Oe!==0;)zt<(Qe=oe.heap[--Je])||(Ce[2*Qe+1]!==fe&&(oe.opt_len+=(fe-Ce[2*Qe+1])*Ce[2*Qe],Ce[2*Qe+1]=fe),Oe--)}}(x,C),be(G,ue,x.bl_count)}function s(x,C,U){var W,R,G=-1,X=C[1],$=0,te=7,ue=4;for(X===0&&(te=138,ue=3),C[2*(U+1)+1]=65535,W=0;W<=U;W++)R=X,X=C[2*(W+1)+1],++$<te&&R===X||($<ue?x.bl_tree[2*R]+=$:R!==0?(R!==G&&x.bl_tree[2*R]++,x.bl_tree[2*w]++):$<=10?x.bl_tree[2*O]++:x.bl_tree[2*z]++,G=R,ue=($=0)===X?(te=138,3):R===X?(te=6,3):(te=7,4))}function V(x,C,U){var W,R,G=-1,X=C[1],$=0,te=7,ue=4;for(X===0&&(te=138,ue=3),W=0;W<=U;W++)if(R=X,X=C[2*(W+1)+1],!(++$<te&&R===X)){if($<ue)for(;q(x,R,x.bl_tree),--$!=0;);else R!==0?(R!==G&&(q(x,R,x.bl_tree),$--),q(x,w,x.bl_tree),K(x,$-3,2)):$<=10?(q(x,O,x.bl_tree),K(x,$-3,3)):(q(x,z,x.bl_tree),K(x,$-11,7));G=R,ue=($=0)===X?(te=138,3):R===X?(te=6,3):(te=7,4)}}i(H);var L=!1;function S(x,C,U,W){K(x,(d<<1)+(W?1:0),3),function(R,G,X,$){ce(R),$&&(ne(R,X),ne(R,~X)),e.arraySet(R.pending_buf,R.window,G,X,R.pending),R.pending+=X}(x,C,U,!0)}a._tr_init=function(x){L||(function(){var C,U,W,R,G,X=new Array(y+1);for(R=W=0;R<b-1;R++)for(M[R]=W,C=0;C<1<<T[R];C++)l[W++]=R;for(l[W-1]=R,R=G=0;R<16;R++)for(H[R]=G,C=0;C<1<<B[R];C++)F[G++]=R;for(G>>=7;R<c;R++)for(H[R]=G<<7,C=0;C<1<<B[R]-7;C++)F[256+G++]=R;for(U=0;U<=y;U++)X[U]=0;for(C=0;C<=143;)Y[2*C+1]=8,C++,X[8]++;for(;C<=255;)Y[2*C+1]=9,C++,X[9]++;for(;C<=279;)Y[2*C+1]=7,C++,X[7]++;for(;C<=287;)Y[2*C+1]=8,C++,X[8]++;for(be(Y,h+1,X),C=0;C<c;C++)A[2*C+1]=5,A[2*C]=pe(C,5);re=new se(Y,T,f+1,h,y),Z=new se(A,B,0,c,y),ae=new se(new Array(0),P,0,v,E)}(),L=!0),x.l_desc=new D(x.dyn_ltree,re),x.d_desc=new D(x.dyn_dtree,Z),x.bl_desc=new D(x.bl_tree,ae),x.bi_buf=0,x.bi_valid=0,ie(x)},a._tr_stored_block=S,a._tr_flush_block=function(x,C,U,W){var R,G,X=0;0<x.level?(x.strm.data_type===2&&(x.strm.data_type=function($){var te,ue=4093624447;for(te=0;te<=31;te++,ue>>>=1)if(1&ue&&$.dyn_ltree[2*te]!==0)return r;if($.dyn_ltree[18]!==0||$.dyn_ltree[20]!==0||$.dyn_ltree[26]!==0)return t;for(te=32;te<f;te++)if($.dyn_ltree[2*te]!==0)return t;return r}(x)),Ae(x,x.l_desc),Ae(x,x.d_desc),X=function($){var te;for(s($,$.dyn_ltree,$.l_desc.max_code),s($,$.dyn_dtree,$.d_desc.max_code),Ae($,$.bl_desc),te=v-1;3<=te&&$.bl_tree[2*N[te]+1]===0;te--);return $.opt_len+=3*(te+1)+5+5+4,te}(x),R=x.opt_len+3+7>>>3,(G=x.static_len+3+7>>>3)<=R&&(R=G)):R=G=U+5,U+4<=R&&C!==-1?S(x,C,U,W):x.strategy===4||G===R?(K(x,2+(W?1:0),3),ke(x,Y,A)):(K(x,4+(W?1:0),3),function($,te,ue,oe){var we;for(K($,te-257,5),K($,ue-1,5),K($,oe-4,4),we=0;we<oe;we++)K($,$.bl_tree[2*N[we]+1],3);V($,$.dyn_ltree,te-1),V($,$.dyn_dtree,ue-1)}(x,x.l_desc.max_code+1,x.d_desc.max_code+1,X+1),ke(x,x.dyn_ltree,x.dyn_dtree)),ie(x),W&&ce(x)},a._tr_tally=function(x,C,U){return x.pending_buf[x.d_buf+2*x.last_lit]=C>>>8&255,x.pending_buf[x.d_buf+2*x.last_lit+1]=255&C,x.pending_buf[x.l_buf+x.last_lit]=255&U,x.last_lit++,C===0?x.dyn_ltree[2*U]++:(x.matches++,C--,x.dyn_ltree[2*(l[U]+f+1)]++,x.dyn_dtree[2*I(C)]++),x.last_lit===x.lit_bufsize-1},a._tr_align=function(x){K(x,2,3),q(x,k,Y),function(C){C.bi_valid===16?(ne(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):8<=C.bi_valid&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)}(x)}},{"../utils/common":41}],53:[function(n,o,a){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,o,a){(function(e){(function(r,t){if(!r.setImmediate){var i,d,b,f,h=1,c={},v=!1,u=r.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(r);y=y&&y.setTimeout?y:r,i={}.toString.call(r.process)==="[object process]"?function(w){process.nextTick(function(){E(w)})}:function(){if(r.postMessage&&!r.importScripts){var w=!0,O=r.onmessage;return r.onmessage=function(){w=!1},r.postMessage("","*"),r.onmessage=O,w}}()?(f="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",k,!1):r.attachEvent("onmessage",k),function(w){r.postMessage(f+w,"*")}):r.MessageChannel?((b=new MessageChannel).port1.onmessage=function(w){E(w.data)},function(w){b.port2.postMessage(w)}):u&&"onreadystatechange"in u.createElement("script")?(d=u.documentElement,function(w){var O=u.createElement("script");O.onreadystatechange=function(){E(w),O.onreadystatechange=null,d.removeChild(O),O=null},d.appendChild(O)}):function(w){setTimeout(E,0,w)},y.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var O=new Array(arguments.length-1),z=0;z<O.length;z++)O[z]=arguments[z+1];var T={callback:w,args:O};return c[h]=T,i(h),h++},y.clearImmediate=g}function g(w){delete c[w]}function E(w){if(v)setTimeout(E,0,w);else{var O=c[w];if(O){v=!0;try{(function(z){var T=z.callback,B=z.args;switch(B.length){case 0:T();break;case 1:T(B[0]);break;case 2:T(B[0],B[1]);break;case 3:T(B[0],B[1],B[2]);break;default:T.apply(t,B)}})(O)}finally{g(w),v=!1}}}}function k(w){w.source===r&&typeof w.data=="string"&&w.data.indexOf(f)===0&&E(+w.data.slice(f.length))}})(typeof self>"u"?e===void 0?this:e:self)}).call(this,typeof ct<"u"?ct:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(yn);var Gs=yn.exports;const $s=Dn(Gs),Ys=async(m,_,n,o,a)=>{var i,d,b;const e=document.querySelector("svg#".concat(m));if(!e)throw new Error("Requested canvas SVG element not found");const r=Number((i=e.style.getPropertyValue("--rmg-svg-height").match(/\d+/g))==null?void 0:i[0]),t=e.cloneNode(!0);if(t.setAttribute("height",(r*(a||100)/100).toString()),t.style.setProperty("all","initial"),["share"].map(f=>{var h;return[...((h=[...document.querySelectorAll("link")].filter(c=>c.id==="css_"+f)[0])==null?void 0:h.sheet).cssRules].map(c=>c.cssText).join(" ")}).forEach(f=>{const h=document.createElement("style");h.textContent=f,t.prepend(h)}),(d=t.querySelector("rect#canvas-border"))==null||d.setAttribute("stroke",o?"black":"none"),(b=t.querySelector("rect#canvas-bg"))==null||b.setAttribute("fill",n?"none":"white"),_===Q.MTR)try{const f=await Xs(t),h=document.createElement("style");h.textContent=f.join("\n"),t.prepend(h)}catch(f){alert("Failed to fonts. Fonts in the exported PNG will be missing."),console.error(f)}return t},qs=m=>new Promise(_=>{const n=new FileReader;n.onloadend=()=>_(n.result),n.readAsDataURL(m)}),Ks=(m,_)=>m.find(n=>{const o=n.style;return o.getPropertyValue("font-family").replace(/^"(.+)"$/,"$1")===_.family&&o.getPropertyValue("unicode-range")===_.unicodeRange}),Xs=async m=>{var e,r,t;const _=Array.from(new Set([...m.querySelectorAll(".rmg-name__zh"),...m.querySelectorAll(".rmg-name__en")].map(i=>i.innerHTML).join("").replace(/\s/g,""))).join(""),n=await document.fonts.load("80px GenYoMin TW, Vegur",_),o=Array.from(((t=(r=(e=document.querySelector("link#css_share"))==null?void 0:e.sheet)==null?void 0:r.cssRules)==null?void 0:t[0]).styleSheet.cssRules),a=n.reduce((i,d)=>{const b=Ks(o,d);return b?i.find(h=>{const c=h.style,v=b.style;return c.getPropertyValue("font-family")===v.getPropertyValue("font-family")&&c.getPropertyValue("unicode-range")===v.getPropertyValue("unicode-range")})?i:i.concat(b):i},[]);return await Promise.all(a.map(async i=>{try{const d=await fetch(Js(i)),b=await qs(await d.blob());return i.cssText.replace(/src:[ \w('",\-:/.)]+;/g,"src: url('".concat(b,"'); "))}catch(d){return console.error(d),""}}))},Js=m=>{var n;const _=m.style.src;return pn()?_.replace(/^url\("(\S+)"\).*$/,"$1"):"/rmg/styles/"+((n=_.match(/^url\("([\S*]+)"\)/))==null?void 0:n[1])},Qs=async(m,_,n)=>{const o=m.viewBox.baseVal.width,a=m.viewBox.baseVal.height,e=document.querySelectorAll("canvas")[0];e.width=Number(o)*window.devicePixelRatio*_,e.height=Number(a)*window.devicePixelRatio*_,m.setAttribute("width",e.width.toString()),m.setAttribute("height",e.height.toString());const r=e.getContext("2d");return r.clearRect(0,0,e.width,e.height),m.querySelectorAll(".rmg-name__en.rmg-name__gzmtr--next2-dest").forEach(t=>t.setAttribute("font-size","8.5px")),m.querySelectorAll("text, tspan").forEach(t=>{const i=window.getComputedStyle(t);t.setAttribute("font-family",i.fontFamily),t.setAttribute("fill",i.fill),t.setAttribute("dominant-baseline",i.dominantBaseline),t.setAttribute("text-anchor",i.textAnchor||"")}),new Promise((t,i)=>{const d=new Image;d.onload=()=>{setTimeout(()=>{r.drawImage(d,0,0,e.width,e.height),e.toBlob(b=>{b?t(b):i("Canvas blob is null")},"image/png")},n?2e3:0)},d.onerror=i,d.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(m.outerHTML)))})};function ea(m){const{isOpen:_,onClose:n}=m,{t:o}=le(),a=ge(),[e,r]=J.useState(""),[t,i]=J.useState(!1),[d,b]=J.useState(!1),[f,h]=J.useState(100),[c,v]=J.useState("png"),u=ee(P=>P.app.canvasToShow),{style:y,stn_list:g,current_stn_idx:E,line_name:k}=ee(P=>P.param);J.useEffect(()=>{e!==""&&!u.includes(e)&&r("")},[u]);const w=It[y].reduce((P,N)=>u.includes(N)?{...P,[N]:o("CanvasType."+N)}:{...P},{"":o("DownloadModal.pleaseSelect")}),O=[25,33,50,67,75,80,90,100,110,125,150,175,200,250,300,400,500].reduce((P,N)=>({...P,[N]:"".concat(N,"%")}),{}),z={png:o("DownloadModal.png"),svg:o("DownloadModal.svg")},T=[{type:"select",label:o("DownloadModal.canvas"),value:e,options:w,disabledOptions:[""],onChange:P=>r(P),minW:"full"},{type:"switch",label:o("DownloadModal.transparent"),isChecked:t,onChange:i,oneLine:!0,minW:"full"},{type:"switch",label:o("DownloadModal.showBorder"),isChecked:d,onChange:b,oneLine:!0,minW:"full"},{type:"select",label:o("DownloadModal.scale"),value:f,options:O,onChange:P=>h(P)},{type:"select",label:o("DownloadModal.format"),value:c,options:z,onChange:P=>v(P)}],B=async P=>{a(Yt(0));const N=P==="current"?[E]:Object.keys(g).filter(A=>!["linestart","lineend"].includes(A)),Y=new $s;for(const A in N){a(Yt((Number(A)+1)/N.length*100));const F=N[A];a(kt(F)),await Xr(500);const l=await Ys(e,y,t,d,f);document.body.appendChild(l);const M="rmg.".concat(F,".").concat(g[F].name[0],".").concat(g[F].name[1]).replaceAll(/\\|\/|\||\*|:|\?|<|>|"/g,"_");if(c==="png"){const re=pn()&&A==="0",Z=await Qs(l,f/100,re);N.length>1?Y.file("".concat(M,".png"),Z):qt("".concat(M,".png"),Z)}else if(c==="svg"){l.removeAttribute("height");const re="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(l.outerHTML)));N.length>1?Y.file("".concat(M,".svg"),re.split("base64,")[1],{base64:!0}):mn(M+".svg","image/svg+xml",l.outerHTML)}document.body.removeChild(l)}if(N.length>1){const A=await Y.generateAsync({type:"blob"}),F="rmg.".concat(k[0],".").concat(k[1],".zip").replaceAll(" ","_");qt(F,A)}he.event(Ee.DOWNLOAD_IMAGES,{canvasToDownload:e,style:y,option:P,format:c}),a(kt(E)),a(Ir()),n()};return p.jsxs(Ze,{isOpen:_,onClose:n,children:[p.jsx(He,{}),p.jsxs(Ge,{children:[p.jsx($e,{children:o("DownloadModal.title")}),p.jsx(Ye,{}),p.jsx(qe,{children:p.jsx(_e,{fields:T})}),p.jsx(Ke,{children:p.jsxs(Ie,{children:[p.jsx(de,{colorScheme:"primary",variant:"outline",size:"sm",onClick:()=>B("current"),isDisabled:!e,children:o("DownloadModal.downloadOne")}),y!==Q.GZMTR&&p.jsx(de,{colorScheme:"primary",variant:"outline",size:"sm",onClick:()=>B("all"),isDisabled:!e,children:o("DownloadModal.downloadAll")})]})})]})]})}function ta(){const{t:m}=le(),[_,n]=J.useState(!1),{paramConfig:o}=ee(r=>r.app),a=ee(r=>r.param),e=()=>{mn("RMG_".concat(o==null?void 0:o.id,".json"),"application/json",JSON.stringify(a)),he.event(Ee.DOWNLOAD_PARAM,{style:a.style})};return p.jsxs(On,{children:[p.jsx(Cn,{as:de,variant:"ghost",size:"sm",rightIcon:p.jsx(Tr,{}),children:m("DownloadActions.downloads")}),p.jsxs(Rn,{children:[p.jsx(Mt,{onClick:e,children:m("DownloadActions.configFile")}),p.jsx(Mt,{onClick:()=>n(!0),children:m("DownloadActions.images")})]}),p.jsx(ea,{isOpen:_,onClose:()=>n(!1)})]})}function _t(){const[m,_]=Ln();return[m,o=>{if(_(o),Object.keys(o)){const a=new URLSearchParams(o);he.updateUrl("/rmg/#/?"+a)}else he.updateUrl("/rmg/#/")}]}function na(){const{t:m}=le(),_=Pt(),[,n]=_t(),o=()=>{_(We(Me.CLOSE)),_(un(void 0)),n({})};return p.jsxs(Ie,{ml:"auto",w:"fit-content",children:[p.jsx(de,{variant:"ghost",size:"sm",leftIcon:p.jsx(Dr,{}),onClick:o,children:m("All projects")}),p.jsx(ta,{}),p.jsx(de,{variant:"solid",size:"sm",colorScheme:"primary",leftIcon:p.jsx(Lr,{}),onClick:()=>_(We(Me.STYLE)),children:m("HeaderActions.editStyle")})]})}function ra(){const{t:m}=le(),_=ge(),{canvasToShow:n,canvasScale:o}=ee(d=>d.app),a=ee(d=>d.param.style),e=Object.values(Q).reduce((d,b)=>({...d,[b]:m("RmgStyle."+b)}),{}),r=It[a].map(d=>({label:m("CanvasType."+d),value:d})),t=d=>{_(Ur(d))},i=[{type:"select",label:m("Style"),value:a,options:e,onChange:d=>t(d)},{type:"custom",label:m("View"),component:p.jsx(Fr,{displayValue:m("Select canvas"),selections:r,defaultValue:n,onChange:d=>_(zr(d))})},{type:"slider",label:m("Canvas scale"),value:o,min:.1,max:2,step:.01,onChange:d=>_(Br(d)),leftIcon:p.jsx(Mr,{}),rightIcon:p.jsx(Vr,{})}];return p.jsxs(Nr,{children:[p.jsx(_e,{fields:i,minW:160}),p.jsx(na,{})]})}const sa=m=>{switch(m){case Q.MTR:return[Re.Hongkong,"twl","#E2231A",xe.white];case Q.GZMTR:return[Re.Guangzhou,"gz1","#F3D03E",xe.black];case Q.SHMetro:return[Re.Shanghai,"sh1","#E4002B",xe.white];default:return[Re.Other,"other","#AAAAAA",xe.white]}},aa=m=>{switch(m){case"zh-Hans":return["1号线","Line 1"];case"zh-Hant":return["荃灣綫","Tsuen Wan Line"];default:return["地鐵線","Metro Line"]}},tt=m=>({name:["未命名 "+m,"Unnamed "+m],secondaryName:!1,num:"00",services:[wt.local],parents:[],children:[],branch:{left:[],right:[]},transfer:{groups:[{lines:[]}],tick_direc:Ne.right,paid_area:!0},facility:"",loop_pivot:!1,one_line:!0,int_padding:355}),ia=(m,_)=>{const n=tt("linestart");n.name=["LEFT END","LEFT END"];const o=tt("lineend");o.name=["RIGHT END","RIGHT END"];const a=it(6),e=tt(a);e.num="01";const r=it(6),t=tt(r);return t.num="02",n.children=[a],e.parents=["linestart"],e.children=[r],t.parents=[a],t.children=["lineend"],o.parents=[r],{svgWidth:{destination:1200,runin:1200,railmap:1200,indoor:1200},svg_height:300,style:m,y_pc:50,padding:10,branchSpacingPct:33,direction:Ne.left,platform_num:"1",theme:sa(m),line_name:aa(_),current_stn_idx:r,stn_list:{linestart:n,[a]:e,[r]:t,lineend:o},namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:m===Q.SHMetro?cn.sh:ln.gz1,notesGZMTR:[],direction_gz_x:40,direction_gz_y:70,coline:{},loop:!1,loop_info:{bank:!0,left_and_right_factor:1,bottom_factor:1}}},rt=(m,_,n,o)=>(a,e)=>{const r=e().param.stn_list;let t=it(6);for(;t in r;)t=it(6);const i=tt(t);if(m!=="new"){const d={...r,[_]:{...r[_],children:r[_].children.map(b=>b===n?t:b),branch:{left:r[_].branch.left,right:r[_].branch.right.length&&r[_].branch.right[1]===n?[r[_].branch.right[0],t]:r[_].branch.right}},[n]:{...r[n],parents:r[n].parents.map(b=>b===_?t:b),branch:{left:r[n].branch.left.length&&r[n].branch.left[1]===_?[r[n].branch.left[0],t]:r[n].branch.left,right:r[n].branch.right}},[t]:{...i,parents:[_],children:[n]}};return a(Be(d)),t}else{if(!o)return!1;const d={...r,[_]:{...r[_],children:o==="upper"?[t,r[_].children[0]]:[r[_].children[0],t],branch:{left:r[_].branch.left,right:[ut.through,t]}},[n]:{...r[n],parents:o==="upper"?[t,r[n].parents[0]]:[r[n].parents[0],t],branch:{left:[ut.through,t],right:r[n].branch.right}},[t]:{...i,parents:[_],children:[n]}};return a(Be(d)),t}},oa=(m,_,n)=>(o,a)=>{const r=a().helper.branches[m];if(r!=null&&r.length)if(_==="before"){const t=r[r.indexOf(n)-1];return o(rt(m.toString(),t,n))}else{const t=r[r.indexOf(n)+1];return o(rt(m.toString(),n,t))}else return!1},la=()=>(m,_)=>{const n=_().param.stn_list;return _().helper.branches[0].filter(a=>{const e=n[a].parents.length+n[a].children.length===4,r=Lt(a,n)===0;return!e&&r})},Xt=(m,_)=>(n,o)=>{const a=o().param.stn_list,e=o().helper.branches;return!e[0].includes(m)||!e[0].includes(_)?"Branch should end at main line":e[0].indexOf(m)>=e[0].indexOf(_)?"Not in correct ordering":m==="linestart"&&_==="lineend"?"Should not be parallel to main line":m==="linestart"&&e[0].indexOf(_)===1?"Branch should not be open jaw from the first station":_==="lineend"&&e[0].indexOf(m)===e[0].length-2?"Branch should not be open jaw from the last station":a[m].children.length>1||a[_].parents.length>1?"Branch already exist":e.slice(1).some(i=>i.slice(1,-1).includes(m)||i.slice(1,-1).includes(_))?"Cannot branch out from existing branch":e[0].slice(e[0].indexOf(m)+1,e[0].indexOf(_)).every(i=>a[i].parents.length===1&&a[i].children.length===1)?"":"One or more stations between both ends are branching out"};function ca(m){var z,T;const{isOpen:_,onClose:n}=m,{t:o}=le(),a=ge(),e=ee(B=>B.app.selectedBranch),{style:r,stn_list:t}=ee(B=>B.param),i=ee(B=>B.helper.branches),[d,b]=J.useState(e),[f,h]=J.useState("before"),[c,v]=J.useState(""),[u,y]=J.useState(!1);J.useEffect(()=>{b(e)},[e]),J.useEffect(()=>{_||y(!1)},[_]);const g=(T=(z=i[Number(d)])==null?void 0:z.slice(1,-1))!=null?T:[],E=B=>B.reduce((P,N)=>{var Y;return{...P,[N]:(Y=t[N])==null?void 0:Y.name.join(" - ")}},{"":o("AddStationModal.pleaseSelect")}),k=[{type:"select",label:o("AddStationModal.where"),value:d,options:{...i.reduce((B,P,N)=>({...B,[N]:N===0?o("AddStationModal.main"):r!==Q.SHMetro||!Xe(P,t)?o("AddStationModal.branch")+" "+N:o("AddStationModal.external")+" "+N}),{})},onChange:B=>w(B),minW:"full"},{type:"select",label:o("AddStationModal.preposition"),value:f,options:{before:o("AddStationModal.before"),after:o("AddStationModal.after")},onChange:B=>h(B)},{type:"select",label:o("AddStationModal.pivot"),value:c,options:E(g),disabledOptions:[""],onChange:B=>v(B)}],w=B=>{b(B),v("")},O=()=>{const B=a(oa(d,f,c));B?(n(),a(dn(B)),a(We(Me.STATION))):(console.log("false here"),y(!0)),he.event(Ee.ADD_STATION,{style:r,branchIndex:d,success:B})};return p.jsxs(Ze,{isOpen:_,onClose:n,children:[p.jsx(He,{}),p.jsxs(Ge,{children:[u&&p.jsxs(pt,{status:"error",variant:"solid",size:"xs",children:[p.jsx(mt,{}),o("AddStationModal.error")]}),p.jsxs(Se,{position:"relative",children:[p.jsx($e,{children:o("AddStationModal.title")}),p.jsx(Ye,{})]}),p.jsx(qe,{children:p.jsx(_e,{fields:k})}),p.jsx(Ke,{children:p.jsx(de,{colorScheme:"primary",onClick:O,isDisabled:!c,children:o("Confirm")})})]})]})}function da(m){const{isOpen:_,onClose:n}=m,{t:o}=le(),a=ge(),[e,r]=J.useState("new"),[t,i]=J.useState(""),[d,b]=J.useState(""),[f,h]=J.useState("upper"),[c,v]=J.useState(""),[u,y]=J.useState(""),{style:g,stn_list:E}=ee(Y=>Y.param);J.useEffect(()=>{_||(r("new"),i(""),b(""))},[_]);const w=(Y=>Y.reduce((A,F)=>{var l;return{...A,[F]:(l=E[F])==null?void 0:l.name.join(" - ")}},{"":o("NewBranchModal.pleaseSelect")}))(a(la())),O=[{type:"select",label:o("NewBranchModal.where"),value:e,options:{new:o("NewBranchModal.new"),ext:o("NewBranchModal.ext")},disabledOptions:g===Q.SHMetro?[]:["ext"],onChange:Y=>z(Y),minW:"full"},{type:"select",label:o("NewBranchModal.from"),value:t,options:w,disabledOptions:[""],onChange:Y=>T(Y),isInvalid:!!c},{type:"select",label:o("NewBranchModal.to"),value:d,options:w,disabledOptions:[""],onChange:Y=>B(Y),isInvalid:!!u},{type:"select",label:o("NewBranchModal.position"),value:f,options:{upper:o("NewBranchModal.upper"),lower:o("NewBranchModal.lower")},onChange:Y=>h(Y),minW:"full",hidden:e!=="new"||g===Q.SHMetro}],z=Y=>{r(Y),i(""),b(""),v(""),y("")},T=Y=>{i(Y),v(""),Y&&d&&y(a(Xt(Y,d)))},B=Y=>{b(Y),y(""),t&&Y&&v(a(Xt(t,Y)))},P=()=>{let Y;e==="ext"?Y=a(rt("new",t,d,"lower")):g===Q.SHMetro?Y=a(rt("new",t,d,"upper")):Y=a(rt("new",t,d,f)),Y&&(n(),he.event(Ee.ADD_BRANCH,{style:g,where:e}))},N=!!(!t||!d||c||u);return p.jsxs(Ze,{isOpen:_,onClose:n,children:[p.jsx(He,{}),p.jsxs(Ge,{children:[p.jsx($e,{children:o("NewBranchModal.title")}),p.jsx(Ye,{}),p.jsx(qe,{children:p.jsx(_e,{fields:O})}),p.jsx(Ke,{children:p.jsx(de,{colorScheme:"primary",title:N?c||u:o("Confirm"),onClick:P,isDisabled:N,children:o("Confirm")})})]})]})}const ua=J.lazy(()=>j(()=>import("./station-ag-grid-9d9c9011.js"),["assets/station-ag-grid-9d9c9011.js","assets/chakra-0b0a1fde.js","assets/react-f83802c2.js","assets/index-b47975a7.js","assets/index-d22c1e14.css","assets/ag-grid-e5cbe116.js","assets/param-updater-utils-67d44659.js"]));function ha(){const{t:m}=le(),_=ge(),[n,o]=J.useState(!1),[a,e]=J.useState(!1),r=ee(f=>f.app.selectedBranch),{style:t,stn_list:i}=ee(f=>f.param),d=ee(f=>f.helper.branches),b=()=>{_(We(Me.BRANCH))};return p.jsxs(Se,{flex:1,overflow:"hidden",children:[p.jsxs(Jt,{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",index:r,onChange:f=>_(Wr(f)),children:[p.jsxs(Qt,{children:[d.map((f,h)=>h===0?p.jsx(nt,{children:m("GridTabs.main")},h):t!==Q.SHMetro||!Xe(f,i)?p.jsx(nt,{children:m("GridTabs.branch")+" "+h},h):p.jsx(nt,{children:m("GridTabs.external")+" "+h},h)),p.jsx(De,{size:"sm",variant:"ghost",alignSelf:"center","aria-label":"New branch",onClick:()=>e(!0),icon:p.jsx(Te,{})}),p.jsxs(Ie,{marginLeft:"auto",marginRight:1,children:[p.jsx(de,{variant:"outline",size:"xs",leftIcon:p.jsx(Te,{}),onClick:()=>o(!0),children:m("GridTabs.addStation")}),p.jsx(de,{size:"xs",colorScheme:"primary",onClick:b,children:m("GridTabs.editLine")})]})]}),p.jsx(en,{flex:1,overflowY:"auto",children:d.map((f,h)=>p.jsx(Et,{padding:0,h:"100%",position:"relative",children:p.jsx(nn,{suspenseFallback:p.jsx(ft,{isIndeterminate:!0}),children:p.jsx(ua,{branchIndex:h})})},h))})]}),p.jsx(ca,{isOpen:n,onClose:()=>o(!1)}),p.jsx(da,{isOpen:a,onClose:()=>e(!1)})]})}function pa(){const m=ge(),_=ee(o=>o.app.globalAlerts),n=o=>{he.isStandaloneWindow()?window.open("/".concat(o),"_blank"):he.openApp(o)};return p.jsx(p.Fragment,{children:Object.entries(_).map(([o,{message:a,url:e,linkedApp:r}])=>p.jsxs(pt,{status:o,variant:"solid",size:"xs",pl:3,pr:1,py:0,children:[p.jsx(mt,{}),r?p.jsx(Ve,{onClick:()=>n(r),children:a}):e?p.jsx(Ve,{href:e,target:"_blank",children:a}):a,p.jsx(Pn,{ml:"auto",onClick:()=>m(Zr(o))})]},o))})}function ma(){const{t:m}=le(),_=ee(a=>a.app.isLoading),[n,o]=J.useState(!1);return J.useEffect(()=>{he.isStandaloneWindow()&&!window.localStorage.getItem(Fe.DO_NOT_SHOW_RMT_MSG)&&o(!0)},[]),p.jsxs(hn,{children:[_&&p.jsx(ft,{isIndeterminate:_<0,value:_>=0?_:void 0}),p.jsx(ra,{}),n&&p.jsxs(pt,{status:"info",variant:"solid",size:"xs",pl:3,pr:1,py:1,children:[p.jsx(mt,{}),p.jsxs(st,{sx:{"& a, button":{fontWeight:"bold",textDecoration:"underline"}},children:[m("Try out")," ",p.jsx(Ve,{href:"/?app=rmg",isExternal:!0,children:m("Rail Map Toolkit")})," ",m("now and enjoy an even better rail map design experience!")," ",p.jsx(Ve,{as:"button",ml:"auto",onClick:()=>o(!1),children:m("Close")})," | ",p.jsx(Ve,{as:"button",onClick:()=>{o(!1),window.localStorage.setItem(Fe.DO_NOT_SHOW_RMT_MSG,"true")},children:m("Don't show me again")})]})]}),p.jsx(pa,{}),p.jsxs(Pe,{flex:1,overflow:"hidden",position:"relative",children:[p.jsxs(Pe,{as:"section",direction:"column",flex:1,ml:1,mr:1,overflow:"hidden",children:[p.jsx(Se,{children:p.jsx(as,{})}),p.jsx(ha,{})]}),p.jsx(Hs,{})]}),p.jsx("canvas",{style:{display:"none"}})]})}const fa="rmg-templates-bridge--",_a={h:800,maxH:"70%","& iframe":{h:"100%",w:"100%"}};function ga(m){const{isOpen:_,onClose:n,onImport:o}=m,[a]=J.useState(crypto.randomUUID()),e="/rmg-templates/#/import?"+new URLSearchParams({parentComponent:he.getAppName(),parentId:a});return J.useEffect(()=>{const r=new BroadcastChannel(fa+a);return r.onmessage=t=>{const{event:i,meta:d,data:b}=t.data;console.log("[rmg] Received event from RMG Templates app clip:",i),i==="CLOSE"?n():i==="IMPORT"&&o(b,d.name)},()=>{r.close()}},[]),p.jsx(Hr,{size:"xl",isOpen:_,onClose:n,sx:_a,children:p.jsx("iframe",{src:e,loading:"lazy"})})}const va={flexWrap:"wrap",flex:"1 1 0%",minW:120,"& button":{w:"100%",m:1}};function ba(m){const{selectedParam:_,disableNew:n,onError:o}=m,{t:a}=le(),[,e]=_t(),[r,t]=J.useState(!1),i=J.useRef(null),d=J.useRef(null);J.useEffect(()=>{var v;_&&((v=d.current)==null||v.focus())},[_]);const b=()=>{const v=ia(Q.MTR,he.getLanguage()),u=bt(JSON.stringify(v));e({project:u}),he.event(Ee.NEW_PARAM,{})},f=(v,u)=>{const y=bt(JSON.stringify(v),u);e({project:y})},h=async v=>{var y;const u=(y=v.target.files)==null?void 0:y[0];console.log("handleImportProject():: received file",u);try{if(!u)o(a("OpenActions.unknownError"));else if(u.type!=="application/json")o(a("OpenActions.invalidType"));else{const g=await Jr(u),E=bt(g);e({project:E}),he.event(Ee.UPLOAD_PARAM,{})}}catch(g){o(a("OpenActions.unknownError")),console.error("handleImportProject():: Unknown error occurred while parsing the uploaded file",g)}v.target.value=""},c=()=>{_&&(e({project:_}),he.event(Ee.OPEN_PARAM,{}))};return p.jsxs(Pe,{sx:va,children:[p.jsx(de,{leftIcon:p.jsx(Te,{}),onClick:b,isDisabled:n,children:a("Blank project")}),p.jsx(de,{leftIcon:p.jsx(Gr,{}),onClick:()=>t(!0),isDisabled:n,children:a("Open template")}),p.jsx(de,{leftIcon:p.jsx($r,{}),onClick:()=>{var v;return(v=i.current)==null?void 0:v.click()},isDisabled:n,children:a("Import project")}),p.jsx(de,{ref:d,colorScheme:"primary",leftIcon:p.jsx(Yr,{}),onClick:c,isDisabled:_===void 0,children:a("Open selected")}),p.jsx("input",{ref:i,type:"file",accept:".json",hidden:!0,onChange:h,"data-testid":"file-upload"}),p.jsx(ga,{isOpen:r,onClose:()=>t(!1),onImport:f})]})}const ya={flexDirection:"column",p:2,h3:{m:2},"& > div":{m:2,flexWrap:"wrap",flexDirection:{base:"column",md:"row"}}};function Ea(m){const{downloading:_}=m,{t:n}=le(),[o]=_t(),a=o.get("project"),[e,r]=J.useState([]),[t,i]=J.useState(),d=J.useRef(null),b=tn();J.useEffect(()=>{r(yt())},[_]),In({ref:d,handler:()=>i(void 0)});const f=v=>{const{id:u,name:y,lastModified:g}=v;u&&(window.localStorage.setItem(Fe.PARAM_CONFIG_BY_ID+u,JSON.stringify({name:y,lastModified:g})),i(void 0),r(yt()),he.event(Ee.UPDATE_PARAM_CONFIG,{}))},h=v=>{window.localStorage.removeItem(Fe.PARAM_BY_ID+v),window.localStorage.removeItem(Fe.PARAM_CONFIG_BY_ID+v),i(void 0),r(yt()),he.event(Ee.REMOVE_PARAM,{})},c=v=>{b({description:v,status:"error",duration:1e4,isClosable:!0})};return p.jsxs(hn,{justifyContent:"center",children:[a&&p.jsx(ft,{isIndeterminate:!0}),p.jsx(Tn,{children:p.jsxs(ze,{sx:ya,children:[p.jsx(ye,{as:"h3",size:"lg",children:n("Saved projects")}),p.jsxs(Pe,{ref:d,children:[p.jsx(Qr,{paramRegistry:e,downloading:_,selectedParam:t,onParamSelect:i,onParamRemove:h,onParamUpdate:f}),p.jsx(ba,{selectedParam:t,disableNew:e.length>=10,onError:c})]})]})})]})}const xa=m=>_=>{let n={id:m};const o=window.localStorage.getItem(Fe.PARAM_CONFIG_BY_ID+m);o===null?console.warn("Config for paramID=".concat(m," does not exist in localStorage")):n={...n,...JSON.parse(o)};try{const a=window.localStorage.getItem(Fe.PARAM_BY_ID+m);if(a===null)return console.warn("Param ID=".concat(m," does not exist in localStorage")),!1;{const e=es(JSON.parse(a));return _(un(n)),_(qr(e)),!0}}catch(a){return console.warn("Failed to parse param.",a),!1}};function Sa(){const{t:m}=le(),_=ge(),{paramConfig:n}=ee(h=>h.app),[o,a]=_t(),e=o.get("project"),r=o.get("external"),[t,i]=J.useState(!1),[d,b]=J.useState(),f=tn();return J.useEffect(()=>{if(console.log("searchParam: project=".concat(e,", external=").concat(r)),e&&r)console.warn("AppRouter:: Both param ID and external URL are provided. External URL will be ignored."),a({project:e});else if(e)f.closeAll(),e===(n==null?void 0:n.id)?(console.log("AppRouter:: Store param ID matches URL param ID. Rendering app view..."),i(!0)):(console.log("AppRouter:: Loading app view for param (ID=".concat(e,")...")),_(xa(e))?i(!0):(console.log("AppRouter:: Failed to read param (ID=".concat(e,"). Rendering param selector view...")),f({description:m("Project selected is invalid or corrupted."),status:"error",duration:1e4,isClosable:!0}),a({})));else if(r){console.log("AppRouter:: External project URl is provided. Downloading project...");const h=decodeURIComponent(r);b(h),Kr(h).then(c=>{c?a({project:c}):(console.log("AppRouter:: Failed to download param from ".concat(h,". Rendering param selector view...")),f({description:m("External URL cannot be opened."),status:"error",duration:1e4,isClosable:!0}),a({})),b(void 0)})}else console.log("AppRouter:: No URL param ID or external URL provided. Rendering param selector view..."),i(!1)},[e,r]),t?p.jsx(ma,{}):p.jsx(Ea,{downloading:d})}const Ca=Object.freeze(Object.defineProperty({__proto__:null,default:Sa},Symbol.toStringTag,{value:"Module"}));export{ts as R,Ca as a,Oa as g,Xe as i};
