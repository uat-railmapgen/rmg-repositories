!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(n){i(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function i(n,t,i){return(t=function(n){var t=function(n,t){if("object"!==e(n)||null===n)return n;var i=n[Symbol.toPrimitive];if(void 0!==i){var r=i.call(n,t||"default");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"===e(t)?t:String(t)}(t))in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,r,o,a,s=[],l=!0,c=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=o.call(t)).done)&&(s.push(i.value),s.length!==n);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return o(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}System.register(["./chakra-legacy-91447f72.js","./react-legacy-6e2dfb62.js","./index-legacy-fa3dcd87.js"],(function(e,n){"use strict";var o,a,s,l,c,u,d,f,h,g,p,m,v,_,b,y,j,x,w,O,S,C,P,D,M,R,T;return{setters:[function(e){o=e.j,a=e.e,s=e.an,l=e.a3,c=e.M,u=e.a4,d=e.q,f=e.r,h=e.s,g=e.v,p=e.d,m=e.Q,v=e.B,_=e.G,b=e.t},function(e){y=e.r},function(e){j=e.k,x=e.ay,w=e.b5,O=e.b6,S=e.ax,C=e.b,P=e.b7,D=e.b8,M=e.m,R=e.e,T=e.ap}],execute:function(){function n(e){var n=e.fields,t=e.noLabel,i=e.minW;return o.jsx(a,{wrap:"wrap",children:n.map((function(e,n){if(e.hidden)return o.jsx(y.Fragment,{},n);var r=e.minW||i,a="full"===r;return o.jsx(j,{className:a?"mw-full":"",label:e.label,flex:a?void 0:1,minW:a?void 0:r,noLabel:t,oneLine:e.oneLine,children:function(e){switch(e.type){case"input":return o.jsx(S,{placeholder:e.placeholder,defaultValue:e.value,type:e.variant,validator:e.validator,onDebouncedChange:e.onChange,delay:e.debouncedDelay,optionList:e.optionList,isDisabled:e.isDisabled});case"textarea":return o.jsx(O,{placeholder:e.placeholder,defaultValue:e.value,onDebouncedChange:e.onChange,isDisabled:e.isDisabled});case"slider":return o.jsx(w,{defaultValue:e.value,min:e.min,max:e.max,step:e.step,onThrottledChange:e.onChange,leftIcon:e.leftIcon,rightIcon:e.rightIcon,isDisabled:e.isDisabled});case"select":return o.jsx(x,{defaultValue:e.value,onChange:function(n){var t,i=n.target.value;return null===(t=e.onChange)||void 0===t?void 0:t.call(e,"number"==typeof e.value?Number(i):i.toString())},options:e.options,disabledOptions:e.disabledOptions,isInvalid:e.isInvalid,isDisabled:e.isDisabled});case"switch":return o.jsx(s,{isChecked:e.isChecked,isDisabled:e.isDisabled,onChange:function(n){var t,i=n.target.checked;return null===(t=e.onChange)||void 0===t?void 0:t.call(e,i)}});case"custom":return e.component;default:return o.jsx("div",{})}}(e)},n)}))})}e({P:function(e){var n=e.paramRegistry,t=e.downloading,i=e.selectedParam,s=e.onParamSelect,l=e.onParamRemove,c=e.onParamUpdate,u=C().t,d=r(y.useState(),2),f=d[0],h=d[1];return o.jsxs(m,{sx:L,children:[o.jsxs(a,{children:[t&&o.jsx(P,{variant:"ghost",primaryText:u("Downloading")+"...",secondaryText:t,isDisabled:!0}),n.slice().sort((function(e,n){var t,i;return(null!==(t=n.lastModified)&&void 0!==t?t:0)-(null!==(i=e.lastModified)&&void 0!==i?i:0)})).map((function(e){var n;return o.jsxs(v,{size:"sm",isAttached:!0,colorScheme:i===e.id?"primary":void 0,variant:i===e.id?"solid":"ghost",children:[o.jsx(P,{primaryText:null!==(n=e.name)&&void 0!==n?n:u("Project")+" "+e.id,secondaryText:u("Last modified")+": "+E(e.lastModified).map((function(e){return u(e)})).join(" "),"aria-pressed":i===e.id,onClick:function(){return s(e.id)}}),c&&o.jsx(_,{"aria-label":u("Edit project info"),title:u("Edit project info"),icon:o.jsx(D,{}),onClick:function(){return h(e)}}),l&&o.jsx(_,{"aria-label":u("Remove project"),title:u("Remove project"),icon:o.jsx(M,{}),onClick:function(){return l(e.id)}})]},e.id)}))]}),n.length>=10&&o.jsx(b,{as:"em",fontSize:"xs",children:u("You have reached the maximum number of projects.")}),o.jsx(z,{config:f,onClose:function(){return h(void 0)},onUpdate:function(e){null==c||c(e),h(void 0)}})]})},R:n});e("a",(function(e,n,t){var i=new Blob([t],{type:n});k(e,i)}));var k=e("d",(function(e,n){var t=window.URL.createObjectURL(n),i=document.createElement("a");i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(t)})),E=(e("r",(function(e){return new Promise((function(n){var t=new FileReader;t.onloadend=function(){return n(t.result)},t.readAsText(e)}))})),e("i",(function(){return navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")})),function(e){if(e){var n=(new Date).getTime()-e;return n<6e4?["Just now"]:n<12e4?["1","minute ago"]:n<36e5?[Math.floor(n/1e3/60).toString(),"minutes ago"]:n<72e5?["1","hour ago"]:n<864e5?[Math.floor(n/1e3/60/60).toString(),"hours ago"]:n<1728e5?["1","day ago"]:[Math.floor(n/1e3/60/60/24).toString(),"days ago"]}return["Unknown"]});e("w",(function(e){return new Promise((function(n){setTimeout(n,e)}))}));function z(e){var i,a=e.config,s=e.onClose,m=e.onUpdate,v=C().t,_=r(y.useState(null!==(i=null==a?void 0:a.name)&&void 0!==i?i:""),2),b=_[0],j=_[1];y.useEffect((function(){var e;a&&j(null!==(e=a.name)&&void 0!==e?e:"")}),[a]);var x=[{type:"input",label:v("Project name"),value:b,onChange:j,debouncedDelay:0}];return o.jsxs(l,{isOpen:!!a,onClose:s,isCentered:!0,children:[o.jsx(c,{}),o.jsxs(u,{children:[o.jsx(d,{children:v("Edit project info")}),o.jsx(f,{}),o.jsx(h,{children:o.jsx(n,{fields:x})}),o.jsx(g,{children:o.jsx(p,{colorScheme:"primary",onClick:function(){var e;a&&((null!==(e=a.name)&&void 0!==e?e:"")!==b&&m(t(t({},a),{},{name:b})))},children:v("Confirm")})})]})]})}var L={flex:"2 1 0%",overflow:"hidden",minW:{base:"unset",md:240},w:{base:"100%",md:"unset"},mr:{base:0,md:2},mb:{base:2,md:0},"& > div":{flexDirection:"column",h:200,overflowX:"hidden",overflowY:"auto",borderRadius:"md",borderWidth:2,"& >.chakra-button":{alignItems:"center"},"& .chakra-button__group":{"& button:not(:first-of-type)":{h:"100%"}}}};e("u",(function(e){var n,o,a;"line_name"in e||(e.line_name=["路線名","Name of Line"]),"dest_legacy"in e||(e.dest_legacy=!1),delete e.fontZH,delete e.fontEN,delete e.weightZH,delete e.weightEN;for(var s=0,l=Object.entries(e.stn_list);s<l.length;s++){var c=r(l[s],2),u=c[0],d=c[1];"branch"in d||(e.stn_list[u].branch={left:[],right:[]},2===d.children.length?e.stn_list[u].branch.right=["through",d.children[1]]:e.stn_list[u].branch.right=[],2===d.parents.length?e.stn_list[u].branch.left=["through",d.parents[1]]:e.stn_list[u].branch.left=[])}e.psd_num="psd_num"in e?e.psd_num.toString():"1","line_num"in e||(e.line_num="1"),3===e.theme.length&&e.theme.push("#fff");for(var f=0,h=Object.entries(e.stn_list);f<h.length;f++){var g=r(h[f],2),p=g[0],m=g[1];"num"in m||(e.stn_list[p].num="00"),"interchange"in m&&m.interchange.map((function(e){return e.forEach((function(e){5===e.length&&e.splice(3,0,"#fff")}))}))}for(var v=0,_=Object.entries(e.stn_list);v<_.length;v++){var b=r(_[v],2),y=b[0],j=b[1];"osi22_end_p"===j.change_type&&(e.stn_list[y].change_type="osi22_pr"),"osi22_end_u"===j.change_type&&(e.stn_list[y].change_type="osi22_ur")}for(var x=0,w=Object.entries(e.stn_list);x<w.length;x++){var O=r(w[x],2),S=O[0];"interchange"in O[1]||(e.stn_list[S].interchange=[[]])}e.info_panel_type="info_panel_type"in e?function(e){switch(e){case"gz_1":case"panasonic":return"gz28";case"gz_2":return"gz6";case"gz_3":return"gz3";default:return e}}(e.info_panel_type):"gz28","direction_gz_x"in e||(e.direction_gz_x=50),"direction_gz_y"in e||(e.direction_gz_y=70);for(var C=0,P=Object.entries(e.stn_list);C<P.length;C++){var D,M,k,E,z=r(P[C],2),L=z[0],N=z[1];if(!("transfer"in N))e.stn_list[L].transfer={tick_direc:"none"===N.change_type||"int2"===N.change_type?"r":null===(D=N.change_type)||void 0===D?void 0:D.split("_")[1].split("").slice().reverse()[0],paid_area:-1===(null===(M=N.change_type)||void 0===M?void 0:M.indexOf("osi"))||"p"===(null===(k=N.change_type)||void 0===k?void 0:k.split("_")[1][0]),osi_names:-1!==(null===(E=N.change_type)||void 0===E?void 0:E.indexOf("osi"))?[N.interchange[1][0]]:[],info:2===N.interchange.length?[N.interchange[0],N.interchange[1].slice(1)]:N.interchange};delete e.stn_list[L].change_type,delete e.stn_list[L].interchange}for(var I=0,W=Object.entries(e.stn_list);I<W.length;I++){var U=r(W[I],2),Z=U[0],G=U[1];"services"in G||(e.stn_list[Z].services=["local"]),"facility"in G||(e.stn_list[Z].facility="usage"in G?G.usage:""),delete e.stn_list[Z].usage}"customiseMTRDest"in e||(e.customiseMTRDest={isLegacy:e.dest_legacy||!1,terminal:!1}),delete e.dest_legacy,"svgWidth"in e||(e.svgWidth={destination:e.svg_dest_width,runin:e.svg_dest_width,railmap:e.svg_width,indoor:e.svg_width}),"indoor"in e.svgWidth||(e.svgWidth.indoor=e.svgWidth.railmap),delete e.svg_width,delete e.svg_dest_width,"notesGZMTR"in e||(e.notesGZMTR=[]),e.notesGZMTR=null===(n=e.notesGZMTR)||void 0===n?void 0:n.map((function(e){return 4===e.length?e.concat([!1]):e})),delete e.char_form,delete e.show_outer,delete e.strip_pc,delete e.txt_bg_gap,"namePosMTR"in e||(e.namePosMTR={isStagger:!0,isFlip:e.txt_flip}),delete e.txt_flip,Object.keys(e.stn_list).forEach((function(n){"secondaryName"in e.stn_list[n]?!1!==e.stn_list[n].secondaryName&&","===e.stn_list[n].secondaryName.join()&&(e.stn_list[n].secondaryName=!1):e.stn_list[n].secondaryName=!1,"type"in e.stn_list[n].transfer&&delete e.stn_list[n].transfer.type})),e.style=void 0!==e.style&&Object.values(R).includes(e.style)?e.style:R.MTR,e.coline=null!==(o=e.coline)&&void 0!==o?o:[],e.loop=null!==(a=e.loop)&&void 0!==a&&a,e.loop_info=void 0===e.loop_info?{bank:!0,left_and_right_factor:0,bottom_factor:1}:t(t({},e.loop_info),{},{bottom_factor:Math.max(e.loop_info.bottom_factor,1)});for(var V=0,F=Object.entries(e.stn_list);V<F.length;V++){var H=r(F[V],2),B=H[0];"loop_pivot"in H[1]||(e.stn_list[B].loop_pivot=!1)}return Array.isArray(e.coline)&&(e.coline=e.coline.reduce((function(e,n){return t(t({},e),{},i({},T(4),n))}),{})),!1===e.platform_num&&(e.platform_num=""),Object.values(e.stn_list).forEach((function(n){var t,i,r=n;r.one_line=null!==(t=r.one_line)&&void 0!==t&&t,r.int_padding=null!==(i=r.int_padding)&&void 0!==i?i:e.loop?250:355})),void 0===e.branchSpacingPct&&(e.style===R.SHMetro?e.branchSpacingPct=Math.round(e.branch_spacing/e.svg_height*300):e.branchSpacingPct=Math.round(e.branch_spacing/e.svg_height*200),delete e.branch_spacing),A(e),e}));var A=function(e){for(var n=function(){var n=r(i[t],2),o=n[0],a=n[1],s=a.transfer.info;s&&(e.stn_list[o].transfer.groups=s.map((function(e,n){return e.length?{name:a.transfer.osi_names[n-1],lines:e.map((function(e){var n=e;return{theme:n.slice(0,4),name:n.slice(4,6)}}))}:{lines:[]}}))),delete e.stn_list[o].transfer.info,delete e.stn_list[o].transfer.osi_names},t=0,i=Object.entries(e.stn_list);t<i.length;t++)n()}}}}))}();
