import{u as O,r as u,j as y,R as P,a as i,H as B,b as _,c as h,B as M,d as U,e as $,f as C,g as T,h as E,i as j,k as x,l as z,m as H,n as D,o as F,p as q,q as J,s as V,t as Y,P as W,C as G,v as K,I as Q}from"./vendor-f64b48da.js";function Je(){import.meta.url,import("_").catch(()=>1);async function*e(){}}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();const X="modulepreload",Z=function(e){return"/rmg-templates/"+e},L={},v=function(n,t,o){if(!t||t.length===0)return n();const a=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=Z(s),s in L)return;L[s]=!0;const r=s.endsWith(".css"),l=r?'[rel="stylesheet"]':"";if(!!o)for(let m=a.length-1;m>=0;m--){const d=a[m];if(d.href===s&&(!r||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const c=document.createElement("link");if(c.rel=r?"stylesheet":X,r||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),r)return new Promise((m,d)=>{c.addEventListener("load",m),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>n())};function ee(){const{t:e}=O(),n=u.getEnv(),t=u.getAppVersion();return y(P,{children:[i(B,{as:"h4",size:"md",children:e("RMG Templates")}),i(_,{environment:n,version:t})]})}const te=h.lazy(()=>v(()=>import("./templates-view-0d46cc92.js"),["assets/templates-view-0d46cc92.js","assets/vendor-f64b48da.js","assets/constant-fb6d3be3.js"])),ne=h.lazy(()=>v(()=>import("./ticket-view-2565362b.js"),["assets/ticket-view-2565362b.js","assets/vendor-f64b48da.js","assets/constant-fb6d3be3.js"]));function ae(){return i(M,{basename:"/rmg-templates/",children:y(U,{children:[i(ee,{}),y($,{children:[i(C,{path:"/new",element:i(T,{suspenseFallback:i(E,{isIndeterminate:!0}),children:i(ne,{})})}),i(C,{path:"/",element:i(T,{suspenseFallback:i(E,{isIndeterminate:!0}),children:i(te,{})})})]})]})})}const oe={companyConfig:x,templateList:z,selectedCompany:""},I=j({name:"app",initialState:oe,reducers:{appendCompanyAndTemplates:(e,n)=>{const{company:t,templates:o}=n.payload;e.companyConfig.push(t),e.templateList[t.id]=o},setSelectedCompany:(e,n)=>{e.selectedCompany=n.payload}}}),{appendCompanyAndTemplates:se,setSelectedCompany:Ye}=I.actions,re=I.reducer,ie=e=>{const n=document.createElement("details");n.setAttribute("repo","rmg-templates"),n.setAttribute("company",e.id),n.setAttribute("line","00config");const t=document.createElement("summary");t.textContent="New company: "+e.name.en,n.append(t);const o=document.createElement("details");return o.setAttribute("type","name"),o.textContent=JSON.stringify(e.name),n.append(o),n},le=(e,n,t,o,a)=>{const s=document.createElement("details");s.setAttribute("repo","rmg-templates"),s.setAttribute("company",e),s.setAttribute("line",n),s.setAttribute("major",t.toString());const r=document.createElement("summary");r.textContent=`${e}/${n}`+(t?"(M)":""),s.append(r);const l=document.createElement("details");l.setAttribute("type","name"),l.textContent=JSON.stringify(o),s.append(l);const p=document.createElement("details");return p.setAttribute("type","param"),p.textContent=JSON.stringify(a),s.append(p),s},N=()=>({id:crypto.randomUUID(),line:"",newLine:"",majorUpdate:!1,templateName:{en:"","zh-Hans":"","zh-Hant":"",ko:""},param:void 0}),b={company:"",newCompany:"",companyName:{en:"","zh-Hans":"","zh-Hant":"",ko:""},templates:[]},S=j({name:"ticket",initialState:b,reducers:{setCompany:(e,n)=>{e.company=n.payload},setNewCompany:(e,n)=>{e.newCompany=n.payload},setCompanyNameByLang:(e,n)=>{const{lang:t,name:o}=n.payload;e.companyName[t]=o},addTemplate:e=>{e.templates.push(N())},setTemplateLineById:(e,n)=>{var r,l,p,c,m,d,w;const{id:t,line:o,name:a}=n.payload,s={...(r=e.templates.find(f=>f.id===t))!=null?r:N(),line:o};a&&(s.templateName.en=(l=a.en)!=null?l:"",s.templateName["zh-Hans"]=(p=a["zh-Hans"])!=null?p:"",s.templateName["zh-Hant"]=(d=(m=(c=a["zh-Hant"])!=null?c:a["zh-HK"])!=null?m:a["zh-TW"])!=null?d:"",s.templateName.ko=(w=a.ko)!=null?w:""),e.templates=e.templates.map(f=>f.id===t?s:f)},setTemplateNewLineById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,newLine:n.payload.newLine}:t)},setTemplateMajorFlagById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,majorUpdate:n.payload.majorUpdate}:t)},setTemplateLineNameById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,templateName:{...t.templateName,[n.payload.lang]:n.payload.name}}:t)},setTemplateParamById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,param:n.payload.param}:t)},removeTemplate:(e,n)=>{e.templates=e.templates.filter(t=>t.id!==n.payload)},resetTicket:()=>b}}),We={getCompanyEnglishName:(e,n)=>{var t,o,a;return e.company==="new"?e.companyName.en:(a=(o=(t=n.find(s=>s.id===e.company))==null?void 0:t.name)==null?void 0:o.en)!=null?a:""},getCompanyBlock:e=>e.company!=="new"?null:ie({id:e.newCompany,name:e.companyName}),getTemplateBlocks:e=>{const n=e.company==="new"?e.newCompany:e.company;return e.templates.map(t=>{const o=t.line==="new"?t.newLine:t.line,a=t.line!=="new"&&t.majorUpdate;return le(n,o,a,t.templateName,t.param)})},getCompanyErrors:e=>{const n=[],{company:t,newCompany:o,companyName:a}=e;return(!t||t==="new"&&!o)&&n.push("COMPANY_CODE_UNDEFINED"),t==="new"&&Object.values(a).some(s=>!s)&&n.push("COMPANY_NAME_INCOMPLETE"),n},getTemplateErrors:e=>{const n={Overall:[]},{templates:t}=e;return t.length===0&&n.Overall.push("TEMPLATE_SECTION_EMPTY"),t.some(o=>!o.line||o.line==="new"&&!o.newLine)&&n.Overall.push("TEMPLATE_CODE_UNDEFINED"),new Set(t.map(o=>o.line==="new"?o.newLine:o.line)).size!==t.length&&n.Overall.push("TEMPLATE_CODE_DUPLICATED"),t.forEach(o=>{const a=[];Object.values(o.templateName).some(s=>!s)&&a.push("TEMPLATE_NAME_INCOMPLETE"),o.param||a.push("TEMPLATE_PARAM_UNDEFINED"),n["Line "+o.line||o.newLine]=a}),n},getMajorUpdateNames:(e,n)=>{const{company:t,templates:o}=e;return t==="new"?[]:o.filter(a=>a.majorUpdate&&a.line!=="new").map(a=>{var r;const s=(r=n[t].find(l=>l.filename===a.line))==null?void 0:r.name;return s?Object.values(s).join("/"):a.line})}},{setCompany:Ge,setNewCompany:Ke,setCompanyNameByLang:Qe,addTemplate:Xe,setTemplateLineById:Ze,setTemplateNewLineById:et,setTemplateMajorFlagById:tt,setTemplateLineNameById:nt,setTemplateParamById:at,removeTemplate:ot,resetTicket:st}=S.actions,ce=S.reducer,me=H(),g=D({reducer:{app:re,ticket:ce},middleware:e=>e().prepend(me.middleware)}),rt=()=>F(),it=q;window.rmgStore=g;const pe={},de="关闭",ue="公司",fe="线路",ye="名称",he="打开",ge="风格",we="模板",Ce="上传者",Te={"Add a company...":"添加公司...","Add a line...":"添加线路...","Add item":"添加项目","Add or update templates":"添加或更新模本","Briefly describe your changes and provide justification":"简洁地描述您的改动并提供理由","Click copy button and paste into issue body":"点击复制按钮然后粘贴到 Issue 正文",Close:de,Company:ue,"Follow the instructions below to open an Issue":"按下方的指引打开 Issue","Justification for major update of":"重大更新的理由：",Line:fe,"Line code":"线路代码","Major update":"重大更新",Name:ye,Open:he,"Please provide suitable source and justification.":"请您提供适当的来源和理由。","Railway company":"铁路公司",Style:ge,"Submit templates":"提交模板",Templates:we,"Toggling on 'Major update' will update the uploader field of the template and you are required enter extra justification for it.":"打开“重大更新”选项会更新模板的上传者栏位。您需要为此提供额外的理由。","Upload templates":"上传模板",Uploader:Ce,"Your inputs contain the following errors. Please fix it before submitting.":"您的输入存在以下问题，请在提交前修正他們。"},Ee="關閉",Le="公司",Ne="路線",be="名稱",Ae="開啟",je="風格",ve="範本",Ie="上載者",Se={"Add a company...":"新增公司...","Add a line...":"新增路線...","Add item":"新增項目","Add or update templates":"新增或更新範本","Briefly describe your changes and provide justification":"簡短地描述你的變更並提供理由","Click copy button and paste into issue body":"點擊複製按鈕並於 Issue 正文內貼上",Close:Ee,Company:Le,"Follow the instructions below to open an Issue":"按下方的指引開啟 Issue","Justification for major update of":"重大更新的理由：",Line:Ne,"Line code":"路線代碼","Major update":"重大更新",Name:be,Open:Ae,"Please provide suitable source and justification.":"請你提供適當的來源及理由。","Railway company":"鐵路公司",Style:je,"Submit templates":"提交範本",Templates:ve,"Toggling on 'Major update' will update the uploader field of the template and you are required enter extra justification for it.":"開啟「重大更新」選項會更新範本的上載者欄位。你需要為此提供額外的理由。","Upload templates":"上載範本",Uploader:Ie,"Your inputs contain the following errors. Please fix it before submitting.":"你的輸入存在以下問題，請於提交前修正他們。"},ke="닫기",Re="회사",Oe="노선",Pe="명칭",Be="열기",_e="스타일",Me="템플릿",Ue="업로더",$e={"Add a company...":"회사 추가","Add a line...":"노선 추가","Add item":"프로젝트 추가","Add or update templates":"템플릿 추가 또는 업데이트","Briefly describe your changes and provide justification":"변경 사항을 간결하게 설명하고 이유를 제공하세요","Click copy button and paste into issue body":"복사 단추를 누른 다음 Issue 본문에 붙여넣기",Close:ke,Company:Re,"Follow the instructions below to open an Issue":"아래 안내로 Issue 열기","Justification for major update of":"주요 업데이트 이유:",Line:Oe,"Line code":"노선 코드","Major update":"주요 업데이트",Name:Pe,Open:Be,"Please provide suitable source and justification.":"당신이 적당한 출처와 이유를 제공해 주십시오.","Railway company":"철도회사",Style:_e,"Submit templates":"템플릿 제출",Templates:Me,"Toggling on 'Major update' will update the uploader field of the template and you are required enter extra justification for it.":"'주요 업데이트' 옵션을 열면 템플릿의 게시자 필드가 업데이트됩니다.이를 위한 추가적인 이유가 필요합니다.","Upload templates":"업로드 템플릿",Uploader:Ue,"Your inputs contain the following errors. Please fix it before submitting.":"귀하의 입력에 다음과 같은 문제가 있으니 제출하기 전에 수정해 주십시오."},k=new J.Builder().use(V).withAppName("RMG Templates").withLng(u.getLanguage()).withResource("en",pe).withResource("zh-Hans",Te).withResource("zh-Hant",Se).withResource("ko",$e).build(),xe=e=>{k.changeLanguage(e).then()};u.onLanguageChange(xe);const R=document.querySelector.bind(document),ze=async()=>{var e;try{const t=await(await fetch("/rmg-templates/resources/other-company-config.json")).json(),o=document.createElement("p");return o.textContent="Fetched non-core company config",(e=R("#root"))==null||e.append(o),t}catch(n){return console.error("Failed to fetch non-core company config",n),[]}},He=async e=>{var n;try{const o=await(await fetch("/rmg-templates/resources/templates/"+e+"/00config.json")).json(),a=document.createElement("p");return a.textContent="Fetched templates of "+e,(n=R("#root"))==null||n.append(a),o}catch(t){return console.error("Failed to fetch template list for "+e,t),[]}},De=async e=>{const n=await ze();for(const t of n){const o=await He(t.id);e.dispatch(se({company:t,templates:o}))}};async function Fe(e){await De(e)}let A;const qe=()=>{A=Y(document.getElementById("root")),A.render(i(h.StrictMode,{children:i(W,{store:g,children:i(G,{theme:K,children:i(Q,{i18n:k,children:i(ae,{})})})})}))};u.ready().then(()=>Fe(g)).then(()=>{qe(),u.injectCss()});export{Je as __vite_legacy_guard,rt as a,Ge as b,Ke as c,Qe as d,et as e,tt as f,nt as g,at as h,Xe as i,Ze as j,st as k,ot as r,Ye as s,We as t,it as u};
