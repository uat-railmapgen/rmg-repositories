import{u as P,r as h,j as g,R as _,a as r,H as k,b as B,c as C,B as M,d as $,e as U,f as E,g as w,h as L,i as j,k as x,l as H,m as z,n as D,o as F,p as q,q as W,s as f,t as J,L as l,v as V,P as Y,C as G,w as K,I as Q}from"./vendor-02092407.js";function Ge(){import.meta.url,import("_").catch(()=>1);async function*e(){}}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();const X="modulepreload",Z=function(e){return"/rmg-templates/"+e},N={},v=function(n,t,o){if(!t||t.length===0)return n();const a=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=Z(s),s in N)return;N[s]=!0;const i=s.endsWith(".css"),c=i?'[rel="stylesheet"]':"";if(!!o)for(let p=a.length-1;p>=0;p--){const u=a[p];if(u.href===s&&(!i||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${c}`))return;const m=document.createElement("link");if(m.rel=i?"stylesheet":X,i||(m.as="script",m.crossOrigin=""),m.href=s,document.head.appendChild(m),i)return new Promise((p,u)=>{m.addEventListener("load",p),m.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>n())};function ee(){const{t:e}=P(),n=h.getEnv(),t=h.getAppVersion();return g(_,{children:[r(k,{as:"h4",size:"md",children:e("RMG Templates")}),r(B,{environment:n,version:t})]})}const te=C.lazy(()=>v(()=>import("./templates-view-40d7cdb4.js"),["assets/templates-view-40d7cdb4.js","assets/vendor-02092407.js","assets/constant-151cbb66.js"])),ne=C.lazy(()=>v(()=>import("./ticket-view-6e750900.js"),["assets/ticket-view-6e750900.js","assets/vendor-02092407.js","assets/constant-151cbb66.js"]));function ae(){return r(M,{basename:"/rmg-templates/",children:g($,{children:[r(ee,{}),g(U,{children:[r(E,{path:"/new",element:r(w,{suspenseFallback:r(L,{isIndeterminate:!0}),children:r(ne,{})})}),r(E,{path:"/",element:r(w,{suspenseFallback:r(L,{isIndeterminate:!0}),children:r(te,{})})})]})]})})}const oe={companyConfig:x,templateList:H,selectedCompany:""},I=j({name:"app",initialState:oe,reducers:{appendCompanyAndTemplates:(e,n)=>{const{company:t,templates:o}=n.payload;e.companyConfig.push(t),e.templateList[t.id]=o},setSelectedCompany:(e,n)=>{e.selectedCompany=n.payload}}}),{appendCompanyAndTemplates:se,setSelectedCompany:Qe}=I.actions,ie=I.reducer,re=e=>{const n=document.createElement("details");n.setAttribute("repo","rmg-templates"),n.setAttribute("company",e.id),n.setAttribute("line","00config");const t=document.createElement("summary");t.textContent="New company: "+e.name.en,n.append(t);const o=document.createElement("details");return o.setAttribute("type","name"),o.textContent=JSON.stringify(e.name),n.append(o),n},le=(e,n,t,o,a)=>{const s=document.createElement("details");s.setAttribute("repo","rmg-templates"),s.setAttribute("company",e),s.setAttribute("line",n),s.setAttribute("major",t.toString());const i=document.createElement("summary");i.textContent=`${e}/${n}`+(t?"(M)":""),s.append(i);const c=document.createElement("details");c.setAttribute("type","name"),c.textContent=JSON.stringify(o),s.append(c);const d=document.createElement("details");return d.setAttribute("type","param"),d.textContent=JSON.stringify(a),s.append(d),s},Xe={en:"English","zh-Hans":"Simplified Chinese","zh-Hant":"Traditional Chinese"},b=()=>({id:crypto.randomUUID(),line:"",newLine:"",majorUpdate:!1,templateName:{en:"","zh-Hans":"","zh-Hant":""},param:void 0}),A={company:"",newCompany:"",companyName:{en:"","zh-Hans":"","zh-Hant":""},templates:[]},R=j({name:"ticket",initialState:A,reducers:{setCompany:(e,n)=>{e.company=n.payload},setNewCompany:(e,n)=>{e.newCompany=n.payload},setCompanyNameByLang:(e,n)=>{const{lang:t,name:o}=n.payload;e.companyName[t]=o},addTemplate:e=>{e.templates.push(b())},setTemplateLineById:(e,n)=>{var i,c,d,m,p,u;const{id:t,line:o,name:a}=n.payload,s={...(i=e.templates.find(y=>y.id===t))!=null?i:b(),line:o};a&&(s.templateName.en=(c=a.en)!=null?c:"",s.templateName["zh-Hans"]=(d=a["zh-Hans"])!=null?d:"",s.templateName["zh-Hant"]=(u=(p=(m=a["zh-Hant"])!=null?m:a["zh-HK"])!=null?p:a["zh-TW"])!=null?u:""),e.templates=e.templates.map(y=>y.id===t?s:y)},setTemplateNewLineById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,newLine:n.payload.newLine}:t)},setTemplateMajorFlagById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,majorUpdate:n.payload.majorUpdate}:t)},setTemplateLineNameById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,templateName:{...t.templateName,[n.payload.lang]:n.payload.name}}:t)},setTemplateParamById:(e,n)=>{e.templates=e.templates.map(t=>t.id===n.payload.id?{...t,param:n.payload.param}:t)},removeTemplate:(e,n)=>{e.templates=e.templates.filter(t=>t.id!==n.payload)},resetTicket:()=>A}}),Ze={getCompanyEnglishName:(e,n)=>{var t,o,a;return e.company==="new"?e.companyName.en:(a=(o=(t=n.find(s=>s.id===e.company))==null?void 0:t.name)==null?void 0:o.en)!=null?a:""},getCompanyBlock:e=>e.company!=="new"?null:re({id:e.newCompany,name:e.companyName}),getTemplateBlocks:e=>{const n=e.company==="new"?e.newCompany:e.company;return e.templates.map(t=>{const o=t.line==="new"?t.newLine:t.line,a=t.line!=="new"&&t.majorUpdate;return le(n,o,a,t.templateName,t.param)})},getCompanyErrors:e=>{const n=[],{company:t,newCompany:o,companyName:a}=e;return(!t||t==="new"&&!o)&&n.push("COMPANY_CODE_UNDEFINED"),t==="new"&&Object.values(a).some(s=>!s)&&n.push("COMPANY_NAME_INCOMPLETE"),n},getTemplateErrors:e=>{const n={Overall:[]},{templates:t}=e;return t.length===0&&n.Overall.push("TEMPLATE_SECTION_EMPTY"),t.some(o=>!o.line||o.line==="new"&&!o.newLine)&&n.Overall.push("TEMPLATE_CODE_UNDEFINED"),new Set(t.map(o=>o.line==="new"?o.newLine:o.line)).size!==t.length&&n.Overall.push("TEMPLATE_CODE_DUPLICATED"),t.forEach(o=>{const a=[];Object.values(o.templateName).some(s=>!s)&&a.push("TEMPLATE_NAME_INCOMPLETE"),o.param||a.push("TEMPLATE_PARAM_UNDEFINED"),n["Line "+o.line||o.newLine]=a}),n},getMajorUpdateNames:(e,n)=>{const{company:t,templates:o}=e;return t==="new"?[]:o.filter(a=>a.majorUpdate&&a.line!=="new").map(a=>{var i;const s=(i=n[t].find(c=>c.filename===a.line))==null?void 0:i.name;return s?Object.values(s).join("/"):a.line})}},{setCompany:et,setNewCompany:tt,setCompanyNameByLang:nt,addTemplate:at,setTemplateLineById:ot,setTemplateNewLineById:st,setTemplateMajorFlagById:it,setTemplateLineNameById:rt,setTemplateParamById:lt,removeTemplate:ct,resetTicket:mt}=R.actions,ce=R.reducer,me=z(),T=D({reducer:{app:ie,ticket:ce},middleware:e=>e().prepend(me.middleware)}),pt=()=>F(),dt=q;window.rmgStore=T;const pe={},de="关闭",ue="公司",he="英文",fe="线路",ye="名称",ge="打开",Ce="风格",Te="模板",Ee="上传者",we={"Add a company...":"添加公司...","Add a line...":"添加线路...","Add item":"添加项目","Add or update templates":"添加或更新模本","Briefly describe your changes and provide justification":"简洁地描述您的改动并提供理由","Click copy button and paste into issue body":"点击复制按钮然后粘贴到 Issue 正文",Close:de,Company:ue,English:he,"Follow the instructions below to open an Issue":"按下方的指引打开 Issue","Justification for major update of":"重大更新的理由：",Line:fe,"Line code":"线路代码","Major update":"重大更新",Name:ye,Open:ge,"Please provide suitable source and justification.":"请您提供适当的来源和理由。","Railway company":"铁路公司","Simplified Chinese":"简体中文",Style:Ce,"Submit templates":"提交模板",Templates:Te,"Toggling on 'Major update' will update the uploader field of the template and you are required enter extra justification for it.":"打开“重大更新”选项会更新模板的上传者栏位。您需要为此提供额外的理由。","Traditional Chinese":"繁体中文","Upload templates":"上传模板",Uploader:Ee,"Your inputs contain the following errors. Please fix it before submitting.":"您的输入存在以下问题，请在提交前修正他們。"},Le="關閉",Ne="公司",be="英文",Ae="路線",Se="名稱",je="開啟",ve="風格",Ie="範本",Re="上載者",Oe={"Add a company...":"新增公司...","Add a line...":"新增路線...","Add item":"新增項目","Add or update templates":"新增或更新範本","Briefly describe your changes and provide justification":"簡短地描述你的變更並提供理由","Click copy button and paste into issue body":"點擊複製按鈕並於 Issue 正文內貼上",Close:Le,Company:Ne,English:be,"Follow the instructions below to open an Issue":"按下方的指引開啟 Issue","Justification for major update of":"重大更新的理由：",Line:Ae,"Line code":"路線代碼","Major update":"重大更新",Name:Se,Open:je,"Please provide suitable source and justification.":"請你提供適當的來源及理由。","Railway company":"鐵路公司","Simplified Chinese":"简體中文",Style:ve,"Submit templates":"提交範本",Templates:Ie,"Toggling on 'Major update' will update the uploader field of the template and you are required enter extra justification for it.":"開啟「重大更新」選項會更新範本的上載者欄位。你需要為此提供額外的理由。","Traditional Chinese":"繁體中文","Upload templates":"上載範本",Uploader:Re,"Your inputs contain the following errors. Please fix it before submitting.":"你的輸入存在以下問題，請於提交前修正他們。"},Pe="닫기",_e="회사",ke="영문",Be="노선",Me="명칭",$e="열기",Ue="스타일",xe="템플릿",He="업로더",ze={"Add a company...":"회사 추가","Add a line...":"노선 추가","Add item":"프로젝트 추가","Add or update templates":"템플릿 추가 또는 업데이트","Briefly describe your changes and provide justification":"변경 사항을 간결하게 설명하고 이유를 제공하세요","Click copy button and paste into issue body":"복사 단추를 누른 다음 Issue 본문에 붙여넣기",Close:Pe,Company:_e,English:ke,"Follow the instructions below to open an Issue":"아래 안내로 Issue 열기","Justification for major update of":"주요 업데이트 이유:",Line:Be,"Line code":"노선 코드","Major update":"주요 업데이트",Name:Me,Open:$e,"Please provide suitable source and justification.":"당신이 적당한 출처와 이유를 제공해 주십시오.","Railway company":"철도회사","Simplified Chinese":"중국 간자체",Style:Ue,"Submit templates":"템플릿 제출",Templates:xe,"Toggling on 'Major update' will update the uploader field of the template and you are required enter extra justification for it.":"'주요 업데이트' 옵션을 열면 템플릿의 게시자 필드가 업데이트됩니다.이를 위한 추가적인 이유가 필요합니다.","Traditional Chinese":"중국어 번체자","Upload templates":"업로드 템플릿",Uploader:He,"Your inputs contain the following errors. Please fix it before submitting.":"귀하의 입력에 다음과 같은 문제가 있으니 제출하기 전에 수정해 주십시오."},De=new W.Builder().withResource("en",pe).withResource("zh-Hans",we).withResource("zh-Hant",Oe).withResource("ko",ze).build();f.use(J).init({lng:h.getLanguage(),fallbackLng:{[l.ChineseCN]:[l.ChineseSimp,l.English],[l.ChineseHK]:[l.ChineseTrad,l.English],[l.ChineseTW]:[l.ChineseTrad,l.English],[l.ChineseTrad]:[l.ChineseHK,l.ChineseTW,l.English],default:[l.English]},resources:De}).then(e=>{document.title=e("RMG Templates"),document.documentElement.lang=f.language});const Fe=e=>{f.changeLanguage(e).then(),document.title=f.t("RMG Templates"),document.documentElement.lang=e};h.onLanguageChange(Fe);const O=document.querySelector.bind(document),qe=async()=>{var e;try{const t=await(await fetch("/rmg-templates/resources/other-company-config.json")).json(),o=document.createElement("p");return o.textContent="Fetched non-core company config",(e=O("#root"))==null||e.append(o),t}catch(n){return console.error("Failed to fetch non-core company config",n),[]}},We=async e=>{var n;try{const o=await(await fetch("/rmg-templates/resources/templates/"+e+"/00config.json")).json(),a=document.createElement("p");return a.textContent="Fetched templates of "+e,(n=O("#root"))==null||n.append(a),o}catch(t){return console.error("Failed to fetch template list for "+e,t),[]}},Je=async e=>{const n=await qe();for(const t of n){const o=await We(t.id);e.dispatch(se({company:t,templates:o}))}};async function Ve(e){await Je(e)}let S;const Ye=()=>{S=V(document.getElementById("root")),S.render(r(C.StrictMode,{children:r(Y,{store:T,children:r(G,{theme:K,children:r(Q,{i18n:f,children:r(ae,{})})})})}))};h.ready().then(()=>Ve(T)).then(()=>{Ye(),h.injectCss()});export{Xe as A,Ge as __vite_legacy_guard,pt as a,et as b,tt as c,nt as d,st as e,it as f,rt as g,lt as h,at as i,ot as j,mt as k,ct as r,Qe as s,Ze as t,dt as u};
