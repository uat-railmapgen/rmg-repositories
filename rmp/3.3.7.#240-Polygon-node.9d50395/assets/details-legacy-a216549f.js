!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(t,n,r){return(n=function(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,n||"default");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,u,o=[],l=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(c){s=!0,i=c}finally{try{if(!l&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(s)throw i}}return o}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}System.register(["./chakra-legacy-99ea1e3b.js","./index-legacy-9748d6eb.js","./stations-legacy-8f8c1c16.js","./react-legacy-57266490.js","./misc-nodes-legacy-5976756c.js","./change-types-legacy-1cb4c927.js","./useEvent-legacy-81ca6d24.js"],(function(e,n){"use strict";var u,o,l,s,c,d,f,p,h,b,g,m,y,v,j,x,O,S,A,N,E,C,w,k,W,P,z,T,I,R,D,_,L,M,F,V,$,q,B;return{setters:[function(e){u=e.j,o=e.A,l=e.M,s=e.m,c=e.n,d=e.p,f=e.r,p=e.s,h=e._,b=e.$,g=e.ad},function(e){m=e.c,y=e.i,v=e.x,j=e.z,x=e.j,O=e.ah,S=e.ai,A=e.y,N=e.q,E=e.K,C=e.p,w=e.t,k=e.B,W=e.ag,P=e.n,z=e.aj,T=e.ak,I=e.al,R=e.am,D=e.o},function(e){_=e.s,L=e.R},function(e){M=e.b},function(e){F=e.m},function(e){V=e.d,$=e.e,q=e.f},function(e){B=e.u}],execute:function(){function n(){var e=m().t,t=y(),n=M.useCallback((function(){t(v()),t(j(i.current.export()))}),[t,v,j]),r=x((function(e){return e.runtime})).selected.at(0),i=M.useRef(window.graph),h=a(M.useState(!1),2),b=h[0],g=h[1],A=M.useRef(null),N=a(M.useState(void 0),2),E=N[0],C=N[1],w=i.current.getNodeAttribute(r,"type"),k=Object.fromEntries(Object.entries(_).map((function(t){var n=a(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),W=function(e){e&&E&&(V(i.current,r,E),n()),C(void 0),g(!1)};return u.jsxs(u.Fragment,{children:[u.jsx(O,{label:e("panel.details.info.stationType"),minW:"276",children:u.jsx(S,{options:k,disabledOptions:[w],value:w,onChange:function(e){var t=e.target.value;C(t),g(!0)}})}),u.jsx(o,{isOpen:b,leastDestructiveRef:A,onClose:function(){return W(!1)},children:u.jsx(l,{children:u.jsxs(s,{children:[u.jsx(c,{children:e("warning")}),u.jsx(d,{children:e("panel.details.changeStationTypeContent")}),u.jsxs(f,{children:[u.jsx(p,{ref:A,onClick:function(){return W(!1)},children:e("cancel")}),u.jsx(p,{ml:"2",colorScheme:"red",onClick:function(){return W(!0)},children:e("panel.details.changeType")})]})]})})})]})}function K(){var e=m().t,t=y(),n=M.useCallback((function(){t(A()),t(j(g.current.export()))}),[t,A,j]),r=x((function(e){return e.runtime})),i=r.selected,h=r.theme,b=i.at(0),g=M.useRef(window.graph),v=a(M.useState(!1),2),k=v[0],W=v[1],P=M.useRef(null),z=Object.fromEntries(Object.entries(N).map((function(t){var n=a(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),T=a(M.useState(g.current.getEdgeAttribute(b,"type")),2),I=T[0],R=T[1],D=a(M.useState(void 0),2),_=D[0],L=D[1],F=Object.fromEntries(Object.entries(E).map((function(t){var n=a(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),V=a(M.useState(g.current.getEdgeAttribute(b,"style")),2),B=V[0],K=V[1],U=a(M.useState(void 0),2),G=U[0],H=U[1],J=Object.values(C).filter((function(e){return!E[B].metadata.supportLinePathType.includes(e)})),Q=Object.values(w).filter((function(e){return!E[e].metadata.supportLinePathType.includes(I)})),X=function(e){e&&(_?(_&&($(g.current,b,_),R(g.current.getEdgeAttribute(b,"type")),n()),L(void 0)):G&&(G&&(q(g.current,b,G,h),K(g.current.getEdgeAttribute(b,"style")),n()),H(void 0))),W(!1)};return u.jsxs(u.Fragment,{children:[u.jsx(O,{label:e("panel.details.info.linePathType"),minW:"276",children:u.jsx(S,{options:z,disabledOptions:J,defaultValue:I,value:I,onChange:function(e){var t=e.target.value;L(t),W(!0)}})}),u.jsx(O,{label:e("panel.details.info.lineStyleType"),minW:"276",children:u.jsx(S,{options:F,disabledOptions:Q,defaultValue:B,value:B,onChange:function(e){var t=e.target.value;H(t),W(!0)}})}),u.jsx(o,{isOpen:k,leastDestructiveRef:P,onClose:function(){return X(!1)},children:u.jsx(l,{children:u.jsxs(s,{children:[u.jsx(c,{children:e("warning")}),u.jsx(d,{children:e("panel.details.changeLineTypeContent")}),u.jsxs(f,{children:[u.jsx(p,{ref:P,onClick:function(){return X(!1)},children:e("cancel")}),u.jsx(p,{ml:"2",colorScheme:"red",onClick:function(){return X(!0)},children:e("panel.details.changeType")})]})]})})})]})}function U(){var e=m().t,t=y(),r=M.useCallback((function(){t(v()),t(A()),t(j(o.current.export()))}),[t,A,j]),i=x((function(e){return e.runtime})).selected,a=i.at(0),o=M.useRef(window.graph),l=[{type:"input",label:e("panel.details.info.id"),value:i.length>0?i.join(", "):"undefined",minW:276},{type:"select",label:e("panel.details.info.zIndex"),value:a?o.current.hasNode(a)?o.current.getNodeAttribute(a,"zIndex"):o.current.hasEdge(a)?o.current.getEdgeAttribute(a,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:11},(function(e,t){return[t-5,(t-5).toString()]}))),onChange:function(e){return function(e){var t=Math.min(Math.max(e,-5),5);o.current.hasNode(a)&&o.current.setNodeAttribute(a,"zIndex",t),o.current.hasEdge(a)&&o.current.setEdgeAttribute(a,"zIndex",t),r()}(Number(e))}}];return 0===i.length||i.length>1&&l.push({type:"input",label:e("panel.details.info.type"),value:"multiple selection",minW:276}),u.jsxs(h,{p:1,children:[u.jsx(b,{as:"h5",size:"sm",children:e("panel.details.info.title")}),u.jsx(L,{fields:l,minW:130}),1===i.length&&a.startsWith("stn")&&o.current.hasNode(a)&&u.jsx(n,{}),1===i.length&&a.startsWith("line")&&o.current.hasEdge(a)&&u.jsx(K,{})]})}function G(){var e=m().t,t=y(),n=x((function(e){return e.runtime})).selected,r=n.at(0),i=M.useRef(window.graph),o=a(M.useState("undefined"),2),l=o[0],s=o[1],c=a(M.useState("undefined"),2),d=c[0],f=c[1],g=a(M.useState("undefined"),2),v=g[0],j=g[1],O=a(M.useState("undefined"),2),S=O[0],A=O[1];M.useEffect((function(){if(null!=r&&r.startsWith("line")){var e=a(i.current.extremities(r),2),t=e[0],n=e[1];if(s(t),f(n),t.startsWith("stn")){var u,o,l=i.current.getNodeAttribute(t,"type");j(null!==(u=null===(o=i.current.getNodeAttribute(t,l))||void 0===o?void 0:o.names.at(0))&&void 0!==u?u:"undefined")}if(n.startsWith("stn")){var c,d,p=i.current.getNodeAttribute(n,"type");A(null!==(c=null===(d=i.current.getNodeAttribute(n,p))||void 0===d?void 0:d.names.at(0))&&void 0!==c?c:"undefined")}}}),[n]);var N=B((function(){t(k()),t(W(l))})),E=B((function(){t(k()),t(W(d))})),C=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:u.jsx(p,{flex:1,size:"sm",variant:"link",onClick:N,children:l})},{type:"custom",label:e("panel.details.lineExtremities.target"),component:u.jsx(p,{flex:1,size:"sm",variant:"link",onClick:E,children:d})},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:v},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:S}];return u.jsxs(h,{p:1,children:[u.jsx(b,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),u.jsx(L,{fields:C,minW:130})]})}function H(){var e=m().t,t=y(),n=M.useCallback((function(){t(v()),t(A()),t(j(s.current.export()))}),[t,v,A,j]),r=x((function(e){return e.runtime})),i=r.selected,o=r.refresh.nodes,l=i.at(0),s=M.useRef(window.graph),c=a(M.useState({x:0,y:0}),2),d=c[0],f=c[1];M.useEffect((function(){if(null!=l&&l.startsWith("stn")||null!=l&&l.startsWith("misc_node_")){var e=s.current.getNodeAttribute(l,"x"),t=s.current.getNodeAttribute(l,"y");f({x:e,y:t})}}),[o,i]);var p=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:d.x.toString(),validator:function(e){return!Number.isNaN(e)},onChange:function(e){s.current.mergeNodeAttributes(l,{x:Number(e)}),n()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:d.y.toString(),validator:function(e){return!Number.isNaN(e)},onChange:function(e){s.current.mergeNodeAttributes(l,{y:Number(e)}),n()}}];return u.jsxs(h,{p:1,children:[u.jsx(b,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),u.jsx(L,{fields:p,minW:130})]})}var J=r(r({},_),F);e("default",(function(){var e=m().t,n=y(),r=M.useRef(window.graph),o=M.useCallback((function(){n(v()),n(A()),n(j(r.current.export()))}),[n,v,A,j]),l=x((function(e){return e.runtime})),s=l.selected,c=l.mode,d=a(M.useState(""),2),f=(d[0],d[1]);M.useEffect((function(){var e,t=s.at(0);r.current.hasEdge(t)&&f(null!==(e=r.current.getEdgeAttribute(t,"reconcileId"))&&void 0!==e?e:"undefined")}),[s]);var O,S=[],C=s.at(0);if(1===s.length&&r.current.hasNode(C)){var w=r.current.getNodeAttribute(C,"type"),W=r.current.getNodeAttribute(C,w);S.push.apply(S,t(J[w].fields.filter((function(e){return"custom"!==e.type})).map((function(t){var a,u,o;return{type:t.type,label:e(t.label),value:null===(a=t.value)||void 0===a?void 0:a.call(t,W),isChecked:null===(u=t.isChecked)||void 0===u?void 0:u.call(t,W),hidden:null===(o=t.hidden)||void 0===o?void 0:o.call(t,W),options:t.options,disabledOptions:t.disabledOptions&&t.disabledOptions(W),validator:t.validator,oneLine:t.oneLine,onChange:function(a){var u;try{u=t.onChange(a,W)}catch(o){return void n(P({status:"error",message:e("err-code.".concat(o))}))}r.current.mergeNodeAttributes(C,i({},w,u)),n(v()),n(j(r.current.export()))}}}))).concat(t(J[w].fields.filter((function(e){return"custom"===e.type})))))}if(1===s.length&&r.current.hasEdge(C)){var _=r.current.getEdgeAttribute(C,"type"),F=r.current.getEdgeAttribute(C,_);S.push.apply(S,t(N[_].fields.map((function(t){return{type:t.type,label:e(t.label),value:t.value(F),options:t.options,disabledOptions:t.disabledOptions&&t.disabledOptions(F),validator:t.validator,onChange:function(e){r.current.mergeEdgeAttributes(C,i({},_,t.onChange(e,F))),n(A()),n(j(r.current.export()))}}}))));var V=r.current.getEdgeAttribute(C,"style"),$=r.current.getEdgeAttribute(C,V);S.push.apply(S,t(E[V].fields.filter((function(e){return"custom"!==e.type})).map((function(t){return{type:t.type,label:e(t.label),value:t.value($),options:t.options,disabledOptions:t.disabledOptions&&t.disabledOptions($),validator:t.validator,onChange:function(e){r.current.mergeEdgeAttributes(C,i({},V,t.onChange(e,$))),n(A()),n(j(r.current.export()))}}})))),S.push.apply(S,t(E[V].fields.filter((function(e){return"custom"===e.type}))))}if(1===s.length&&r.current.hasNode(C)){var q=r.current.getNodeAttribute(C,"type");O=J[q].attrsComponent}return u.jsxs(z,{isOpen:s.length>0&&!c.startsWith("line"),width:300,header:"Dummy header",alwaysOverlay:!0,children:[u.jsx(T,{onClose:function(){return n(k())},children:e("panel.details.header")}),u.jsxs(I,{children:[u.jsx(U,{}),1===s.length&&r.current.hasNode(C)&&u.jsx(H,{}),1===s.length&&r.current.hasEdge(C)&&u.jsx(G,{}),1===s.length&&u.jsxs(h,{p:1,children:[u.jsx(b,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),u.jsx(L,{fields:S,minW:276}),O&&u.jsx(O,{})]})]}),u.jsx(R,{children:u.jsxs(g,{children:[1===s.length&&r.current.hasNode(s.at(0))&&u.jsx(p,{size:"sm",variant:"outline",onClick:function(){return function(e){var t=structuredClone(r.current.getNodeAttributes(e));t.y+=50;var i=e.startsWith("stn")?"stn_".concat(D(10)):"misc_node_".concat(D(10));r.current.addNode(i,t),n(v()),n(j(r.current.export()))}(s.at(0))},children:e("panel.details.footer.duplicate")}),u.jsx(p,{size:"sm",variant:"outline",onClick:function(){return e=s,n(k()),void e.forEach((function(e){r.current.hasNode(e)?(r.current.dropNode(e),o()):r.current.hasEdge(e)&&(r.current.dropEdge(e),n(A()),n(j(r.current.export())))}));var e},children:e("panel.details.footer.remove")})]})})]})}))}}}))}();
