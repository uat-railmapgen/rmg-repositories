"use strict";(self.webpackChunkrmp=self.webpackChunkrmp||[]).push([[5316],{6737:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var r=n(4942),i=n(3433),u=n(9439),a=n(1413),s=n(2791),l=n(9230),o=n(4087),c=n(5946),d=n(2893),f=n(3306),p=n(5984),h=n(1106),g=n(7339),m=n(8284),v=n(3671),b=n(3649),x=n(6882),y=n(7599),j=n(3948),N=n(9671),E=n(7705),A=n(7496),Z=n(3578),O=n(1122),C=n(184);function S(){var e=(0,l.$G)().t,t=(0,g.u5)(),n=s.useCallback((function(){t((0,v.ML)()),t((0,m.DR)(i.current.export()))}),[t,v.ML,m.DR]),r=(0,g.Qy)((function(e){return e.runtime})).selected.at(0),i=s.useRef(window.graph),a=s.useState(!1),o=(0,u.Z)(a,2),c=o[0],d=o[1],p=s.useRef(null),x=s.useState(void 0),y=(0,u.Z)(x,2),S=y[0],R=y[1],z=i.current.getNodeAttribute(r,"type"),k=Object.fromEntries(Object.entries(b.Z).map((function(t){var n=(0,u.Z)(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),w=function(e){e&&S&&((0,O.Kz)(i.current,r,S),n()),R(void 0),d(!1)};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(h.Nv,{label:e("panel.details.info.stationType"),minW:"276",children:(0,C.jsx)(h.mg,{options:k,disabledOptions:[z],value:z,onChange:function(e){var t=e.target.value;R(t),d(!0)}})}),(0,C.jsx)(j.a,{isOpen:c,leastDestructiveRef:p,onClose:function(){return w(!1)},children:(0,C.jsx)(N.Z,{children:(0,C.jsxs)(j._,{children:[(0,C.jsx)(E.x,{children:e("warning")}),(0,C.jsx)(A.f,{children:e("panel.details.changeStationTypeContent")}),(0,C.jsxs)(Z.m,{children:[(0,C.jsx)(f.z,{ref:p,onClick:function(){return w(!1)},children:e("cancel")}),(0,C.jsx)(f.z,{ml:"2",colorScheme:"red",onClick:function(){return w(!0)},children:e("panel.details.changeType")})]})]})})})]})}var R=n(8817);function z(){var e=(0,l.$G)().t,t=(0,g.u5)(),n=s.useCallback((function(){t((0,v.lH)()),t((0,m.DR)(c.current.export()))}),[t,v.lH,m.DR]),r=(0,g.Qy)((function(e){return e.runtime})),i=r.selected,a=r.theme,o=i.at(0),c=s.useRef(window.graph),d=s.useState(!1),p=(0,u.Z)(d,2),b=p[0],x=p[1],S=s.useRef(null),z=Object.fromEntries(Object.entries(y.V).map((function(t){var n=(0,u.Z)(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),k=s.useState(c.current.getEdgeAttribute(o,"type")),w=(0,u.Z)(k,2),W=w[0],D=w[1],L=s.useState(void 0),I=(0,u.Z)(L,2),M=I[0],_=I[1],H=Object.fromEntries(Object.entries(y.b).map((function(t){var n=(0,u.Z)(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),T=s.useState(c.current.getEdgeAttribute(o,"style")),G=(0,u.Z)(T,2),V=G[0],P=G[1],Q=s.useState(void 0),X=(0,u.Z)(Q,2),$=X[0],J=X[1],B=Object.values(R.y).filter((function(e){return!y.b[V].metadata.supportLinePathType.includes(e)})),K=Object.values(R.R).filter((function(e){return!y.b[e].metadata.supportLinePathType.includes(W)})),U=function(e){e&&(M?(M&&((0,O.Vz)(c.current,o,M),D(c.current.getEdgeAttribute(o,"type")),n()),_(void 0)):$&&($&&((0,O.Bd)(c.current,o,$,a),P(c.current.getEdgeAttribute(o,"style")),n()),J(void 0))),x(!1)};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(h.Nv,{label:e("panel.details.info.linePathType"),minW:"276",children:(0,C.jsx)(h.mg,{options:z,disabledOptions:B,defaultValue:W,value:W,onChange:function(e){var t=e.target.value;_(t),x(!0)}})}),(0,C.jsx)(h.Nv,{label:e("panel.details.info.lineStyleType"),minW:"276",children:(0,C.jsx)(h.mg,{options:H,disabledOptions:K,defaultValue:V,value:V,onChange:function(e){var t=e.target.value;J(t),x(!0)}})}),(0,C.jsx)(j.a,{isOpen:b,leastDestructiveRef:S,onClose:function(){return U(!1)},children:(0,C.jsx)(N.Z,{children:(0,C.jsxs)(j._,{children:[(0,C.jsx)(E.x,{children:e("warning")}),(0,C.jsx)(A.f,{children:e("panel.details.changeLineTypeContent")}),(0,C.jsxs)(Z.m,{children:[(0,C.jsx)(f.z,{ref:S,onClick:function(){return U(!1)},children:e("cancel")}),(0,C.jsx)(f.z,{ml:"2",colorScheme:"red",onClick:function(){return U(!0)},children:e("panel.details.changeType")})]})]})})})]})}function k(){var e=(0,l.$G)().t,t=(0,g.u5)(),n=s.useCallback((function(){t((0,v.ML)()),t((0,v.lH)()),t((0,m.DR)(u.current.export()))}),[t,v.lH,m.DR]),r=(0,g.Qy)((function(e){return e.runtime})).selected,i=r.at(0),u=s.useRef(window.graph),a=[{type:"input",label:e("panel.details.info.id"),value:r.length>0?r.join(", "):"undefined",minW:276},{type:"select",label:e("panel.details.info.zIndex"),value:i?u.current.hasNode(i)?u.current.getNodeAttribute(i,"zIndex"):u.current.hasEdge(i)?u.current.getEdgeAttribute(i,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:11},(function(e,t){return[t-5,(t-5).toString()]}))),onChange:function(e){return function(e){var t=Math.min(Math.max(e,-5),5);u.current.hasNode(i)&&u.current.setNodeAttribute(i,"zIndex",t),u.current.hasEdge(i)&&u.current.setEdgeAttribute(i,"zIndex",t),n()}(Number(e))}}];return 0===r.length||r.length>1&&a.push({type:"input",label:e("panel.details.info.type"),value:"multiple selection",minW:276}),(0,C.jsxs)(o.xu,{p:1,children:[(0,C.jsx)(c.X,{as:"h5",size:"sm",children:e("panel.details.info.title")}),(0,C.jsx)(h.M5,{fields:a,minW:130}),1===r.length&&i.startsWith("stn")&&u.current.hasNode(i)&&(0,C.jsx)(S,{}),1===r.length&&i.startsWith("line")&&u.current.hasEdge(i)&&(0,C.jsx)(z,{})]})}function w(){var e=(0,l.$G)().t,t=(0,g.u5)(),n=s.useCallback((function(){t((0,v.ML)()),t((0,v.lH)()),t((0,m.DR)(f.current.export()))}),[t,v.ML,v.lH,m.DR]),r=(0,g.Qy)((function(e){return e.runtime})),i=r.selected,a=r.refresh.nodes,d=i.at(0),f=s.useRef(window.graph),p=s.useState({x:0,y:0}),b=(0,u.Z)(p,2),x=b[0],y=b[1];s.useEffect((function(){if(null!==d&&void 0!==d&&d.startsWith("stn")||null!==d&&void 0!==d&&d.startsWith("misc_node_")){var e=f.current.getNodeAttribute(d,"x"),t=f.current.getNodeAttribute(d,"y");y({x:e,y:t})}}),[a,i]);var j=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:x.x.toString(),validator:function(e){return!Number.isNaN(e)},onChange:function(e){f.current.mergeNodeAttributes(d,{x:Number(e)}),n()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:x.y.toString(),validator:function(e){return!Number.isNaN(e)},onChange:function(e){f.current.mergeNodeAttributes(d,{y:Number(e)}),n()}}];return(0,C.jsxs)(o.xu,{p:1,children:[(0,C.jsx)(c.X,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),(0,C.jsx)(h.M5,{fields:j,minW:130})]})}var W=n(8617);function D(){var e=(0,l.$G)().t,t=(0,g.u5)(),n=(0,g.Qy)((function(e){return e.runtime})).selected,r=n.at(0),i=s.useRef(window.graph),a=s.useState("undefined"),d=(0,u.Z)(a,2),p=d[0],m=d[1],b=s.useState("undefined"),x=(0,u.Z)(b,2),y=x[0],j=x[1],N=s.useState("undefined"),E=(0,u.Z)(N,2),A=E[0],Z=E[1],O=s.useState("undefined"),S=(0,u.Z)(O,2),R=S[0],z=S[1];s.useEffect((function(){if(null!==r&&void 0!==r&&r.startsWith("line")){var e=i.current.extremities(r),t=(0,u.Z)(e,2),n=t[0],a=t[1];if(m(n),j(a),n.startsWith("stn")){var s,l,o=i.current.getNodeAttribute(n,"type");Z(null!==(s=null===(l=i.current.getNodeAttribute(n,o))||void 0===l?void 0:l.names.at(0))&&void 0!==s?s:"undefined")}if(a.startsWith("stn")){var c,d,f=i.current.getNodeAttribute(a,"type");z(null!==(c=null===(d=i.current.getNodeAttribute(a,f))||void 0===d?void 0:d.names.at(0))&&void 0!==c?c:"undefined")}}}),[n]);var k=(0,W.ZP)((function(){t((0,v.x_)()),t((0,v.Gv)(p))})),w=(0,W.ZP)((function(){t((0,v.x_)()),t((0,v.Gv)(y))})),D=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:(0,C.jsx)(f.z,{flex:1,size:"sm",variant:"link",onClick:k,children:p})},{type:"custom",label:e("panel.details.lineExtremities.target"),component:(0,C.jsx)(f.z,{flex:1,size:"sm",variant:"link",onClick:w,children:y})},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:A},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:R}];return(0,C.jsxs)(o.xu,{p:1,children:[(0,C.jsx)(c.X,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),(0,C.jsx)(h.M5,{fields:D,minW:130})]})}var L=(0,a.Z)((0,a.Z)({},b.Z),x.Z),I=function(){var e=(0,l.$G)().t,t=(0,g.u5)(),n=s.useRef(window.graph),a=s.useCallback((function(){t((0,v.ML)()),t((0,v.lH)()),t((0,m.DR)(n.current.export()))}),[t,v.ML,v.lH,m.DR]),b=(0,g.Qy)((function(e){return e.runtime})),x=b.selected,j=b.mode,N=s.useState(""),E=(0,u.Z)(N,2),A=(E[0],E[1]);s.useEffect((function(){var e,t=x.at(0);n.current.hasEdge(t)&&A(null!==(e=n.current.getEdgeAttribute(t,"reconcileId"))&&void 0!==e?e:"undefined")}),[x]);var Z=[],O=x.at(0);if(1===x.length&&n.current.hasNode(O)){var S=n.current.getNodeAttribute(O,"type"),R=n.current.getNodeAttribute(O,S);Z.push.apply(Z,(0,i.Z)(L[S].fields.filter((function(e){return"custom"!==e.type})).map((function(i){var u,a,s;return{type:i.type,label:e(i.label),value:null===(u=i.value)||void 0===u?void 0:u.call(i,R),isChecked:null===(a=i.isChecked)||void 0===a?void 0:a.call(i,R),hidden:null===(s=i.hidden)||void 0===s?void 0:s.call(i,R),options:i.options,disabledOptions:i.disabledOptions&&i.disabledOptions(R),validator:i.validator,oneLine:i.oneLine,onChange:function(u){var a;try{a=i.onChange(u,R)}catch(s){return void t((0,v.bI)({status:"error",message:e("err-code.".concat(s))}))}n.current.mergeNodeAttributes(O,(0,r.Z)({},S,a)),t((0,v.ML)()),t((0,m.DR)(n.current.export()))}}}))).concat((0,i.Z)(L[S].fields.filter((function(e){return"custom"===e.type})))))}if(1===x.length&&n.current.hasEdge(O)){var z=n.current.getEdgeAttribute(O,"type"),W=n.current.getEdgeAttribute(O,z);Z.push.apply(Z,(0,i.Z)(y.V[z].fields.map((function(i){return{type:i.type,label:e(i.label),value:i.value(W),options:i.options,disabledOptions:i.disabledOptions&&i.disabledOptions(W),validator:i.validator,onChange:function(e){n.current.mergeEdgeAttributes(O,(0,r.Z)({},z,i.onChange(e,W))),t((0,v.lH)()),t((0,m.DR)(n.current.export()))}}}))));var I=n.current.getEdgeAttribute(O,"style"),M=n.current.getEdgeAttribute(O,I);Z.push.apply(Z,(0,i.Z)(y.b[I].fields.filter((function(e){return"custom"!==e.type})).map((function(i){return{type:i.type,label:e(i.label),value:i.value(M),options:i.options,disabledOptions:i.disabledOptions&&i.disabledOptions(M),validator:i.validator,onChange:function(e){n.current.mergeEdgeAttributes(O,(0,r.Z)({},I,i.onChange(e,M))),t((0,v.lH)()),t((0,m.DR)(n.current.export()))}}})))),Z.push.apply(Z,(0,i.Z)(y.b[I].fields.filter((function(e){return"custom"===e.type}))))}return(0,C.jsxs)(h.L$,{isOpen:x.length>0&&!j.startsWith("line")&&!j.startsWith("misc-edge"),width:300,header:"Dummy header",alwaysOverlay:!0,children:[(0,C.jsx)(h.mQ,{onClose:function(){return t((0,v.x_)())},children:e("panel.details.header")}),(0,C.jsxs)(h.EI,{children:[(0,C.jsx)(k,{}),1===x.length&&n.current.hasNode(O)&&(0,C.jsx)(w,{}),1===x.length&&n.current.hasEdge(O)&&(0,C.jsx)(D,{}),1===x.length&&(0,C.jsxs)(o.xu,{p:1,children:[(0,C.jsx)(c.X,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),(0,C.jsx)(h.M5,{fields:Z,minW:276})]})]}),(0,C.jsx)(h.B0,{children:(0,C.jsxs)(d.U,{children:[1===x.length&&n.current.hasNode(x.at(0))&&(0,C.jsx)(f.z,{size:"sm",variant:"outline",onClick:function(){return function(e){var r=JSON.parse(JSON.stringify(n.current.getNodeAttributes(e)));r.x+=50,r.y+=50;var i=e.startsWith("stn")?"stn_".concat((0,p.x0)(10)):"misc_node_".concat((0,p.x0)(10));n.current.addNode(i,r),t((0,v.ML)()),t((0,m.DR)(n.current.export()))}(x.at(0))},children:e("panel.details.footer.duplicate")}),(0,C.jsx)(f.z,{size:"sm",variant:"outline",onClick:function(){return function(e){t((0,v.x_)()),e.forEach((function(e){n.current.hasNode(e)?(n.current.dropNode(e),a()):n.current.hasEdge(e)&&(n.current.dropEdge(e),t((0,v.lH)()),t((0,m.DR)(n.current.export())))}))}(x)},children:e("panel.details.footer.remove")})]})})]})}},1122:function(e,t,n){n.d(t,{Bd:function(){return p},Kz:function(){return c},Vz:function(){return f},x8:function(){return d}});var r=n(4942),i=n(1413),u=n(3486),a=n(8817),s=n(3649),l=n(7599),o=[u.T.ShmetroBasic2020],c=function(e,t,n){var u=e.getNodeAttribute(t,"type"),a=e.getNodeAttribute(t,u).names,l=(0,i.Z)((0,i.Z)({},s.Z[n].defaultAttrs),{},{names:a});Object.values(o).includes(u)&&Object.values(o).includes(n)||(l.nameOffsetX=e.getNodeAttribute(t,u).nameOffsetX,l.nameOffsetY=e.getNodeAttribute(t,u).nameOffsetY),e.removeNodeAttribute(t,u),e.mergeNodeAttributes(t,(0,r.Z)({type:n},n,l))},d=function(e,t,n){return e.filterNodes((function(e,n){return e.startsWith("stn")&&n.type===t})).forEach((function(t){c(e,t,n)}))},f=function(e,t,n){var i=e.getEdgeAttribute(t,"type");e.removeEdgeAttribute(t,i);var u=JSON.parse(JSON.stringify(l.V[n].defaultAttrs));e.mergeEdgeAttributes(t,(0,r.Z)({type:n},n,u))},p=function(e,t,n,i){var u=e.getEdgeAttribute(t,"style");e.removeEdgeAttribute(t,u);var s=JSON.parse(JSON.stringify(l.b[n].defaultAttrs));n===a.R.SingleColor&&i&&(s.color=i),e.mergeEdgeAttributes(t,(0,r.Z)({style:n},n,s)),n===a.R.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",0)}},8617:function(e,t,n){var r=n(2791),i="undefined"!==typeof window?null!==r.useInsertionEffect&&void 0!==r.useInsertionEffect?r.useInsertionEffect:r.useLayoutEffect:function(){};function u(e){var t=(0,r.useRef)(a);i((function(){t.current=e}),[e]);var n=(0,r.useRef)(null);return n.current||(n.current=function(){return t.current.apply(this,arguments)}),n.current}function a(){throw new Error("INVALID_USEEVENT_INVOCATION: the callback from useEvent cannot be invoked before the component has mounted.")}t.ZP=u},5946:function(e,t,n){n.d(t,{X:function(){return f}});var r=n(1413),i=n(5987),u=n(7872),a=n(9084),s=n(9477),l=n(1070),o=n(6992),c=n(184),d=["className"],f=(0,u.G)((function(e,t){var n=(0,a.mq)("Heading",e),u=(0,s.Lr)(e),f=(u.className,(0,i.Z)(u,d));return(0,c.jsx)(l.m.h2,(0,r.Z)((0,r.Z)({ref:t,className:(0,o.cx)("chakra-heading",e.className)},f),{},{__css:n}))}));f.displayName="Heading"},2893:function(e,t,n){n.d(t,{U:function(){return s}});var r=n(1413),i=n(751),u=n(7872),a=n(184),s=(0,u.G)((function(e,t){return(0,a.jsx)(i.K,(0,r.Z)((0,r.Z)({align:"center"},e),{},{direction:"row",ref:t}))}));s.displayName="HStack"}}]);
//# sourceMappingURL=DetailsPanel.9a072e92.chunk.js.map