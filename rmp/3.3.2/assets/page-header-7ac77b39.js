import{W as vt,j as e,X as F,M as Z,Y as K,n as Y,o as V,p as q,d as ct,Z as dt,q as x,_ as I,$ as ue,a0 as xe,a1 as X,a2 as Q,a3 as ee,I as Xe,s as E,r as de,a4 as ht,a5 as fn,a6 as ve,L as z,a7 as M,t as Vt,a8 as kt,a9 as St,D as oe,aa as Ct,ab as pe,B as ze,ac as ut,ad as mn,ae as qt,K as Jt,af as Ze,ag as gn,ah as Tt,ai as Et,aj as Mt,ak as It,al as xn,am as yn,an as jn,ao as bn,ap as Qe,aq as wn,ar as vn,as as re,at as Bt,au as kn,av as L,aw as B,e as Sn,f as Cn,g as On,l as zn,ax as An,ay as ae,v as Tn,w as En}from"./chakra-c00f698a.js";import{w as Mn,g as In,a as et,b as $t,I as Bn,u as Nn,r as U,c as G,M as Rn,d as We,C as Hn,e as Xt,L as ie,S as N,R as Nt,f as Qt,h as T,i as $,j as te,k as _n,l as Wn,m as Ln,E as pt,s as Pn,n as Ue,o as Rt,p as tt,q as Un,t as en,v as ye,x as me,y as ce,z as tn,A as ft,B as Ht,D as Gn,F as Dn,G as nn,H as Fn,J as nt,T as Zn,K as Kn,N as _t,O as Yn,P as ke,Q as Vn,U as qn,V as Jn,W as $n,X as Xn,Y as Wt,Z as Qn,_ as st,$ as es,a0 as ts,a1 as ns,a2 as ss,a3 as is,a4 as rs,a5 as as,a6 as Lt,a7 as os,a8 as ls,a9 as cs}from"./index-1ed6763b.js";import{g as ds,r as D,b as j}from"./react-2c0b8364.js";import{F as hs,R as je,s as Ge}from"./stations-51ed0062.js";import{c as sn,f as us,F as Pt,g as ps,i as fs,s as Ut,a as Me}from"./helpers-5c642f28.js";import{c as ms,a as gs}from"./change-types-15aa7eec.js";var xs={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};const ys=ds(xs);var js=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Gt(t){var i={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},s=t.match(/<\/?([^\s]+?)[/\s>]/);if(s&&(i.name=s[1],(ys[s[1]]||t.charAt(t.length-2)==="/")&&(i.voidElement=!0),i.name.startsWith("!--"))){var n=t.indexOf("-->");return{type:"comment",comment:n!==-1?t.slice(4,n):""}}for(var a=new RegExp(js),r=null;(r=a.exec(t))!==null;)if(r[0].trim())if(r[1]){var o=r[1].trim(),l=[o,""];o.indexOf("=")>-1&&(l=o.split("=")),i.attrs[l[0]]=l[1],a.lastIndex--}else r[2]&&(i.attrs[r[2]]=r[3].trim().substring(1,r[3].length-1));return i}var bs=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,ws=/^\s*$/,vs=Object.create(null);function rn(t,i){switch(i.type){case"text":return t+i.content;case"tag":return t+="<"+i.name+(i.attrs?function(s){var n=[];for(var a in s)n.push(a+'="'+s[a]+'"');return n.length?" "+n.join(" "):""}(i.attrs):"")+(i.voidElement?"/>":">"),i.voidElement?t:t+i.children.reduce(rn,"")+"</"+i.name+">";case"comment":return t+"<!--"+i.comment+"-->"}}var ks={parse:function(t,i){i||(i={}),i.components||(i.components=vs);var s,n=[],a=[],r=-1,o=!1;if(t.indexOf("<")!==0){var l=t.indexOf("<");n.push({type:"text",content:l===-1?t:t.substring(0,l)})}return t.replace(bs,function(u,f){if(o){if(u!=="</"+s.name+">")return;o=!1}var d,g=u.charAt(1)!=="/",h=u.startsWith("<!--"),c=f+u.length,p=t.charAt(c);if(h){var m=Gt(u);return r<0?(n.push(m),n):((d=a[r]).children.push(m),n)}if(g&&(r++,(s=Gt(u)).type==="tag"&&i.components[s.name]&&(s.type="component",o=!0),s.voidElement||o||!p||p==="<"||s.children.push({type:"text",content:t.slice(c,t.indexOf("<",c))}),r===0&&n.push(s),(d=a[r-1])&&d.children.push(s),a[r]=s),(!g||s.voidElement)&&(r>-1&&(s.voidElement||s.name===u.slice(2,-1))&&(r--,s=r===-1?n:a[r]),!o&&p!=="<"&&p)){d=r===-1?n:a[r].children;var v=t.indexOf("<",c),w=t.slice(c,v===-1?void 0:v);ws.test(w)&&(w=" "),(v>-1&&r+d.length>=0||w!==" ")&&d.push({type:"text",content:w})}}),n},stringify:function(t){return t.reduce(function(i,s){return i+rn("",s)},"")}};function it(t,i){if(!t)return!1;const s=t.props?t.props.children:t.children;return i?s.length>0:!!s}function rt(t){return t?t.props?t.props.children:t.children:[]}function Ss(t){return Object.prototype.toString.call(t)!=="[object Array]"?!1:t.every(i=>D.isValidElement(i))}function Be(t){return Array.isArray(t)?t:[t]}function Cs(t,i){const s={...i};return s.props=Object.assign(t.props,i.props),s}function an(t,i){if(!t)return"";let s="";const n=Be(t),a=i.transSupportBasicHtmlNodes&&i.transKeepBasicHtmlNodesFor?i.transKeepBasicHtmlNodesFor:[];return n.forEach((r,o)=>{if(typeof r=="string")s+=`${r}`;else if(D.isValidElement(r)){const l=Object.keys(r.props).length,u=a.indexOf(r.type)>-1,f=r.props.children;if(!f&&u&&l===0)s+=`<${r.type}/>`;else if(!f&&(!u||l!==0))s+=`<${o}></${o}>`;else if(r.props.i18nIsDynamicList)s+=`<${o}></${o}>`;else if(u&&l===1&&typeof f=="string")s+=`<${r.type}>${f}</${r.type}>`;else{const d=an(f,i);s+=`<${o}>${d}</${o}>`}}else if(r===null)et("Trans: the passed in value is invalid - seems you passed in a null child.");else if(typeof r=="object"){const{format:l,...u}=r,f=Object.keys(u);if(f.length===1){const d=l?`${f[0]}, ${l}`:f[0];s+=`{{${d}}}`}else et("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",r)}else et("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",r)}),s}function Os(t,i,s,n,a,r){if(i==="")return[];const o=n.transKeepBasicHtmlNodesFor||[],l=i&&new RegExp(o.join("|")).test(i);if(!t&&!l)return[i];const u={};function f(v){Be(v).forEach(b=>{typeof b!="string"&&(it(b)?f(rt(b)):typeof b=="object"&&!D.isValidElement(b)&&Object.assign(u,b))})}f(t);const d=ks.parse(`<0>${i}</0>`),g={...u,...a};function h(v,w,b){const k=rt(v),A=p(k,w.children,b);return Ss(k)&&A.length===0?k:A}function c(v,w,b,k,A){v.dummy&&(v.children=w),b.push(D.cloneElement(v,{...v.props,key:k},A?void 0:w))}function p(v,w,b){const k=Be(v);return Be(w).reduce((S,y,_)=>{const se=y.children&&y.children[0]&&y.children[0].content&&s.services.interpolator.interpolate(y.children[0].content,g,s.language);if(y.type==="tag"){let R=k[parseInt(y.name,10)];!R&&b.length===1&&b[0][y.name]&&(R=b[0][y.name]),R||(R={});const C=Object.keys(y.attrs).length!==0?Cs({props:y.attrs},R):R,he=D.isValidElement(C),Ye=he&&it(y,!0)&&!y.voidElement,Ve=l&&typeof C=="object"&&C.dummy&&!he,_e=typeof t=="object"&&t!==null&&Object.hasOwnProperty.call(t,y.name);if(typeof C=="string"){const W=s.services.interpolator.interpolate(C,g,s.language);S.push(W)}else if(it(C)||Ye){const W=h(C,y,b);c(C,W,S,_)}else if(Ve){const W=p(k,y.children,b);S.push(D.cloneElement(C,{...C.props,key:_},W))}else if(Number.isNaN(parseFloat(y.name)))if(_e){const W=h(C,y,b);c(C,W,S,_,y.voidElement)}else if(n.transSupportBasicHtmlNodes&&o.indexOf(y.name)>-1)if(y.voidElement)S.push(D.createElement(y.name,{key:`${y.name}-${_}`}));else{const W=p(k,y.children,b);S.push(D.createElement(y.name,{key:`${y.name}-${_}`},W))}else if(y.voidElement)S.push(`<${y.name} />`);else{const W=p(k,y.children,b);S.push(`<${y.name}>${W}</${y.name}>`)}else if(typeof C=="object"&&!he){const W=y.children[0]?se:null;W&&S.push(W)}else y.children.length===1&&se?S.push(D.cloneElement(C,{...C.props,key:_},se)):S.push(D.cloneElement(C,{...C.props,key:_}))}else if(y.type==="text"){const R=n.transWrapTextNodes,C=r?n.unescape(s.services.interpolator.interpolate(y.content,g,s.language)):s.services.interpolator.interpolate(y.content,g,s.language);R?S.push(D.createElement(R,{key:`${y.name}-${_}`},C)):S.push(C)}return S},[])}const m=p([{dummy:!0,children:t||[]}],d,Be(t||[]));return rt(m[0])}function zs(t){let{children:i,count:s,parent:n,i18nKey:a,context:r,tOptions:o={},values:l,defaults:u,components:f,ns:d,i18n:g,t:h,shouldUnescape:c,...p}=t;const m=g||$t();if(!m)return Mn("You will need to pass in an i18next instance by using i18nextReactModule"),i;const v=h||m.t.bind(m)||(he=>he);r&&(o.context=r);const w={...In(),...m.options&&m.options.react};let b=d||v.ns||m.options&&m.options.defaultNS;b=typeof b=="string"?[b]:b||["translation"];const k=u||an(i,w)||w.transEmptyNodeValue||a,{hashTransKey:A}=w,S=a||(A?A(k):k),y=l?o.interpolation:{interpolation:{...o.interpolation,prefix:"#$?",suffix:"?$#"}},_={...o,count:s,...l,...y,defaultValue:k,ns:b},se=S?v(S,_):k,R=Os(f||i,se,m,w,_,c),C=n!==void 0?n:w.defaultTransParent;return C?D.createElement(C,p,R):R}function Dt(t){let{children:i,count:s,parent:n,i18nKey:a,context:r,tOptions:o={},values:l,defaults:u,components:f,ns:d,i18n:g,t:h,shouldUnescape:c,...p}=t;const{i18n:m,defaultNS:v}=D.useContext(Bn)||{},w=g||m||$t(),b=h||w&&w.t.bind(w);return zs({children:i,count:s,parent:n,i18nKey:a,context:r,tOptions:o,values:l,defaults:u,components:f,ns:d||b&&b.ns||v||w&&w.options&&w.options.defaultNS,i18n:w,t:h,shouldUnescape:c,...p})}var Ft=function(t){return Nn(U.ready(),t)},As={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},"zh-Hans":{en:"Simplified Chinese",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};function on(t){return vt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 448l-30.164-27.211C118.718 322.442 48 258.61 48 179.095 48 114.221 97.918 64 162.4 64c36.399 0 70.717 16.742 93.6 43.947C278.882 80.742 313.199 64 349.6 64 414.082 64 464 114.221 464 179.095c0 79.516-70.719 143.348-177.836 241.694L256 448z"}}]})(t)}const Ts="/rmp/assets/github-mark-7a0dd11e.svg",Es="/rmp/assets/slack-mark-19839006.svg",Ms=t=>{const{isOpen:i,onClose:s}=t,{t:n}=G(),a=U.getAppVersion(),[r,o]=j.useState(!1);return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:n("header.about.title")}),e.jsx(V,{}),e.jsxs(q,{paddingBottom:10,children:[e.jsxs(ct,{direction:"row",children:[e.jsx(dt,{boxSize:"128px",src:"/rmp//logo192.png"}),e.jsxs(ct,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e.jsx(x,{fontSize:"xl",as:"b",children:n("header.about.rmp")}),e.jsx(x,{children:a}),e.jsx(x,{}),e.jsx(x,{fontSize:"sm",children:n("header.about.railmapgen")})]})]}),e.jsx(I,{margin:5,children:e.jsx(x,{fontSize:"xl",children:n("header.about.desc")})}),e.jsx(ue,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.about.contributors")}),e.jsx(ue,{as:"h6",size:"xs",my:2,children:n("header.about.coreContributors")}),e.jsxs(xe,{children:[e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e.jsx(x,{fontSize:"sm",children:n("header.about.content1")}),e.jsx(x,{fontSize:"sm",align:"right",mb:1,children:n("header.about.content2")})]})]}),e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/langonginc","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:"https://github.com/langonginc.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:"langonginc"}),e.jsx(x,{fontSize:"sm",children:n("header.about.langonginc")}),e.jsx(x,{fontSize:"sm",align:"right",mb:1,children:"--Avicii"})]})]})]}),e.jsx(ue,{as:"h6",size:"xs",my:2,children:n("header.about.styleContributors")}),e.jsxs(xe,{children:[e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/203IhzElttil","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:"https://github.com/203IhzElttil.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:"203IhzElttil"}),e.jsx(x,{fontSize:"sm",mb:1,children:n("header.about.203IhzElttil")})]})]}),e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/52PD","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:"https://github.com/52PD.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:"52PD"}),e.jsx(x,{fontSize:"sm",mb:1,children:n("header.about.52PD")})]})]})]}),e.jsx(ue,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.about.contactUs")}),e.jsxs(xe,{children:[e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:Ts,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.about.github")}),e.jsx(x,{fontSize:"sm",children:n("header.about.githubContent")})]})]}),e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:Es,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.about.slack")}),e.jsx(x,{fontSize:"sm",children:n("header.about.slackContent")}),e.jsx(x,{fontSize:"sm",as:"i",children:"#rmp, #gallery, #rmg, #palette-and-templates"})]})]})]}),e.jsx(ue,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.about.linkExchange")}),e.jsxs(xe,{children:[e.jsxs(X,{size:"lg",w:"85%",onClick:()=>o(!0),cursor:"pointer",children:[e.jsx(Q,{src:"/rmp//images/guidaoTransit.jpg",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.about.guidaoTransit")}),e.jsx(x,{fontSize:"sm",children:n("header.about.guidaoTransitContent")})]})]}),e.jsxs(F,{size:"6xl",isOpen:r,onClose:()=>o(!1),children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:n("header.about.guidaoTransit")}),e.jsx(V,{}),e.jsx(q,{paddingBottom:10,children:e.jsx(dt,{width:"1080",height:"304",src:"/rmp//images/guidaoTransitQRCode.png"})})]})]})]})]})]})]})},Is=Ms;function Bs(t){return vt({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z"}},{tag:"path",attr:{d:"M12 12m-4.5 0a4.5 4.5 0 1 0 9 0a4.5 4.5 0 1 0 -9 0"}}]})(t)}function Ns(t){return vt({tag:"svg",attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M13 10v-10h-13v13h13v-3zM1 1h11v8h-0.755l-2.564-3.319-1.159 1.214-2.248-3.881-3.576 5.986h-0.698v-8zM9.982 9h-7.119l2.398-4.014 2.064 3.564 1.275-1.337 1.382 1.787zM1 12v-2h11v2h-11zM17 3v13h-13v-1.984h1v0.984h11v-11h-2v-1h3z"}}]})(t)}const Rs="data:image/png;base64,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",Hs="/rmp/assets/opencollective-icon-27c981e6.webp",_s=t=>{const{isOpen:i,onClose:s}=t,{t:n}=G(),a=()=>{U.isStandaloneWindow()?window.open("/rmp-gallery/donation","_blank"):U.openApp("rmp-gallery","/rmg-gallery/donation")},r=o=>new URLSearchParams({title:`Donation: New ${o} request for [city name]`,body:`Hi, I'd like to have new ${o}, and here is my support.

<!-- your donation entry -->

<!-- reference (images or URLs) -->

`}).toString();return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:n("header.donation.title")}),e.jsx(V,{}),e.jsxs(q,{paddingBottom:10,children:[e.jsxs(ct,{direction:"row",alignItems:"center",justifyContent:"space-around",children:[e.jsx(x,{fontSize:"96px",fontFamily:"serif",children:"I"}),e.jsx(on,{size:"64px",color:"red"}),e.jsx(dt,{boxSize:"96px",src:"/rmp//logo192.png"})]}),e.jsx(I,{margin:5,children:e.jsx(x,{fontSize:"xl",children:n("header.donation.content")})}),e.jsx(ue,{as:"h5",size:"sm",mb:2,children:n("header.donation.rewards")}),e.jsxs(xe,{children:[e.jsxs(X,{size:"lg",w:"85%",onClick:a,cursor:"pointer",children:[e.jsx(Q,{icon:e.jsx(Ns,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",pb:1,children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.gallery")}),e.jsx(x,{fontSize:"sm",children:n("header.donation.galleryContent")})]})]}),e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+r("stations/nodes"),"_blank"),cursor:"pointer",children:[e.jsx(Q,{icon:e.jsx(Bs,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",pb:1,children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.nodes")}),e.jsx(x,{fontSize:"sm",children:n("header.donation.nodesContent")})]})]}),e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+r("features"),"_blank"),cursor:"pointer",children:[e.jsx(Q,{icon:e.jsx(Rn,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",pb:1,children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.features")}),e.jsx(x,{fontSize:"sm",children:n("header.donation.featuresContent")})]})]})]}),e.jsx(ue,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.donation.methods")}),e.jsxs(xe,{children:[e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://opencollective.com/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:Hs,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",pb:1,children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.openCollective")}),e.jsx(x,{fontSize:"sm",children:n("header.donation.viaUSD")})]})]}),e.jsxs(X,{size:"lg",w:"85%",onClick:()=>window.open("https://afdian.net/a/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(Q,{src:Rs,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(ee,{display:"block",width:"100%",pb:1,children:[e.jsx(x,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.afdian")}),e.jsx(x,{fontSize:"sm",children:n("header.donation.viaCNY")})]})]})]})]})]})]})},Ws=_s;/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Ls(t,i){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var n,a,r,o,l=[],u=!0,f=!1;try{if(r=(s=s.call(t)).next,i===0){if(Object(s)!==s)return;u=!1}else for(;!(u=(n=r.call(s)).done)&&(l.push(n.value),l.length!==i);u=!0);}catch(d){f=!0,a=d}finally{try{if(!u&&s.return!=null&&(o=s.return(),Object(o)!==o))return}finally{if(f)throw a}}return l}}function Zt(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),s.push.apply(s,n)}return s}function J(t){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};i%2?Zt(Object(s),!0).forEach(function(n){Ps(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Zt(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Ps(t,i,s){return i=qs(i),i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function Us(t,i){if(t==null)return{};var s={},n=Object.keys(t),a,r;for(r=0;r<n.length;r++)a=n[r],!(i.indexOf(a)>=0)&&(s[a]=t[a]);return s}function Gs(t,i){if(t==null)return{};var s=Us(t,i),n,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],!(i.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function Kt(t,i){return Fs(t)||Ls(t,i)||ln(t,i)||Ys()}function Le(t){return Ds(t)||Zs(t)||ln(t)||Ks()}function Ds(t){if(Array.isArray(t))return mt(t)}function Fs(t){if(Array.isArray(t))return t}function Zs(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ln(t,i){if(t){if(typeof t=="string")return mt(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return mt(t,i)}}function mt(t,i){(i==null||i>t.length)&&(i=t.length);for(var s=0,n=new Array(i);s<i;s++)n[s]=t[s];return n}function Ks(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ys(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vs(t,i){if(typeof t!="object"||t===null)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(t)}function qs(t){var i=Vs(t,"string");return typeof i=="symbol"?i:String(i)}function Re(t){var i=t.sizes.shift(),s=Math.max(Math.ceil(i[0]),1),n=Math.max(Math.ceil(i[1]),1),a=[s-1,n-1,1,1],r=Date.now(),o=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,l,u;o?(l=new OffscreenCanvas(1,1),u=new OffscreenCanvas(s,n)):(l=document.createElement("canvas"),l.width=1,l.height=1,u=document.createElement("canvas"),u.width=s,u.height=n);var f=l.getContext("2d"),d=u.getContext("2d");d&&(d.fillRect.apply(d,a),f.drawImage(u,s-1,n-1,1,1,0,0,1,1));var g=f&&f.getImageData(0,0,1,1).data[3]!==0,h=Date.now()-r;return[l,u].forEach(function(c){c.height=0,c.width=0}),o?(postMessage({width:s,height:n,benchmark:h,isTestPass:g}),!g&&t.sizes.length&&Re(t)):g?t.onSuccess(s,n,h):(t.onError(s,n,h),t.sizes.length&&Re(t)),g}var at={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},Js=["onError","onSuccess"],Oe={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Ie={};function ot(t){var i=t.width===t.height,s=t.height===1,n=t.width===1,a=[];if(!t.width||!t.height)t.sizes.forEach(function(d){var g=i||s?d:1,h=i||n?d:1;a.push([g,h])});else for(var r=t.min||Oe.min,o=t.step||Oe.step,l=Math.max(t.width,t.height);l>=r;){var u=i||s?l:1,f=i||n?l:1;a.push([u,f]),l-=o}return a}function Pe(t){var i=window&&"HTMLCanvasElement"in window,s=window&&"OffscreenCanvas"in window,n=Date.now(),a=t.onError,r=t.onSuccess,o=Gs(t,Js),l=null;if(!i)return!1;if(t.useWorker&&s){var u=`
            var canvasTest = `.concat(Re.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),f=new Blob([u],{type:"application/javascript"}),d=URL.createObjectURL(f);l=new Worker(d),URL.revokeObjectURL(d),l.onmessage=function(g){var h=g.data,c=h.width,p=h.height,m=h.benchmark,v=h.isTestPass;v?(Ie[n].onSuccess(c,p,m),delete Ie[n]):Ie[n].onError(c,p,m)}}if(t.usePromise)return new Promise(function(g,h){var c=J(J({},t),{},{onError:function(w,b,k){var A;if(t.sizes.length===0)A=!0;else{var S=t.sizes.slice(-1),y=Kt(S,1),_=Kt(y[0],2),se=_[0],R=_[1];A=w===se&&b===R}a(w,b,k),A&&h({width:w,height:b,benchmark:k})},onSuccess:function(w,b,k){r(w,b,k),g({width:w,height:b,benchmark:k})}});if(l){var p=c.onError,m=c.onSuccess;Ie[n]={onError:p,onSuccess:m},l.postMessage(o)}else Re(c)});if(l)Ie[n]={onError:a,onSuccess:r},l.postMessage(o);else return Re(t)}var $s={maxArea:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=ot({width:i.max,height:i.max,min:i.min,step:i.step,sizes:Le(at.area)}),n=J(J(J({},Oe),i),{},{sizes:s});return Pe(n)},maxHeight:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=ot({width:1,height:i.max,min:i.min,step:i.step,sizes:Le(at.height)}),n=J(J(J({},Oe),i),{},{sizes:s});return Pe(n)},maxWidth:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=ot({width:i.max,height:1,min:i.min,step:i.step,sizes:Le(at.width)}),n=J(J(J({},Oe),i),{},{sizes:s});return Pe(n)},test:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=J(J({},Oe),i);return s.sizes=Le(s.sizes),s.width&&s.height&&(s.sizes=[[s.width,s.height]]),Pe(s)}};const gt=(t,i,s)=>{const n=new Blob([s],{type:i});cn(t,n)},cn=(t,i)=>{const s=window.URL.createObjectURL(i),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s)},Xs=async(t,i)=>{const{xMin:s,yMin:n,xMax:a,yMax:r}=sn(t),[o,l]=[a-s,r-n],u=document.getElementById("canvas").cloneNode(!0);[...u.children].filter(d=>t.hasNode(d.id)&&t.getNodeAttribute(d.id,"type")===We.Virtual).forEach(d=>u.removeChild(d)),i||u.appendChild(Qs(a-400,r-120)),u.setAttribute("viewBox",`${s} ${n} ${o} ${l}`),u.setAttribute("width",o.toString()),u.setAttribute("height",l.toString()),Object.entries({".rmp-name__zh":["font-family"],".rmp-name__en":["font-family"],".rmp-name__mtr__zh":["font-family"],".rmp-name__mtr__en":["font-family"],".rmp-name__berlin":["font-family"],".rmp-name-outline":["paint-order","stroke","stroke-width","stroke-linejoin"]}).forEach(([d,g])=>{const h=document.querySelector(d);if(h===null)return;const c=window.getComputedStyle(h);u.querySelectorAll(d).forEach(p=>{g.forEach(m=>{p.setAttribute(m,c.getPropertyValue(m))}),p.classList.remove(d)})});const f=us(t);for(const d in Pt)if(f[d])try{const{className:g,cssFont:h,cssName:c,baseUrl:p}=Pt[d],m=await ps(u,g,h,c,p),v=document.createElement("style");v.textContent=m.join(`
`),u.prepend(v)}catch(g){alert("Failed to load fonts. Fonts in the exported PNG will be missing."),console.error(g)}if(f[We.Facilities]){const d=t.filterNodes((p,m)=>m.type===We.Facilities),g=Object.fromEntries(Object.values(hs).map(p=>[p,[]]));d.forEach(p=>{var v;const m=(v=t.getNodeAttribute(p,We.Facilities))==null?void 0:v.type;m&&g[m].push(p)});const h=Object.entries(g).filter(([p,m])=>m.length>0).map(([p,m])=>p),c=await Promise.all((await Promise.all(h.map(async p=>await fetch(`/rmp//images/facilities/${p}.svg`)))).map(p=>p.text()));h.forEach((p,m)=>{const v=document.createElement("div");v.innerHTML=c[m];const w=v.querySelector("svg"),b=document.createElementNS("http://www.w3.org/2000/svg","symbol");for(const k of w.attributes)b.setAttribute(k.name,k.value);for(;w.firstChild;)b.appendChild(w.firstChild);w.replaceWith(b),b.id=p,u.appendChild(b),g[p].forEach(k=>{const A=u.querySelector(`#${k}`),S=A==null?void 0:A.querySelector("image");if(S){A.removeChild(S);const y=document.createElementNS("http://www.w3.org/2000/svg","use");y.setAttribute("href",`#${p}`),y.setAttribute("height",b.getAttribute("height")),y.setAttribute("width",b.getAttribute("width")),A.appendChild(y)}}),v.remove()})}return{elem:u,width:o,height:l}},Qs=(t,i)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","g");s.setAttribute("transform",`translate(${t}, ${i})scale(2)`);const n=document.createElementNS("http://www.w3.org/2000/svg","image");n.setAttribute("width","40"),n.setAttribute("height","40"),n.setAttribute("x","-50"),n.setAttribute("y","-20");const a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttribute("font-family","Arial, sans-serif"),a.setAttribute("font-size","16"),a.appendChild(document.createTextNode("Rail Map Painter"));const r=document.createElementNS("http://www.w3.org/2000/svg","text");return r.setAttribute("font-family","Arial, sans-serif"),r.setAttribute("font-size","10"),r.setAttribute("y","10"),r.appendChild(document.createTextNode("https://railmapgen.github.io/rmp/")),s.appendChild(n),s.appendChild(a),s.appendChild(r),s};var He=(t=>(t.left="l",t.right="r",t))(He||{}),ge=(t=>(t.through="through",t.nonThrough="nonthrough",t))(ge||{}),Ke=(t=>(t.local="local",t.express="express",t.direct="direct",t))(Ke||{}),fe=(t=>(t.MTR="mtr",t.GZMTR="gzmtr",t.SHMetro="shmetro",t))(fe||{}),Ot=(t=>(t.sh="sh",t.sh2020="sh2020",t))(Ot||{});const le=new Set,xt=new Set,yt=new Set,jt=new Set,De=new Map,ne=new Map;let H=[],Ne=0;const Fe=new Map,lt=new Map,bt=new Set,ei={name:["LEFT END","LEFT END"],secondaryName:!1,num:"00",services:[Ke.local],parents:[],children:["lineend"],branch:{left:[],right:[]},transfer:{groups:[{lines:[]}],tick_direc:He.right,paid_area:!0},facility:"",loop_pivot:!1,one_line:!0,int_padding:355},ti={name:["RIGHT END","RIGHT END"],secondaryName:!1,num:"00",services:[Ke.local],parents:[],children:[],branch:{left:[],right:[]},transfer:{groups:[{lines:[]}],tick_direc:He.right,paid_area:!0},facility:"",loop_pivot:!1,one_line:!0,int_padding:355},ni={},dn={svgWidth:{destination:1500,runin:1500,railmap:1500,indoor:1500},svg_height:400,style:fe.SHMetro,y_pc:50,padding:10,branchSpacingPct:33,direction:He.right,platform_num:"1",theme:[Hn.Shanghai,"sh1","#E3002B",Xt.white],line_name:["地鐵線","Metro Line"],current_stn_idx:"jlaMj2",stn_list:ni,namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:Ot.sh,notesGZMTR:[],direction_gz_x:40,direction_gz_y:70,coline:{},loop:!1,loop_info:{bank:!0,left_and_right_factor:0,bottom_factor:1}},si={name:["",""],secondaryName:!1,num:"",services:[Ke.local],parents:[],children:[],branch:{left:[],right:[]},transfer:{groups:[{lines:[]}],tick_direc:He.right,paid_area:!0},facility:"",loop_pivot:!1,one_line:!0,int_padding:355},ii=[ie.SingleColor,ie.BjsubwayDotted,ie.BjsubwaySingleColor,ie.BjsubwayTram,ie.MTRRaceDays,ie.MTRLightRail],P=t=>`${t[0]}/${t[1]}=${t[2]}${t[3]}`,zt=t=>ii.includes(t),ri=t=>{if(zt(t.style))return structuredClone(t[t.style].color)},ai=(t,i)=>{const[s,n]=t.extremities(i),a=t.getEdgeAttributes(i),r=a.style;if(s!=n&&zt(r)){const o=ri(a);jt.has(P(o))||(yt.add(o),jt.add(P(o)),De.set(o,s)),ne.has(s)?H.push({target:n,next:ne.get(s),color:o}):H.push({target:n,next:-1,color:o}),ne.set(s,Ne),Ne++,ne.has(n)?H.push({target:s,next:ne.get(n),color:o}):H.push({target:s,next:-1,color:o}),ne.set(n,Ne),Ne++}},hn=(t,i,s)=>{if(le.has(t))return;le.add(t);let n=0;const a=new Set;for(let r=ne.get(t);r!=-1;r=H[r].next){const o=H[r].target,l=H[r].color;P(l)==P(s)&&(a.has(o)||(a.add(o),n++,o!=i&&hn(o,t,s)))}Fe.set(t,n)},Yt=(t,i)=>{const s=t.stn_list.lineend.parents;s.push(i),t.stn_list.lineend.parents=structuredClone(s).reverse(),t.stn_list.lineend.parents.length==2?t.stn_list.lineend.branch.left=[ge.through,s[1]]:t.stn_list.lineend.branch.left=[]},oi=(t,i)=>{let s=0;for(let n=ne.get(t);n!=-1;n=H[n].next){H[n].target;const a=H[n].color;P(a)==P(i)&&s++}return s},un=(t,i,s)=>{if(bt.has(t))return[];bt.add(t);const n=[];for(let a=ne.get(t);a!=-1;a=H[a].next){const r=H[a].target,o=H[a].color;r!=i&&P(o)==P(s)&&(r.startsWith("stn")?n.push(r):n.push(...un(r,t,s)))}return n},wt=(t,i,s,n,a,r,o)=>{if(le.has(t)&&(!t.startsWith("misc_node_")&&o.stn_list[t]==null||t.startsWith("misc_node_")&&!xt.has(t)||o.loop))return[];if(le.has(t)&&o.stn_list[t]!=null&&oi(t,r)-1>=2){const h=[...o.stn_list[t].parents,i];if(o.stn_list[h[1]]==null){const m=h[0];h[0]=h[1],h[1]=m}o.stn_list[t].parents=structuredClone(h).reverse(),o.stn_list[t].branch.left=[ge.through,h[1]];const c=[];for(const m of o.stn_list[t].children)m!=i&&c.push(m);o.stn_list[t].children=structuredClone(c),o.stn_list[t].branch.right=[];const p=[];for(const m of o.stn_list.lineend.parents)m!=t&&p.push(m);return o.stn_list.lineend.parents=structuredClone(p).reverse(),o.stn_list.lineend.parents.length==2?o.stn_list.lineend.branch.left=[ge.through,p[1]]:o.stn_list.lineend.branch.left=[],c.length==0&&(o.stn_list[t].children=["lineend"],Yt(o,t)),[t]}le.add(t);const l=[],u=[],f=[],d=new Set,g=new Set;for(let h=ne.get(t);h!=-1;h=H[h].next){const c=H[h].target,p=H[h].color;if(c!=s){if(P(p)==P(r)){if(g.has(c))continue;if(g.add(c),t.startsWith("misc_node_")){const m=wt(c,i,t,n+1,a,r,o);m.length!=0&&l.push(...m)}else{const m=wt(c,t,t,n+1,a,r,o);m.length!=0&&l.push(...m)}}if(!d.has(P(p))&&P(p)!=P(r)){d.add(P(p));const m={theme:p,name:[p[1],p[1]]};f.push(m)}}}if(l.length==2){for(let h=0;h<2;h++)l[h]=="lineend"&&l.splice(h,1);if(o.stn_list[l[1]].parents.length>=2){const h=l[0];l[0]=l[1],l[1]=h}}if(le.has(t)&&o.stn_list[t]!=null){const h=[];for(const c of o.stn_list.lineend.parents)c!=t&&h.push(c);o.stn_list.lineend.parents=structuredClone(h).reverse(),o.stn_list.lineend.parents.length==2?o.stn_list.lineend.branch.left=[ge.through,h[1]]:o.stn_list.lineend.branch.left=[],l.length==0&&(bt.clear(),u.push(...un(t,i,r)))}if(t.startsWith("misc_node_"))return xt.add(t),l;{const h=a.getNodeAttributes(t).type,c=a.getNodeAttributes(t)[h];if(o.stn_list[t]=structuredClone(si),o.stn_list[t].name=[c.names[0],c.names[1]],o.stn_list[t].num=String(n),a.getNodeAttributes(t).type==N.GzmtrBasic){const p=c;o.stn_list[t].num=p.stationCode,o.stn_list[t].secondaryName=p.secondaryNames}if(a.getNodeAttributes(t).type==N.GzmtrInt){const p=c,m=p.transfer[0];for(const v of m)if(P(v)==P(r)){o.stn_list[t].num=String(v[5]);break}o.stn_list[t].secondaryName=p.secondaryNames}return l.length!=0?(o.stn_list[t].children=structuredClone(l).reverse(),l.length==2&&(o.stn_list[t].branch.right=[ge.through,l[1]])):(o.stn_list[t].children=["lineend"],Yt(o,t)),u.push(i),o.stn_list[t].parents=structuredClone(u).reverse(),u.length==2&&(o.stn_list[t].branch.left=[ge.through,u[1]]),f.length!=0&&(o.stn_list[t].transfer.groups[0].lines=structuredClone(f)),[t]}},li=(t,i,s,n)=>{const a=structuredClone(dn);n=="LOOP"&&(a.loop=!0);let r;switch(t.getNodeAttributes(s).type){case N.GzmtrBasic:case N.GzmtrInt:r=fe.GZMTR;break;case N.MTR:r=fe.MTR;break;default:r=fe.SHMetro;break}a.theme=structuredClone(i),a.style=r,a.stn_list.linestart=structuredClone(ei),a.stn_list.lineend=structuredClone(ti),le.clear(),xt.clear();const o=wt(s,"linestart","linestart",1,t,i,a);if(a.current_stn_idx=o[0],a.stn_list.linestart.children=[o[0]],!(Object.keys(a.stn_list).length<=3||a.stn_list.lineend.parents.length>=3))return structuredClone(a)},ci=t=>{le.clear(),yt.clear(),jt.clear(),De.clear(),ne.clear(),H=[],Ne=0,Fe.clear(),lt.clear(),t.filterEdges(n=>n.startsWith("line")).forEach(n=>{zt(t.getEdgeAttributes(n).style)&&ai(t,n)});let i=0;t.forEachNode(n=>{lt.set(n,++i)}),lt.set("lineend",++i);const s=[];for(const n of yt){le.clear(),Fe.clear(),hn(De.get(n),"line_root",n);let a=!0,r="LINE";const o=[];for(const[u,f]of Fe)f==1&&o.push(u),f==3&&(r="BRANCH"),f>3&&(a=!1);if(!a)continue;o.length==0&&(r="LOOP",o.push(De.get(n)));const l=[];for(const u of o){const f=li(t,n,u,r);f!=null&&l.push([f,f.stn_list[f.current_stn_idx].name[0],f.stn_list[f.current_stn_idx].name[1]])}l.length!=0&&s.push({theme:n,param:structuredClone(l),type:r})}return s},di=t=>t[0]!=""&&t[1]!=""?t[0]+"_"+t[1]:t[0]!=""?t[0]:t[1]!=""?t[1]:`${new Date().valueOf()}`,hi=(t,i,s)=>{t.line_name=i,t.line_num=String(s),console.log(t),gt(`RMG_${di(i)}.json`,"application/json",JSON.stringify(t))},ui={LINE:"#33ccff",BRANCH:"#007B61",LOOP:"#ff6666"},pi=t=>{const{isOpen:i,onClose:s}=t,{t:n}=G(),a=j.useRef(window.graph),[r,o]=j.useState(!1),[l,u]=j.useState([[dn,"",""]]),[f,d]=j.useState(["","",""]),[g,h]=j.useState([]);return j.useEffect(()=>{i&&h(ci(a.current))},[i]),e.jsxs(F,{isOpen:i,onClose:s,size:"2xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:e.jsx(x,{as:"b",fontSize:"xl",children:n("header.download.2rmg.title")})}),e.jsx(V,{}),e.jsxs(q,{children:[e.jsx(x,{fontSize:"sm",mt:"3",lineHeight:"100%",children:n("header.download.2rmg.info1")}),e.jsx(x,{fontSize:"sm",mt:"3",lineHeight:"100%",children:n("header.download.2rmg.info2")}),e.jsx("br",{}),g.length===0?e.jsx(x,{fontSize:"md",children:n("header.download.2rmg.noline")}):e.jsx("table",{children:g.map(({theme:c,param:p,type:m})=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(Nt,{name:c[0]=="other"&&c[1]=="other"?c[2]:c[1],bg:c[2],fg:c[3]})}),e.jsx("td",{children:e.jsx(Xe,{placeholder:n("header.download.2rmg.placeholder.chinese"),id:"nameCh_"+JSON.stringify(c),size:"sm"})}),e.jsx("td",{children:e.jsx(Xe,{placeholder:n("header.download.2rmg.placeholder.english"),id:"nameEn_"+JSON.stringify(c),size:"sm"})}),e.jsx("td",{children:e.jsx(Xe,{placeholder:n("header.download.2rmg.placeholder.lineCode"),id:"lineNum_"+JSON.stringify(c),size:"sm"})}),e.jsx("td",{children:e.jsx(Nt,{name:n(`header.download.2rmg.type.${m.toLowerCase()}`),bg:ui[m],fg:Xt.white})}),e.jsx("td",{children:e.jsx(E,{colorScheme:"blue",variant:"ghost",mr:"1",onClick:()=>{const v=document.getElementById("nameCh_"+JSON.stringify(c)),w=document.getElementById("nameEn_"+JSON.stringify(c)),b=document.getElementById("lineNum_"+JSON.stringify(c));u(p),d([v.value.trim(),w.value.trim(),b.value.trim()]),o(!0)},size:"sm",children:e.jsx(Qt,{})})})]},JSON.stringify(c)))})]}),e.jsx(de,{children:e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:n("close")})})]}),e.jsx(fi,{isOpen:r,onClose:()=>o(!1),param:l,nameList:f})]})},fi=t=>{const{isOpen:i,onClose:s,param:n,nameList:a}=t,{t:r}=G(),[o,l]=j.useState("");return j.useEffect(()=>{a[0]!=""&&a[1]!=""?l(a[0]+"/"+a[1]):a[0]!=""?l(a[0]):a[1]!=""&&l(a[1])},[...a]),e.jsxs(F,{isOpen:i,onClose:s,size:"md",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:e.jsxs(x,{as:"b",fontSize:"xl",children:[r("header.download.2rmg.download")," ",o]})}),e.jsx(V,{}),e.jsx(q,{children:e.jsxs(ht,{children:[e.jsx(x,{fontSize:"sm",mb:"2",lineHeight:"100%",children:r("header.download.2rmg.downloadInfo")}),n.map(([u,f,d])=>e.jsxs(E,{onClick:()=>{hi(u,[a[0],a[1]],a[2])},children:[f,"/",d]},`${f}${d}`))]})}),e.jsx(de,{children:e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:r("close")})})]})]})},mi=t=>{const{isOpen:i,onClose:s}=t,{t:n}=G();return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:n("header.download.termsAndConditions")}),e.jsx(V,{}),e.jsx(q,{children:e.jsxs(fn,{children:[e.jsxs(ve,{children:["The layout of the elements on the signage or rail map, is designed by"," ",e.jsxs(z,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",e.jsx(M,{as:T})]}),", ",e.jsxs(z,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",e.jsx(M,{as:T})]})," or ",e.jsxs(z,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",e.jsx(M,{as:T})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",e.jsx("br",{}),"标志版或路线图的元素或布局，基于你所选择的风格，为",e.jsxs(z,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["上海申通地铁集团 ",e.jsx(M,{as:T})]}),"，",e.jsxs(z,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["广州地铁集团公司 ",e.jsx(M,{as:T})]}),"或",e.jsxs(z,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["港铁公司 ",e.jsx(M,{as:T})]}),"所设计。在产生的图像用作商业用途前，你应向相关公司取得适当之许可证或授权。"]}),e.jsxs(ve,{children:["The elements including shapes and lines on the image are drawn by"," ",e.jsxs(z,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(M,{as:T})]})," and ",e.jsxs(z,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(M,{as:T})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",e.jsx("br",{}),"图像的元素，包括图形及线条，均由",e.jsxs(z,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(M,{as:T})]}),"及",e.jsxs(z,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(M,{as:T})]}),"基于上述公司设计标准或准则绘制。你可将其用于任何目的，但我们建议你于使用同时附以我们的名字以及本网站地址。"]}),e.jsxs(ve,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Painter uses"," ",e.jsxs(z,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",e.jsx(M,{as:T})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",e.jsx("br",{}),"由于著作权及其他法律限制，铁路路线图绘制器使用由",e.jsxs(z,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["ButTaiwan提供的源樣明體 ",e.jsx(M,{as:T})]}),"，以及Vegur，以代替港铁样式标志牌所使用的地铁宋及Myriad Pro。在产生之图像用作商业用途前，你应向字型生产厂商取得适当之许可证或授权。"]}),e.jsxs(ve,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes except commercial use, under the conditions above.",e.jsx("br",{}),"输出的PNG或SVG图像可基于上述条款，在非商业使用时，用于修改、发行或其他用途。"]}),e.jsxs(ve,{children:["All flag emojis shown on Windows platforms are designed by"," ",e.jsxs(z,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(M,{as:T})]})," ","– the open-source emoji and icon project. License:",e.jsxs(z,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(M,{as:T})]}),e.jsx("br",{}),"于Windows作业系统上显示的国旗Emoji为",e.jsxs(z,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(M,{as:T})]}),"所设计。许可证：",e.jsxs(z,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(M,{as:T})]})]}),e.jsxs(ve,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",e.jsx("br",{}),"我们保留修改、新增或移除上述条款之权利，而无需另行通知。中文译本仅供参考，文义如与英文有歧异，概以英文本为准。"]})]})})]})]})},gi=mi;function xi(){const t=Vt("white","gray.800"),i=$(),{telemetry:{project:s}}=te(O=>O.app),n=te(O=>O.param),{t:a}=G(),r=j.useRef(window.graph),[o,l]=j.useState("png"),u={png:a("header.download.png"),svg:a("header.download.svg")},[f,d]=j.useState({width:1,height:1,benchmark:.001}),[g,h]=j.useState(200),c=[10,25,33,50,67,75,100,125,150,175,200,250,300,400,500,750,1e3],p=Object.fromEntries(c.map(O=>[O,`${O}%`])),[m,v]=j.useState([]),[w,b]=j.useState(!1),k=[{type:"select",label:a("header.download.format"),value:o,options:u,onChange:O=>l(O==="png"?"png":"svg")}],A=[{type:"select",label:a("header.download.scale"),value:g,options:p,disabledOptions:m,onChange:O=>h(O)},{type:"switch",label:a("header.download.transparent"),isChecked:w,onChange:b}],[S,y]=j.useState(!1),[_,se]=j.useState(!1),[R,C]=j.useState(!1),[he,Ye]=j.useState(!1),[Ve,_e]=j.useState(!1);j.useEffect(()=>{(async()=>{const Ae=await $s.maxArea({usePromise:!0,useWorker:!0});d(Ae)})()},[]),j.useEffect(()=>{if(S){const{xMin:O,yMin:Ae,xMax:qe,yMax:Je}=sn(r.current),[be,Te]=[qe-O,Je-Ae],Ee=c.filter(we=>be*we/100>f.width&&Te*we/100>f.height);v(Ee)}},[S]);const W=()=>{s&&U.event(pt.DOWNLOAD_PARAM,{"#nodes":r.current.order,"#edges":r.current.size}),gt(`RMP_${new Date().valueOf()}.json`,"application/json",Pn(n))},pn=async()=>{y(!1),s&&U.event(pt.DOWNLOAD_IMAGES,{numberOfNodes:r.current.order,numberOfEdges:r.current.size});const{elem:O,width:Ae,height:qe}=await Xs(r.current,R);if(o==="svg"){gt(`RMP_${new Date().valueOf()}.svg`,"image/svg+xml",O.outerHTML);return}document.body.appendChild(O);const Je="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(O.outerHTML)));document.body.removeChild(O),O.remove();const be=document.createElement("canvas"),[Te,Ee]=[Ae*g/100,qe*g/100];be.width=Te,be.height=Ee;const we=be.getContext("2d");w||(we.fillStyle=t,we.fillRect(0,0,Te,Ee));const $e=new Image;$e.onload=()=>{setTimeout(()=>{we.drawImage($e,0,0,Te,Ee),be.toBlob(At=>{At||i(Ue({status:"error",message:a("header.download.imageTooBig")})),cn(`RMP_${new Date().valueOf()}.png`,At)},"image/png")},fs()?2e3:0)},$e.src=Je};return e.jsxs(kt,{id:"download",children:[e.jsx(St,{as:oe,size:"sm",variant:"ghost",icon:e.jsx(Qt,{})}),e.jsxs(Ct,{children:[e.jsx(pe,{icon:e.jsx(_n,{}),onClick:W,children:a("header.download.config")}),e.jsxs(pe,{icon:e.jsx(Wn,{}),onClick:()=>_e(!0),children:[a("header.download.2rmg.title"),e.jsx(ze,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(pe,{icon:e.jsx(Ln,{}),onClick:()=>y(!0),children:a("header.download.image")})]}),e.jsxs(F,{size:"xl",isOpen:S,onClose:()=>y(!1),children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:a("header.download.image")}),e.jsx(V,{}),e.jsxs(q,{children:[e.jsx(je,{fields:k}),o==="png"&&e.jsx(je,{fields:A}),o==="png"&&m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(x,{as:"i",fontSize:"sm",children:a("header.download.disabledScaleOptions")}),e.jsx("br",{}),e.jsx(x,{as:"i",fontSize:"sm",children:a("header.download.disabledScaleOptionsWorkarounds")}),e.jsxs(z,{color:"teal.500",onClick:()=>window.open("https://github.com/RazrFalcon/resvg","_blank"),children:["RazrFalcon/resvg ",e.jsx(M,{as:T})]}),e.jsx("br",{})]}),e.jsx("br",{}),e.jsx(ut,{isChecked:R,onChange:O=>C(O.target.checked),children:e.jsxs(x,{children:[a("header.download.shareInfo1"),e.jsxs(z,{color:"teal.500",onClick:()=>window.open("https://railmapgen.github.io/rmp","_blank"),children:[a("header.about.rmp")," ",e.jsx(M,{as:T})]}),a("header.download.shareInfo2")]})}),e.jsx(ut,{isChecked:he,onChange:O=>Ye(O.target.checked),children:e.jsxs(x,{children:[a("header.download.termsAndConditionsInfo"),e.jsxs(z,{color:"teal.500",onClick:()=>se(!0),children:[a("header.download.termsAndConditions")," ",e.jsx(M,{as:T})]}),a("header.download.period")]})})]}),e.jsx(de,{children:e.jsx(mn,{children:e.jsx(E,{colorScheme:"teal",variant:"outline",size:"sm",isDisabled:!he||m.includes(g),onClick:pn,children:a("header.download.confirm")})})}),e.jsx(gi,{isOpen:_,onClose:()=>se(!1)})]})]}),e.jsx(pi,{isOpen:Ve,onClose:()=>_e(!1)})]})}const yi=(t,{info_panel_type:i,line_num:s,stn_list:n,style:a,theme:r})=>{const o=Object.fromEntries(Object.keys(n).filter(l=>!["linestart","lineend"].includes(l)).map(l=>[l,`stn_${Rt(10)}`]));Object.entries(n).filter(([l,u])=>!["linestart","lineend"].includes(l)).forEach(([l,u])=>{const f=t.filterNodes((d,g)=>Object.values(N).includes(g.type)&&g[g.type].names[0]===u.name[0]);f.length!==0&&(o[l]=f[0])}),Object.entries(n).filter(([l,u])=>!["linestart","lineend"].includes(l)).filter(([l,u])=>t.filterNodes((f,d)=>Object.values(N).includes(d.type)&&d[d.type].names[0]===u.name[0]).length===0).forEach(([l,u],f)=>{let d=N.ShmetroBasic;const g=u.transfer.groups,h=g.map(p=>p.lines).flat();a===fe.SHMetro?h.length>0?d=N.ShmetroInt:i===Ot.sh2020?d=N.ShmetroBasic2020:d=N.ShmetroBasic:a===fe.GZMTR?h.length>0?d=N.GzmtrInt:d=N.GzmtrBasic:a===fe.MTR&&(d=N.MTR);const c={...structuredClone(Ge[d].defaultAttrs),names:u.name};d===N.ShmetroBasic2020?c.color=r:d===N.GzmtrBasic?(c.color=r,c.lineCode=s,c.stationCode=u.num):d===N.GzmtrInt?c.transfer=g.map((p,m)=>{const v=p.lines.map(w=>{var b;return[...(b=w.theme)!=null?b:r,"1","01"]});return m===0?[[...r,s,u.num],...v]:v}):d===N.MTR&&(g[0].lines.length?c.transfer=[[[...r,"",""],...g[0].lines.map(p=>{var m;return[...(m=p.theme)!=null?m:r,"",""]})]]:c.transfer=[[]]),t.addNode(o[l],{visible:!0,zIndex:0,x:100+f*50,y:1e3,type:d,[d]:c})}),Object.entries(n).filter(([l,u])=>!["linestart","lineend"].includes(l)).forEach(([l,u])=>{u.children.filter(f=>!["linestart","lineend"].includes(f)).forEach(f=>{t.addDirectedEdgeWithKey(`line_${Rt(10)}`,o[l],o[f],{visible:!0,zIndex:0,type:tt.Diagonal,[tt.Diagonal]:structuredClone(Un[tt.Diagonal].defaultAttrs),style:ie.SingleColor,[ie.SingleColor]:{color:r},reconcileId:""})})})},ji="rmg-bridge--",bi={h:500,maxH:"70%","& iframe":{h:"100%",w:"100%"}};function wi(t){const{isOpen:i,onClose:s,onImport:n}=t,[a]=D.useState(crypto.randomUUID()),r="/rmg/#/import?"+new URLSearchParams({parentComponent:U.getAppName(),parentId:a});return D.useEffect(()=>{const o=new BroadcastChannel(ji+a);return o.onmessage=l=>{const{event:u,data:f}=l.data;console.log("[rmp] Received event from RMG app clip:",u),u==="CLOSE"?s():u==="IMPORT"&&n(f)},()=>{o.close()}},[]),e.jsx(en,{isOpen:i,onClose:s,sx:bi,children:e.jsx("iframe",{src:r,loading:"lazy"})})}const vi="RMP_GALLERY_CHANNEL",ki="OPEN_TEMPLATE",Si=new BroadcastChannel(vi),Ci={h:"80%",w:"80%","& iframe":{h:"100%",w:"100%"}};function Oi(t){const{isOpen:i,onClose:s}=t,n=qt(),{t:a}=G(),r=$(),o=j.useRef(window.graph),l=j.useCallback(()=>{r(ye()),r(me()),r(ce(o.current.export()))},[r,ye,me,ce,o]),u=async d=>{const{version:g,...h}=JSON.parse(await tn(JSON.stringify(d)));r(ft()),o.current.clear(),o.current.import(h.graph),l()},f=async d=>{var h;const g=await((h=(await Promise.allSettled([fetch(`/rmp-gallery/resources/real_world/${d}.json`),fetch(`/rmp-gallery/resources/fantasy/${d}.json`)])).filter(c=>c.status==="fulfilled").find(c=>c.value.status===200))==null?void 0:h.value.json());g?(u(g),n({title:a("header.open.importFromRMPGallery",{id:d}),status:"success",duration:9e3,isClosable:!0})):n({title:a("header.open.failToImportFromRMPGallery",{id:d}),status:"error",duration:9e3,isClosable:!0})};return j.useEffect(()=>{const d=window.location.href;if(d.includes("/s/")){history.replaceState({},a("about.rmp"),d.substring(0,d.indexOf("s/")));const g=d.substring(d.lastIndexOf("s/")+2);f(g)}},[]),j.useEffect(()=>{Si.onmessage=d=>{const{event:g,data:h}=d.data;g===ki&&(f(h),s())}},[]),e.jsx(e.Fragment,{children:e.jsxs(en,{isOpen:i,onClose:s,size:"full",sx:Ci,children:[e.jsx("iframe",{src:"/rmp-gallery/",loading:"lazy"}),e.jsx(Jt,{onClick:s,position:"fixed",top:"5px",right:"15px"})]})})}function zi(){const{t}=G(),i=$(),s=j.useRef(window.graph),n=j.useRef(null),[a,r]=j.useState(!1),[o,l]=j.useState(!1),u=j.useCallback(()=>{i(ye()),i(me()),i(ce(s.current.export()))},[i,ye,me,ce,s]),f=()=>{i(ft()),s.current.clear(),i(nn(100)),i(Fn({x:0,y:0})),u()},d=h=>{try{yi(s.current,h),u()}catch(c){i(Ue({status:"error",message:t("header.open.unknownError")})),console.error("OpenActions.handleUploadRMG():: Unknown error occurred while parsing the RMG project",c)}finally{r(!1)}},g=async h=>{var p;const c=(p=h.target.files)==null?void 0:p[0];if(console.log("OpenActions.handleUpload():: received file",c),(c==null?void 0:c.type)!=="application/json")i(Ue({status:"error",message:t("header.open.invalidType")})),console.error("OpenActions.handleUpload():: Invalid file type! Only file in JSON format is accepted.");else try{const m=await Ai(c),{version:v,...w}=JSON.parse(await tn(m));i(ft()),s.current.clear(),s.current.import(w.graph),u()}catch(m){i(Ue({status:"error",message:t("header.open.unknownError")})),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",m)}h.target.value=""};return e.jsxs(kt,{children:[e.jsx(St,{as:oe,size:"sm",variant:"ghost",icon:e.jsx(Ht,{})}),e.jsxs(Ct,{children:[e.jsx(pe,{icon:e.jsx(Gn,{}),onClick:f,children:t("header.open.new")}),e.jsx("input",{id:"upload_project",ref:n,type:"file",accept:".json",hidden:!0,onChange:g,"data-testid":"file-upload"}),e.jsx(pe,{icon:e.jsx(Ht,{}),onClick:()=>{var h;return(h=n==null?void 0:n.current)==null?void 0:h.click()},children:t("header.open.config")}),e.jsx(pe,{icon:e.jsx(Dn,{}),onClick:()=>r(!0),children:t("header.open.projectRMG")}),e.jsxs(pe,{icon:e.jsx(T,{}),onClick:()=>l(!0),children:[t("header.open.gallery"),e.jsx(ze,{ml:"1",colorScheme:"green",children:"New"})]})]}),e.jsx(wi,{isOpen:a,onClose:()=>r(!1),onImport:d}),e.jsx(Oi,{isOpen:o,onClose:()=>l(!1)})]})}const Ai=t=>new Promise(i=>{const s=new FileReader;s.onloadend=()=>i(s.result),s.readAsText(t)}),Ti=t=>{const{isOpen:i,onClose:s}=t,n=$(),{t:a}=G(),r=j.useRef(window.graph),[o,l]=j.useState(0),[u,f]=j.useState(0),d=[{type:"input",label:a("header.settings.procedures.translate.x"),value:o.toString(),variant:"number",onChange:h=>l(Number(h)),minW:"full"},{type:"input",label:a("header.settings.procedures.translate.y"),value:u.toString(),variant:"number",onChange:h=>f(Number(h)),minW:"full"}],g=()=>{r.current.forEachNode((h,c)=>{r.current.updateNodeAttribute(h,"x",p=>(p!=null?p:0)+o),r.current.updateNodeAttribute(h,"y",p=>(p!=null?p:0)+u)}),n(ye()),n(me()),n(ce(r.current.export())),s()};return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:a("header.settings.procedures.translate.title")}),e.jsx(V,{}),e.jsxs(q,{children:[a("header.settings.procedures.translate.content"),e.jsx(je,{fields:d})]}),e.jsxs(de,{children:[e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:a("cancel")}),e.jsx(E,{colorScheme:"red",onClick:g,children:a("apply")})]})]})]})},Ei=t=>{const{isOpen:i,onClose:s}=t,n=$(),{t:a}=G(),r=j.useRef(window.graph),[o,l]=j.useState(1),u=[{type:"input",label:a("header.settings.procedures.scale.factor"),value:o.toString(),variant:"number",onChange:d=>l(Number(d)),minW:"full"}],f=()=>{r.current.forEachNode((d,g)=>{r.current.updateNodeAttribute(d,"x",h=>(h!=null?h:0)*o),r.current.updateNodeAttribute(d,"y",h=>(h!=null?h:0)*o)}),n(ye()),n(me()),n(ce(r.current.export())),s()};return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:a("header.settings.procedures.scale.title")}),e.jsx(V,{}),e.jsxs(q,{children:[a("header.settings.procedures.scale.content"),e.jsx(je,{fields:u})]}),e.jsxs(de,{children:[e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:a("cancel")}),e.jsx(E,{colorScheme:"red",onClick:f,children:a("apply")})]})]})]})},Mi=t=>{const{isOpen:i,onClose:s}=t,n=$(),{t:a}=G(),r=j.useRef(window.graph),o=Object.fromEntries(Object.entries(Ge).map(([c,p])=>[c,a(p.metadata.displayName).toString()])),[l,u]=j.useState(Object.keys(Ge).at(0)),[f,d]=j.useState(Object.keys(Ge).at(1)),g=[{type:"select",label:a("header.settings.procedures.changeType.changeFrom"),value:l,options:o,disabledOptions:[f],onChange:c=>u(c),minW:"full"},{type:"select",label:a("header.settings.procedures.changeType.changeTo"),value:f,options:o,disabledOptions:[l],onChange:c=>d(c),minW:"full"}],h=()=>{ms(r.current,l,f),n(ye()),n(ce(r.current.export())),s()};return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsxs(Y,{children:[e.jsx(x,{as:"b",fontSize:"xl",children:a("header.settings.procedures.changeType.title")}),e.jsx(Ze,{label:a("header.settings.pro"),children:e.jsx(ze,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})})]}),e.jsx(V,{}),e.jsxs(q,{children:[e.jsx(je,{fields:g}),e.jsx(x,{fontSize:"sm",mt:"3",lineHeight:"100%",color:"red.500",children:a("header.settings.procedures.changeType.info")})]}),e.jsxs(de,{children:[e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:a("cancel")}),e.jsx(E,{colorScheme:"red",onClick:h,children:a("apply")})]})]})]})},Ii=t=>{const{isOpen:i,onClose:s}=t,n=$(),{t:a}=G(),r=j.useRef(window.graph),{theme:o}=te(p=>p.runtime),l=Object.fromEntries(Object.entries(nt).map(([p,m])=>[p,a(m.metadata.displayName).toString()])),[u,f]=j.useState(Object.keys(nt).at(0)),[d,g]=j.useState(Object.keys(nt).at(1)),h=[{type:"select",label:a("header.settings.procedures.changeLineStyleType.changeFrom"),value:u,options:l,disabledOptions:[d],onChange:p=>f(p),minW:"full"},{type:"select",label:a("header.settings.procedures.changeLineStyleType.changeTo"),value:d,options:l,disabledOptions:[u],onChange:p=>g(p),minW:"full"}],c=()=>{gs(r.current,u,d,o),n(me()),n(ce(r.current.export())),s()};return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsxs(Y,{children:[e.jsx(x,{as:"b",fontSize:"xl",children:a("header.settings.procedures.changeLineStyleType.title")}),e.jsx(Ze,{label:a("header.settings.pro"),children:e.jsx(ze,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})})]}),e.jsx(V,{}),e.jsxs(q,{children:[e.jsx(je,{fields:h}),e.jsx(x,{fontSize:"sm",mt:"3",lineHeight:"100%",color:"red.500",children:a("header.settings.procedures.changeLineStyleType.info")})]}),e.jsxs(de,{children:[e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:a("cancel")}),e.jsx(E,{colorScheme:"red",onClick:c,children:a("apply")})]})]})]})},Bi=t=>{const{isOpen:i,onClose:s}=t,n=$(),{theme:a,paletteAppClip:{output:r}}=te(c=>c.runtime),{t:o}=G(),l=j.useRef(window.graph),[u,f]=j.useState(a),[d,g]=j.useState(!1);j.useEffect(()=>{d&&r&&(f(r),g(!1))},[r==null?void 0:r.toString()]);const h=()=>{l.current.filterEdges((c,p,m,v,w,b,k)=>p.style===ie.SingleColor&&JSON.stringify(p[ie.SingleColor].color)===JSON.stringify(u)).forEach(c=>l.current.dropEdge(c)),n(me()),n(ce(l.current.export())),s()};return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:o("header.settings.procedures.removeLines.title")}),e.jsx(V,{}),e.jsxs(q,{children:[o("header.settings.procedures.removeLines.content"),e.jsx(Zn,{theme:u,onClick:()=>{g(!0),n(Kn(u))}})]}),e.jsxs(de,{children:[e.jsx(E,{colorScheme:"blue",variant:"outline",mr:"1",onClick:s,children:o("cancel")}),e.jsx(E,{colorScheme:"red",onClick:h,children:o("remove")})]})]})]})},Ni=t=>{const{isOpen:i,onClose:s}=t,n=$(),{preference:{unlockSimplePathAttempts:a}}=te(h=>h.app),r=qt(),{t:o}=G(),[l,u]=j.useState([]),[f,d]=j.useState([[],[],[]]);j.useEffect(()=>{if(i){const h=Ut([{question:"What is one reason why Beck's original design of the Underground map is sometimes overestimated in terms of its innovation?",choices:["It introduced a completely new way of representing railway networks.","It was created by George Dow, a renowned map designer.","It evolved from previous map designs and was influenced by existing schematic railway maps.","It was the first map to include detailed surface information."],answers:["It evolved from previous map designs and was influenced by existing schematic railway maps."]},{question:"What is the main argument of the paragraph 4?",choices:["Beck's original design was an isolated stroke of genius.","Schematic maps were not in use before Beck's design.","Evaluating an innovation is easier for innovators than for observers.","Beck's map is an evolution of previous Underground maps."],answers:["Beck's map is an evolution of previous Underground maps."]},{question:"According to Roberts, what was the key factor contributing to the usability of Beck's map?",choices:["The inclusion of intricate geographical details","The use of a wide range of colors","The adoption of octolinearit","The incorporation of 45° and 90° angles"],answers:["The adoption of octolinearit"]},{question:"According to the passage, what is the significance of octolinearity in Beck's map design?",choices:["It enhances the complexity of the network.","It simplifies line trajectories and improves usability.","It increases the disorientation for passengers.","It offers the most effective solution."],answers:["It simplifies line trajectories and improves usability."]},{question:"According to the paragraph 9, what aspect of Beck's map design helped create a perception of flow and ease of navigation?",choices:["Use of angular joins","Inconsistent station spacing","Tight curves in lines","Irregular angles"],answers:["Tight curves in lines"]},{question:"What was the central transformative possibility offered by Beck's map according to Pike?",choices:["Replacing negative connotations of the Underground with positive connotations","Aligning individual behavior with the dynamic system of the Underground","Creating an abstract representation of the Underground network","Introducing escalators in 1924 to regulate passenger movement"],answers:["Replacing negative connotations of the Underground with positive connotations"]}]).slice(0,2),c=Ut([{question:"What were the successive innovations incorporated into Beck's design of the Underground map? Choose all that apply.",choices:["Introduction of flamboyant calligraphic letters","Enlargement of the central area","Use of Johnston-style lettering","Expansion of the map's periphery","Removal of surface detail","Inclusion of detailed geographical features"],answers:["Enlargement of the central area","Use of Johnston-style lettering","Removal of surface detail"]},{question:"What factors contributed to the success of Beck's design for the transit map? Choose all that apply.",choices:["Excessive geographical distortion","Complex and winding line trajectories","Enhanced usability due to straightened lines and limited directional changes","Positive reception by society due to aesthetic appeal","Inclusion of intricate surface features","Incorporation of a wide range of colors","Sole reliance on geographical accuracy"],answers:["Enhanced usability due to straightened lines and limited directional changes","Positive reception by society due to aesthetic appeal"]},{question:"How did Beck's subway map influence users' behavior and perception of the Underground system? Choose all that apply.",choices:["It introduced vibrant colors and abstract forms.","It reinforced the organic and representative design of its predecessors.","It aligned with the Art Deco style of design.","It provided users with a sense of control and mastery over the vast network.","It encouraged passengers to focus on the intricate details of the map's design.","It presented a chaotic and confusing representation of the Underground's routes."],answers:["It aligned with the Art Deco style of design.","It provided users with a sense of control and mastery over the vast network."]},{question:"What aspects of Beck's map design contributed to its favorability during the 1930s and in the modern era? Choose all that apply.",choices:["The use of vibrant colors that reflected the Art Deco style","The map's intricate cartographic symbols and detailed topographic representation","The incorporation of chaotic design elements to match the city's character","The inclusion of historical Classicism elements","The alignment with the machine aesthetic and modern industrial functionalism","An emphasis on organic, flowing lines to represent the city's natural features"],answers:["The use of vibrant colors that reflected the Art Deco style","The alignment with the machine aesthetic and modern industrial functionalism"]}]).slice(0,1);u([...h,...c]),d([[],[],[]])}},[i]);const g=()=>{l.map(h=>h.answers).flat().join("")===f.flat().join("")?n(_t(-1)):(n(_t(a-1)),r({title:o("header.settings.procedures.unlockSimplePath.fail"),status:"error",duration:9e3,isClosable:!0}),s())};return e.jsxs(F,{isOpen:i,onClose:s,size:"5xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:o("header.settings.procedures.unlockSimplePath.title")}),e.jsx(V,{}),e.jsxs(q,{children:[e.jsx(x,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content1")}),e.jsx(x,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content2")}),e.jsx(x,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content3")}),e.jsx(x,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content4")}),e.jsxs(x,{mb:"2",children:[o("header.settings.procedures.unlockSimplePath.content5"),a>=0?a:""]}),e.jsxs(gn,{defaultIndex:[],allowMultiple:!0,children:[e.jsxs(Tt,{children:[e.jsx("h2",{children:e.jsxs(Et,{children:[e.jsx(I,{as:"span",flex:"1",textAlign:"left",children:"Passage"}),e.jsx(Mt,{})]})}),e.jsxs(It,{pb:4,children:[e.jsxs(z,{color:"teal.500",href:"https://www.tandfonline.com/doi/full/10.1080/00087041.2021.1953765",isExternal:!0,children:[e.jsx(x,{as:"b",children:"When Topology Trumped Topography: Celebrating 90 Years of Beck’s Underground Map"})," ",e.jsx(M,{as:T})]}),e.jsx(x,{mt:"2",children:"The year 1931 saw the inception of what has become arguably the world’s most successful cartographic design. Henry C. Beck, a technical draughtsman who had been laid off by the Underground Electric Railways of London (UERL), devised a new diagrammatic map of the network in his spare time. Beck’s radical approach favoured topology over topography – connectivity over geographical fidelity – which he achieved primarily by straightening out the lines and limiting changes in their direction to 45° and 90°. Beck submitted a presentation copy of his map to the board of the Publicity Office of the UERL that same year, and, although his solution was initially rejected as being too revolutionary, Beck re-submitted his design in 1932 and it was accepted. The map was eventually issued as a pocket edition in January 1933; its first print run of 750,000 copies reflecting the board’s new-found confidence in its design and an enthusiastic reception by the public secured a further printing of 100,000 copies in February and a poster edition in March."}),e.jsx(x,{mt:"2",children:"Today, the ‘Tube map’ needs hardly any introduction. It has been hailed as a supreme example of information design; it has been implemented in transit mapping around the globe (with varying levels of success); it has been venerated, analysed and parodied; and it has been transformed into countless artefacts, souvenirs and merchandise – from mugs to face masks. Instantly recognizable and used by millions of travellers daily, it came second only to Concorde in a BBC poll in 2006 of favourite British designs of the twentieth century and is widely regarded as an icon of London itself. If the success of a cartographic design is measured by its use over space and time, Beck’s map certainly hits the mark with its worldwide imitation and marathon longevity. Ninety years after its inception, it is worth reflecting on how and why his design became an icon, and whether this can offer some insights about the nature of cartographic innovation that can inspire us today."}),e.jsx(x,{mt:"2",children:"In terms of bringing public recognition to Beck and his contribution to the map’s design, much is owed to graphic designer Ken Garland. He interviewed Beck in 1965, a year after Garbutt’s homage was published, and Garland championed the man and his map in an article for The Penrose Annual and later in his seminal contribution Mr Beck’s Underground Map: A History. Garland’s photographs of Beck and of his initial sketch map were included in the exhibition ‘Classics of Modern Design’ at Camden Arts Centre in 1977, along with later editions of the map. At the time, the map was ‘only just beginning to be recognized as a classic of twentieth century graphic design’, and Harry Beck – as he became more commonly known – gradually gained renown as the creator of ‘a masterpiece of twentieth century graphic art’. Beck and his map were featured in a 25-minute BBC documentary Design Classics in 1987 and were highlighted in a 1990 exhibition entitled ‘Finding the Way – 100 Years of London’s Transport Maps’ at the London Transport Museum. This official recognition was galvanized by their naming of the Museum’s new map gallery after Beck in 1993, and today, a large display in the Museum’s ‘London by Design’ exhibition is devoted to maps of the Underground and emphasizes Beck’s role in their evolution. In recognizing the debt owed to Beck after his death in 1974, Walker urged London Transport to acknowledge him by printing a credit to Beck on the then-current design by Garbutt. Yet it was not until 2001 that Transport for London (TfL) incorporated the statement ‘This diagram is an evolution of the original design conceived in 1931 by Harry Beck’ on the Tube map, cementing his association with the map and his unique role in its creation."}),e.jsx(x,{mt:"2",children:"Beck’s original design, however, was itself an evolution of the designs of previous maps of the Underground, particularly in their migration towards a more diagrammatic approach. Schematic maps of railway networks were already in use by the late nineteenth century and linear route diagrams, such as those designed by George Dow, were commonplace in commuter trains – including those used by Beck. This tends to be overlooked by appraisals of Beck’s design that exaggerate the scope of its innovation, promulgating the myth that his map emerged fully fledged as an isolated, single stroke of genius. Beck’s map is regularly lauded as a radical departure from previous Underground maps with their confusing surface detail and poor legibility. It is, however, always easier to evaluate an innovation from our perspective looking back, rather than from the innovator’s perspective looking forward."}),e.jsx(x,{mt:"2",children:"The UERL was formed in 1902 and had produced its first map showing the Underground as a coordinated system by 1908. Beck’s design incorporated several successive innovations, which included the removal of surface detail, the enlargement of the central area, and the use of Johnston-style lettering. In 1920, the map’s first named designer, MacDonald (Max) Gill, who had been commissioned to create several striking pictorial maps for the Underground in the previous, had taken the bold step to remove all surface features (including the River Thames) from the map. This achieved a greater sense of clarity and freed the map from any reference to street-level detail – a transformative move in directing the evolution of its design away from maintaining geographical fidelity. Gill also gave the map its own distinctive visual style and identity, focusing its purpose and strengthening its association with its subject. Following Gill’s removal of all surface features, Fred H. Stingemore (a draughtsman in the Publicity Manager’s Office) expanded the map’s central area slightly and compressed its periphery. His re-insertion of the Thames restored the map’s geographical context, which aided orientation and renewed its visual association with London. But it was Stingemore’s introduction of the Johnston typeface (with his simple, hand-drawn uppercase letters replacing Gill’s flamboyant calligraphic style), which perhaps signalled a new aesthetic direction that would align the map to the wider visual language of the Underground, including Charles Holden’s architecture of 1923–1942."}),e.jsx(x,{mt:"2",children:"Gill’s omission of surface features and Stingemore’s approach to lettering had therefore set the stage for a radical re-arrangement of the map. If its predecessors were ‘tied to the geography of London above ground’, Beck’s first published design of 1933 finally tipped the balance towards topology and embraced the new cartographic possibilities that this offered. As Beck himself justified, it simply ‘seemed common sense. If you’re going underground, why do you need to bother about geography? It’s not so important. Connections are the thing’. Gill and Stingemore also allowed scope for a more holistic aesthetic to emerge – one that could mimic the bold geometry of the uppercase letters of Johnston’s sans serif typeface. The close visual association between the microaesthetics of the lettering and the macroaesthetics of the map’s structure utilizes their similar vertical, horizontal and diagonal forms to create a sense of unity and conformity that permeates from the first impression to closer reading. As Gill’s calligraphic lettering had echoed the organic, fluid form of what Beck had called the ‘vermicelli’ of Underground lines, so Johnston’s modern typeface heralded a new approach that would be based upon clarity, directness and simplicity."}),e.jsx(x,{mt:"2",children:"There are many reasons for the success of Beck’s design and the magnitude of its enduring impact. When it was first published in 1933, the map presented a sufficient departure from previous designs to warrant an official plea for user feedback. Its enthusiastic reception by the public, however, not only expunged any lingering doubts, but managed to eclipse the impact of its previous designers. Garland described the map as ‘so obviously useful’, with Roberts identifying that its usability is ultimately derived from the simplicity of its design. Others, such as Pike, ascribe the success of the map to the colour-coding of its lines: ‘the primary feature that Beck borrowed from the failed attempts of his predecessors to conceptualize the Underground as a modernist space’. Certainly, the success of Beck’s design is due to a combination of factors, which include an internal structure that offered enhanced usability; an aesthetic appeal that resonated sufficiently with society to facilitate its positive reception; and its agency to transform the negative image of the Underground within the minds of its would-be users. Beck therefore produced the right map at the right time and in the right place, but he also ensured that it would affect its users in the right way by promising a modern experience of urban travel that they desired."}),e.jsx(x,{mt:"2",children:"Bain considers the most significant trait of transit maps to be their geographical distortion, which is what makes them practical. For Garland, the distortion in Beck’s map was ‘purposeful, straightforward and skilful’. The exclusion of surface features allowed Beck to introduce a level of distortion that could achieve greater clarity and balance without incurring excessive disorientation (for a geometric analysis). Indeed, passengers can sometimes find too much distortion unacceptable, with the 1972 subway map of New York City abandoned for this reason. More specifically, the architecture of Beck’s design, as constructed by straightening the lines and limiting changes in their direction to 45° and 90° angles (termed octolinearity), served to reduce the inherent complexity of the network, enhancing the map’s usability. As Roberts explains, ‘[b]y casting away irrelevant details, [Beck] presented the routes as simple, straight lines, minimising their kinks, maintaining interchanges, and making overall trajectories […] easier to identify’. Since straighter lines induce a lower cognitive load than twisting ones, journeys become easier to plan and remember. In addition, maps with the simplest line trajectories tend to be judged as the most usable, although octolinearity does not always offer the most effective solution. Beck’s map was not the first octolinear transit map to be published, e.g. Cartwright presents a map of the Berlin S-Bahn that was published in 1931, but the global influence of Beck’s design has ensured that octolinearity remains the most frequent choice for schematic maps in which line trajectories are depicted as linear."}),e.jsx(x,{mt:"2",children:"Regardless of the source of his inspiration, Beck’s design principles created a graphic identity and ensured a continuity that remains unparalleled in any other metropolitan subway diagram. They also exhibit an aesthetic appeal that generates positive connotations for would-be users of the Underground. Walker identified principles that are historically associated with Classicism, i.e. order, unity, harmony, stability, purity, clarity, economy, anonymity of finish, and rationality. More recently, Roberts et al. define the principles of successful transit map design as simplicity, coherence, balance, harmony, and topographicity. If Beck knew intuitively that the most elementary and simple of forms, if well-proportioned and of graceful contour, are the most pleasing, he applied a graphical approach that tempered the visual harshness of lines changing their direction by using tight curves instead of angular joins (unlike the later attempt by Hutchison), to create a perception of flow. Together with the regularity of straight lines and evenly spaced stations, this presented an image of London for the modern era."}),e.jsx(x,{mt:"2",children:"The public welcomed this new, utopian image of the city. In the grip of an economic depression, the financial argument for modern industrial design grew and a machine aesthetic began to emerge in the design vocabulary of British products; clean modern lines reflected a new industrial functionalism. Beck’s regular angles and vibrant colours met the public taste for the machine aesthetic and were in step with the Art Deco style. For London in the 1930s, the requirements of mass-production had elevated efficiency, functionality, and standardization as new social values to which Beck’s map presented ‘an ideal image of modern time and space: orderly, lucid, regular, efficient, and entirely functional’. Central to the map’s success, then, was the transformative possibility it offered to re-imagine the Underground, and, ultimately, London itself. As Pike puts it, the ‘outmoded, filthy underground of mining and slums’ gave way to the ‘inorganic, ordered space of modernism’. To those encountering the map, it therefore communicated in that first half-second a fresh and positive image of the city as a whole. For Garland, the map transcends its navigational purpose, since ‘the optimistic vision it offered of a city that was not chaotic […]. Its bright, clean and colourful design exuded confidence in every line’. The map, therefore, served to replace negative connotations of the Underground with positive connotations, affecting users’ perceptions and behaviour. More simply, the image of the map aligned to what users of the Underground wanted it to be – a clean, straightforward and efficient way of getting around the city."}),e.jsx(x,{mt:"2",children:"Giving people confidence to use the Underground was the ultimate purpose of Beck’s map, and this particular motivation – to give users confidence – perhaps lies at the very heart of cartographic design. As Berger noted, Beck’s map gives ‘mastery and power’, providing the user with ‘the illusion of control, somehow of this vast entity’. Beyond this, Hornsey believes that the map ‘sought to revise how individual passengers responded to the corporate built environment, so that they might learn to align their behaviour with the spatial requirements of the dynamic system’, drawing a comparison, for example, with the introduction of escalators in 1924 to regulate passenger movement. Penrice suggests that map and traveller become a working model of the railway, and not a static representation. Indeed, although maps can empower users, their performative function includes their agency to influence user behaviour, and the map’s continued serves to reinforce this agency. Perhaps more so for Beck’s map than for its predecessors, this agency is derived from an impression of unauthoredness; its inorganic, abstract form contrasts with their organic, representative design while its rationalization of the chaos of the Underground network and machine aesthetic suggest that the map is a product of the Underground network itself. As Walker observed, passengers look through it rather than at it (emphasis original). For them, the map is the network."})]})]}),e.jsxs(Tt,{children:[e.jsx("h2",{children:e.jsxs(Et,{children:[e.jsx(I,{as:"span",flex:"1",textAlign:"left",children:"Questions"}),e.jsx(Mt,{})]})}),e.jsx(It,{pb:4,children:a>0&&l.map((h,c)=>e.jsxs(I,{children:[e.jsx(x,{mt:"2",mb:"2",children:h.question}),h.answers.length===1?e.jsx(xn,{onChange:p=>{const m=structuredClone(f);m[c]=[p],d(m)},value:f[c][0],children:e.jsx(ht,{direction:"column",children:h.choices.map(p=>e.jsx(yn,{value:p,children:p},p))})}):e.jsx(jn,{colorScheme:"green",onChange:p=>{const m=structuredClone(f);m[c]=p,d(m)},value:f[c],children:e.jsx(ht,{direction:"column",children:h.choices.map(p=>e.jsx(ut,{value:p,children:p},p))})})]},h.question))})]})]})]}),e.jsx(de,{children:e.jsx(E,{onClick:g,isDisabled:a===0,children:a<0?o("header.settings.procedures.unlockSimplePath.unlocked"):o(a===0?"header.settings.procedures.unlockSimplePath.maximumAttemptsExceed":"header.settings.procedures.unlockSimplePath.check")})})]})]})},Se={width:"100%",justifyContent:"space-between"},Ce={fontFamily:"-apple-system"},Ri=t=>{const{isOpen:i,onClose:s}=t,{keepLastPath:n}=te(y=>y.runtime),a=$(),{t:r}=G(),o=Vt("primary.500","primary.300"),[l,u]=j.useState(!1),[f,d]=j.useState(!1),[g,h]=j.useState(!1),[c,p]=j.useState(!1),[m,v]=j.useState(!1),[w,b]=j.useState(!1),k=U.isAllowAnalytics(),{telemetry:{app:A}}=te(y=>y.app),S=y=>a(Xn(y));return e.jsxs(F,{isOpen:i,onClose:s,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(Z,{}),e.jsxs(K,{children:[e.jsx(Y,{children:r("header.settings.title")}),e.jsx(V,{}),e.jsx(q,{children:e.jsxs(xe,{divider:e.jsx(bn,{borderColor:"gray.200"}),children:[e.jsxs(I,{width:"100%",mb:"3",children:[e.jsx(x,{as:"b",fontSize:"xl",children:r("header.settings.preference.title")}),e.jsx(I,{mt:"3",children:e.jsxs(I,{display:"flex",mb:"1",children:[e.jsx(x,{flex:"1",children:r("header.settings.preference.keepLastPath")}),e.jsx(Qe,{isChecked:n,onChange:({target:{checked:y}})=>a(Yn(y))})]})})]}),e.jsxs(I,{width:"100%",mb:"3",children:[e.jsx(x,{as:"b",fontSize:"xl",children:r("header.settings.procedures.title")}),e.jsxs(I,{mt:"3",children:[e.jsx(E,{sx:Se,rightIcon:e.jsx(ke,{}),onClick:()=>u(!0),children:r("header.settings.procedures.translate.title")}),e.jsx(Ti,{isOpen:l,onClose:()=>u(!1)}),e.jsx(E,{sx:Se,rightIcon:e.jsx(ke,{}),onClick:()=>d(!0),children:r("header.settings.procedures.scale.title")}),e.jsx(Ei,{isOpen:f,onClose:()=>d(!1)}),e.jsx(E,{sx:Se,rightIcon:e.jsx(ke,{}),onClick:()=>h(!0),children:e.jsxs(I,{children:[r("header.settings.procedures.changeType.title"),e.jsx(Ze,{label:r("header.settings.pro"),children:e.jsx(ze,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})})]})}),e.jsx(Mi,{isOpen:g,onClose:()=>h(!1)}),e.jsx(E,{sx:Se,rightIcon:e.jsx(ke,{}),onClick:()=>p(!0),children:e.jsxs(I,{children:[r("header.settings.procedures.changeLineStyleType.title"),e.jsx(Ze,{label:r("header.settings.pro"),children:e.jsx(ze,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})})]})}),e.jsx(Ii,{isOpen:c,onClose:()=>p(!1)}),e.jsx(E,{sx:Se,rightIcon:e.jsx(ke,{}),onClick:()=>v(!0),children:r("header.settings.procedures.removeLines.title")}),e.jsx(Bi,{isOpen:m,onClose:()=>v(!1)}),e.jsx(E,{sx:Se,rightIcon:e.jsx(ke,{}),onClick:()=>b(!0),children:r("header.settings.procedures.unlockSimplePath.title")}),e.jsx(Ni,{isOpen:w,onClose:()=>b(!1)})]})]}),e.jsxs(I,{width:"100%",mb:"3",children:[e.jsx(x,{as:"b",fontSize:"xl",children:r("header.settings.shortcuts.title")}),e.jsx(I,{mt:"3",children:e.jsxs(wn,{children:[e.jsx(vn,{children:e.jsxs(re,{children:[e.jsx(Bt,{children:r("header.settings.shortcuts.keys")}),e.jsx(Bt,{children:r("header.settings.shortcuts.description")})]})}),e.jsxs(kn,{children:[e.jsxs(re,{children:[e.jsx(L,{children:e.jsx(B,{children:"f"})}),e.jsx(L,{children:r("header.settings.shortcuts.f")})]}),e.jsxs(re,{children:[e.jsx(L,{children:e.jsxs(I,{display:"flex",flexDirection:"row",children:[e.jsx(Vn,{}),e.jsx(qn,{}),e.jsx(Jn,{}),e.jsx($n,{})]})}),e.jsx(L,{children:r("header.settings.shortcuts.arrows")})]}),e.jsxs(re,{children:[e.jsx(L,{children:e.jsxs(I,{display:"flex",flexDirection:"row",children:[e.jsx(B,{children:"i"}),e.jsx(B,{children:"j"}),e.jsx(B,{children:"k"}),e.jsx(B,{children:"l"})]})}),e.jsx(L,{children:r("header.settings.shortcuts.ijkl")})]}),e.jsxs(re,{children:[e.jsx(L,{children:Me?e.jsx(B,{sx:Ce,children:"⇧"}):e.jsx(B,{children:"shift"})}),e.jsx(L,{children:r("header.settings.shortcuts.shift")})]}),e.jsxs(re,{children:[e.jsx(L,{children:Me?e.jsx(B,{sx:Ce,children:"⌥"}):e.jsx(B,{children:"alt"})}),e.jsx(L,{children:r("header.settings.shortcuts.alt")})]}),e.jsxs(re,{children:[e.jsx(L,{children:Me?e.jsx(B,{sx:Ce,children:"⌫"}):e.jsx(B,{children:"delete"})}),e.jsx(L,{children:r("header.settings.shortcuts.delete")})]}),e.jsxs(re,{children:[e.jsxs(L,{children:[Me?e.jsx(B,{sx:Ce,children:"⌘"}):e.jsx(B,{children:"ctrl"})," + ",e.jsx(B,{children:"z"})]}),e.jsx(L,{children:r("header.settings.shortcuts.undo")})]}),e.jsxs(re,{children:[e.jsx(L,{children:Me?e.jsxs(e.Fragment,{children:[e.jsx(B,{sx:Ce,children:"⇧"})," + ",e.jsx(B,{sx:Ce,children:"⌘"})," + ",e.jsx(B,{children:"z"})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{children:"ctrl"})," + ",e.jsx(B,{children:"y"})]})}),e.jsx(L,{children:r("header.settings.shortcuts.redo")})]})]})]})})]}),e.jsxs(I,{width:"100%",mb:"3",children:[e.jsx(x,{as:"b",fontSize:"xl",children:r("header.settings.telemetry.title")}),e.jsxs(I,{mt:"3",children:[e.jsxs(I,{display:"flex",mb:"1",children:[e.jsx(x,{flex:"1",children:r("header.settings.telemetry.essential")}),e.jsx(Qe,{isChecked:k,isDisabled:!0})]}),e.jsx(x,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:r("header.settings.telemetry.essentialInfo")}),e.jsxs(z,{color:o,fontSize:"sm",lineHeight:"100%",href:"https://support.google.com/analytics/answer/11593727",isExternal:!0,children:[r("header.settings.telemetry.essentialLink")," ",e.jsx(M,{as:T})]}),e.jsxs(I,{display:"flex",mb:"1",children:[e.jsx(x,{flex:"1",children:r("header.settings.telemetry.additional")}),e.jsx(Qe,{isChecked:A,onChange:({target:{checked:y}})=>S(y)})]}),e.jsx(x,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:r("header.settings.telemetry.additionalInfo")})]})]})]})})]})]})},Hi=Ri,_i=()=>{const[t,i]=j.useState(!1),{svgViewBoxZoom:s}=te(r=>r.param),n=$(),a=[{type:"slider",label:"",value:400-s,min:10,max:390,step:1,onChange:r=>n(nn(400-r)),leftIcon:e.jsx(Qn,{}),rightIcon:e.jsx(Wt,{}),minW:160}];return e.jsxs(Sn,{isOpen:t,onOpen:()=>i(!0),onClose:()=>i(!1),children:[e.jsx(Cn,{children:e.jsx(oe,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx(Wt,{}),onClick:()=>i(!t)})}),e.jsx(On,{children:e.jsx(zn,{children:e.jsx(je,{fields:a,noLabel:!0})})})]})};function Wi(){const{t}=G(),i=$(),{telemetry:{app:s}}=te(c=>c.app),{past:n,future:a}=te(c=>c.param),{isDonationModalOpen:r}=te(c=>c.runtime),[o,l]=j.useState(!1),[u,f]=j.useState(!1),d=Ft(U.getEnv),g=Ft(U.getAppVersion);j.useEffect(()=>{s&&d!==st.DEV&&U.event(pt.APP_LOAD,{isStandaloneWindow:U.isStandaloneWindow()})},[d]);const h=async c=>{U.getI18nInstance().changeLanguage(c)};return e.jsxs(es,{children:[e.jsx(ue,{as:"h4",size:"md",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:t("header.about.rmp")}),e.jsx(ts,{environment:d,version:g,popoverHeader:d===st.PRD?void 0:e.jsxs(Dt,{i18nKey:"header.popoverHeader",environment:d,children:["You're on ",{environment:d}," environment!"]}),popoverBody:d===st.PRD?void 0:e.jsx(Dt,{i18nKey:"header.popoverBody",children:"This is a testing environment where we test the latest beta RMP."})}),e.jsxs(An,{ml:"auto",children:[e.jsx(ae,{children:e.jsx(oe,{size:"sm",variant:"ghost","aria-label":"Undo",icon:e.jsx(ns,{}),isDisabled:n.length===0,onClick:()=>i(ss())})}),e.jsx(ae,{children:e.jsx(oe,{size:"sm",variant:"ghost","aria-label":"Redo",icon:e.jsx(is,{}),isDisabled:a.length===0,onClick:()=>i(rs())})}),e.jsx(ae,{children:e.jsx(_i,{})}),e.jsx(ae,{children:e.jsx(zi,{})}),e.jsx(ae,{children:e.jsx(xi,{})}),U.isStandaloneWindow()&&e.jsx(ae,{children:e.jsxs(kt,{children:[e.jsx(St,{as:oe,icon:e.jsx(as,{}),variant:"ghost",size:"sm"}),e.jsx(Ct,{children:["en","zh-Hans","zh-Hant","ja","ko"].map(c=>e.jsx(pe,{onClick:()=>h(c),children:As[c][c]},c))})]})}),e.jsx(ae,{children:e.jsx(oe,{size:"sm",variant:"ghost","aria-label":"Donation",color:"red",icon:e.jsx(on,{}),onClick:()=>i(Lt(!0))})}),e.jsx(ae,{children:e.jsx(oe,{size:"sm",variant:"ghost","aria-label":"Settings",icon:e.jsx(os,{}),onClick:()=>l(!0)})}),e.jsx(ae,{children:e.jsx(oe,{size:"sm",variant:"ghost","aria-label":"Help",icon:e.jsx(ls,{}),onClick:()=>f(!0)})})]}),e.jsx(Ws,{isOpen:r,onClose:()=>i(Lt(!1))}),e.jsx(Hi,{isOpen:o,onClose:()=>l(!1)}),e.jsx(Is,{isOpen:u,onClose:()=>f(!1)})]})}function Li(){const t=$(),i=te(n=>n.runtime.globalAlerts),s=n=>{U.isStandaloneWindow()?window.open(`/${n}`,"_blank"):U.openApp(n)};return e.jsx(e.Fragment,{children:Object.entries(i).map(([n,{message:a,url:r,linkedApp:o}])=>e.jsxs(Tn,{status:n,variant:"solid",size:"xs",pl:3,pr:1,py:0,zIndex:"1",children:[e.jsx(En,{}),o?e.jsx(z,{onClick:()=>s(o),children:a}):r?e.jsx(z,{href:r,target:"_blank",children:a}):a,e.jsx(Jt,{ml:"auto",onClick:()=>t(cs(n))})]},n))})}function Ki(){return e.jsxs(e.Fragment,{children:[e.jsx(Wi,{}),e.jsx(Li,{})]})}export{Ki as default};
