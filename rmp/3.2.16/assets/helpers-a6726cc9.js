import{S as p,G as i}from"./index-d1183c16.js";const b=()=>navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),S=t=>new Promise(e=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.readAsDataURL(t)}),_=(t,e)=>t.find(n=>{const s=n.style;return s.getPropertyValue("font-family")===e.family&&s.getPropertyValue("unicode-range")===e.unicodeRange}),A=async(t,e,n,s)=>{var m,f;const a=Array.from(new Set(e.map(r=>[...t.querySelectorAll(r)]).flat().map(r=>r.innerHTML).join("").replace(/\s/g,""))).join(""),u=await document.fonts.load(n.join(", "),a),o=(f=(m=document.querySelector(`link#${s}`))==null?void 0:m.sheet)==null?void 0:f.cssRules;if(!o)return Promise.reject(new Error(`cssRules can not be found in link#${s}`));const g=Array.from(o).filter(r=>r instanceof CSSFontFaceRule),h=u.reduce((r,c)=>{const l=_(g,c);return l?r.find(M=>{const y=M.style,d=l.style;return y.getPropertyValue("font-family")===d.getPropertyValue("font-family")&&y.getPropertyValue("unicode-range")===d.getPropertyValue("unicode-range")})?r:r.concat(l):r},[]);return await Promise.all(h.map(async r=>{try{const c=await fetch(x(r)),l=await S(await c.blob());return r.cssText.replace(/src:[ \w('",\-:/.)]+;/g,`src: url('${l}'); `)}catch(c){return console.error(c),""}}))},x=t=>{var n;const e=t.style.getPropertyValue("src");return b()?e.replace(/^url\("(\S+)"\).*$/,"$1"):"/rmp//styles/"+((n=e.match(/^url\("([\S*]+)"\)/))==null?void 0:n[1])},F={[p.MTR]:{className:[".rmp-name__mtr__zh",".rmp-name__mtr__en"],cssFont:["80px GenYoMin TW","Vegur"],cssName:"fonts_mtr"},[i.BerlinSBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["16px Roboto"],cssName:"fonts_berlin"},[i.BerlinUBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["16px Roboto"],cssName:"fonts_berlin"}},V=t=>{const e=t.currentTarget.getBoundingClientRect(),n=t.clientX-e.left,s=t.clientY-e.top;return{x:n,y:s}},P=(t,e)=>Math.round(t/e)*e,w=t=>{let[e,n,s,a]=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];return t.forEachNode((u,o)=>{e=Math.min(o.x,e),n=Math.min(o.y,n),s=Math.max(o.x,s),a=Math.max(o.y,a)}),e-=100,n-=100,s+=150,a+=150,{xMin:e,yMin:n,xMax:s,yMax:a}},B=navigator.platform.startsWith("Mac"),E=t=>{const e=Object.fromEntries([...Object.values(p),Object.values(i)].map(n=>[n,!1]));return t.forEachNode(n=>{const s=t.getNodeAttribute(n,"type");e[s]=!0}),e},L=t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t};export{F,V as a,w as c,E as f,A as g,B as i,P as r,L as s};
