import{S as h,G as f}from"./index-73eb1caf.js";const S=()=>navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),_=t=>new Promise(e=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.readAsDataURL(t)}),M=(t,e)=>t.find(n=>{const r=n.style;return r.getPropertyValue("font-family")===e.family&&r.getPropertyValue("unicode-range")===e.unicodeRange}),A=async(t,e,n,r)=>{var o,d;const a=Array.from(new Set(e.map(s=>[...t.querySelectorAll(s)]).flat().map(s=>s.innerHTML).join("").replace(/\s/g,""))).join(""),c=await document.fonts.load(n.join(", "),a),m=(d=(o=document.querySelector(`link#${r}`))==null?void 0:o.sheet)==null?void 0:d.cssRules;if(!m)return Promise.reject(new Error(`cssRules can not be found in link#${r}`));const y=Array.from(m).filter(s=>s instanceof CSSFontFaceRule),l=c.reduce((s,i)=>{const u=M(y,i);return u?s.find(b=>{const g=b.style,p=u.style;return g.getPropertyValue("font-family")===p.getPropertyValue("font-family")&&g.getPropertyValue("unicode-range")===p.getPropertyValue("unicode-range")})?s:s.concat(u):s},[]);return await Promise.all(l.map(async s=>{try{const i=await fetch(N(s)),u=await _(await i.blob());return s.cssText.replace(/src:[ \w('",\-:/.)]+;/g,`src: url('${u}'); `)}catch(i){return console.error(i),""}}))},N=t=>{var n;const e=t.style.getPropertyValue("src");return S()?e.replace(/^url\("(\S+)"\).*$/,"$1"):"/rmp//styles/"+((n=e.match(/^url\("([\S*]+)"\)/))==null?void 0:n[1])},F={[h.MTR]:{className:[".rmp-name__mtr__zh",".rmp-name__mtr__en"],cssFont:["80px GenYoMin TW","Vegur"],cssName:"fonts_mtr"},[f.BerlinSBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["16px Roboto"],cssName:"fonts_berlin"},[f.BerlinUBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["16px Roboto"],cssName:"fonts_berlin"}},P=t=>{const e=t.currentTarget.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;return{x:n,y:r}},C=(t,e)=>Math.round(t/e)*e,E=(t,e)=>{let[n,r,a,c]=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];return t.forEachNode((m,y)=>{const l=document.getElementById(m),o=l==null?void 0:l.getBoundingClientRect();o&&(n=Math.min(e.x+o.x,n),r=Math.min(e.y+o.y,r),a=Math.max(e.x+o.x+o.width,a),c=Math.max(e.y+o.y+o.height,c))}),n-=100,r-=100,a+=100,c+=100,{xMin:n,yMin:r,xMax:a,yMax:c}},L=navigator.platform.startsWith("Mac"),B=t=>{const e=Object.fromEntries([...Object.values(h),Object.values(f)].map(n=>[n,!1]));return t.forEachNode(n=>{const r=t.getNodeAttribute(n,"type");e[r]=!0}),e},T=t=>{for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t};export{F,P as a,E as c,B as f,A as g,L as i,C as r,T as s};
