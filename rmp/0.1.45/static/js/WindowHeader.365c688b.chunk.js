(self.webpackChunkrmp=self.webpackChunkrmp||[]).push([[4030],{2153:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return K}});var r=t(4165),o=t(5861),i=t(9439),s=t(2791),a=t(8735),c=t(1641),l=t(2504),d=t(7322),h=t(2020),u=t(6899),f=t(2006),p=t(7770),x=t(6538),j=t(713),m=t(5987),g=t(4942),v=t(3433),w=t(1413),b=t(5984),y=t(7339),C=t(5105),O=t(3671),Z=t(138),S=t(3486),k=t(8817),E=t(6853),A=t(708),z=t(9793),M=t(184),U=function(e){var n=e.isOpen,i=e.handleOpenTemplates,s=e.onClose,c=(0,h.$)().t,d=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(9681)("./".concat(n,".json"));case 2:o=e.sent,i(o.default),s();case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,M.jsxs)(z.u_,{isOpen:n,onClose:s,children:[(0,M.jsx)(z.ZA,{}),(0,M.jsxs)(z.hz,{children:[(0,M.jsx)(z.xB,{children:c("header.open.gallery")}),(0,M.jsx)(z.ol,{}),(0,M.jsx)(z.fe,{children:(0,M.jsx)(a.gC,{children:["shanghai","guangzhou","beijing","santiago"].map((function(e){return(0,M.jsx)(l.zx,{minWidth:200,onClick:function(){return d(e)},children:c("header.open.".concat(e))},e)}))})})]})]})},N=["version"],_=["version"];function T(){var e=(0,h.$)().t,n=(0,y.u5)(),t=s.useRef(window.graph),u=s.useRef(null),f=s.useRef(null),p=s.useState(!1),x=(0,i.Z)(p,2),j=x[0],z=x[1],T=s.useCallback((function(){n((0,O.n9)()),n((0,C.DR)(t.current.export()))}),[n,O.n9,C.DR,t]),B=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var o,s,a,c,l,d,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null===(o=n.target.files)||void 0===o?void 0:o[0],console.log("OpenActions.handleUploadRMG():: received file",s),"application/json"===(null===s||void 0===s?void 0:s.type)){e.next=6;break}console.error("OpenActions.handleUploadRMG():: Invalid file type! Only file in JSON format is accepted."),e.next=23;break;case 6:return e.prev=6,e.next=9,J(s);case 9:a=e.sent,c=JSON.parse(a),l=c.stn_list,d=c.theme,h=Object.fromEntries(Object.keys(l).filter((function(e){return!["linestart","lineend"].includes(e)})).map((function(e){return[e,"stn_".concat((0,b.x0)(10))]}))),Object.entries(l).filter((function(e){var n=(0,i.Z)(e,2),t=n[0];n[1];return!["linestart","lineend"].includes(t)})).forEach((function(e){var n=(0,i.Z)(e,2),r=n[0],o=n[1],s=t.current.filterNodes((function(e,n){return Object.values(S.T).includes(n.type)&&n[n.type].names[0]===o.name[0]}));0!==s.length&&(h[r]=s[0])})),Object.entries(l).filter((function(e){var n=(0,i.Z)(e,2),t=n[0];n[1];return!["linestart","lineend"].includes(t)})).filter((function(e){var n=(0,i.Z)(e,2),r=(n[0],n[1]);return 0===t.current.filterNodes((function(e,n){return Object.values(S.T).includes(n.type)&&n[n.type].names[0]===r.name[0]})).length})).forEach((function(e,n){var r=(0,i.Z)(e,2),o=r[0],s=r[1],a=S.T.ShmetroBasic;"shmetro"===c.style?a=s.transfer.info.flat().length>0?S.T.ShmetroInt:"sh2020"===c.info_panel_type?S.T.ShmetroBasic2020:S.T.ShmetroBasic:"gzmtr"!==c.style&&"mtr"!==c.style||(a=s.transfer.info.flat().length>0?S.T.GzmtrInt:S.T.GzmtrBasic);var l=(0,w.Z)((0,w.Z)({},JSON.parse(JSON.stringify(E.Z[a].defaultAttrs))),{},{names:s.name});if(a===S.T.ShmetroBasic2020)l.color=d;else if(a===S.T.GzmtrBasic)l.color=c.theme,l.lineCode=c.line_num,l.stationCode=s.num;else if(a===S.T.GzmtrInt){var u=JSON.parse(JSON.stringify(s.transfer.info));u.forEach((function(e){return e.forEach((function(e){e[4]="1",e[5]="01"}))})),u[0].unshift([].concat((0,v.Z)(c.theme),[c.line_num,s.num])),l.transfer=u}t.current.addNode(h[o],(0,g.Z)({visible:!0,zIndex:0,x:100+50*n,y:1e3,type:a},a,l))})),Object.entries(l).filter((function(e){var n=(0,i.Z)(e,2),t=n[0];n[1];return!["linestart","lineend"].includes(t)})).forEach((function(e){var n=(0,i.Z)(e,2),r=n[0];n[1].children.filter((function(e){return!["linestart","lineend"].includes(e)})).forEach((function(e){var n;t.current.addDirectedEdgeWithKey("line_".concat((0,b.x0)(10)),h[r],h[e],(n={visible:!0,zIndex:0,color:d,type:k.S.Diagonal},(0,g.Z)(n,k.S.Diagonal,JSON.parse(JSON.stringify(A.Z[k.S.Diagonal].defaultAttrs))),(0,g.Z)(n,"reconcileId",""),n))}))})),T(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),console.error("OpenActions.handleUploadRMG():: Unknown error occurred while parsing the uploaded file",e.t0);case 23:n.target.value="";case 24:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(n){return e.apply(this,arguments)}}(),R=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(o){var i,s,a,c,l,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null===(i=o.target.files)||void 0===i?void 0:i[0],console.log("OpenActions.handleUpload():: received file",s),"application/json"===(null===s||void 0===s?void 0:s.type)){e.next=6;break}console.error("OpenActions.handleUpload():: Invalid file type! Only file in JSON format is accepted."),e.next=28;break;case 6:return e.prev=6,e.next=9,J(s);case 9:return a=e.sent,e.t0=JSON,e.next=13,(0,Z._s)(a);case 13:e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),c.version,l=(0,m.Z)(c,N),n((0,O.x_)()),t.current.clear(),t.current.import(l.graph),d=(0,w.Z)((0,w.Z)({},l),{},{graph:JSON.stringify(l.graph)}),n((0,C.hf)(d)),T(),e.next=28;break;case 25:e.prev=25,e.t2=e.catch(6),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",e.t2);case 28:o.target.value="";case 29:case"end":return e.stop()}}),e,null,[[6,25]])})));return function(n){return e.apply(this,arguments)}}(),P=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(o){var i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.version,i=(0,m.Z)(o,_),n((0,O.x_)()),t.current.clear(),t.current.import(i.graph),s=(0,w.Z)((0,w.Z)({},i),{},{graph:JSON.stringify(i.graph)}),n((0,C.hf)(s)),T();case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,M.jsxs)(c.v2,{children:[(0,M.jsx)(c.j2,{as:l.hU,size:"sm",variant:"ghost",icon:(0,M.jsx)(d.Ap8,{})}),(0,M.jsxs)(c.qy,{children:[(0,M.jsx)(c.sN,{icon:(0,M.jsx)(d.KVB,{}),onClick:function(){n((0,O.x_)()),t.current.clear();n((0,C.hf)({graph:"{}",svgViewBoxZoom:100,svgViewBoxMin:{x:0,y:0}})),T()},children:e("header.open.new")}),(0,M.jsx)("input",{ref:f,type:"file",accept:".json",hidden:!0,onChange:R,"data-testid":"file-upload"}),(0,M.jsx)(c.sN,{icon:(0,M.jsx)(d.Ap8,{}),onClick:function(){var e;return null===f||void 0===f||null===(e=f.current)||void 0===e?void 0:e.click()},children:e("header.open.config")}),(0,M.jsx)("input",{ref:u,type:"file",accept:".json",hidden:!0,onChange:B,"data-testid":"file-upload"}),(0,M.jsx)(c.sN,{icon:(0,M.jsx)(d.Ap8,{}),onClick:function(){var e;return null===u||void 0===u||null===(e=u.current)||void 0===e?void 0:e.click()},children:e("header.open.configRMG")}),(0,M.jsxs)(c.sN,{icon:(0,M.jsx)(d.uEt,{}),onClick:function(){return z(!0)},children:[e("header.open.gallery"),(0,M.jsx)(a.Ct,{ml:"1",colorScheme:"green",children:"New"})]}),(0,M.jsx)(U,{isOpen:j,handleOpenTemplates:P,onClose:function(){return z(!1)}})]})]})}var J=function(e){return new Promise((function(n){var t=new FileReader;t.onloadend=function(){return n(t.result)},t.readAsText(e)}))},B=t(5420),R=t(9113),P=t(3300),I=function(e){var n=e.isOpen,t=e.onClose,r=(0,h.$)().t;return(0,M.jsxs)(z.u_,{isOpen:n,onClose:t,size:"xl",scrollBehavior:"inside",children:[(0,M.jsx)(z.ZA,{}),(0,M.jsxs)(z.hz,{children:[(0,M.jsx)(z.xB,{children:r("header.download.termsAndConditions")}),(0,M.jsx)(z.ol,{}),(0,M.jsx)(z.fe,{children:(0,M.jsxs)(a.GS,{children:[(0,M.jsxs)(a.HC,{children:["The layout of the elements on the signage or rail map, is designed by"," ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",(0,M.jsx)(R.JO,{as:d.jhj})]}),", ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",(0,M.jsx)(R.JO,{as:d.jhj})]})," or ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",(0,M.jsx)(R.JO,{as:d.jhj})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",(0,M.jsx)("br",{}),"\u6807\u5fd7\u7248\u6216\u8def\u7ebf\u56fe\u7684\u5143\u7d20\u6216\u5e03\u5c40\uff0c\u57fa\u4e8e\u4f60\u6240\u9009\u62e9\u7684\u98ce\u683c\uff0c\u4e3a",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["\u4e0a\u6d77\u7533\u901a\u5730\u94c1\u96c6\u56e2 ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\uff0c",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["\u5e7f\u5dde\u5730\u94c1\u96c6\u56e2\u516c\u53f8 ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\u6216",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["\u6e2f\u94c1\u516c\u53f8 ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\u6240\u8bbe\u8ba1\u3002\u5728\u4ea7\u751f\u7684\u56fe\u50cf\u7528\u4f5c\u5546\u4e1a\u7528\u9014\u524d\uff0c\u4f60\u5e94\u5411\u76f8\u5173\u516c\u53f8\u53d6\u5f97\u9002\u5f53\u4e4b\u8bb8\u53ef\u8bc1\u6216\u6388\u6743\u3002"]}),(0,M.jsxs)(a.HC,{children:["The elements including shapes and lines on the image are drawn by"," ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",(0,M.jsx)(R.JO,{as:d.jhj})]})," and ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",(0,M.jsx)(R.JO,{as:d.jhj})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",(0,M.jsx)("br",{}),"\u56fe\u50cf\u7684\u5143\u7d20\uff0c\u5305\u62ec\u56fe\u5f62\u53ca\u7ebf\u6761\uff0c\u5747\u7531",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\u53ca",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\u57fa\u4e8e\u4e0a\u8ff0\u516c\u53f8\u8bbe\u8ba1\u6807\u51c6\u6216\u51c6\u5219\u7ed8\u5236\u3002\u4f60\u53ef\u5c06\u5176\u7528\u4e8e\u4efb\u4f55\u76ee\u7684\uff0c\u4f46\u6211\u4eec\u5efa\u8bae\u4f60\u4e8e\u4f7f\u7528\u540c\u65f6\u9644\u4ee5\u6211\u4eec\u7684\u540d\u5b57\u4ee5\u53ca\u672c\u7f51\u7ad9\u5730\u5740\u3002"]}),(0,M.jsxs)(a.HC,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Painter uses"," ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",(0,M.jsx)(R.JO,{as:d.jhj})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",(0,M.jsx)("br",{}),"\u7531\u4e8e\u8457\u4f5c\u6743\u53ca\u5176\u4ed6\u6cd5\u5f8b\u9650\u5236\uff0c\u94c1\u8def\u8def\u7ebf\u56fe\u7ed8\u5236\u5668\u4f7f\u7528\u7531",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["ButTaiwan\u63d0\u4f9b\u7684\u6e90\u6a23\u660e\u9ad4 ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\uff0c\u4ee5\u53caVegur\uff0c\u4ee5\u4ee3\u66ff\u6e2f\u94c1\u6837\u5f0f\u6807\u5fd7\u724c\u6240\u4f7f\u7528\u7684\u5730\u94c1\u5b8b\u53caMyriad Pro\u3002\u5728\u4ea7\u751f\u4e4b\u56fe\u50cf\u7528\u4f5c\u5546\u4e1a\u7528\u9014\u524d\uff0c\u4f60\u5e94\u5411\u5b57\u578b\u751f\u4ea7\u5382\u5546\u53d6\u5f97\u9002\u5f53\u4e4b\u8bb8\u53ef\u8bc1\u6216\u6388\u6743\u3002"]}),(0,M.jsxs)(a.HC,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes except commercial use, under the conditions above.",(0,M.jsx)("br",{}),"\u8f93\u51fa\u7684PNG\u6216SVG\u56fe\u50cf\u53ef\u57fa\u4e8e\u4e0a\u8ff0\u6761\u6b3e\uff0c\u5728\u975e\u5546\u4e1a\u4f7f\u7528\u65f6\uff0c\u7528\u4e8e\u4fee\u6539\u3001\u53d1\u884c\u6216\u5176\u4ed6\u7528\u9014\u3002"]}),(0,M.jsxs)(a.HC,{children:["All flag emojis shown on Windows platforms are designed by"," ",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",(0,M.jsx)(R.JO,{as:d.jhj})]})," ","\u2013 the open-source emoji and icon project. License:",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",(0,M.jsx)(R.JO,{as:d.jhj})]}),(0,M.jsx)("br",{}),"\u4e8eWindows\u4f5c\u4e1a\u7cfb\u7edf\u4e0a\u663e\u793a\u7684\u56fd\u65d7Emoji\u4e3a",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",(0,M.jsx)(R.JO,{as:d.jhj})]}),"\u6240\u8bbe\u8ba1\u3002\u8bb8\u53ef\u8bc1\uff1a",(0,M.jsxs)(a.rU,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",(0,M.jsx)(R.JO,{as:d.jhj})]})]}),(0,M.jsxs)(a.HC,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",(0,M.jsx)("br",{}),"\u6211\u4eec\u4fdd\u7559\u4fee\u6539\u3001\u65b0\u589e\u6216\u79fb\u9664\u4e0a\u8ff0\u6761\u6b3e\u4e4b\u6743\u5229\uff0c\u800c\u65e0\u9700\u53e6\u884c\u901a\u77e5\u3002\u4e2d\u6587\u8bd1\u672c\u4ec5\u4f9b\u53c2\u8003\uff0c\u6587\u4e49\u5982\u4e0e\u82f1\u6587\u6709\u6b67\u5f02\uff0c\u6982\u4ee5\u82f1\u6587\u672c\u4e3a\u51c6\u3002"]})]})})]})]})};function G(){var e=(0,h.$)().t,n=s.useRef(window.graph),t=s.useState("png"),r=(0,i.Z)(t,2),o=r[0],u=r[1],p={png:e("header.download.png"),svg:e("header.download.svg")},x=s.useState(100),j=(0,i.Z)(x,2),m=j[0],g=j[1],w=Object.fromEntries([25,33,50,67,75,80,90,100,110,125,150,175,200,250,300,400,500].map((function(e){return[e,"".concat(e,"%")]}))),b=s.useState(!1),C=(0,i.Z)(b,2),O=C[0],S=C[1],k=[{type:"select",label:e("header.download.format"),value:o,options:p,onChange:function(e){return u("png"===e?"png":"svg")}}],E=[{type:"select",label:e("header.download.scale"),value:m,options:w,onChange:function(e){return g(e)}},{type:"switch",label:e("header.download.transparent"),isChecked:O,onChange:S}],A=s.useState(!1),U=(0,i.Z)(A,2),N=U[0],_=U[1],T=s.useState(!1),J=(0,i.Z)(T,2),G=J[0],W=J[1],H=s.useState(!1),X=(0,i.Z)(H,2),Y=X[0],q=X[1],$=s.useState(!1),K=(0,i.Z)($,2),F=K[0],Q=K[1];return(0,M.jsxs)(c.v2,{children:[(0,M.jsx)(c.j2,{as:l.hU,size:"sm",variant:"ghost",icon:(0,M.jsx)(d.uKn,{})}),(0,M.jsxs)(c.qy,{children:[(0,M.jsx)(c.sN,{icon:(0,M.jsx)(d.tfk,{}),onClick:function(){var e=(0,Z.Ru)(y.ZP.getState().app);V("RMP_".concat((new Date).valueOf(),".json"),"application/json",e)},children:e("header.download.config")}),(0,M.jsx)(c.sN,{icon:(0,M.jsx)(d.e0s,{}),onClick:function(){return _(!0)},children:e("header.download.image")})]}),(0,M.jsxs)(z.u_,{size:"xl",isOpen:N,onClose:function(){return _(!1)},children:[(0,M.jsx)(z.ZA,{}),(0,M.jsxs)(z.hz,{children:[(0,M.jsx)(z.xB,{children:e("header.download.image")}),(0,M.jsx)(z.ol,{}),(0,M.jsxs)(z.fe,{children:[(0,M.jsx)(f.M5,{fields:k}),"png"===o&&(0,M.jsx)(f.M5,{fields:E}),(0,M.jsx)("br",{}),(0,M.jsx)(B.XZ,{isChecked:Y,onChange:function(e){return q(e.target.checked)},children:(0,M.jsxs)(a.xv,{children:[e("header.download.shareInfo1"),(0,M.jsxs)(a.rU,{color:"teal.500",onClick:function(){return window.open("https://railmapgen.github.io/rmp","_blank")},children:[e("header.about.rmp")," ",(0,M.jsx)(R.JO,{as:d.jhj})]}),e("header.download.shareInfo2")]})}),(0,M.jsx)(B.XZ,{isChecked:F,onChange:function(e){return Q(e.target.checked)},children:(0,M.jsxs)(a.xv,{children:[e("header.download.termsAndConditionsInfo"),(0,M.jsxs)(a.rU,{color:"teal.500",onClick:function(){return W(!0)},children:[e("header.download.termsAndConditions")," ",(0,M.jsx)(R.JO,{as:d.jhj})]}),e("header.download.period")]})})]}),(0,M.jsx)(z.mz,{children:(0,M.jsx)(a.Ug,{children:(0,M.jsx)(l.zx,{colorScheme:"teal",variant:"outline",size:"sm",disabled:!F,onClick:function(){_(!1);var e=(0,P.fx)(n.current),t=e.xMin,r=e.yMin,s=e.xMax,a=e.yMax,c=s-t,l=a-r,d=document.getElementById("canvas").cloneNode(!0);if((0,v.Z)(d.children).filter((function(e){return e.id.startsWith("misc_node_virtual")})).forEach((function(e){return d.removeChild(e)})),Y||d.appendChild(L(s-600,a-60)),d.setAttribute("viewBox","".concat(t," ").concat(r," ").concat(c," ").concat(l)),d.setAttribute("width",c.toString()),d.setAttribute("height",l.toString()),Object.entries({".rmp-name__zh":["font-family"],".rmp-name__en":["font-family"],".rmp-name-station":["paint-order","stroke","stroke-width"]}).forEach((function(e){var n=(0,i.Z)(e,2),t=n[0],r=n[1],o=document.querySelector(t),s=window.getComputedStyle(o);d.querySelectorAll(t).forEach((function(e){r.forEach((function(n){e.setAttribute(n,s.getPropertyValue(n))})),e.removeAttribute("class")}))})),"svg"!==o){document.body.appendChild(d);var h="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(d.outerHTML)));document.body.removeChild(d);var u=document.createElement("canvas"),f=c*m/100,p=l*m/100;u.width=f,u.height=p;var x=u.getContext("2d");O||(x.fillStyle="#fff",x.fillRect(0,0,f,p));var j=new Image;j.onload=function(){x.drawImage(j,0,0,f,p),u.toBlob((function(e){return D("RMP_".concat((new Date).valueOf(),".png"),e)}),"image/png")},j.src=h}else V("RMP_".concat((new Date).valueOf(),".svg"),"image/svg+xml",d.outerHTML)},children:e("header.download.confirm")})})}),(0,M.jsx)(I,{isOpen:G,onClose:function(){return W(!1)}})]})]})]})}var V=function(e,n,t){var r=new Blob([t],{type:n});D(e,r)},D=function(e,n){var t=window.URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)},L=function(e,n){var t=document.createElementNS("http://www.w3.org/2000/svg","g");t.setAttribute("transform","translate(".concat(e,", ").concat(n,")scale(2)"));var r=document.createElementNS("http://www.w3.org/2000/svg","image");r.setAttribute("width","40"),r.setAttribute("height","40"),r.setAttribute("x","-50"),r.setAttribute("y","-20");var o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("font-size","20"),o.appendChild(document.createTextNode("Rail Map Painter"));var i=document.createElementNS("http://www.w3.org/2000/svg","text");return i.setAttribute("y","15"),i.appendChild(document.createTextNode("https://railmapgen.github.io/rmp/")),t.appendChild(r),t.appendChild(o),t.appendChild(i),t},W=t(3046),H=t(6450),X=t(6866),Y=function(e){var n=e.isOpen,t=e.onClose,r=(0,h.$)().t,o=x.ZP.getAppVersion();return(0,M.jsxs)(z.u_,{isOpen:n,onClose:t,size:"xl",scrollBehavior:"inside",children:[(0,M.jsx)(z.ZA,{}),(0,M.jsxs)(z.hz,{children:[(0,M.jsx)(z.xB,{children:r("header.about.title")}),(0,M.jsx)(z.ol,{}),(0,M.jsxs)(z.fe,{paddingBottom:10,children:[(0,M.jsxs)(a.kC,{direction:"row",children:[(0,M.jsx)(W.Ee,{boxSize:"128px",src:"/rmp/logo192.png"}),(0,M.jsxs)(a.kC,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[(0,M.jsx)(a.xv,{fontSize:"xl",as:"b",children:r("header.about.rmp")}),(0,M.jsx)(a.xv,{children:o}),(0,M.jsx)(a.xv,{children:" "}),(0,M.jsx)(a.xv,{fontSize:"sm",children:r("header.about.railmapgen")})]})]}),(0,M.jsx)(a.xu,{margin:5,children:(0,M.jsx)(a.xv,{fontSize:"xl",children:r("header.about.desc")})}),(0,M.jsx)(a.X6,{as:"h5",size:"sm",mt:3,mb:2,children:r("header.about.contributors")}),(0,M.jsx)(a.X6,{as:"h6",size:"xs",my:2,children:r("header.about.coreContributors")}),(0,M.jsx)(a.gC,{children:(0,M.jsxs)(H.Vp,{size:"lg",minW:"80%",onClick:function(){return window.open("https://github.com/thekingofcity","_blank")},cursor:"pointer",children:[(0,M.jsx)(X.qE,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),(0,M.jsxs)(H.Sn,{display:"block",children:[(0,M.jsx)(a.xv,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),(0,M.jsx)(a.xv,{fontSize:"sm",children:r("header.about.content1")}),(0,M.jsx)(a.xv,{fontSize:"sm",align:"right",children:r("header.about.content2")})]})]})})]})]})]})},q=t(4817),$=function(){var e=s.useState(!1),n=(0,i.Z)(e,2),t=n[0],r=n[1],o=(0,y.Qy)((function(e){return e.app})).svgViewBoxZoom,a=(0,y.u5)(),c=[{type:"slider",label:"",value:400-o,min:10,max:390,step:10,onChange:function(e){return a((0,C.u4)(400-e))},leftIcon:(0,M.jsx)(d._a6,{}),rightIcon:(0,M.jsx)(d.Ers,{}),minW:160}];return(0,M.jsxs)(q.J2,{isOpen:t,onOpen:function(){return r(!0)},onClose:function(){return r(!1)},children:[(0,M.jsx)(q.xo,{children:(0,M.jsx)(l.hU,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:(0,M.jsx)(d._a6,{}),onClick:function(){return r(!t)}})}),(0,M.jsx)(q.yk,{children:(0,M.jsx)(q.b,{children:(0,M.jsx)(f.M5,{fields:c,noLabel:!0})})})]})};function K(){var e=(0,h.$)(),n=e.t,t=e.i18n,m=s.useState(!1),g=(0,i.Z)(m,2),v=g[0],w=g[1],b=s.useState(x.Sy.DEV),y=(0,i.Z)(b,2),C=y[0],O=y[1],Z=s.useState("unknown"),S=(0,i.Z)(Z,2),k=S[0],E=S[1];s.useEffect((function(){function e(){return(e=(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.ZP.ready();case 2:x.ZP.event(j.zW.APP_LOAD,{isStandaloneWindow:x.ZP.isStandaloneWindow()}),O(x.ZP.getEnv()),E(x.ZP.getAppVersion());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[O,E]);var A=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(n){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.ZP.setLanguage(n),e.next=3,t.changeLanguage(n);case 3:o=e.sent,document.documentElement.lang=n,document.title=o("header.about.rmp");case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,M.jsxs)(f.Td,{children:[(0,M.jsx)(a.X6,{as:"h4",size:"md",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n("header.about.rmp")}),(0,M.jsx)(f.xt,{environment:C,version:k,popoverHeader:C===x.Sy.PRD?void 0:(0,M.jsxs)(u.c,{i18nKey:"header.popoverHeader",environment:C,children:["You're on ",{environment:C}," environment!"]}),popoverBody:C===x.Sy.PRD?void 0:(0,M.jsx)(u.c,{i18nKey:"header.popoverBody",children:"This is a testing environment where we test the latest beta RMP."})}),(0,M.jsxs)(a.Ug,{ml:"auto",children:[(0,M.jsx)($,{}),(0,M.jsx)(T,{}),(0,M.jsx)(G,{}),(0,M.jsxs)(c.v2,{children:[(0,M.jsx)(c.j2,{as:l.hU,icon:(0,M.jsx)(d.mp2,{}),variant:"ghost",size:"sm"}),(0,M.jsxs)(c.qy,{children:[(0,M.jsx)(c.sN,{onClick:function(){return A(p.s.English)},children:"English"}),(0,M.jsx)(c.sN,{onClick:function(){return A(p.s.ChineseSimp)},children:"\u7b80\u4f53\u4e2d\u6587"}),(0,M.jsx)(c.sN,{onClick:function(){return A(p.s.ChineseTrad)},children:"\u7e41\u9ad4\u4e2d\u6587"})]})]}),(0,M.jsx)(l.hU,{size:"sm",variant:"ghost","aria-label":"Help",icon:(0,M.jsx)(d.r$n,{}),onClick:function(){return w(!0)}})]}),(0,M.jsx)(Y,{isOpen:v,onClose:function(){return w(!1)}})]})}},3300:function(e,n,t){"use strict";t.d(n,{Z9:function(){return o},fx:function(){return i},yK:function(){return r}});var r=function(e){var n=e.currentTarget.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}},o=function(e,n){return Math.round(e/n)*n},i=function(e){var n=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE],t=n[0],r=n[1],o=n[2],i=n[3];return e.forEachNode((function(e,n){t=Math.min(n.x,t),r=Math.min(n.y,r),o=Math.max(n.x,o),i=Math.max(n.y,i)})),{xMin:t-=150,yMin:r-=150,xMax:o+=150,yMax:i+=150}}},9681:function(e,n,t){var r={"./beijing.json":[4781,2639],"./guangzhou.json":[7845,5202],"./santiago.json":[8470,6398],"./shanghai.json":[7414,8233]};function o(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],o=n[0];return t.e(n[1]).then((function(){return t.t(o,19)}))}o.keys=function(){return Object.keys(r)},o.id=9681,e.exports=o}}]);
//# sourceMappingURL=WindowHeader.365c688b.chunk.js.map