import{c as de,a as ue,b as he,u as me,d as pe,e as R,f as L,R as w,j as d,M as F,g as e,h as W,i as $,k as V,l as J,m as Y,V as ge,I as q,H as P,T as K,n as Z,A as Q,o as X,p as b,q as fe,r as ye,s as be,t as we,v as ve,w as Re,x as Se,y as j,z as Ce,B as Me,F as C,C as Le,D as Pe,S as Ae,E as Oe,G as S,J as ee,K as te,L as y,N as Ee,O as A,P as ae,Q as De,U as M,W as Te,X as xe,Y as ne,Z as _,_ as Ie,$ as ke,a0 as je,a1 as _e,a2 as ze,a3 as Be,a4 as Ne,a5 as Ge,a6 as He,a7 as Ue,a8 as Fe,a9 as We,aa as $e,ab as Ve,ac as Je,ad as z,ae as B,af as N,ag as Ye,ah as qe,ai as Ke,aj as Ze,ak as Qe}from"./vendor-9abae04e.js";function Lt(){import.meta.url,import("_").catch(()=>1);async function*o(){}}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function u(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=u(a);fetch(a.href,s)}})();const Xe={counter:0,gallery:{shanghai:{contributors:["3353040"],name:{en:"Shanghai","zh-Hans":"上海","zh-Hant":"上海"}}}},re=de({name:"app",initialState:Xe,reducers:{bumpCounter:o=>{o.counter++},setGallery:(o,r)=>{o.gallery=r.payload}}}),{bumpCounter:At,setGallery:et}=re.actions,tt=re.reducer,at=ue(),se=he({reducer:{app:tt},middleware:o=>o().prepend(at.middleware)}),nt=()=>me(),O=pe;window.rmgStore=se;var E=(o=>(o.APP_LOAD="APP_LOAD",o.UPLOAD_TEMPLATES="UPLOAD_TEMPLATES",o))(E||{});const rt="Hi RMP team! I would like to contribute to the gallery with the data below.",st="**Do not edit lines below, they are meant for bots only!!!**";function D(){const{i18n:o}=R();return r=>{var u,n;return(n=(u=o.languages.map(a=>r[a]).find(a=>a!==void 0))!=null?u:r.en)!=null?n:"(Translation Error)"}}const ot=o=>{const{city:r,isOpen:u,onClose:n}=o,a=L(),{t:s}=R(),p=D(),v=O(t=>t.app.gallery),[i,c]=w.useState({name:{en:""},desc:{en:""},reference:"",justification:""});w.useEffect(()=>{fetch(`resources/metadata/${r}.json`).then(t=>t.json()).then(t=>c({...t,justification:""}))},[r]);const g=()=>a("/new",{state:{metadata:i}});return d(F,{isOpen:u,onClose:n,size:"6xl",scrollBehavior:"inside",children:[e(W,{}),d($,{children:[e(V,{children:s("Details")}),e(J,{}),d(Y,{paddingBottom:10,children:[e(ge,{children:e("a",{href:`resources/thumbnails/${r}.png`,target:"_blank",rel:"noopener noreferrer",children:e(q,{src:`resources/thumbnails/${r}.png`,alt:r,borderRadius:"lg"})})}),e(P,{as:"h5",size:"sm",mt:3,mb:2,children:p(i.name)}),e(K,{children:p(i.desc)})]}),d(Z,{children:[e(Q,{max:8,mr:"auto",children:v[r].contributors.map(t=>e(X,{src:`https://avatars.githubusercontent.com/u/${t}`},t))}),e(b,{"aria-label":"Like",variant:"ghost",icon:e(fe,{}),isDisabled:!0}),e(b,{"aria-label":"Favorite",variant:"ghost",icon:e(ye,{}),isDisabled:!0}),e(b,{"aria-label":"Edit",variant:"ghost",icon:e(be,{}),onClick:g}),e("a",{href:`resources/real_world/${r}.json`,target:"_blank",rel:"noopener noreferrer",children:e(b,{"aria-label":"Download",variant:"ghost",icon:e(we,{})})}),e(b,{"aria-label":"Import",variant:"ghost",icon:e(ve,{}),isDisabled:!0})]})]})]})};function it(){const o=L(),r=nt(),u=D(),{t:n}=R(),a=O(t=>t.app.gallery),s=()=>{o("/new",{state:{metadata:{name:{en:""},desc:{en:""},reference:"",justification:""}}}),y.event(E.UPLOAD_TEMPLATES,{})},[p,v]=w.useState("shanghai"),[i,c]=w.useState(!1),g=t=>{c(!0),v(t)};return w.useEffect(()=>{fetch("resources/real_world.json").then(t=>t.json()).then(t=>r(et(t)))},[]),d(Re,{isLazy:!0,isFitted:!0,children:[d(Se,{children:[e(j,{children:n("gallery.type.realWorld")}),e(j,{isDisabled:!0,children:n("gallery.type.fantasy")})]}),e(Ce,{children:d(Me,{children:[d(C,{flexWrap:"wrap",children:[Object.keys(a).map(t=>d(Le,{variant:"elevated",minWidth:"300",m:"2",children:[d(Pe,{children:[e(q,{src:`resources/thumbnails/${t}@300.png`,alt:t,borderRadius:"lg"}),e(Ae,{mt:"6",spacing:"3",children:e(P,{size:"lg",children:u(a[t].name)})})]}),d(Oe,{children:[e(Q,{max:3,children:a[t].contributors.map(m=>e(X,{src:`https://avatars.githubusercontent.com/u/${m}`},m))}),e(S,{variant:"solid",colorScheme:"blue",ml:"auto",onClick:()=>g(t),children:n("Details")})]})]},t)),e(ee,{onClick:s,position:"fixed",bottom:"20px",right:"20px",zIndex:3,children:e(b,{"aria-label":"new",size:"lg",icon:e(te,{}),colorScheme:"blue",variant:"solid"})})]}),e(ot,{city:p,isOpen:i,onClose:()=>c(!1)})]})})]})}const lt=o=>new Promise(r=>{const u=new FileReader;u.onloadend=()=>r(u.result),u.readAsText(o)}),G=(o,r,u)=>{if(r!==null){const n=document.createElement("details");return n.setAttribute("repo","rmp-gallery"),n.setAttribute("type",o),Object.entries(u).forEach(([a,s])=>{n.setAttribute(a,s)}),n.textContent=r,n.outerHTML}else return""},ct={"& > div:first-of-type":{flex:1}};function H(o){const{translations:r,onUpdate:u,onLangSwitch:n,onRemove:a}=o,{t:s}=R(),p=D(),v=(c,g)=>[{type:"select",label:s("Language"),value:c,options:Object.entries(M).reduce((t,m)=>({...t,[m[0]]:p(m[1])}),{}),disabledOptions:r.filter(t=>t[0]!==c).map(t=>t[0]),onChange:t=>n(c,t)},{type:"input",label:s("Name"),value:g,onChange:t=>u(c,t),validator:t=>!!t}],i=()=>{const c=Object.keys(M).filter(g=>!r.find(t=>t[0]===g))[0];u(c,"")};return e(Ee,{direction:"column",children:r.map(([c,g],t,m)=>d(A,{sx:ct,children:[e(ae,{fields:v(c,g),noLabel:t>0}),t===m.length-1?e(b,{size:"sm",variant:"ghost","aria-label":s("Add a name in another language"),title:s("Add a name in another language"),onClick:i,icon:e(te,{})}):e(ee,{minW:8}),m.length>1&&e(b,{size:"sm",variant:"ghost","aria-label":s("Remove this name"),title:s("Remove this name"),onClick:()=>a(c),icon:e(De,{})})]},t))})}const dt={px:2,pt:2,width:{base:"100%",md:520},"& > div:first-of-type":{flexDirection:"column",flex:1,overflowY:"auto"},"& > div:nth-of-type(2)":{my:2}};function ut(){var x,I;const{state:{metadata:o}}=Te(),r=L(),u=O(l=>l.app.gallery),{t:n}=R(),a=()=>r("/"),s=w.useRef(null),[p,v]=w.useState(!1),[i,c]=w.useState(o),[g,t]=w.useState(""),m=(I=(x=i.name.en)==null?void 0:x.replace(/[^A-Za-z0-9]/g,"").toLowerCase())!=null?I:"",T=[rt,st,G("metadata",JSON.stringify(i,null,4),{}),G("real_world",g,{compress:"zipson",city:m})].join(`

`),oe=new URLSearchParams({labels:"resources",title:`Resources: ${m in u?"Update":"New"} template of ${m}`}),ie=async l=>{var f;const h=(f=l.target.files)==null?void 0:f[0];if(console.log("handleFileUpload():: received file",h),!!h){if(h.type!=="application/json"){alert("Invalid file type!"),l.target.value="";return}try{const k=await lt(h);t(je.stringify(JSON.parse(k.trim())).trim())}catch(k){alert("Invalid file!"),l.target.value=""}}},le=async()=>{s!=null&&s.current&&(s.current.select(),await navigator.clipboard.writeText(T)),window.open("https://github.com/railmapgen/rmp-gallery/issues/new?"+oe.toString(),"_blank")},ce=[{type:"custom",label:n("Project file"),component:e(xe,{variant:"flushed",size:"xs",type:"file",accept:".json",onChange:ie}),minW:250},{type:"input",label:n("Reference link"),placeholder:"Enter the link where you get the valid data",value:i.reference,onChange:l=>c({...i,reference:l}),minW:250},{type:"input",label:n("Justification"),placeholder:"The reason why you make these changes",value:i.justification,onChange:l=>c({...i,justification:l}),minW:250}];return d(ne,{sx:dt,children:[d(C,{children:[e(ae,{fields:ce}),e(_,{label:n("City Name"),children:e(H,{translations:Object.entries(i.name),onUpdate:(l,h)=>c({...i,name:{...i.name,[l]:h}}),onLangSwitch:(l,h)=>{const f=structuredClone(i);f.name[h]=f.name[l],delete f.name[l],c(f)},onRemove:l=>{const h=structuredClone(i);delete h.name[l],c(h)}})}),e(_,{label:n("Description (Optional)"),children:e(H,{translations:Object.entries(i.desc),onUpdate:(l,h)=>c({...i,desc:{...i.desc,[l]:h}}),onLangSwitch:(l,h)=>{const f=structuredClone(i);f.desc[h]=f.desc[l],delete f.desc[l],c(f)},onRemove:l=>{const h=structuredClone(i);delete h.desc[l],c(h)}})})]}),d(C,{children:[e(S,{size:"sm",onClick:a,children:n("Back to list")}),e(A,{ml:"auto",children:e(S,{size:"sm",colorScheme:"primary",isDisabled:g===""||i.reference===""||m==="",onClick:()=>v(!0),children:n("Submit")})})]}),d(F,{isOpen:p,onClose:()=>v(!1),children:[e(W,{}),d($,{children:[e(V,{children:n("Submit template")}),e(J,{}),d(Y,{children:[e(K,{children:n("You may now copy the following text into your new issue's body.")}),e(Ie,{mt:"2",mb:"2"}),e(ke,{ref:s,isReadOnly:!0,defaultValue:T,onClick:({target:l})=>l.select()})]}),e(Z,{children:e(S,{colorScheme:"primary",onClick:le,children:n("Copy issue body and open a new issue")})})]})]})]})}function ht(){const{t:o}=R(),r=y.getEnv(),u=y.getAppVersion(),n=a=>{y.setLanguage(a),y.getI18nInstance().changeLanguage(a)};return d(_e,{children:[e(P,{as:"h4",size:"md",children:o("header.about.rmpGallery")}),e(ze,{environment:r,version:u}),e(A,{ml:"auto",children:d(Be,{children:[e(Ne,{as:b,icon:e(Ge,{}),variant:"ghost",size:"sm"}),e(He,{children:Ue.map(a=>e(Fe,{onClick:()=>n(a),children:M[a][a]},a))})]})})]})}function mt(){return e(We,{basename:"/rmp-gallery/",children:e($e,{children:d(Ve,{children:[e(ht,{}),e(ne,{children:d(Je,{children:[e(z,{path:"/",element:e(B,{suspenseFallback:e(N,{isIndeterminate:!0}),children:e(it,{})})}),e(z,{path:"/new",element:e(B,{suspenseFallback:e(N,{isIndeterminate:!0}),children:e(ut,{})})})]})})]})})})}const pt={about:{rmpGallery:"RMP Gallery"}},gt={type:{realWorld:"Real World",fantasy:"Fantasy"}},ft={header:pt,gallery:gt},yt={about:{rmpGallery:"RMP画廊"}},bt={header:yt},wt={about:{rmpGallery:"RMP畫廊"}},vt={header:wt},Rt={about:{rmpGallery:"RMP Gallery"}},St={header:Rt},Ct=new y.I18nBuilder().use(Ye).withAppName("RMP Gallery").withLng(y.getLanguage()).withResource("en",ft).withResource("zh-Hans",bt).withResource("zh-Hant",vt).withResource("ko",St).build();let U;const Mt=()=>{U=qe(document.getElementById("root")),U.render(e(Ke.StrictMode,{children:e(Ze,{store:se,children:e(Qe,{i18n:Ct,children:e(mt,{})})})}))};y.ready().then(()=>{Mt(),y.injectCss(),y.event(E.APP_LOAD,{})});export{Lt as __vite_legacy_guard};
