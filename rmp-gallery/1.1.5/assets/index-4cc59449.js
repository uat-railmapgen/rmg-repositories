import{c as me,a as pe,b as ge,u as be,d as fe,e as R,f as I,g as ye,R as k,j as n,M as E,h as e,i as j,k as _,l as B,m as U,n as G,V as D,I as $,H as v,T as p,o as re,A as se,p as A,q as w,r as we,s as Se,t as ke,v as Ce,w as ve,x as Re,y as Ae,z as ze,B as Me,C as Y,D as Pe,E as Le,F as M,G as Oe,J as De,S as Te,K as xe,L as T,N as H,O as oe,P as S,Q as Ie,U as N,W as ie,X as Ee,Y as x,Z as je,_ as _e,$ as le,a0 as K,a1 as Be,a2 as Ue,a3 as Ge,a4 as L,a5 as O,a6 as $e,a7 as He,a8 as Ne,a9 as Fe,aa as We,ab as Ve,ac as qe,ad as Je,ae as Ze,af as Ye,ag as Ke,ah as Qe,ai as Xe,aj as Q,ak as X,al as ee,am as et,an as tt,ao as at,ap as nt,aq as rt}from"./vendor-5251448a.js";function It(){import.meta.url,import("_").catch(()=>1);async function*i(){}}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function h(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=h(r);fetch(r.href,a)}})();const st={counter:0,gallery:{shanghai:{contributors:["3353040"],name:{en:"Shanghai","zh-Hans":"上海","zh-Hant":"上海"}}}},ce=me({name:"app",initialState:st,reducers:{bumpCounter:i=>{i.counter++},setGallery:(i,o)=>{i.gallery=o.payload}}}),{bumpCounter:jt,setGallery:ot}=ce.actions,it=ce.reducer,lt=pe(),de=ge({reducer:{app:it},middleware:i=>i().prepend(lt.middleware)}),ct=()=>be(),F=fe;window.rmgStore=de;var W=(i=>(i.APP_LOAD="APP_LOAD",i.UPLOAD_TEMPLATES="UPLOAD_TEMPLATES",i))(W||{});const dt="Hi RMP team! I would like to contribute to the gallery with the data below.",ht="**Do not edit lines below, they are meant for bots only!!!**";function V(){const{i18n:i}=R();return o=>{var h,t;return(t=(h=i.languages.map(r=>o[r]).find(r=>r!==void 0))!=null?h:o.en)!=null?t:"(Translation Error)"}}const ut=i=>{const{city:o,isOpen:h,onClose:t}=i,r=I(),a=ye(),{t:u}=R(),C=V(),c=F(y=>y.app.gallery),[d,b]=k.useState({name:{en:""},desc:{en:""},reference:"",justification:""});k.useEffect(()=>{fetch(`resources/metadata/${o}.json`).then(y=>y.json()).then(y=>b({...y,justification:""}))},[o]);const s=()=>r("/new",{state:{metadata:d}}),g=`https://${window.location.hostname}/rmp/s/${o}`,P={title:u("Link copied."),status:"success",duration:9e3,isClosable:!0};return n(E,{isOpen:h,onClose:t,size:"6xl",scrollBehavior:"inside",children:[e(j,{}),n(_,{children:[e(B,{children:u("Details")}),e(U,{}),n(G,{paddingBottom:10,children:[e(D,{children:e("a",{href:`resources/thumbnails/${o}.png`,target:"_blank",rel:"noopener noreferrer",children:e($,{src:`resources/thumbnails/${o}.png`,alt:o,borderRadius:"lg"})})}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:C(d.name)}),e(p,{children:C(d.desc)})]}),n(re,{children:[e(se,{max:8,mr:"auto",children:c[o].contributors.map(y=>e(A,{src:`https://avatars.githubusercontent.com/u/${y}`,cursor:"pointer",onClick:()=>fetch(`https://api.github.com/user/${y}`).then(z=>z.json()).then(z=>window.open(`https://github.com/${z.login}`))},y))}),e(w,{"aria-label":"Like",variant:"ghost",icon:e(we,{}),isDisabled:!0}),e(w,{"aria-label":"Favorite",variant:"ghost",icon:e(Se,{}),isDisabled:!0}),e(ke,{label:g,children:e(w,{"aria-label":"Share",variant:"ghost",icon:e(Ce,{}),onClick:()=>{navigator.clipboard.writeText(g),a(P)}})}),e(w,{"aria-label":"Edit",variant:"ghost",icon:e(ve,{}),onClick:s}),e("a",{href:`resources/real_world/${o}.json`,target:"_blank",rel:"noopener noreferrer",children:e(w,{"aria-label":"Download",variant:"ghost",icon:e(Re,{})})}),e(w,{"aria-label":"Import",variant:"ghost",icon:e(Ae,{}),isDisabled:!0})]})]})]})};function mt(){const i=I(),o=ct(),h=V(),{t}=R(),r=F(s=>s.app.gallery),a=()=>{i("/new",{state:{metadata:{name:{en:""},desc:{en:""},reference:"",justification:""}}}),S.event(W.UPLOAD_TEMPLATES,{})},[u,C]=k.useState("shanghai"),[c,d]=k.useState(!1),b=s=>{d(!0),C(s)};return k.useEffect(()=>{fetch("resources/real_world.json").then(s=>s.json()).then(s=>o(ot(s)))},[]),n(ze,{isLazy:!0,isFitted:!0,children:[n(Me,{children:[e(Y,{children:t("gallery.type.realWorld")}),e(Y,{isDisabled:!0,children:t("gallery.type.fantasy")})]}),e(Pe,{children:n(Le,{children:[n(M,{flexWrap:"wrap",children:[Object.keys(r).map(s=>n(Oe,{variant:"elevated",minWidth:"300",m:"2",children:[n(De,{children:[e($,{src:`resources/thumbnails/${s}@300.png`,alt:s,borderRadius:"lg"}),e(Te,{mt:"6",spacing:"3",children:e(v,{size:"lg",children:h(r[s].name)})})]}),n(xe,{children:[e(se,{max:3,children:r[s].contributors.map(g=>e(A,{src:`https://avatars.githubusercontent.com/u/${g}`},g))}),e(T,{variant:"solid",colorScheme:"blue",ml:"auto",onClick:()=>b(s),children:t("Details")})]})]},s)),e(H,{onClick:a,position:"fixed",bottom:"20px",right:"20px",zIndex:3,children:e(w,{"aria-label":"new",size:"lg",icon:e(oe,{}),colorScheme:"blue",variant:"solid"})})]}),e(ut,{city:u,isOpen:c,onClose:()=>d(!1)})]})})]})}const pt=i=>new Promise(o=>{const h=new FileReader;h.onloadend=()=>o(h.result),h.readAsText(i)}),te=(i,o,h)=>{if(o!==null){const t=document.createElement("details");return t.setAttribute("repo","rmp-gallery"),t.setAttribute("type",i),Object.entries(h).forEach(([r,a])=>{t.setAttribute(r,a)}),t.textContent=o,t.outerHTML}else return""},gt={"& > div:first-of-type":{flex:1}};function ae(i){const{translations:o,onUpdate:h,onLangSwitch:t,onRemove:r}=i,{t:a}=R(),u=V(),C=(d,b)=>[{type:"select",label:a("Language"),value:d,options:Object.entries(x).reduce((s,g)=>({...s,[g[0]]:u(g[1])}),{}),disabledOptions:o.filter(s=>s[0]!==d).map(s=>s[0]),onChange:s=>t(d,s)},{type:"input",label:a("Name"),value:b,onChange:s=>h(d,s),validator:s=>!!s}],c=()=>{const d=Object.keys(x).filter(b=>!o.find(s=>s[0]===b))[0];h(d,"")};return e(Ie,{direction:"column",children:o.map(([d,b],s,g)=>n(N,{sx:gt,children:[e(ie,{fields:C(d,b),noLabel:s>0}),s===g.length-1?e(w,{size:"sm",variant:"ghost","aria-label":a("Add a name in another language"),title:a("Add a name in another language"),onClick:c,icon:e(oe,{})}):e(H,{minW:8}),g.length>1&&e(w,{size:"sm",variant:"ghost","aria-label":a("Remove this name"),title:a("Remove this name"),onClick:()=>r(d),icon:e(Ee,{})})]},s))})}const bt={px:2,pt:2,width:{base:"100%",md:520},"& > div:first-of-type":{flexDirection:"column",flex:1,overflowY:"auto"},"& > div:nth-of-type(2)":{my:2}};function ft(){var q,J;const{state:{metadata:i}}=je(),o=I(),h=F(l=>l.app.gallery),{t}=R(),r=()=>o("/"),a=k.useRef(null),[u,C]=k.useState(!1),[c,d]=k.useState(i),[b,s]=k.useState(""),g=(J=(q=c.name.en)==null?void 0:q.replace(/[^A-Za-z0-9]/g,"").toLowerCase())!=null?J:"",P=[dt,ht,te("metadata",JSON.stringify(c,null,4),{}),te("real_world",b,{compress:"zipson",city:g})].join(`

`),y=new URLSearchParams({labels:"resources",title:`Resources: ${g in h?"Update":"New"} template of ${g}`}),z=async l=>{var f;const m=(f=l.target.files)==null?void 0:f[0];if(console.log("handleFileUpload():: received file",m),!!m){if(m.type!=="application/json"){alert("Invalid file type!"),l.target.value="";return}try{const Z=await pt(m);s(Ge.stringify(JSON.parse(Z.trim())).trim())}catch(Z){alert("Invalid file!"),l.target.value=""}}},he=async()=>{a!=null&&a.current&&(a.current.select(),await navigator.clipboard.writeText(P)),window.open("https://github.com/railmapgen/rmp-gallery/issues/new?"+y.toString(),"_blank")},ue=[{type:"custom",label:t("Project file"),component:e(_e,{variant:"flushed",size:"xs",type:"file",accept:".json",onChange:z}),minW:250},{type:"input",label:t("Reference link"),placeholder:"Enter the link where you get the valid data",value:c.reference,onChange:l=>d({...c,reference:l}),minW:250},{type:"input",label:t("Justification"),placeholder:"The reason why you make these changes",validator:l=>/^[a-zA-Z0-9. -]+$/.test(l),value:c.justification,onChange:l=>d({...c,justification:l}),minW:250}];return n(le,{sx:bt,children:[n(M,{children:[e(ie,{fields:ue}),e(K,{label:t("City Name"),children:e(ae,{translations:Object.entries(c.name),onUpdate:(l,m)=>d({...c,name:{...c.name,[l]:m}}),onLangSwitch:(l,m)=>{const f=structuredClone(c);f.name[m]=f.name[l],delete f.name[l],d(f)},onRemove:l=>{const m=structuredClone(c);delete m.name[l],d(m)}})}),e(K,{label:t("Description (Optional)"),children:e(ae,{translations:Object.entries(c.desc),onUpdate:(l,m)=>d({...c,desc:{...c.desc,[l]:m}}),onLangSwitch:(l,m)=>{const f=structuredClone(c);f.desc[m]=f.desc[l],delete f.desc[l],d(f)},onRemove:l=>{const m=structuredClone(c);delete m.desc[l],d(m)}})})]}),n(M,{children:[e(T,{size:"sm",onClick:r,children:t("Back to list")}),e(N,{ml:"auto",children:e(T,{size:"sm",colorScheme:"primary",isDisabled:b===""||c.reference===""||c.justification===""||!/^[a-zA-Z0-9. -]+$/.test(c.justification)||g==="",onClick:()=>C(!0),children:t("Submit")})})]}),n(E,{isOpen:u,onClose:()=>C(!1),children:[e(j,{}),n(_,{children:[e(B,{children:t("Submit template")}),e(U,{}),n(G,{children:[e(p,{children:t("You may now copy the following text into your new issue's body.")}),e(Be,{mt:"2",mb:"2"}),e(Ue,{ref:a,isReadOnly:!0,defaultValue:P,onClick:({target:l})=>l.select()})]}),e(re,{children:e(T,{colorScheme:"primary",onClick:he,children:t("Copy issue body and open a new issue")})})]})]})]})}const yt="/rmp-gallery/assets/github-mark-7a0dd11e.svg",wt="/rmp-gallery/assets/slack-mark-19839006.svg",St=i=>{const{isOpen:o,onClose:h}=i,{t}=R(),r=S.getAppVersion();return n(E,{isOpen:o,onClose:h,size:"xl",scrollBehavior:"inside",children:[e(j,{}),n(_,{children:[e(B,{children:t("header.about.title")}),e(U,{}),n(G,{paddingBottom:10,children:[n(M,{direction:"row",children:[e($,{boxSize:"128px",src:"/rmp-gallery/logo192.png"}),n(M,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e(p,{fontSize:"xl",as:"b",children:t("header.about.rmpGallery")}),e(p,{children:r}),e(p,{}),e(p,{fontSize:"sm",children:t("header.about.railmapgen")})]})]}),e(H,{margin:5,children:e(p,{fontSize:"xl",children:t("header.about.desc")})}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:t("header.about.contributors")}),e(v,{as:"h6",size:"xs",my:2,children:t("header.about.coreContributors")}),e(D,{children:n(L,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e(A,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),n(O,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e(p,{fontSize:"sm",children:t("header.about.content1")}),e(p,{fontSize:"sm",align:"right",mb:1,children:t("header.about.content2")})]})]})}),e(v,{as:"h6",size:"xs",my:2,children:t("header.about.templateAdministrators")}),e(D,{children:["52PD","linchen1965"].map(a=>n(L,{size:"lg",w:"85%",onClick:()=>window.open(`https://github.com/${a}`,"_blank"),cursor:"pointer",children:[e(A,{src:`https://github.com/${a}.png`,size:"lg",my:2,ml:-1,mr:2}),n(O,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:a}),e(p,{fontSize:"sm",mb:1,children:t(`header.about.${a}`)})]})]},a))}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:t("header.about.contactUs")}),n(D,{children:[n(L,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp-gallery/issues","_blank"),cursor:"pointer",children:[e(A,{src:yt,size:"lg",my:2,ml:-1,mr:2}),n(O,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:t("header.about.github")}),e(p,{fontSize:"sm",children:t("header.about.githubContent")})]})]}),n(L,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e(A,{src:wt,size:"lg",my:2,ml:-1,mr:2}),n(O,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:t("header.about.slack")}),e(p,{fontSize:"sm",children:t("header.about.slackContent")}),e(p,{fontSize:"sm",as:"i",children:"#rmg, #rmp, #gallery, #random"})]})]})]})]})]})]})};function kt(){const{t:i}=R(),o=S.getEnv(),h=S.getAppVersion(),[t,r]=k.useState(!1),a=u=>{S.setLanguage(u),S.getI18nInstance().changeLanguage(u)};return n($e,{children:[e(v,{as:"h4",size:"md",children:i("header.about.rmpGallery")}),e(He,{environment:o,version:h}),n(N,{ml:"auto",children:[n(Ne,{children:[e(Fe,{as:w,icon:e(We,{}),variant:"ghost",size:"sm"}),e(Ve,{children:qe.map(u=>e(Je,{onClick:()=>a(u),children:x[u][u]},u))})]}),e(w,{size:"sm",variant:"ghost","aria-label":"Help",icon:e(Ze,{}),onClick:()=>r(!0)})]}),e(St,{isOpen:t,onClose:()=>r(!1)})]})}function Ct(){return e(Ye,{basename:"/rmp-gallery/",children:e(Ke,{children:n(Qe,{children:[e(kt,{}),e(le,{children:n(Xe,{children:[e(Q,{path:"/",element:e(X,{suspenseFallback:e(ee,{isIndeterminate:!0}),children:e(mt,{})})}),e(Q,{path:"/new",element:e(X,{suspenseFallback:e(ee,{isIndeterminate:!0}),children:e(ft,{})})})]})})]})})})}const vt={about:{rmpGallery:"RMP Gallery",title:"About",railmapgen:"A railmapgen project",desc:"Browse, set, and submit your RMP template here!",content1:"In memory of all the freedom and equality we once had.",content2:"06/01/2022 in Shanghai",contributors:"Contributors",coreContributors:"Core Contributors",templateAdministrators:"Administrators","52PD":"Special thanks for his continuous effort in maintaining templates.",linchen1965:"Special thanks for his continuous effort in maintaining templates.",contactUs:"Contact Us",github:"Project Repository",githubContent:"Face any problems? Search or raise an issue here!",slack:"Slack Group",slackContent:"Chat in these Slack channels!"}},Rt={type:{realWorld:"Real World",fantasy:"Fantasy"}},At={header:vt,gallery:Rt},zt={about:{rmpGallery:"RMP画廊",title:"About",railmapgen:"一个railmapgen项目",desc:"浏览、设置、提交你制作的RMP模板！",content1:"谨以此纪念我们曾拥有的自由与平等。",content2:"06/01/2022于上海",contributors:"贡献者",coreContributors:"核心贡献者",templateAdministrators:"管理员","52PD":"特别感谢他维护这些模板的持续付出。",linchen1965:"特别感谢他维护这些模板的持续付出。",contactUs:"联系我们",github:"项目仓库",githubContent:"遇到任何问题？在这里搜索或提出一个问题！",slack:"Slack群组",slackContent:"在这些Slack频道中讨论!"}},Mt={header:zt},Pt={about:{rmpGallery:"RMP畫廊",title:"關於",railmapgen:"一個railmapgen項目",desc:"瀏覽、設置、提交你製作的RMP模板！",content1:"謹以此紀念我們曾擁有的自由與平等。",content2:"06/01/2022於上海",contributors:"貢獻者",coreContributors:"核心貢獻者",templateAdministrators:"管理員","52PD":"特別感謝他維護這些模板的持續付出。",linchen1965:"特別感謝他維護這些模板的持續付出。",contactUs:"聯繫我們",github:"項目倉庫",githubContent:"遇到任何問題？在這裡搜索或提出一個問題！",slack:"Slack群組",slackContent:"在這些Slack頻道中討論!"}},Lt={header:Pt},Ot={about:{rmpGallery:"RMP 갤러리",title:"대함",railmapgen:"railmapgen 프로젝트",desc:"Browse, set, and submit your RMP template here!",content1:"우리가 가졌던 자유와 평등을 기념한다.",content2:"2022년 6월 1일 상해",contributors:"기여자",coreContributors:"핵심 기여자",templateAdministrators:"Administrators","52PD":"Special thanks for his continuous effort in maintaining templates.",linchen1965:"Special thanks for his continuous effort in maintaining templates.",contactUs:"우리에게 연락하기",github:"프로젝트 저장소",githubContent:"무슨 문제라도 있나요? 여기서 문제를 검색하거나 제기하십시오!",slack:"슬랙 그룹",slackContent:"이 슬랙 채널에서 채팅해요!"}},Dt={header:Ot},Tt=new S.I18nBuilder().use(et).withAppName("RMP Gallery").withLng(S.getLanguage()).withResource("en",At).withResource("zh-Hans",Mt).withResource("zh-Hant",Lt).withResource("ko",Dt).build();let ne;const xt=()=>{ne=tt(document.getElementById("root")),ne.render(e(at.StrictMode,{children:e(nt,{store:de,children:e(rt,{i18n:Tt,children:e(Ct,{})})})}))};S.ready().then(()=>{xt(),S.injectCss(),S.event(W.APP_LOAD,{})});export{It as __vite_legacy_guard};
