import{c as ue,a as me,b as pe,u as ge,d as be,e as z,f as E,g as fe,R as k,j as n,M as I,h as e,i as j,k as _,l as U,m as B,n as H,V as O,I as N,H as v,T as p,L as ye,o as we,F as M,A,p as Se,q as re,r as w,s as ke,t as Ce,v as ve,w as Re,x as ze,y as Ae,z as Me,B as Pe,C as Le,D as Y,E as Oe,G as De,J as xe,K as Te,S as Ee,N as Ie,O as je,P as D,Q as $,U as se,W as S,X as _e,Y as G,Z as ie,_ as Ue,$ as T,a0 as Be,a1 as He,a2 as oe,a3 as K,a4 as Ne,a5 as $e,a6 as Ge,a7 as P,a8 as L,a9 as Fe,aa as We,ab as Ve,ac as qe,ad as Je,ae as Ze,af as Ye,ag as Ke,ah as Qe,ai as Xe,aj as et,ak as tt,al as at,am as Q,an as X,ao as ee,ap as nt,aq as rt,ar as st,as as it,at as ot}from"./vendor-e06576d2.js";function _t(){import.meta.url,import("_").catch(()=>1);async function*l(){}}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function d(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(s){if(s.ep)return;s.ep=!0;const a=d(s);fetch(s.href,a)}})();const lt={gallery:{shanghai:{contributors:["3353040"],name:{en:"Shanghai","zh-Hans":"上海","zh-Hant":"上海"},lastUpdateOn:1683810518708}}},le=ue({name:"app",initialState:lt,reducers:{setGallery:(l,i)=>{l.gallery=i.payload}}}),{setGallery:ct}=le.actions,dt=le.reducer,ht=me(),ce=pe({reducer:{app:dt},middleware:l=>l().prepend(ht.middleware)}),ut=()=>ge(),de=be;window.rmgStore=ce;var F=(l=>(l.APP_LOAD="APP_LOAD",l.UPLOAD_TEMPLATES="UPLOAD_TEMPLATES",l))(F||{});const mt="Hi RMP team! I would like to contribute to the gallery with the data below.",pt="**Do not edit lines below, they are meant for bots only!!!**";function W(){const{i18n:l}=z();return i=>{var d,t;return(t=(d=l.languages.map(s=>i[s]).find(s=>s!==void 0))!=null?d:i.en)!=null?t:"(Translation Error)"}}const gt=l=>{const{city:i,isOpen:d,onClose:t}=l,s=E(),a=fe(),{t:u}=z(),C=W(),[o,h]=k.useState({name:{en:""},desc:{en:""},reference:"",updateHistory:[]});k.useEffect(()=>{fetch(`resources/metadata/${i}.json`).then(b=>b.json()).then(b=>h({...b,justification:""}))},[i]);const f=()=>{const b=structuredClone(o),R=(({updateHistory:V,...x})=>({...x,justification:""}))(b);s("/new",{state:{metadata:R}})},r=`https://${window.location.hostname}/rmp/s/${i}`,g={title:u("Link copied."),status:"success",duration:9e3,isClosable:!0};return n(I,{isOpen:d,onClose:t,size:"6xl",scrollBehavior:"inside",children:[e(j,{}),n(_,{children:[e(U,{children:u("Details")}),e(B,{}),n(H,{paddingBottom:10,children:[e(O,{children:e("a",{href:`resources/thumbnails/${i}.png`,target:"_blank",rel:"noopener noreferrer",children:e(N,{src:`resources/thumbnails/${i}.png`,alt:i,borderRadius:"lg"})})}),e(v,{as:"h5",size:"md",mt:3,mb:2,children:C(o.name)}),e(p,{children:C(o.desc)}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:u("Update History")}),e(ye,{children:o.updateHistory.map(b=>e(we,{children:n(M,{flexDirection:"row",alignItems:"center",children:[e(A,{size:"sm",mr:"2",src:`https://avatars.githubusercontent.com/u/${b.id}`,cursor:"pointer",onClick:()=>fetch(`https://api.github.com/user/${b.id}`).then(R=>R.json()).then(R=>window.open(`https://github.com/${R.login}`))}),e(Se,{mr:"auto",href:`https://github.com/railmapgen/rmp-gallery/issues/${b.issueNumber}`,isExternal:!0,children:b.reason}),e(p,{children:new Date(b.time).toLocaleString(void 0,{hour12:!1})})]})},b.issueNumber))})]}),n(re,{children:[e(w,{"aria-label":"Like",variant:"ghost",icon:e(ke,{}),isDisabled:!0}),e(w,{"aria-label":"Favorite",variant:"ghost",icon:e(Ce,{}),isDisabled:!0}),e(ve,{label:r,children:e(w,{"aria-label":"Share",variant:"ghost",icon:e(Re,{}),onClick:()=>{navigator.clipboard.writeText(r),a(g)}})}),e(w,{"aria-label":"Edit",variant:"ghost",icon:e(ze,{}),onClick:f}),e("a",{href:`resources/real_world/${i}.json`,target:"_blank",rel:"noopener noreferrer",children:e(w,{"aria-label":"Download",variant:"ghost",icon:e(Ae,{})})}),e(w,{"aria-label":"Import",variant:"ghost",icon:e(Me,{}),isDisabled:!0})]})]})]})};function bt(){const l=E(),i=ut(),d=W(),{t}=z(),{gallery:s}=de(r=>r.app),a=()=>{l("/new",{state:{metadata:{name:{en:""},desc:{en:""},reference:"",justification:""}}}),S.event(F.UPLOAD_TEMPLATES,{})},[u,C]=k.useState("shanghai"),[o,h]=k.useState(!1),f=r=>{h(!0),C(r)};return k.useEffect(()=>{fetch("resources/real_world.json").then(r=>r.json()).then(r=>i(ct(r)))},[]),n(Pe,{isLazy:!0,isFitted:!0,children:[n(Le,{children:[e(Y,{children:t("gallery.type.realWorld")}),e(Y,{isDisabled:!0,children:t("gallery.type.fantasy")})]}),e(Oe,{children:n(De,{children:[n(M,{flexWrap:"wrap",children:[Object.keys(s).map(r=>n(xe,{variant:"elevated",minWidth:"300",m:"2",children:[n(Te,{children:[e(N,{src:`resources/thumbnails/${r}@300.png`,alt:r,borderRadius:"lg"}),e(Ee,{mt:"6",spacing:"3",children:e(v,{size:"lg",children:d(s[r].name)})})]}),n(Ie,{children:[e(je,{max:3,children:s[r].contributors.map(g=>e(A,{src:`https://avatars.githubusercontent.com/u/${g}`},g))}),e(D,{variant:"solid",colorScheme:"blue",ml:"auto",onClick:()=>f(r),children:t("Details")})]})]},r)),e($,{onClick:a,position:"fixed",bottom:"20px",right:"20px",zIndex:3,children:e(w,{"aria-label":"new",size:"lg",icon:e(se,{}),colorScheme:"blue",variant:"solid"})})]}),e(gt,{city:u,isOpen:o,onClose:()=>h(!1)})]})})]})}const ft=l=>new Promise(i=>{const d=new FileReader;d.onloadend=()=>i(d.result),d.readAsText(l)}),te=(l,i,d)=>{if(i!==null){const t=document.createElement("details");return t.setAttribute("repo","rmp-gallery"),t.setAttribute("type",l),Object.entries(d).forEach(([s,a])=>{t.setAttribute(s,a)}),t.textContent=i,t.outerHTML}else return""},yt={"& > div:first-of-type":{flex:1}};function ae(l){const{translations:i,onUpdate:d,onLangSwitch:t,onRemove:s}=l,{t:a}=z(),u=W(),C=(h,f)=>[{type:"select",label:a("Language"),value:h,options:Object.entries(T).reduce((r,g)=>({...r,[g[0]]:u(g[1])}),{}),disabledOptions:i.filter(r=>r[0]!==h).map(r=>r[0]),onChange:r=>t(h,r)},{type:"input",label:a("Name"),value:f,onChange:r=>d(h,r),validator:r=>!!r}],o=()=>{const h=Object.keys(T).filter(f=>!i.find(r=>r[0]===f))[0];d(h,"")};return e(_e,{direction:"column",children:i.map(([h,f],r,g)=>n(G,{sx:yt,children:[e(ie,{fields:C(h,f),noLabel:r>0}),r===g.length-1?e(w,{size:"sm",variant:"ghost","aria-label":a("Add a name in another language"),title:a("Add a name in another language"),onClick:o,icon:e(se,{})}):e($,{minW:8}),g.length>1&&e(w,{size:"sm",variant:"ghost","aria-label":a("Remove this name"),title:a("Remove this name"),onClick:()=>s(h),icon:e(Ue,{})})]},r))})}const wt={px:2,pt:2,width:{base:"100%",md:520},"& > div:first-of-type":{flexDirection:"column",flex:1,overflowY:"auto"},"& > div:nth-of-type(2)":{my:2}};function St(){var q,J;const{state:{metadata:l}}=Be(),i=E(),d=de(c=>c.app.gallery),{t}=z(),s=()=>i("/"),a=k.useRef(null),[u,C]=k.useState(!1),[o,h]=k.useState(l),[f,r]=k.useState(""),g=(J=(q=o.name.en)==null?void 0:q.replace(/[^A-Za-z0-9]/g,"").toLowerCase())!=null?J:"",b=[mt,pt,te("metadata",JSON.stringify(o,null,4),{}),te("real_world",f,{compress:"zipson",city:g})].join(`

`),R=new URLSearchParams({labels:"resources",title:`Resources: ${g in d?"Update":"New"} template of ${g}`}),V=async c=>{var y;const m=(y=c.target.files)==null?void 0:y[0];if(console.log("handleFileUpload():: received file",m),!!m){if(m.type!=="application/json"){alert("Invalid file type!"),c.target.value="";return}try{const Z=await ft(m);r(Ge.stringify(JSON.parse(Z.trim())).trim())}catch(Z){alert("Invalid file!"),c.target.value=""}}},x=async()=>{a!=null&&a.current&&(a.current.select(),await navigator.clipboard.writeText(b)),window.open("https://github.com/railmapgen/rmp-gallery/issues/new?"+R.toString(),"_blank")},he=[{type:"custom",label:t("Project file"),component:e(He,{variant:"flushed",size:"xs",type:"file",accept:".json",onChange:V}),minW:250},{type:"input",label:t("Reference link (Official website preferred)"),placeholder:"Enter the link where you get the valid data",value:o.reference,onChange:c=>h({...o,reference:c}),minW:250},{type:"input",label:t("Justification (English only)"),placeholder:"The reason why you make these changes",validator:c=>/^[a-zA-Z0-9. -]+$/.test(c),value:o.justification,onChange:c=>h({...o,justification:c}),minW:250}];return n(oe,{sx:wt,children:[n(M,{children:[e(ie,{fields:he}),e(K,{label:t("City Name (English required)"),children:e(ae,{translations:Object.entries(o.name),onUpdate:(c,m)=>h({...o,name:{...o.name,[c]:m}}),onLangSwitch:(c,m)=>{const y=structuredClone(o);y.name[m]=y.name[c],delete y.name[c],h(y)},onRemove:c=>{const m=structuredClone(o);delete m.name[c],h(m)}})}),e(K,{label:t("Description (Optional, English required)"),children:e(ae,{translations:Object.entries(o.desc),onUpdate:(c,m)=>h({...o,desc:{...o.desc,[c]:m}}),onLangSwitch:(c,m)=>{const y=structuredClone(o);y.desc[m]=y.desc[c],delete y.desc[c],h(y)},onRemove:c=>{const m=structuredClone(o);delete m.desc[c],h(m)}})})]}),n(M,{children:[e(D,{size:"sm",onClick:s,children:t("Back to list")}),e(G,{ml:"auto",children:e(D,{size:"sm",colorScheme:"primary",isDisabled:f===""||o.reference===""||o.justification===""||!/^[a-zA-Z0-9. -]+$/.test(o.justification)||Object.keys(o.desc).length>0&&!("en"in o.desc)||g==="",onClick:()=>C(!0),children:t("Submit")})})]}),n(I,{isOpen:u,onClose:()=>C(!1),children:[e(j,{}),n(_,{children:[e(U,{children:t("Submit template")}),e(B,{}),n(H,{children:[e(p,{children:t("You may now copy the following text into your new issue's body.")}),e(Ne,{mt:"2",mb:"2"}),e($e,{ref:a,isReadOnly:!0,defaultValue:b,onClick:({target:c})=>c.select()})]}),e(re,{children:e(D,{colorScheme:"primary",onClick:x,children:t("Copy issue body and open a new issue")})})]})]})]})}const kt="/rmp-gallery/assets/github-mark-7a0dd11e.svg",Ct="/rmp-gallery/assets/slack-mark-19839006.svg",vt=l=>{const{isOpen:i,onClose:d}=l,{t}=z(),s=S.getAppVersion();return n(I,{isOpen:i,onClose:d,size:"xl",scrollBehavior:"inside",children:[e(j,{}),n(_,{children:[e(U,{children:t("header.about.title")}),e(B,{}),n(H,{paddingBottom:10,children:[n(M,{direction:"row",children:[e(N,{boxSize:"128px",src:"/rmp-gallery/logo192.png"}),n(M,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e(p,{fontSize:"xl",as:"b",children:t("header.about.rmpGallery")}),e(p,{children:s}),e(p,{}),e(p,{fontSize:"sm",children:t("header.about.railmapgen")})]})]}),e($,{margin:5,children:e(p,{fontSize:"xl",children:t("header.about.desc")})}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:t("header.about.contributors")}),e(v,{as:"h6",size:"xs",my:2,children:t("header.about.coreContributors")}),e(O,{children:n(P,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e(A,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),n(L,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e(p,{fontSize:"sm",children:t("header.about.content1")}),e(p,{fontSize:"sm",align:"right",mb:1,children:t("header.about.content2")})]})]})}),e(v,{as:"h6",size:"xs",my:2,children:t("header.about.templateAdministrators")}),e(O,{children:["52PD","linchen1965"].map(a=>n(P,{size:"lg",w:"85%",onClick:()=>window.open(`https://github.com/${a}`,"_blank"),cursor:"pointer",children:[e(A,{src:`https://github.com/${a}.png`,size:"lg",my:2,ml:-1,mr:2}),n(L,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:a}),e(p,{fontSize:"sm",mb:1,children:t(`header.about.${a}`)})]})]},a))}),e(v,{as:"h5",size:"sm",mt:3,mb:2,children:t("header.about.contactUs")}),n(O,{children:[n(P,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp-gallery/issues","_blank"),cursor:"pointer",children:[e(A,{src:kt,size:"lg",my:2,ml:-1,mr:2}),n(L,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:t("header.about.github")}),e(p,{fontSize:"sm",children:t("header.about.githubContent")})]})]}),n(P,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e(A,{src:Ct,size:"lg",my:2,ml:-1,mr:2}),n(L,{display:"block",width:"100%",children:[e(p,{fontSize:"lg",fontWeight:"bold",mb:1,children:t("header.about.slack")}),e(p,{fontSize:"sm",children:t("header.about.slackContent")}),e(p,{fontSize:"sm",as:"i",children:"#rmg, #rmp, #gallery, #random"})]})]})]})]})]})]})};function Rt(){const{t:l}=z(),i=S.getEnv(),d=S.getAppVersion(),[t,s]=k.useState(!1),a=u=>{S.setLanguage(u),S.getI18nInstance().changeLanguage(u)};return n(Fe,{children:[e(v,{as:"h4",size:"md",children:l("header.about.rmpGallery")}),e(We,{environment:i,version:d}),n(G,{ml:"auto",children:[n(Ve,{children:[e(qe,{as:w,icon:e(Je,{}),variant:"ghost",size:"sm"}),e(Ze,{children:Ye.map(u=>e(Ke,{onClick:()=>a(u),children:T[u][u]},u))})]}),e(w,{size:"sm",variant:"ghost","aria-label":"Help",icon:e(Qe,{}),onClick:()=>s(!0)})]}),e(vt,{isOpen:t,onClose:()=>s(!1)})]})}function zt(){return e(Xe,{basename:"/rmp-gallery/",children:e(et,{children:n(tt,{children:[e(Rt,{}),e(oe,{children:n(at,{children:[e(Q,{path:"/",element:e(X,{suspenseFallback:e(ee,{isIndeterminate:!0}),children:e(bt,{})})}),e(Q,{path:"/new",element:e(X,{suspenseFallback:e(ee,{isIndeterminate:!0}),children:e(St,{})})})]})})]})})})}const At={about:{rmpGallery:"RMP Gallery",title:"About",railmapgen:"A railmapgen project",desc:"Browse, set, and submit your RMP template here!",content1:"In memory of all the freedom and equality we once had.",content2:"06/01/2022 in Shanghai",contributors:"Contributors",coreContributors:"Core Contributors",templateAdministrators:"Administrators","52PD":"Special thanks for his continuous effort in maintaining templates.",linchen1965:"Special thanks for his continuous effort in maintaining templates.",contactUs:"Contact Us",github:"Project Repository",githubContent:"Face any problems? Search or raise an issue here!",slack:"Slack Group",slackContent:"Chat in these Slack channels!"}},Mt={type:{realWorld:"Real World",fantasy:"Fantasy"}},Pt={header:At,gallery:Mt},Lt={about:{rmpGallery:"RMP画廊",title:"About",railmapgen:"一个railmapgen项目",desc:"浏览、设置、提交你制作的RMP模板！",content1:"谨以此纪念我们曾拥有的自由与平等。",content2:"06/01/2022于上海",contributors:"贡献者",coreContributors:"核心贡献者",templateAdministrators:"管理员","52PD":"特别感谢他维护这些模板的持续付出。",linchen1965:"特别感谢他维护这些模板的持续付出。",contactUs:"联系我们",github:"项目仓库",githubContent:"遇到任何问题？在这里搜索或提出一个问题！",slack:"Slack群组",slackContent:"在这些Slack频道中讨论!"}},Ot={header:Lt},Dt={about:{rmpGallery:"RMP畫廊",title:"關於",railmapgen:"一個railmapgen項目",desc:"瀏覽、設置、提交你製作的RMP模板！",content1:"謹以此紀念我們曾擁有的自由與平等。",content2:"06/01/2022於上海",contributors:"貢獻者",coreContributors:"核心貢獻者",templateAdministrators:"管理員","52PD":"特別感謝他維護這些模板的持續付出。",linchen1965:"特別感謝他維護這些模板的持續付出。",contactUs:"聯繫我們",github:"項目倉庫",githubContent:"遇到任何問題？在這裡搜索或提出一個問題！",slack:"Slack群組",slackContent:"在這些Slack頻道中討論!"}},xt={header:Dt},Tt={about:{rmpGallery:"RMP 갤러리",title:"대함",railmapgen:"railmapgen 프로젝트",desc:"Browse, set, and submit your RMP template here!",content1:"우리가 가졌던 자유와 평등을 기념한다.",content2:"2022년 6월 1일 상해",contributors:"기여자",coreContributors:"핵심 기여자",templateAdministrators:"Administrators","52PD":"Special thanks for his continuous effort in maintaining templates.",linchen1965:"Special thanks for his continuous effort in maintaining templates.",contactUs:"우리에게 연락하기",github:"프로젝트 저장소",githubContent:"무슨 문제라도 있나요? 여기서 문제를 검색하거나 제기하십시오!",slack:"슬랙 그룹",slackContent:"이 슬랙 채널에서 채팅해요!"}},Et={header:Tt},It=new S.I18nBuilder().use(nt).withAppName("RMP Gallery").withLng(S.getLanguage()).withResource("en",Pt).withResource("zh-Hans",Ot).withResource("zh-Hant",xt).withResource("ko",Et).build();let ne;const jt=()=>{ne=rt(document.getElementById("root")),ne.render(e(st.StrictMode,{children:e(it,{store:ce,children:e(ot,{i18n:It,children:e(zt,{})})})}))};S.ready().then(()=>{jt(),S.injectCss(),S.event(F.APP_LOAD,{})});export{_t as __vite_legacy_guard};
