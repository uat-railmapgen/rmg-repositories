import{c as le,a as ce,b as de,u as ue,d as he,e as S,R as b,j as d,M as G,f as e,g as H,h as F,i as U,k as W,l as $,V as me,I as V,H as A,T as J,m as Y,A as q,n as K,o as v,p as pe,q as ge,r as fe,s as ye,t as Z,v as be,w as we,x,y as ve,z as Se,F as C,C as Re,B as Ce,S as Me,D as Ae,E as R,G as Q,J as X,K as g,L as Le,N as L,O as ee,P as Pe,Q as M,U as Oe,W as te,X as I,Y as De,Z as Te,_ as Ee,$ as xe,a0 as Ie,a1 as ke,a2 as je,a3 as _e,a4 as ze,a5 as Be,a6 as Ne,a7 as Ge,a8 as He,a9 as Fe,aa as Ue,ab as k,ac as j,ad as _,ae as We,af as $e,ag as Ve,ah as Je,ai as Ye}from"./vendor-e00d976f.js";function St(){import.meta.url,import("_").catch(()=>1);async function*a(){}}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function u(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(t){if(t.ep)return;t.ep=!0;const s=u(t);fetch(t.href,s)}})();const qe={counter:0,gallery:{shanghai:{contributors:["3353040"],name:{en:"Shanghai","zh-Hans":"上海","zh-Hant":"上海"}}}},ae=le({name:"app",initialState:qe,reducers:{bumpCounter:a=>{a.counter++},setGallery:(a,r)=>{a.gallery=r.payload}}}),{bumpCounter:Ct,setGallery:Ke}=ae.actions,Ze=ae.reducer,Qe=ce(),ne=de({reducer:{app:Ze},middleware:a=>a().prepend(Qe.middleware)}),Xe=()=>ue(),re=he;window.rmgStore=ne;var P=(a=>(a.APP_LOAD="APP_LOAD",a.UPLOAD_TEMPLATES="UPLOAD_TEMPLATES",a))(P||{});const et="Hi RMP team! I would like to contribute to the gallery with the data below.",tt="**Do not edit lines below, they are meant for bots only!!!**";function O(){const{i18n:a}=S();return r=>{var u,o;return(o=(u=a.languages.map(t=>r[t]).find(t=>t!==void 0))!=null?u:r.en)!=null?o:"(Translation Error)"}}const at=a=>{const{city:r,isOpen:u,onClose:o}=a,{t}=S(),s=O(),i=re(l=>l.app.gallery),[m,w]=b.useState({name:{en:""},desc:{en:""},reference:"",justification:""});return b.useEffect(()=>{fetch(`resources/metadata/${r}.json`).then(l=>l.json()).then(l=>w(l))},[r]),d(G,{isOpen:u,onClose:o,size:"xl",scrollBehavior:"inside",children:[e(H,{}),d(F,{children:[e(U,{children:t("Details")}),e(W,{}),d($,{paddingBottom:10,children:[e(me,{children:e("a",{href:`resources/thumbnails/${r}.png`,target:"_blank",rel:"noopener noreferrer",children:e(V,{src:`resources/thumbnails/${r}.png`,alt:r,borderRadius:"lg"})})}),e(A,{as:"h5",size:"sm",mt:3,mb:2,children:s(m.name)}),e(J,{children:s(m.desc)})]}),d(Y,{children:[e(q,{max:8,mr:"auto",children:i[r].contributors.map(l=>e(K,{src:`https://avatars.githubusercontent.com/u/${l}`},l))}),e(v,{"aria-label":"Like",variant:"ghost",icon:e(pe,{}),isDisabled:!0}),e(v,{"aria-label":"Favorite",variant:"ghost",icon:e(ge,{}),isDisabled:!0}),e("a",{href:`resources/real_world/${r}.json`,target:"_blank",rel:"noopener noreferrer",children:e(v,{"aria-label":"Download",variant:"ghost",icon:e(fe,{})})}),e(v,{"aria-label":"Import",variant:"ghost",icon:e(ye,{}),isDisabled:!0})]})]})]})};function nt(){const a=Z(),r=Xe(),u=O(),{t:o}=S(),t=re(n=>n.app.gallery),s=()=>{a("/new"),g.event(P.UPLOAD_TEMPLATES,{})},[i,m]=b.useState("shanghai"),[w,l]=b.useState(!1),f=n=>{l(!0),m(n)};return b.useEffect(()=>{fetch("resources/real_world.json").then(n=>n.json()).then(n=>r(Ke(n)))},[]),d(be,{isLazy:!0,isFitted:!0,children:[d(we,{children:[e(x,{children:o("gallery.type.realWorld")}),e(x,{isDisabled:!0,children:o("gallery.type.fantasy")})]}),e(ve,{children:d(Se,{children:[d(C,{flexWrap:"wrap",children:[Object.keys(t).map(n=>d(Re,{variant:"elevated",minWidth:"300",m:"2",children:[d(Ce,{children:[e(V,{src:`resources/thumbnails/${n}@300.png`,alt:n,borderRadius:"lg"}),e(Me,{mt:"6",spacing:"3",children:e(A,{size:"lg",children:u(t[n].name)})})]}),d(Ae,{children:[e(q,{max:3,children:t[n].contributors.map(y=>e(K,{src:`https://avatars.githubusercontent.com/u/${y}`},y))}),e(R,{variant:"solid",colorScheme:"blue",ml:"auto",onClick:()=>f(n),children:o("Details")})]})]},n)),e(Q,{onClick:s,position:"fixed",bottom:"20px",right:"20px",zIndex:3,children:e(v,{"aria-label":"new",size:"lg",icon:e(X,{}),colorScheme:"blue",variant:"solid"})})]}),e(at,{city:i,isOpen:w,onClose:()=>l(!1)})]})})]})}const rt=a=>new Promise(r=>{const u=new FileReader;u.onloadend=()=>r(u.result),u.readAsText(a)}),z=(a,r,u)=>{if(r!==null){const o=document.createElement("details");return o.setAttribute("repo","rmp-gallery"),o.setAttribute("type",a),Object.entries(u).forEach(([t,s])=>{o.setAttribute(t,s)}),o.textContent=r,o.outerHTML}else return""},st={"& > div:first-of-type":{flex:1}};function B(a){const{translations:r,onUpdate:u,onLangSwitch:o,onRemove:t}=a,{t:s}=S(),i=O(),m=(l,f)=>[{type:"select",label:s("Language"),value:l,options:Object.entries(M).reduce((n,y)=>({...n,[y[0]]:i(y[1])}),{}),disabledOptions:r.filter(n=>n[0]!==l).map(n=>n[0]),onChange:n=>o(l,n)},{type:"input",label:s("Name"),value:f,onChange:n=>u(l,n),validator:n=>!!n}],w=()=>{const l=Object.keys(M).filter(f=>!r.find(n=>n[0]===f))[0];u(l,"")};return e(Le,{direction:"column",children:r.map(([l,f],n,y)=>d(L,{sx:st,children:[e(ee,{fields:m(l,f),noLabel:n>0}),n===y.length-1?e(v,{size:"sm",variant:"ghost","aria-label":s("Add a name in another language"),title:s("Add a name in another language"),onClick:w,icon:e(X,{})}):e(Q,{minW:8}),y.length>1&&e(v,{size:"sm",variant:"ghost","aria-label":s("Remove this name"),title:s("Remove this name"),onClick:()=>t(l),icon:e(Pe,{})})]},n))})}const ot={px:2,pt:2,width:{base:"100%",md:520},"& > div:first-of-type":{flexDirection:"column",flex:1,overflowY:"auto"},"& > div:nth-of-type(2)":{my:2}};function it(){var D,T;const{t:a}=S(),r=Z(),u=()=>{g.isStandaloneWindow()?r("/"):g.openApp("rmg-templates")},o=b.useRef(null),[t,s]=b.useState(!1),[i,m]=b.useState({name:{en:""},desc:{en:""},reference:"",justification:""}),[w,l]=b.useState(""),f=(T=(D=i.name.en)==null?void 0:D.replace(/[^A-Za-z0-9]/g,"").toLowerCase())!=null?T:"",n=[et,tt,z("metadata",JSON.stringify(i,null,4),{}),z("real_world",w,{compress:"zipson",city:f})].join(`

`),y=new URLSearchParams({labels:"resources",title:`Resources: New template of ${f}`}),se=async c=>{var p;const h=(p=c.target.files)==null?void 0:p[0];if(console.log("handleFileUpload():: received file",h),!!h){if(h.type!=="application/json"){alert("Invalid file type!"),c.target.value="";return}try{const E=await rt(h);l(Ee.stringify(JSON.parse(E.trim())).trim())}catch(E){alert("Invalid file!"),c.target.value=""}}},oe=async()=>{o!=null&&o.current&&(o.current.select(),await navigator.clipboard.writeText(n)),window.open("https://github.com/railmapgen/rmp-gallery/issues/new?"+y.toString(),"_blank")},ie=[{type:"custom",label:a("Project file"),component:e(Oe,{variant:"flushed",size:"xs",type:"file",accept:".json",onChange:se}),minW:250},{type:"input",label:a("Reference link"),placeholder:"Enter the link where you get the valid data",value:i.reference,onChange:c=>m({...i,reference:c}),minW:250},{type:"input",label:a("Justification"),placeholder:"The reason why you make these changes",value:i.justification,onChange:c=>m({...i,justification:c}),minW:250}];return d(te,{sx:ot,children:[d(C,{children:[e(ee,{fields:ie}),e(I,{label:a("City Name"),children:e(B,{translations:Object.entries(i.name),onUpdate:(c,h)=>m({...i,name:{...i.name,[c]:h}}),onLangSwitch:(c,h)=>{const p=structuredClone(i);p.name[h]=p.name[c],delete p.name[c],m(p)},onRemove:c=>{const h=structuredClone(i);delete h.name[c],m(h)}})}),e(I,{label:a("Description (Optional)"),children:e(B,{translations:Object.entries(i.desc),onUpdate:(c,h)=>m({...i,desc:{...i.desc,[c]:h}}),onLangSwitch:(c,h)=>{const p=structuredClone(i);p.desc[h]=p.desc[c],delete p.desc[c],m(p)},onRemove:c=>{const h=structuredClone(i);delete h.desc[c],m(h)}})})]}),d(C,{children:[e(R,{size:"sm",onClick:u,children:a("Back to list")}),e(L,{ml:"auto",children:e(R,{size:"sm",colorScheme:"primary",isDisabled:w===""||i.reference===""||f==="",onClick:()=>s(!0),children:a("Submit")})})]}),d(G,{isOpen:t,onClose:()=>s(!1),children:[e(H,{}),d(F,{children:[e(U,{children:a("Submit template")}),e(W,{}),d($,{children:[e(J,{children:a("You may now copy the following text into your new issue's body.")}),e(De,{mt:"2",mb:"2"}),e(Te,{ref:o,isReadOnly:!0,defaultValue:n,onClick:({target:c})=>c.select()})]}),e(Y,{children:e(R,{colorScheme:"primary",onClick:oe,children:a("Copy issue body and open a new issue")})})]})]})]})}function lt(){const{t:a}=S(),r=g.getEnv(),u=g.getAppVersion(),o=t=>{g.setLanguage(t),g.getI18nInstance().changeLanguage(t)};return d(xe,{children:[e(A,{as:"h4",size:"md",children:a("header.about.rmpGallery")}),e(Ie,{environment:r,version:u}),e(L,{ml:"auto",children:d(ke,{children:[e(je,{as:v,icon:e(_e,{}),variant:"ghost",size:"sm"}),e(ze,{children:Be.map(t=>e(Ne,{onClick:()=>o(t),children:M[t][t]},t))})]})})]})}function ct(){return e(Ge,{basename:"/rmp-gallery/",children:e(He,{children:d(Fe,{children:[e(lt,{}),e(te,{children:d(Ue,{children:[e(k,{path:"/",element:e(j,{suspenseFallback:e(_,{isIndeterminate:!0}),children:e(nt,{})})}),e(k,{path:"/new",element:e(j,{suspenseFallback:e(_,{isIndeterminate:!0}),children:e(it,{})})})]})})]})})})}const dt={about:{rmpGallery:"RMP Gallery"}},ut={type:{realWorld:"Real World",fantasy:"Fantasy"}},ht={header:dt,gallery:ut},mt={about:{rmpGallery:"RMP画廊"}},pt={header:mt},gt={about:{rmpGallery:"RMP畫廊"}},ft={header:gt},yt={about:{rmpGallery:"RMP Gallery"}},bt={header:yt},wt=new g.I18nBuilder().use(We).withAppName("RMP Gallery").withLng(g.getLanguage()).withResource("en",ht).withResource("zh-Hans",pt).withResource("zh-Hant",ft).withResource("ko",bt).build();let N;const vt=()=>{N=$e(document.getElementById("root")),N.render(e(Ve.StrictMode,{children:e(Je,{store:ne,children:e(Ye,{i18n:wt,children:e(ct,{})})})}))};g.ready().then(()=>{vt(),g.injectCss(),g.event(P.APP_LOAD,{})});export{St as __vite_legacy_guard};
