"use strict";(self.webpackChunkrmg_palette=self.webpackChunkrmg_palette||[]).push([[1041],{4517:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(3168),i=t(2638);function o(){var e=(0,r.$)().i18n;return function(n){var t,r;return null!==(t=null!==(r=e.languages.map((function(e){return n[e]})).find((function(e){return void 0!==e})))&&void 0!==r?r:n[i.sp.English])&&void 0!==t?t:"(Translation Error)"}}},6016:function(e,n,t){t.r(n),t.d(n,{default:function(){return O}});var r=t(9439),i=t(8735),o=t(2504),s=t(2791),l=t(4942),a=t(1413),u=t(4588),c=t(2638),d=t(7322),h=t(2161),f=t(3168),x=t(184);function g(e){var n,t=e.onUpdate,r=e.onAdd,s=e.onRemove,g=null!==(n=e.entries)&&void 0!==n?n:h.dX.getInitialState(),j=(0,f.$)().t,m=function(e){var n=h.$j.selectById(g,e);if(!n)return[];var r=n.lang,i=n.name,o=Object.entries(c.sp).reduce((function(e,n){return n[1]!==r&&n[1]in g?e:(0,a.Z)((0,a.Z)({},e),{},(0,l.Z)({},n[1],n[0]))}),{});return[{type:"select",label:j("Language"),value:r,options:o,onChange:function(n){return t(e,{lang:n})}},{type:"input",label:j("Name"),value:i,onChange:function(n){return t(e,{name:n})},validator:function(e){return""!==e}}]},p=function(){var e=Object.values(c.sp).filter((function(e){return!Object.values(g.entities).find((function(n){return(null===n||void 0===n?void 0:n.lang)===e}))}))[0];r(e)};return(0,x.jsx)(u.bg,{direction:"column",children:h.$j.selectIds(g).map((function(e,n){return(0,x.jsxs)(i.Ug,{sx:{"& > div:first-of-type":{flex:1}},"data-testid":"entry-card-stack-"+e,children:[(0,x.jsx)(u.M5,{fields:m(e),noLabel:n>0}),n===g.ids.length-1?(0,x.jsx)(o.hU,{size:"sm",variant:"ghost","aria-label":j("Add a name in another language"),title:j("Add a name in another language"),onClick:p,icon:(0,x.jsx)(d.x06,{})}):(0,x.jsx)(i.xu,{minW:8}),(0,x.jsx)(o.hU,{size:"sm",variant:"ghost","aria-label":j("Remove this name"),title:j("Remove this name"),onClick:function(){return s(e)},icon:(0,x.jsx)(d.ZkW,{})})]},e)}))})}var j=t(9840),m=t(7339),p=t(4517);function v(){var e=(0,f.$)().t,n=(0,p.Z)(),t=(0,m.u5)(),r=(0,m.Qy)((function(e){return e.ticket})),o=r.country,s=r.newCountry,d=r.countryName,h=(0,a.Z)((0,a.Z)({},c.Jm.reduce((function(e,t){return t.id===c.Cv.UN?e:(0,a.Z)((0,a.Z)({},e),{},(0,l.Z)({},t.id,n(t.name)))}),{})),{},{new:e("Add a country/region...")}),v=[{type:"select",label:e("Country / Region"),value:o,options:h,onChange:function(e){return t((0,j.RZ)(e))}},{type:"input",label:e("Country/region code"),placeholder:"e.g. CN, HK, JP (ISO 3166-1 alpha-2)",value:s,onChange:function(e){return t((0,j.o8)(e))},hidden:"new"!==o}];return(0,x.jsxs)(i.xu,{as:"section",children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",mb:2,children:e("Country / Region")}),(0,x.jsx)(u.M5,{fields:v}),"new"===o&&(0,x.jsx)(g,{entries:d,onUpdate:function(e,n){return t((0,j.uA)({id:e,changes:n}))},onAdd:function(e){return t((0,j.W2)(e))},onRemove:function(e){return t((0,j.p7)(e))}})]})}function y(){var e=(0,f.$)().t,n=(0,m.u5)(),t=(0,m.Qy)((function(e){return e.ticket})),r=t.city,o=t.cityName,s=[{type:"input",label:e("City code"),placeholder:"e.g. hongkong, guangzhou, shanghai",value:r,onChange:function(e){return n((0,j.nc)(e))},validator:function(e){return""!==e&&!e.match(/[^a-z]/)}}];return(0,x.jsxs)(i.xu,{as:"section",children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",mt:3,mb:2,children:e("City")}),(0,x.jsx)(u.M5,{fields:s}),(0,x.jsx)(g,{entries:o,onUpdate:function(e,t){return n((0,j.O0)({id:e,changes:t}))},onAdd:function(e){return n((0,j.Pe)(e))},onRemove:function(e){return n((0,j.VE)(e))}})]})}function b(){var e,n=(0,f.$)().t,t=(0,p.Z)(),v=(0,m.u5)(),y=(0,m.Qy)((function(e){return e.ticket.lines})),b=(0,s.useState)(Object.keys(y)[0]),C=(0,r.Z)(b,2),k=C[0],w=C[1];return(0,x.jsxs)(i.xu,{as:"section",children:[(0,x.jsxs)(i.kC,{mt:3,mb:2,alignItems:"center",children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",mr:"auto",children:n("Lines")}),(0,x.jsx)(o.zx,{size:"xs",variant:"ghost",leftIcon:(0,x.jsx)(d.x06,{}),mr:1,onClick:function(){return v((0,j.j0)())},children:n("Add a line")})]}),(0,x.jsx)(i.Ug,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:Object.entries(y).map((function(e){var i=(0,r.Z)(e,2),s=i[0],c=i[1],f=h.$j.selectAll(c.nameEntity).reduce((function(e,n){return(0,a.Z)((0,a.Z)({},e),{},(0,l.Z)({},n.lang,n.name))}),{}),g=t(f);return(0,x.jsx)(u.l2,{name:g,bg:c.colour,fg:c.fg,actions:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.hU,{size:"xs",variant:"ghost",color:c.fg,"aria-label":n("Edit")+" "+g,title:n("Edit")+" "+g,icon:(0,x.jsx)(d.zmo,{}),onClick:function(){return w(s)}}),(0,x.jsx)(o.hU,{size:"xs",variant:"ghost",color:c.fg,"aria-label":n("Copy")+" "+g,title:n("Copy")+" "+g,icon:(0,x.jsx)(d.Fqs,{}),onClick:function(){return v((0,j.Dj)(s))}}),(0,x.jsx)(o.hU,{size:"xs",variant:"ghost",color:c.fg,"aria-label":n("Remove")+" "+g,title:n("Remove")+" "+g,icon:(0,x.jsx)(d.ZkW,{}),onClick:function(){return v((0,j.zq)(s))}})]})},s)}))}),(0,x.jsx)(u.M5,{fields:function(e){var t,r=y[e];return r?[{type:"input",label:n("Line code"),placeholder:"e.g. twl, gz1, sh1",value:r.id,onChange:function(n){return v((0,j.uD)({entryId:e,lineId:n}))},validator:function(e){return""!==e&&!e.match(/[^a-z0-9]/)}},{type:"input",label:n("Background colour"),variant:"color",value:r.colour,onChange:function(n){return v((0,j.OO)({entryId:e,bgColour:n}))}},{type:"select",label:n("Foreground colour"),value:r.fg,options:(t={},(0,l.Z)(t,c.AJ.white,n("White")),(0,l.Z)(t,c.AJ.black,n("Black")),t),onChange:function(n){return v((0,j.AV)({entryId:e,fgColour:n}))}}]:[]}(k)}),(0,x.jsx)(g,{entries:null===(e=y[k])||void 0===e?void 0:e.nameEntity,onUpdate:function(e,n){return v((0,j.HA)({entryId:k,id:e,changes:n}))},onAdd:function(e){return v((0,j.lJ)({entryId:k,lang:e}))},onRemove:function(e){return v((0,j.UV)({entryId:k,id:e}))}})]})}var C=t(5861),k=t(7757),w=t.n(k),z=t(1564),Z=t(9113),S=t(3543);function R(e){var n,t,l=e.isOpen,a=e.onClose,c=(0,f.$)().t,h=(0,p.Z)(),g=(0,s.useState)([]),v=(0,r.Z)(g,2),y=v[0],b=v[1],k=(0,s.useState)([]),R=(0,r.Z)(k,2),I=R[0],O=R[1],U=(0,s.useState)({}),A=(0,r.Z)(U,2),E=A[0],H=A[1],L=(0,s.useState)(!1),$=(0,r.Z)(L,2),F=$[0],N=$[1],P=(0,s.useRef)(null),Q=(0,m.Qy)((function(e){return e.ticket})),q=j.Hl.getCityEntry(Q),J=j.Hl.getPalettes(Q);(0,s.useEffect)((function(){l?(b(j.Hl.getCountryErrors(Q)),O(j.Hl.getCityErrors(Q)),H(j.Hl.getLineErrors(Q))):N(!1)}),[l]);var W=["**Justification:** (Replace the content within these brackets, or we will not proceed your request.)",S.o4,(0,S.sZ)(q),(0,S.$W)(J)].join("\n\n"),X=new URLSearchParams({template:"new-palettes-request.md",label:"resources",title:"Resources: New palettes of "+(null===q||void 0===q||null===(n=q.name)||void 0===n?void 0:n.en),body:W}),B=new URLSearchParams({template:"new-palettes-request.md",label:"resources",title:"Resources: New palettes of "+(null===q||void 0===q||null===(t=q.name)||void 0===t?void 0:t.en)}),M=function(){var e=(0,C.Z)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===P||void 0===P||!P.current){e.next=4;break}return P.current.select(),e.next=4,navigator.clipboard.writeText(W);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=y.length>0||I.length>0||Object.values(E).flat().length>0;return(0,x.jsxs)(z.u_,{blockScrollOnMount:!1,isOpen:l,onClose:a,scrollBehavior:"inside",children:[(0,x.jsx)(z.ZA,{}),(0,x.jsxs)(z.hz,{children:[(0,x.jsx)(z.xB,{children:c("Submit palettes")}),(0,x.jsx)(z.ol,{}),(0,x.jsxs)(z.fe,{children:[V&&(0,x.jsx)(i.xv,{children:c("Your inputs contain the following errors. Please consider fixing it before submitting.")}),y.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",my:2,children:c("Country / Region")}),(0,x.jsx)(i.QI,{"aria-label":"List of country errors",children:y.map((function(e,n){return(0,x.jsx)(i.HC,{children:h(S.ui[e])},n)}))})]}),I.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",my:2,children:c("City")}),(0,x.jsx)(i.QI,{"aria-label":"List of city errors",children:I.map((function(e,n){return(0,x.jsx)(i.HC,{children:h(S.ui[e])},n)}))})]}),Object.values(E).flat().length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",my:2,children:c("Lines")}),(0,x.jsx)(i.QI,{"aria-label":"List of line errors",children:Object.entries(E).map((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];return(0,x.jsxs)(i.HC,{children:[t,(0,x.jsx)(i.QI,{children:o.map((function(e,n){return(0,x.jsx)(i.HC,{children:h(S.ui[e])},n)}))})]},t)}))})]}),(!V||F)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.xv,{children:c("If the button below doesn't work for you, please follow the instructions below:")}),(0,x.jsxs)(i.GS,{children:[(0,x.jsxs)(i.HC,{children:[c("Open")," ",(0,x.jsxs)(i.rU,{color:"teal.500",href:"https://github.com/railmapgen/rmg-palette/issues/new?"+B.toString(),isExternal:!0,children:["Issue: New Palettes Request ",(0,x.jsx)(Z.JO,{as:d.jhj})]})]}),(0,x.jsxs)(i.HC,{children:[c("Paste following text to the issue body and add anything you want to say.")," ",(0,x.jsx)(o.zx,{size:"xs",leftIcon:(0,x.jsx)(d.Fqs,{}),onClick:M,children:c("Copy")}),(0,x.jsx)(u.SD,{ref:P,isReadOnly:!0,defaultValue:W,onClick:function(e){return e.target.select()}})]})]})]})]}),(0,x.jsx)(z.mz,{children:!F&&V?(0,x.jsxs)(i.Ug,{children:[(0,x.jsx)(o.zx,{onClick:function(){return N(!0)},children:c("Submit anyway")}),(0,x.jsx)(o.zx,{colorScheme:"teal",onClick:a,children:c("Go back")})]}):(0,x.jsx)(o.zx,{colorScheme:"teal",onClick:function(){return window.open("https://github.com/railmapgen/rmg-palette/issues/new?"+X.toString(),"_blank")},children:c("1-click open issue")})})]})]})}var I=t(6871);function O(){var e=(0,f.$)().t,n=(0,m.u5)(),t=(0,I.s0)(),l=(0,s.useState)(!1),a=(0,r.Z)(l,2),c=a[0],d=a[1];return(0,x.jsxs)(u.uo,{px:2,pt:2,sx:{width:{base:"100%",md:520}},children:[(0,x.jsxs)(i.kC,{direction:"column",flex:1,overflowY:"auto",children:[(0,x.jsx)(v,{}),(0,x.jsx)(y,{}),(0,x.jsx)(b,{})]}),(0,x.jsxs)(i.kC,{my:2,children:[(0,x.jsx)(o.zx,{size:"sm",onClick:function(){return t("/")},children:e("Go back")}),(0,x.jsxs)(i.Ug,{ml:"auto",children:[(0,x.jsx)(o.zx,{size:"sm",variant:"outline",onClick:function(){return n((0,j.US)())},children:e("Reset")}),(0,x.jsx)(o.zx,{size:"sm",colorScheme:"teal",onClick:function(){return d(!0)},children:e("Submit")})]})]}),(0,x.jsx)(R,{isOpen:c,onClose:function(){return d(!1)}})]})}}}]);
//# sourceMappingURL=TicketView.d6f3af3c.chunk.js.map