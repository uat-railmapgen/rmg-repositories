"use strict";(self.webpackChunkrmg_palette=self.webpackChunkrmg_palette||[]).push([[1041],{6016:function(e,n,t){t.r(n),t.d(n,{default:function(){return I}});var r=t(885),i=t(8735),s=t(2504),o=t(2791),l=t(4942),a=t(1413),u=t(4588),c=t(2638),d=t(7322),h=t(2161),x=t(184);function f(e){var n,t=e.onUpdate,r=e.onAdd,o=e.onRemove,f=null!==(n=e.entries)&&void 0!==n?n:h.dX.getInitialState(),j=function(e){var n=h.$j.selectById(f,e);if(!n)return[];var r=n.lang,i=n.name,s=Object.entries(c.sp).reduce((function(e,n){return n[1]!==r&&n[1]in f?e:(0,a.Z)((0,a.Z)({},e),{},(0,l.Z)({},n[1],n[0]))}),{});return[{type:"select",label:"Language",value:r,options:s,onChange:function(n){return t(e,{lang:n})}},{type:"input",label:"Name",value:i,onChange:function(n){return t(e,{name:n})},validator:function(e){return""!==e}}]},g=function(){var e=Object.values(c.sp).filter((function(e){return!Object.values(f.entities).find((function(n){return(null===n||void 0===n?void 0:n.lang)===e}))}))[0];r(e)};return(0,x.jsx)(u.bg,{direction:"column",children:h.$j.selectIds(f).map((function(e,n){return(0,x.jsxs)(i.Ug,{sx:{"& > div:first-of-type":{flex:1}},"data-testid":"entry-card-stack-"+e,children:[(0,x.jsx)(u.M5,{fields:j(e),noLabel:n>0}),n===f.ids.length-1?(0,x.jsx)(s.hU,{size:"sm",variant:"ghost","aria-label":"Add name in another language",onClick:g,icon:(0,x.jsx)(d.x06,{})}):(0,x.jsx)(i.xu,{minW:8}),(0,x.jsx)(s.hU,{size:"sm",variant:"ghost","aria-label":"Remove name",onClick:function(){return o(e)},icon:(0,x.jsx)(d.ZkW,{})})]},e)}))})}var j=t(9840),g=t(7339);function m(){var e=(0,g.u5)(),n=(0,g.Qy)((function(e){return e.ticket})),t=n.country,r=n.newCountry,s=n.countryName,o=[{type:"select",label:"Country/region",value:t,options:(0,a.Z)((0,a.Z)({},c.Jm.reduce((function(e,n){return n.id===c.Cv.UN?e:(0,a.Z)((0,a.Z)({},e),{},(0,l.Z)({},n.id,n.name.en))}),{})),{},{new:"Add a new country/region..."}),onChange:function(n){return e((0,j.RZ)(n))}},{type:"input",label:"Country code",placeholder:"e.g. CN, HK, JP (ISO 3166-1 alpha-2)",value:r,onChange:function(n){return e((0,j.o8)(n))},hidden:"new"!==t}];return(0,x.jsxs)(i.xu,{as:"section",children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",mb:2,children:"Country / Region"}),(0,x.jsx)(u.M5,{fields:o}),"new"===t&&(0,x.jsx)(f,{entries:s,onUpdate:function(n,t){return e((0,j.uA)({id:n,changes:t}))},onAdd:function(n){return e((0,j.W2)(n))},onRemove:function(n){return e((0,j.p7)(n))}})]})}function p(){var e=(0,g.u5)(),n=(0,g.Qy)((function(e){return e.ticket})),t=n.city,r=n.cityName,s=[{type:"input",label:"City code",placeholder:"e.g. hongkong, guangzhou, shanghai",value:t,onChange:function(n){return e((0,j.nc)(n))},validator:function(e){return""!==e&&!e.match(/[^a-z]/)}}];return(0,x.jsxs)(i.xu,{as:"section",children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",mt:3,mb:2,children:"City"}),(0,x.jsx)(u.M5,{fields:s}),(0,x.jsx)(f,{entries:r,onUpdate:function(n,t){return e((0,j.O0)({id:n,changes:t}))},onAdd:function(n){return e((0,j.Pe)(n))},onRemove:function(n){return e((0,j.VE)(n))}})]})}function v(){var e,n=(0,g.u5)(),t=(0,g.Qy)((function(e){return e.ticket.lines})),a=(0,o.useState)(Object.keys(t)[0]),m=(0,r.Z)(a,2),p=m[0],v=m[1];return(0,x.jsxs)(i.xu,{as:"section",children:[(0,x.jsxs)(i.kC,{mt:3,mb:2,alignItems:"center",children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",mr:"auto",children:"Lines"}),(0,x.jsx)(s.zx,{size:"xs",variant:"ghost",leftIcon:(0,x.jsx)(d.x06,{}),mr:1,onClick:function(){return n((0,j.j0)())},children:"Add line"})]}),(0,x.jsx)(i.Ug,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:Object.entries(t).map((function(e){var t,i=(0,r.Z)(e,2),o=i[0],l=i[1],a=h.$j.selectAll(l.nameEntity).find((function(e){return e.lang===c.sp.English}));return(0,x.jsx)(u.l2,{name:null!==(t=null===a||void 0===a?void 0:a.name)&&void 0!==t?t:"",bg:l.colour,fg:l.fg,actions:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(s.hU,{size:"xs",variant:"ghost",color:l.fg,"aria-label":"Edit "+a,icon:(0,x.jsx)(d.zmo,{}),onClick:function(){return v(o)}}),(0,x.jsx)(s.hU,{size:"xs",variant:"ghost",color:l.fg,"aria-label":"Copy "+a,icon:(0,x.jsx)(d.Fqs,{}),onClick:function(){return n((0,j.Dj)(o))}}),(0,x.jsx)(s.hU,{size:"xs",variant:"ghost",color:l.fg,"aria-label":"Remove "+a,icon:(0,x.jsx)(d.ZkW,{}),onClick:function(){return n((0,j.zq)(o))}})]})},o)}))}),(0,x.jsx)(u.M5,{fields:function(e){var r,i=t[e];return i?[{type:"input",label:"Line code",placeholder:"e.g. twl, gz1, sh1",value:i.id,onChange:function(t){return n((0,j.uD)({entryId:e,lineId:t}))},validator:function(e){return""!==e&&!e.match(/[^a-z0-9]/)}},{type:"input",label:"Background colour",variant:"color",value:i.colour,onChange:function(t){return n((0,j.OO)({entryId:e,bgColour:t}))}},{type:"select",label:"Foreground colour",value:i.fg,options:(r={},(0,l.Z)(r,c.AJ.white,"White"),(0,l.Z)(r,c.AJ.black,"Black"),r),onChange:function(t){return n((0,j.AV)({entryId:e,fgColour:t}))}}]:[]}(p)}),(0,x.jsx)(f,{entries:null===(e=t[p])||void 0===e?void 0:e.nameEntity,onUpdate:function(e,t){return n((0,j.HA)({entryId:p,id:e,changes:t}))},onAdd:function(e){return n((0,j.lJ)({entryId:p,lang:e}))},onRemove:function(e){return n((0,j.UV)({entryId:p,id:e}))}})]})}var y=t(5861),b=t(7757),C=t.n(b),k=t(1564),w=t(9113),z=t(3543);function Z(e){var n,t,l=e.isOpen,a=e.onClose,c=(0,o.useState)([]),h=(0,r.Z)(c,2),f=h[0],m=h[1],p=(0,o.useState)([]),v=(0,r.Z)(p,2),b=v[0],Z=v[1],S=(0,o.useState)({}),I=(0,r.Z)(S,2),O=I[0],U=I[1],R=(0,o.useState)(!1),A=(0,r.Z)(R,2),H=A[0],E=A[1],L=(0,o.useRef)(null),F=(0,g.Qy)((function(e){return e.ticket})),N=j.Hl.getCityEntry(F),P=j.Hl.getPalettes(F);(0,o.useEffect)((function(){l?(m(j.Hl.getCountryErrors(F)),Z(j.Hl.getCityErrors(F)),U(j.Hl.getLineErrors(F))):E(!1)}),[l]);var Q=["**Justification:** (Replace the content within these brackets, or we will not proceed your request.)",z.o4,(0,z.sZ)(N),(0,z.$W)(P)].join("\n\n"),q=new URLSearchParams({template:"new-palettes-request.md",label:"resources",title:"Resources: New palettes of "+(null===N||void 0===N||null===(n=N.name)||void 0===n?void 0:n.en),body:Q}),J=new URLSearchParams({template:"new-palettes-request.md",label:"resources",title:"Resources: New palettes of "+(null===N||void 0===N||null===(t=N.name)||void 0===t?void 0:t.en)}),W=function(){var e=(0,y.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===L||void 0===L||!L.current){e.next=4;break}return L.current.select(),e.next=4,navigator.clipboard.writeText(Q);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=f.length>0||b.length>0||Object.values(O).flat().length>0;return(0,x.jsxs)(k.u_,{blockScrollOnMount:!1,isOpen:l,onClose:a,scrollBehavior:"inside",children:[(0,x.jsx)(k.ZA,{}),(0,x.jsxs)(k.hz,{children:[(0,x.jsx)(k.xB,{children:"Submit palettes"}),(0,x.jsx)(k.ol,{}),(0,x.jsxs)(k.fe,{children:[X&&(0,x.jsx)(i.xv,{children:"Your inputs contain the following errors. Please consider fixing it before submitting."}),f.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",my:2,children:"Country / Region"}),(0,x.jsx)(i.QI,{"aria-label":"List of country errors",children:f.map((function(e,n){return(0,x.jsx)(i.HC,{children:e},n)}))})]}),b.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",my:2,children:"City"}),(0,x.jsx)(i.QI,{"aria-label":"List of city errors",children:b.map((function(e,n){return(0,x.jsx)(i.HC,{children:e},n)}))})]}),Object.values(O).flat().length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.X6,{as:"h5",size:"sm",my:2,children:"Lines"}),(0,x.jsx)(i.QI,{"aria-label":"List of line errors",children:Object.entries(O).map((function(e){var n=(0,r.Z)(e,2),t=n[0],s=n[1];return(0,x.jsxs)(i.HC,{children:[t,(0,x.jsx)(i.QI,{children:s.map((function(e,n){return(0,x.jsx)(i.HC,{children:e},n)}))})]},t)}))})]}),(!X||H)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.xv,{children:"If the button below doesn't work for you, please follow the instructions below:"}),(0,x.jsxs)(i.GS,{children:[(0,x.jsxs)(i.HC,{children:["Open"," ",(0,x.jsxs)(i.rU,{color:"teal.500",href:"https://github.com/railmapgen/rmg-palette/issues/new?"+J.toString(),isExternal:!0,children:["Issue: New Palettes Request ",(0,x.jsx)(w.JO,{as:d.jhj})]}),"."]}),(0,x.jsxs)(i.HC,{children:["Paste following text to the issue body and add anything you want to say."," ",(0,x.jsx)(s.zx,{size:"xs",leftIcon:(0,x.jsx)(d.Fqs,{}),onClick:W,children:"Copy"}),(0,x.jsx)(u.SD,{ref:L,isReadOnly:!0,defaultValue:Q,onClick:function(e){return e.target.select()}})]})]})]})]}),(0,x.jsx)(k.mz,{children:!H&&X?(0,x.jsxs)(i.Ug,{children:[(0,x.jsx)(s.zx,{onClick:function(){return E(!0)},children:"Submit anyway"}),(0,x.jsx)(s.zx,{colorScheme:"teal",onClick:a,children:"Go back"})]}):(0,x.jsx)(s.zx,{colorScheme:"teal",onClick:function(){return window.open("https://github.com/railmapgen/rmg-palette/issues/new?"+q.toString(),"_blank")},children:"1-click open issue"})})]})]})}var S=t(6871);function I(){var e=(0,g.u5)(),n=(0,S.s0)(),t=(0,o.useState)(!1),l=(0,r.Z)(t,2),a=l[0],c=l[1];return(0,x.jsxs)(u.uo,{px:2,pt:2,sx:{width:{base:"100%",md:520}},children:[(0,x.jsxs)(i.kC,{direction:"column",flex:1,overflowY:"auto",children:[(0,x.jsx)(m,{}),(0,x.jsx)(p,{}),(0,x.jsx)(v,{})]}),(0,x.jsxs)(i.kC,{my:2,children:[(0,x.jsx)(s.zx,{size:"sm",onClick:function(){return n("/")},children:"Go back"}),(0,x.jsxs)(i.Ug,{ml:"auto",children:[(0,x.jsx)(s.zx,{size:"sm",variant:"outline",onClick:function(){return e((0,j.US)())},children:"Reset"}),(0,x.jsx)(s.zx,{size:"sm",colorScheme:"teal",onClick:function(){return c(!0)},children:"Submit"})]})]}),(0,x.jsx)(Z,{isOpen:a,onClose:function(){return c(!1)}})]})}}}]);
//# sourceMappingURL=TicketView.51f78df5.chunk.js.map