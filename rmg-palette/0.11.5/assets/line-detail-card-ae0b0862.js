import{j as e,a0 as z,H as x,B as O,F as R}from"./chakra-7070dc54.js";import{a as F,M as k,X as L,i as P,Y as M,L as D}from"./index-1e9275cb.js";import{u as b,r as m,a as I}from"./react-af516715.js";import{R as w,M as N,e as S,f as U,g as T,h as G,d as W}from"./index.esm-fa0f4c6f.js";function A(){const{i18n:r}=b();return n=>{var l,o;return(o=(l=r.languages.map(c=>n[c]).find(c=>c!==void 0))!=null?l:n.en)!=null?o:"(Translation Error)"}}const q=r=>`{ getColor(code:"${r}") { code, rgb { r g b }, hex, cmyk { c m y k } } }`,H=async(r,n)=>"#"+(await(await fetch("https://4n6dg5ccsfct3lzfssu34boemq.appsync-api.us-east-1.amazonaws.com/graphql",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":"da2-sa3lsp2tkzhj3c2ysxbdprl73e"},body:JSON.stringify({query:q(r)}),signal:n})).json()).data.getColor.hex;function K(r){var j;const{lineDetail:n,onUpdate:l}=r,{t:o}=b(),{pantoneReady:c}=F(t=>t.app),[d,f]=m.useState(!!n.pantone),[y,u]=m.useState((j=n.pantone)!=null?j:""),[g,i]=m.useState(!1),a=m.useRef(new AbortController);m.useEffect(()=>()=>{var t;(t=a.current)==null||t.abort()},[]);const s=async t=>{var h;if(a.current.abort(),!!c){a.current=new AbortController,i(!0);try{const E=await H(t,a.current.signal);l({pantone:t,colour:E}),u(t)}catch(E){I.flushSync(()=>{u(t)}),u((h=n.pantone)!=null?h:"")}finally{i(!1)}}},p=[{label:o("Yes"),value:!0},{label:o("No"),value:!1}],v=[{label:o("Black"),value:k.black},{label:o("White"),value:k.white}],C=[{type:"input",label:o("Line code"),placeholder:"e.g. twl, gz1, sh1",value:n.id,onChange:t=>l({id:t}),validator:t=>t!==""&&!t.match(/[^a-z0-9]/)},{type:"input",label:o("Background colour"),variant:d?"text":"color",value:n.colour,onChange:t=>l({colour:t}),isDisabled:c&&d},{type:"custom",label:o("Use Pantone"),component:e.jsx(L,{selections:p,defaultValue:d,onChange:t=>f(t)}),hidden:!c},{type:"input",label:o("Pantone code"),value:y,onChange:s,debouncedDelay:1500,hidden:!c||!d},{type:"custom",label:o("Foreground colour"),component:e.jsx(L,{selections:v,defaultValue:n.fg,onChange:t=>l({fg:t})})}];return e.jsxs(e.Fragment,{children:[g&&e.jsx(P,{isIndeterminate:!0}),e.jsx(w,{fields:C})]})}const V={"& > div:first-of-type":{flex:1}},B=r=>{var g;const{onUpdate:n,onLangSwitch:l,onRemove:o}=r,c=(g=r.entries)!=null?g:[],{t:d}=b(),f=A(),y=(i,a)=>[{type:"select",label:d("Language"),value:i,options:Object.entries(D).reduce((s,p)=>({...s,[p[0]]:f(p[1])}),{}),disabledOptions:c.filter(s=>s[0]!==i).map(s=>s[0]),onChange:s=>l(i,s)},{type:"input",label:d("Name"),value:a,onChange:s=>n(i,s),validator:s=>!!s}],u=()=>{const i=Object.keys(D).filter(a=>!c.find(s=>s[0]===a))[0];n(i,"")};return e.jsx(e.Fragment,{children:c.map(([i,a],s,p)=>e.jsxs(z,{sx:V,"data-testid":"entry-card-stack-"+i,children:[e.jsx(w,{fields:y(i,a),noLabel:s>0}),s===p.length-1?e.jsx(x,{size:"sm",variant:"ghost","aria-label":d("Add a name in another language"),title:d("Add a name in another language"),onClick:u,icon:e.jsx(N,{})}):e.jsx(O,{minW:8}),p.length>1&&e.jsx(x,{size:"sm",variant:"ghost","aria-label":d("Remove this name"),title:d("Remove this name"),onClick:()=>o(i),icon:e.jsx(S,{})})]},s))})};function $(r){return e.jsx(M,{direction:"column",children:e.jsx(B,{...r})})}function Y(r){const{lineDetail:n}=r,{t:l}=b(),o=[{type:"output",label:l("Line code"),value:n.id},{type:"output",label:l("Background colour"),value:n.colour},{type:"output",label:l("Pantone code"),value:n.pantone,hidden:!n.pantone},{type:"output",label:l("Foreground colour"),value:n.fg===k.black?l("Black"):l("White")}];return e.jsx(w,{fields:o})}function Z(r){const{lineDetail:n,editable:l,onUpdate:o,onMoveUp:c,onMoveDown:d,onCopy:f,onRemove:y,onNameUpdate:u,onLangSwitch:g,onNameRemove:i}=r,{t:a}=b(),s=A(),[p,v]=m.useState(!1),C=m.useMemo(()=>({bg:n.colour,m:-1,w:"calc(100% + var(--chakra-space-1) * 2)",px:2,"&, button":{color:n.fg},"& > div:first-of-type":{overflow:"hidden",textWrap:"nowrap",textOverflow:"ellipsis"},"& > div:nth-of-type(2)":{ml:"auto"}}),[n.colour,n.fg]),j=s(Object.fromEntries(n.nameEntity));return e.jsxs(M,{direction:"column",sx:{pb:0},children:[e.jsxs(M,{sx:C,children:[e.jsx("div",{children:j}),l&&e.jsxs(z,{spacing:.5,children:[e.jsx(x,{size:"xs",variant:"ghost","aria-label":a("Move up"),title:a("Move up"),icon:e.jsx(U,{}),onClick:c}),e.jsx(x,{size:"xs",variant:"ghost","aria-label":a("Move down"),title:a("Move down"),icon:e.jsx(T,{}),onClick:d}),e.jsx(x,{size:"xs",variant:"ghost","aria-label":a("Edit"),title:a("Edit"),icon:e.jsx(G,{}),onClick:()=>v(t=>!t)}),e.jsx(x,{size:"xs",variant:"ghost","aria-label":a("Duplicate"),title:a("Duplicate"),icon:e.jsx(W,{}),onClick:f}),e.jsx(x,{size:"xs",variant:"ghost","aria-label":a("Remove"),title:a("Remove"),icon:e.jsx(S,{}),onClick:y})]})]}),p&&e.jsxs(R,{direction:"column",position:"relative",my:1,children:[e.jsx(K,{lineDetail:n,onUpdate:t=>o==null?void 0:o(t)}),e.jsx(B,{entries:n.nameEntity,onUpdate:(t,h)=>u==null?void 0:u(t,h),onLangSwitch:(t,h)=>g==null?void 0:g(t,h),onRemove:t=>i==null?void 0:i(t)})]}),!l&&e.jsx(R,{direction:"column",my:1,children:e.jsx(Y,{lineDetail:n})})]})}export{Z as L,$ as M,H as g,A as u};
