import{Y as w,h as v,j as t,B as b,$ as y,f as A,H as N}from"./chakra-dca798c1.js";import{u as D,a as f,s as E,R as M,r as l,E as C,b as T,M as k,c as L,g as B,p as H,d as I,e as P}from"./index-1d596612.js";import{u as R,n as j,r as x}from"./react-af516715.js";import{R as S,M as z}from"./index.esm-a73a456a.js";import{u as h}from"./use-translated-name-b1cd0e7b.js";import{m as G}from"./ag-grid-23746c80.js";import{u as F}from"./use-palette-945d5d87.js";var W=function(a){var o=a.children,r=w().colorMode,i=v("RmgAgGrid");return t.jsx(b,{className:r==="light"?"ag-theme-alpine":"ag-theme-alpine-dark",sx:i,children:o})};function Y(){const{t:a,i18n:o}=R(),r=h(),i=D(),n=j(),{countryList:c,selectedCountry:u}=f(s=>s.app),m=c.map(s=>[s.id,r(s.name)]).sort((s,e)=>s[1].localeCompare(e[1],o.languages[0])).reduce((s,e)=>e[0]==="UN"?s:{...s,[e[0]]:e[1]},{"":a("Please select...")}),p=[{type:"select",label:a("Country/Region"),value:u,options:m,disabledOptions:[""],onChange:s=>i(E(s))}],g=()=>{l.isStandaloneWindow()?n("/new"):l.openApp("rmg-palette-upload"),l.event(C.ADD_CITY,{})};return t.jsxs(M,{children:[t.jsx(S,{fields:p}),t.jsx(y,{ml:"auto",children:t.jsx(A,{variant:"solid",size:"sm",colorScheme:"primary",onClick:g,children:a("Add a city")})})]})}function O(a){const{city:o}=a,r=F(o),i=h();return t.jsx(y,{flexWrap:"wrap",sx:{"& .chakra-badge":{mb:1}},children:r.map(n=>t.jsx(T,{name:i(n.name),fg:n.fg||k.white,bg:n.colour},n.id))})}function V(){const{t:a,i18n:o}=R(),r=h(),i=L(),n=j(),{cityList:c,selectedCountry:u}=f(e=>e.app),m=c.filter(e=>e.country===u),p=x.useMemo(()=>[{headerName:a("City"),field:"name",valueFormatter:({value:e})=>r(e),comparator:(e,d)=>r(e).localeCompare(r(d),o.languages[0]),sortable:!0,sort:"asc",wrapText:!0},{headerName:a("Lines"),field:"id",cellRenderer:({value:e})=>t.jsx(O,{city:e}),flex:1,autoHeight:!0,resizable:!1},{headerName:a("Action"),field:"id",cellRenderer:({value:e})=>t.jsx(N,{size:"xs","aria-label":a("Edit city"),title:a("Edit city"),icon:t.jsx(z,{}),onClick:()=>s(e)}),resizable:!1,width:72}],[o.language]),g=x.useMemo(()=>({resizable:!0}),[]),s=async e=>{if(l.isStandaloneWindow()){const d=await B(e,c);d&&(i(H(d)),n("/new"))}else l.closeApp("rmg-palette-upload"),setTimeout(()=>{l.openApp("rmg-palette-upload","/rmg-palette/#/new?city="+e)},200);l.event(C.EDIT_CITY,{city:e})};return t.jsx(W,{children:t.jsx(G.AgGridReact,{rowData:m,columnDefs:p,defaultColDef:g,getRowId:({data:e})=>e.id,headerHeight:36,rowHeight:36,suppressCellFocus:!0,suppressRowVirtualisation:!0,debug:!1})})}function X(){const{isDataLoading:a}=f(o=>o.app);return t.jsxs(I,{children:[a&&t.jsx(P,{isIndeterminate:!0}),t.jsx(Y,{}),t.jsx(V,{})]})}export{X as default};
